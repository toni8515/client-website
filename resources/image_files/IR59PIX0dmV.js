if (self.CavalryLogger) { CavalryLogger.start_js_script(document.currentScript); }/*FB_PKG_DELIM*/

__d("LSTableDefaults",[],(function(a,b,c,d,e,f){e.exports={sync_groups:{syncStatus:[0,0],sendSyncParams:!1,minTimeToSyncTimestampMs:[0,0],canIgnoreTimestamp:!1,priority:[0,0],lastSyncRequestTimestampMs:[0,0],lastSyncCompletedTimestampMs:[0,0],syncChannel:[0,1]},pending_tasks:{enqueueTimestampMs:[0,0],firstExecutedTimestampMs:[0,0],failureCount:[0,0],minTimeToSyncTimestampMs:[0,0],pluginType:[0,0],priority:[0,0]},pending_fire_and_forget_tasks:{enqueueTimestampMs:[0,0],priority:[0,0]},contacts:{isMessengerUser:!1,isMemorialized:!1,blockedByViewerStatus:[0,0],rank:[0,0],contactType:[0,0],contactTypeExact:[0,0],canViewerMessage:!0,gender:[0,0],authorityLevel:[0,0],optimisticBlockedByViewerStatus:[0,0],optimisticBlockedByViewerStatusTimestampMs:[0,0],contactReachabilityStatusType:[0,0],restrictionType:[0,0],waConnectStatus:[0,0],capabilities2:[0,0]},ig_contact_info:{e2eeEligibility:[0,0]},reactions:{timestampMs:[0,0],authorityLevel:[0,0]},threads:{lastActivityTimestampMs:[0,0],lastReadWatermarkTimestampMs:[0,0],removeWatermarkTimestampMs:[0,0],muteExpireTimeMs:[0,0],isAdminSnippet:!1,ongoingCallState:[0,0],snippetHasEmoji:!1,hasPersistentMenu:!1,disableComposerInput:!1,capabilities:[0,0],isCustomThreadPicture:!1,isDisappearingMode:!1,unreadDisappearingMessageCount:[0,0],authorityLevel:[0,0],capabilities2:[0,0],muteCallsExpireTimeMs:[0,0],unsendLimitMs:[0,0],threadInvitesEnabled:[0,0],threadInvitesEnabledV2:[0,0],capabilities3:[0,0]},threads_ranges_v2__generated:{minThreadKey:[0,0],minLastActivityTimestampMs:[0,0],maxThreadKey:[0,0],maxLastActivityTimestampMs:[0,0],isLoadingBefore:!1,isLoadingAfter:!1,hasMoreBefore:!1,hasMoreAfter:!1},messages:{timestampMs:[0,0],primarySortKey:[0,0],secondarySortKey:[0,0],isAdminMessage:!1,sendStatus:[0,0],sendStatusV2:[0,0],isUnsent:!1,replyStatus:[0,0],replyAttachmentType:[0,0],hasQuickReplies:!1,textHasLinks:!1,viewFlags:[0,0],displayedContentTypes:[0,1],quickReplyType:[0,0],authorityLevel:[0,0],unsentTimestampMs:[0,0]},messages_ranges_v2__generated:{isLoadingBefore:!1,isLoadingAfter:!1,hasMoreBefore:!1,hasMoreAfter:!1},participants:{readWatermarkTimestampMs:[0,0],deliveredWatermarkTimestampMs:[0,0],authorityLevel:[0,0],readActionTimestampMs:[0,0],groupParticipantJoinState:[0,0]},attachments:{timestampMs:[0,0],attachmentType:[0,0],hasMedia:!1,isSharable:!1,hasXma:!1,attachmentIndex:[0,0],authorityLevel:[0,0]},attachments_ranges_v2__generated:{mediaGroup:[0,0],isLoadingBefore:!1,isLoadingAfter:!1,hasMoreBefore:!1,hasMoreAfter:!1},attachment_items:{attachmentIndex:[0,0]},group_membership_approval_requests:{authorityLevel:[0,0]},admin_message_ctas:{timestampMs:[0,0],showAdChoiceIcon:!1},thread_nullstate:{ctaType:[0,0]},messages_status:{timestampMs:[0,0]},polls:{pollType:[0,0]},poll_options_v2:{voteCount:[0,0],sortKeyVotingTimestamp:[0,0],sortKeyCreationTimestamp:[0,0]},filtered_threads_ranges_v2__generated:{minThreadKey:[0,0],minLastActivityTimestampMs:[0,0],maxThreadKey:[0,0],maxLastActivityTimestampMs:[0,0],isLoadingBefore:!1,isLoadingAfter:!1,hasMoreBefore:!1,hasMoreAfter:!1,folderName:"inbox"},community_folders:{capabilities:[0,0],notificationMutedUntil:[0,0]},community_members:{source:[0,0],adminActions:[0,0]},inbox_threads_ranges:{minThreadKey:[0,0],minLastActivityTimestampMs:[0,0],isLoadingBefore:!1,hasMoreBefore:!1},community_direct_invites_presets:{fallbackUrl:"",pictureUrlExpirationTimestampMs1:[0,0],pictureUrlExpirationTimestampMs2:[0,0]},universal_search_recent_searches:{lastAccessedTimestampMs:[0,0]},contact_upload_settings:{authorityLevel:[0,0]},presence_settings:{isActiveStatusViewable:!1,isActiveStatusViewableOnFb:!1,isActiveStatusViewableOnMessenger:!1,hasConvertedToViewSideSettings:!1},video_chat_links_joining:{canAnonymousUsersJoin:[0,0]},notification_settings:{includeInSwitchAccountBadges:!1,mutePageAccountMessageReminder:!1},transaction_history:{timestampMs:[0,0]},thread_themes:{isDeprecated:!1},ranking_scores:{score:[0,0],scoreIndex:[0,0]},story_buckets:{pageNum:[0,0],readState:[0,0]},stories:{authorityLevel:[0,0]},story_viewers:{interactionType:[0,1],authorityLevel:[0,0]},story_reactions:{authorityLevel:[0,0]},story_ad_unit:{shouldShowAdChoice:!1},story_overlays:{authorityLevel:[0,0]},media_staging:{progress:[0,0]},data_trace_meta:{initTimestampMs:[0,0],foregroundTimestampMs:[0,0],traceType:[0,0],shouldFlush:!1},data_trace_addon:{timestampMs:[0,0]},secure_encrypted_backups_client_state:{authorityLevel:[0,0],encryptionVersion:[0,0],revisionVersion:[0,0]},secure_encrypted_backups_epochs:{authorityLevel:[0,0]},encrypted_backups:{authorityLevel:[0,0]},secure_encrypted_backups_generated_recovery_code:{virtualDeviceType:[0,1]},encrypted_backups_virtual_devices:{virtualDeviceType:[0,1]},encrypted_backups_metadata:{authorityLevel:[0,0]},cutover_threads:{isMigrated:!1,showOpenMessageHistory:!1}}}),null);
__d("LSStorage",["unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,d,e){a=a.tableNames[b];b=a.indexes;a=a.primaryKeyIds;a=e==null?a:b[e];return a.reduceRight(function(a,b){if(d[b]!==void 0||e!=null)return{hd:d[b],tl:a};throw c("unrecoverableViolation")("primary key must be defined on object","messenger_web_product")},0)}function b(a,b){while(a!==0&&b!==0){if(a.hd!==b.hd&&!(Array.isArray(a.hd)&&Array.isArray(b.hd)&&a.hd.length===b.hd.length&&a.hd.every(function(a,c){return a===b.hd[c]})))return!1;a=a.tl;b=b.tl}return a===0&&b===0}g.searchKey=a;g.areKeysEqual=b}),98);
__d("ReStorePersistence",["PromiseOrValue","nativePromiseRegeneratorRuntime","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h={};function i(a,b,c){return(a.has(b)?a:a.set(b,c())).get(b)}function j(b){if(b==null)return b;var c=Object.getOwnPropertyNames(b),a={},d,e;for(d=0;d<c.length;d++)e=b[c[d]],a[c[d]]=Array.isArray(e)?[].concat(e):e;return a}function a(a){return{clearCache:a.clearCache,close:a.close,createTransaction:function(){var b=new Map();return{flush:function(){return c("nativePromiseRegeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:d.next=2;return c("nativePromiseRegeneratorRuntime").awrap(a.flush(b));case 2:case"end":return d.stop()}},null,this)},table:function(e){function f(b,c){var d=k.get(c);if(d===h)return void 0;return d!==void 0?d:a.get(b,e,c)}function g(a,b){return d("PromiseOrValue").map(f(a,b),function(a){if(a===void 0)throw c("unrecoverableViolation")("Got unexpected undefined","messenger_web_product");return a})}var k=i(b,e,function(){return new Map()});function l(a,b){return{read:c("nativePromiseRegeneratorRuntime").mark(function b(d){var e;return c("nativePromiseRegeneratorRuntime").wrap(function(b){while(1)switch(b.prev=b.next){case 0:e=f(a,d);if(!(e instanceof window.Promise)){b.next=7;break}b.next=4;return e;case 4:b.t0=b.sent;b.next=8;break;case 7:b.t0=e;case 8:return b.abrupt("return",b.t0);case 9:case"end":return b.stop()}},b,this)}),readExn:c("nativePromiseRegeneratorRuntime").mark(function b(d){var e;return c("nativePromiseRegeneratorRuntime").wrap(function(b){while(1)switch(b.prev=b.next){case 0:e=g(a,d);if(!(e instanceof window.Promise)){b.next=7;break}b.next=4;return e;case 4:b.t0=b.sent;b.next=8;break;case 7:b.t0=e;case 8:return b.abrupt("return",b.t0);case 9:case"end":return b.stop()}},b,this)}),readHeader:c("nativePromiseRegeneratorRuntime").mark(function d(){var e;return c("nativePromiseRegeneratorRuntime").wrap(function(c){while(1)switch(c.prev=c.next){case 0:e=f(a,b);if(!(e instanceof window.Promise)){c.next=7;break}c.next=4;return e;case 4:c.t0=c.sent;c.next=8;break;case 7:c.t0=e;case 8:return c.abrupt("return",c.t0);case 9:case"end":return c.stop()}},d,this)}),remove:c("nativePromiseRegeneratorRuntime").mark(function a(b){return c("nativePromiseRegeneratorRuntime").wrap(function(a){while(1)switch(a.prev=a.next){case 0:k.set(b,h);case 1:case"end":return a.stop()}},a,this)}),removeHeader:c("nativePromiseRegeneratorRuntime").mark(function a(){return c("nativePromiseRegeneratorRuntime").wrap(function(a){while(1)switch(a.prev=a.next){case 0:k.set(b,h);case 1:case"end":return a.stop()}},a,this)}),write:c("nativePromiseRegeneratorRuntime").mark(function a(b,d){return c("nativePromiseRegeneratorRuntime").wrap(function(a){while(1)switch(a.prev=a.next){case 0:k.set(b,d);case 1:case"end":return a.stop()}},a,this)}),writeHeader:c("nativePromiseRegeneratorRuntime").mark(function a(d){return c("nativePromiseRegeneratorRuntime").wrap(function(a){while(1)switch(a.prev=a.next){case 0:k.set(b,d);case 1:case"end":return a.stop()}},a,this)}),writeNew:c("nativePromiseRegeneratorRuntime").mark(function b(e){var g;return c("nativePromiseRegeneratorRuntime").wrap(function(b){while(1)switch(b.prev=b.next){case 0:g=d("PromiseOrValue").map(f(a,"nextId"),function(a){a===void 0&&(a=0);k.set("nextId",a+1);k.set(a,e);return a});if(!(g instanceof window.Promise)){b.next=7;break}b.next=4;return g;case 4:b.t0=b.sent;b.next=8;break;case 7:b.t0=g;case 8:return b.abrupt("return",b.t0);case 9:case"end":return b.stop()}},b,this)})}}return{getBPlusTreeStore:l,incrementSeed:function(a,b){return d("PromiseOrValue").map(f(a,"seed"),function(a){a===void 0&&(a=0);k.set("seed",Math.max(a,b||0)+1);return b===void 0?a:b})},readData:c("nativePromiseRegeneratorRuntime").mark(function a(b,d){var e;return c("nativePromiseRegeneratorRuntime").wrap(function(a){while(1)switch(a.prev=a.next){case 0:e=f(b,d);if(!(e instanceof window.Promise)){a.next=7;break}a.next=4;return e;case 4:a.t0=a.sent;a.next=8;break;case 7:a.t0=e;case 8:return a.abrupt("return",a.t0);case 9:case"end":return a.stop()}},a,this)}),readDataExn:c("nativePromiseRegeneratorRuntime").mark(function a(b,d){var e;return c("nativePromiseRegeneratorRuntime").wrap(function(a){while(1)switch(a.prev=a.next){case 0:e=g(b,d);if(!(e instanceof window.Promise)){a.next=7;break}a.next=4;return e;case 4:a.t0=a.sent;a.next=8;break;case 7:a.t0=e;case 8:return a.abrupt("return",a.t0);case 9:case"end":return a.stop()}},a,this)}),readSeed:function(a){return d("PromiseOrValue").map(f(a,"seed"),function(a){a===void 0&&(a=0);return a})},remove:function(a,b){k.set(b,h)},writeData:function(a,b,c){k.set(b,j(c))},writeNewData:function(a,b){return d("PromiseOrValue").map(f(a,"nextId"),function(a){a===void 0&&(a=0);k.set("nextId",a+1);k.set(a,j(b));return a})}}}}},releaseLockIfNeeded:a.releaseLockIfNeeded,waitForLock:a.waitForLock}}g.sentinelDeleted=h;g.createDbStore=a}),98);
__d("ReStoreTransactionLock",["gkx"],(function(a,b,c,d,e,f,g){"use strict";var h={chainPromiseOrValue:function(a){return a(h)}};a=function(){function a(a){var b=this;this.waitFor=null;a!=null&&(this.waitFor=a.then(function(a){return b.waitFor=null}))}var b=a.prototype;b.chainPromiseOrValue=function(a){if(this.waitFor!=null)return this.waitFor.then(function(){return a(h)});else return a(h)};return a}();b=function(){function a(){this.lock=null}var b=a.prototype;b.chainPromiseOrValue=function(a){var b=this;if(!c("gkx")("3174"))return h.chainPromiseOrValue(a);var d=this.lock;if(d==null){var e=a(h);if(e instanceof window.Promise)d=e;else return e}else d=d.then(function(){return a(h)});var f=d.then(function(a){b.lock===f&&(b.lock=null);return a})["finally"](function(a){b.lock===f&&(b.lock=null)});this.lock=f;return f};return a}();g.WaitForPromiseLock=a;g.ReStoreTransactionLock=b}),98);
__d("EncryptedBackupsDbStorageAllowlist",["ReStoreIndexMetadata"],(function(a,b,c,d,e,f,g){"use strict";a=new Set([d("ReStoreIndexMetadata").indicesTableName,"encrypted_backups","encrypted_backups_virtual_devices","encrypted_backups_metadata","secure_encrypted_backups_client_state","secure_encrypted_backups_epochs","secure_recovery_code_data","secure_encrypted_backups_message_thread_id_context","secure_encrypted_backups_recovery_code_status","secure_encrypted_backups_generated_recovery_code","device_metadata","secure_encrypted_backups_qr_add_device_context","encrypted_backup_restore_task_payload_context"]);b=a;g["default"]=b}),98);
__d("ReQLBounds.bs",["LSDbKeyComparer.bs","bs_js_dict","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";function g(a,b,c){if(!b)return c;if(a<=0)return c;var d=b.hd;if(a===1)return{hd:d,tl:0};else return{hd:d,tl:g(a-1|0,b.tl,c)}}function a(a,c){return g(a,c,{hd:b("LSDbKeyComparer.bs").maxKey,tl:0})}function c(a,c){a=function(a){var b=a.NAME;if(b==="lessThan")return["lt",a.VAL];else if(b==="greaterThan")return["gt",a.VAL];else if(b==="greaterThanOrEqual")return["gte",a.VAL];else return["lte",a.VAL]};var d=c.NAME;if(d!=="range")if(d==="greaterThanOrEqual"||d==="greaterThan")return b("bs_js_dict").fromArray([a(c)]);else return b("bs_js_dict").fromArray([a(c)]);d=c.VAL;return b("bs_js_dict").fromArray([a(d[0]),a(d[1])])}function d(a){var c=a.operation;switch(c){case"add":return{TAG:0,_0:a.value};case"delete":return 0;case"put":return{TAG:1,_0:a.value};default:return b("unrecoverableViolation")("Unexpected operation","messenger_web_product")}}f.concat=g;f.nextKey=a;f.mapBounds=c;f.mapEventToOperation=d}),null);
__d("IntervalList",["FBLogger","LSDbKeyComparer","ReQLBounds.bs","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(a){if(a==null)throw c("FBLogger")("messenger_web_product").mustfixThrow("must not be null");return a}function a(a,c){var e=b("regeneratorRuntime").mark(k),f=new Map(),g=new Map(),i=new Map();function j(b,c){return c==null?!0:(c.gt!==void 0?a(b,c.gt)>0:c.gte!==void 0?a(b,c.gte)>=0:!0)&&(c.lt!==void 0?a(b,c.lt)<0:c.lte!==void 0?a(b,c.lte)<=0:!0)}function k(a){var h,i,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;return b("regeneratorRuntime").wrap(function(b){while(1)switch(b.prev=b.next){case 0:h=a,i={hd:d("LSDbKeyComparer").MAX_KEY,tl:0},k=0;case 3:if(!(h!==0&&g.size)){b.next=33;break}k++;l=h;m=h.tl;h.tl=k<c?i:0;b.prev=8;n=g.get(JSON.stringify(a));if(!(n!=null)){b.next=27;break}o=n,p=Array.isArray(o),q=0,o=p?o:o[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();case 12:if(!p){b.next=18;break}if(!(q>=o.length)){b.next=15;break}return b.abrupt("break",27);case 15:r=o[q++];b.next=22;break;case 18:q=o.next();if(!q.done){b.next=21;break}return b.abrupt("break",27);case 21:r=q.value;case 22:s=r;b.next=25;return s;case 25:b.next=12;break;case 27:b.prev=27;l.tl=m;return b.finish(27);case 30:h=l.tl;b.next=3;break;case 33:t=f.entries(),u=Array.isArray(t),v=0,t=u?t:t[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();case 34:if(!u){b.next=40;break}if(!(v>=t.length)){b.next=37;break}return b.abrupt("break",52);case 37:w=t[v++];b.next=44;break;case 40:v=t.next();if(!v.done){b.next=43;break}return b.abrupt("break",52);case 43:w=v.value;case 44:x=w;y=x[0];z=x[1];if(!(f.has(y)&&j(a,z))){b.next=50;break}b.next=50;return y;case 50:b.next=34;break;case 52:case"end":return b.stop()}},e,this,[[8,,27,30]])}function l(a){var b=i.get(a);if(b!=null){i["delete"](a);var c=h(g.get(b));c["delete"](a);c.size===0&&g["delete"](b)}else f["delete"](a)}function m(a,b){var e;if(a&&a.gte!=null&&a.lte!=null&&(e=JSON.stringify(d("ReQLBounds.bs").nextKey(c,a.gte)))===JSON.stringify(a.lte)){var h=g.get(e);h==null&&(h=new Set(),g.set(e,h));h.add(b);i.set(b,e)}else f.set(b,a)}return{"delete":l,findIntersecting:k,set:m}}g["default"]=a}),98);
__d("createReStoreSubscriptionManager",["EncryptedBackupsDbStorageAllowlist","IntervalList","LSDbKeyComparer","LSPersistedDbGating","LSStorage","Promise","cr:181","killswitch","nullthrows","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var e=new Map(),f=new Map();function g(a,c,d,e){return b("Promise").all(Array.from(a.findIntersecting(d)).map(function(a){return a(d,e,c)}))}function h(b){return c("nullthrows")((e.has(b)?e:e.set(b,[c("IntervalList")(d("LSDbKeyComparer").compareKey,a.tableNames[b].primaryKeyIds.length),new Map()])).get(b))}function i(b,e){var f=h(b);f[0];f=f[1];return c("nullthrows")((f.has(e)?f:f.set(e,c("IntervalList")(d("LSDbKeyComparer").compareKey,a.tableNames[b].indexes[e].length))).get(e))}function j(e,f,h,i,j,k){var l=function(a,b){return g(e,k,a,b)},m=h==null?void 0:d("LSStorage").searchKey(a,f,h,j),n=i==null?void 0:d("LSStorage").searchKey(a,f,i,j);if(n==null&&m!=null)return l(m,{operation:"delete",prevValue:h});if(m==null&&n!=null)return l(n,{operation:"add",value:c("nullthrows")(i)});return m!=null&&n!=null?d("LSDbKeyComparer").compareKey(m,n)===0?l(m,{operation:"put",prevValue:h,value:c("nullthrows")(i)}):l(m,{operation:"delete",prevValue:h}).then(function(){return l(n,{operation:"add",value:c("nullthrows")(i)})}):b("Promise").resolve()}function k(a,e,f,g,i){i===void 0&&(i=!1);if(!c("killswitch")("MESSENGER_WEB_PERSISTED_DB")&&i&&b("cr:181")!=null){i=d("LSPersistedDbGating").allTablesPersisted||c("EncryptedBackupsDbStorageAllowlist").has(a);i&&b("cr:181").postMessage("notifyTable",[a,e,f])}i=h(a);var k=i[0],l=i[1];return j(k,a,e,f,null,g).then(function(){return b("Promise").all(Array.from(l.entries()).map(function(b){var c=b[0];b=b[1];return j(b,a,e,f,c,g)}).filter(function(a){return a!=null}))})}function l(a){a===void 0&&(a=!1),!c("killswitch")("MESSENGER_WEB_PERSISTED_DB")&&a&&b("cr:181")!=null&&b("cr:181").postMessage("notifyCommit"),f.forEach(function(a){return a()})}!c("killswitch")("MESSENGER_WEB_PERSISTED_DB")&&b("cr:181")!=null&&(b("cr:181").onEventReceive("notifyTable",function(a){var b=a[0],d=a[1];a=a[2];var e=new WeakMap();c("promiseDone")(k(b,d,a,e,!1))}),b("cr:181").onEventReceive("notifyCommit",function(a){l(!1)}));return{dispose:function(){e.clear(),f.clear()},notifyCommit:l,notifyTableAndIndexSubscribers:k,subscribeIndex:function(a,c,d,e){var f=i(a,c),g=!1,h=function(a,c,e){return g?b("Promise").resolve():d(a,c,e)};f.set(e,h);return function(){g=!0,f["delete"](h)}},subscribeTable:function(a,c,d){a=h(a);var e=a[0],f=!1,g=function(a,d,e){return f?b("Promise").resolve():c(a,d,e)};e.set(d,g);return function(){f=!0,e["delete"](g)}},subscribeToCommit:function(a){f.set(a,a);return function(){f["delete"](a)}}}}g["default"]=a}),98);
__d("ReStore",["BPlusTreeBase","FBLogger","I64","LSDbKeyComparer","LSStorage","LSTableDefaults","PromiseOrValue","QuickPerformanceLogger","ReStoreIndexMetadata","ReStorePersistence","ReStoreTransactionLock","clearTimeout","createReStoreSubscriptionManager","err","gkx","nativePromiseRegeneratorRuntime","qpl","setTimeout","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";e=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.call(this,"Transaction has finished")||this}return b}(babelHelpers.wrapNativeSuper(Error));function h(a){a=d("I64").cast(a);if(a===void 0)throw c("unrecoverableViolation")("Expected int64","messenger_web_product");return d("I64").to_float(a)}function i(a,b){function d(b){if(b.done)return b.value;if(!(b.value instanceof Promise))throw c("unrecoverableViolation")("expected promise","messenger_web_product");return b.value.then(function(b){return d(a.next(b))})}return d(a.next(b))}function j(a,b){return!c("gkx")("3174")?a:{next:function(c){return b.chainPromiseOrValue(function(){return a.next(c)})}}}function k(a){var b,d;return c("nativePromiseRegeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:b=[];e.next=3;return c("nativePromiseRegeneratorRuntime").awrap(a.next());case 3:d=e.sent;case 4:if(d.done){e.next=11;break}b.push(d.value);e.next=8;return c("nativePromiseRegeneratorRuntime").awrap(a.next());case 8:d=e.sent;e.next=4;break;case 11:return e.abrupt("return",b);case 12:case"end":return e.stop()}},null,this)}function l(a,b){var d=c("LSTableDefaults")[b.name];return!d?a:Object.keys(d).reduce(function(a,b){Object.prototype.hasOwnProperty.call(a,b)||(a[b]=d[b]);return a},babelHelpers["extends"]({},a))}function m(a,b){if(!c("gkx")("3174"))return b;var d=babelHelpers["extends"]({},b),e=function(c){d[c]=function(){for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return a.chainPromiseOrValue(function(){return b[c].apply(b,e)})}};for(var f in b)e(f);d.entries=function(c,d,e,f,g,h){return j(b.entries(c,d,e,f,g,h),a)};return d}function n(a,b,e){return c("BPlusTreeBase")(d("LSDbKeyComparer").compareKey,16,b.getBPlusTreeStore(a,e==null?"root":"index("+e+")"))}function o(a,b,c){return(a.has(b)?a:a.set(b,c())).get(b)}function a(a,e){var f=d("ReStorePersistence").createDbStore(a),g=c("createReStoreSubscriptionManager")(e),p=b("LSStorage").searchKey.bind(null,e),q=Promise.resolve(),r=new Map(),s=null;function t(a,b,c){return!b||a<=0?c:{hd:b.hd,tl:a===1?0:t(a-1,b.tl,c)}}function u(a,b){if(a==null)return void 0;a=babelHelpers["extends"]({},a);a.gt!=null&&(a.gt=t(b,a.gt,{hd:d("LSDbKeyComparer").MAX_KEY,tl:0}));a.lte!=null&&(a.lte=t(b,a.lte,{hd:d("LSDbKeyComparer").MAX_KEY,tl:0}));return a}function v(a,b){return function(d){return{add:function(e){var f;return c("nativePromiseRegeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:g.prev=0;c("gkx")("3827")&&(f=c("setTimeout")(function(){c("FBLogger")("messenger_web_product").mustfix("ReStore add took longer than 10 seconds to execute")},1e4));g.next=4;return c("nativePromiseRegeneratorRuntime").awrap(b.add(a,new WeakMap(),d,e));case 4:return g.abrupt("return",g.sent);case 5:g.prev=5;f!=null&&c("clearTimeout")(f);return g.finish(5);case 8:case"end":return g.stop()}},null,this,[[0,,5,8]])},"delete":function(c){return b["delete"](a,new WeakMap(),d,c)},deleteThenInsert:function(c){return b.deleteThenInsert(a,new WeakMap(),d,c)},entries:function(c,e,f){e===void 0&&(e="asc");return b.entries(a,c,d,void 0,e,f)},get:function(c,e){e===void 0&&(e=new WeakMap());return b.get(a,e,d,void 0,c)},index:function(c){return{entries:function(e,f,g){f===void 0&&(f="asc");return b.entries(a,e,d,c,f,g)},get:function(e){return b.get(a,new WeakMap(),d,c,e)},getKey:function(e){return b.getKey(a,new WeakMap(),d,c,e)}}},peekNextAutoIncrementId:function(){return b.peekNextAutoIncrementId(a,new WeakMap(),d)},put:function(c){return b.put(a,new WeakMap(),d,c)},upsert:function(c,e){return b.upsert(a,new WeakMap(),d,c,e)}}}}function w(a){function b(b,c,d,e){b=JSON.stringify([b,c]);c=a.get(b);a.set(b,[c==null?d:c[0],e])}function f(a,b,d,e,f){var g,h,j;return c("nativePromiseRegeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:g=a.table(d);h=n(b,g,e);k.next=4;return c("nativePromiseRegeneratorRuntime").awrap(i(h.getWithDefault(f,void 0)));case 4:j=k.sent;if(!(j===void 0)){k.next=7;break}return k.abrupt("return",void 0);case 7:return k.abrupt("return",i(g.readDataExn(b,j)));case 8:case"end":return k.stop()}},null,this)}function g(a,b,d,e,g){var h;return c("nativePromiseRegeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:i.next=2;return c("nativePromiseRegeneratorRuntime").awrap(f(a,b,d,e,g));case 2:h=i.sent;if(!(h===void 0)){i.next=5;break}return i.abrupt("return",void 0);case 5:return i.abrupt("return",p(d,h));case 6:case"end":return i.stop()}},null,this)}function j(a,b,c,f,g,h){function j(){var k=a.table(c),l=n(b,k,f),m=l.entries(babelHelpers["extends"]({},u(h,(f===void 0?e.tableNames[c].primaryKeyIds:e.tableNames[c].indexes[f]).length),{dir:g}));return l={next:function(a){return d("PromiseOrValue").map(i(m.next(a)),function(a){return a.done?{done:!0}:d("PromiseOrValue").map(i(k.readDataExn(b,a.value[1])),function(b){return{done:!1,value:[a.value[0],b]}})})}},l[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]=j,l}return j()}function m(a,b,f,g,h){var i,l,n,o,q,t,u,v,w,x;return c("nativePromiseRegeneratorRuntime").async(function(y){while(1)switch(y.prev=y.next){case 0:i=function(a,b){var c=[],e=a;while(e!==0)c.push(e.hd),e=e.tl;return c.length>=b?a:c.reduceRight(function(a,b){return{hd:b,tl:a}},{hd:d("LSDbKeyComparer").MAX_KEY,tl:0})};if(!(h!=null&&d("LSDbKeyComparer").compareKey(g,h)===0)){y.next=3;break}return y.abrupt("return");case 3:(l=e.tableNames[f],n=l.cascadeUpdates,o=l.primaryKeyIds),q=function(){var f,l,d,n,q,x,y,z,A,B,C,D,E,F,G,H,I;return c("nativePromiseRegeneratorRuntime").async(function(J){while(1)switch(J.prev=J.next){case 0:if(!u){J.next=6;break}if(!(v>=t.length)){J.next=3;break}return J.abrupt("return","break");case 3:w=t[v++];J.next=10;break;case 6:v=t.next();if(!v.done){J.next=9;break}return J.abrupt("return","break");case 9:w=v.value;case 10:f=w;l=f.indexName;d=f.tableName;n=e.tableNames[d],q=n.indexes,x=n.primaryKeyIds;y=l==null?x:q[l];z={gte:g,lte:i(g,y.length)};J.next=18;return c("nativePromiseRegeneratorRuntime").awrap(k(j(a,b,d,l,"asc",z)));case 18:A=J.sent,(B=A,C=Array.isArray(B),D=0,B=C?B:B[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 20:if(!C){J.next=26;break}if(!(D>=B.length)){J.next=23;break}return J.abrupt("break",48);case 23:E=B[D++];J.next=30;break;case 26:D=B.next();if(!D.done){J.next=29;break}return J.abrupt("break",48);case 29:E=D.value;case 30:F=E;F[0];G=F[1];H=p(d,G);if(!(h===void 0)){J.next=41;break}J.next=37;return c("nativePromiseRegeneratorRuntime").awrap(s(a,b,d,H));case 37:J.next=39;return c("nativePromiseRegeneratorRuntime").awrap(m(a,b,d,H,void 0));case 39:J.next=46;break;case 41:I=o.reduce(function(a,b,c){b=a[0];a=a[1];if(!a)return[b,a];b[y[c]]=a.hd;return[b,a.tl]},[babelHelpers["extends"]({},G),h])[0];J.next=44;return c("nativePromiseRegeneratorRuntime").awrap(r(a,b,d,H,I));case 44:J.next=46;return c("nativePromiseRegeneratorRuntime").awrap(m(a,b,d,H,p(d,I)));case 46:J.next=20;break;case 48:case"end":return J.stop()}},null,this)},(t=n,u=Array.isArray(t),v=0,t=u?t:t[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 6:y.next=8;return c("nativePromiseRegeneratorRuntime").awrap(q());case 8:x=y.sent;if(!(x==="break")){y.next=11;break}return y.abrupt("break",13);case 11:y.next=6;break;case 13:case"end":return y.stop()}},null,this)}function o(a,b,f){var g,h;return c("nativePromiseRegeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:g=e.tableNames[f].autoIncrement;if(g){i.next=3;break}throw c("unrecoverableViolation")("only supported for auto-incrementing tables","messenger_web_product");case 3:i.next=5;return c("nativePromiseRegeneratorRuntime").awrap(a.table(f).readSeed(b));case 5:h=i.sent;if(!(h===void 0)){i.next=8;break}throw c("unrecoverableViolation")("unexpected undefined autoIncrementSeed","messenger_web_product");case 8:return i.abrupt("return",d("I64").of_float(h));case 9:case"end":return i.stop()}},null,this)}function q(a,f,g,h){var j,k,m,o,q,r,s,u,x,y,z,A,B,C,D,E;return c("nativePromiseRegeneratorRuntime").async(function(F){while(1)switch(F.prev=F.next){case 0:j=a.table(g);k=n(f,j);m=e.tableNames[g];o=p(g,h);q={};F.next=7;return c("nativePromiseRegeneratorRuntime").awrap(i(k.getWithDefault(o,void 0)));case 7:r=F.sent;u=h;if(!(r!==void 0)){F.next=17;break}F.next=12;return c("nativePromiseRegeneratorRuntime").awrap(i(j.readDataExn(f,r)));case 12:s=F.sent;q=t(Object.keys(m.indexes),g,s);j.writeData(f,r,h);F.next=25;break;case 17:if(!m.autoIncrement){F.next=19;break}throw c("unrecoverableViolation")("Id must not be specified for new record when table has an autoincrementing primary key","messenger_web_product");case 19:u=l(h,m);F.next=22;return c("nativePromiseRegeneratorRuntime").awrap(j.writeNewData(f,u));case 22:r=F.sent;F.next=25;return c("nativePromiseRegeneratorRuntime").awrap(i(k.set(o,r)));case 25:x=t(Object.keys(m.indexes),g,u);y=Object.keys(x);for(z=0;z<y.length;z++)A=y[z],q[A]!==void 0&&d("LSDbKeyComparer").compareKey(q[A],x[A])===0&&(delete x[A],delete q[A]);F.next=30;return c("nativePromiseRegeneratorRuntime").awrap(v(a,f,g,x));case 30:F.next=32;return c("nativePromiseRegeneratorRuntime").awrap(w(a,f,g,r,x));case 32:B=Object.keys(q),C=0;case 34:if(!(C<B.length)){F.next=42;break}D=B[C];E=n(f,j,D);F.next=39;return c("nativePromiseRegeneratorRuntime").awrap(i(E["delete"](q[D])));case 39:C++;F.next=34;break;case 42:b(g,o,s,u);case 43:case"end":return F.stop()}},null,this)}function r(a,b,e,f,g){var h;return c("nativePromiseRegeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:h=p(e,g);if(d("LSStorage").areKeysEqual(f,h)){i.next=4;break}i.next=4;return c("nativePromiseRegeneratorRuntime").awrap(s(a,b,e,f));case 4:i.next=6;return c("nativePromiseRegeneratorRuntime").awrap(q(a,b,e,g));case 6:case"end":return i.stop()}},null,this)}function s(a,d,f,g){var h,j,k,l,m,o,q,r,s,t;return c("nativePromiseRegeneratorRuntime").async(function(u){while(1)switch(u.prev=u.next){case 0:h=a.table(f);j=n(d,h);k=e.tableNames[f];u.next=5;return c("nativePromiseRegeneratorRuntime").awrap(i(j.getWithDefault(g,void 0)));case 5:l=u.sent;if(!(l!==void 0)){u.next=27;break}u.next=9;return c("nativePromiseRegeneratorRuntime").awrap(i(h.readDataExn(d,l)));case 9:m=u.sent;if(!Object.keys(k.indexes).length){u.next=23;break}o=Object.keys(k.indexes);q=0;case 13:if(!(q<o.length)){u.next=23;break}r=o[q];s=p(f,m,r);if(!(s!=null)){u.next=20;break}t=n(d,h,r);u.next=20;return c("nativePromiseRegeneratorRuntime").awrap(i(t["delete"](s)));case 20:q++;u.next=13;break;case 23:u.next=25;return c("nativePromiseRegeneratorRuntime").awrap(i(j["delete"](g)));case 25:h.remove(d,l),b(f,g,m,void 0);case 27:case"end":return u.stop()}},null,this)}function t(a,b,c){return a.reduce(function(a,d){var e=p(b,c,d);a[d]=e;return a},{})}function v(a,b,d,e){var f,g,h,j,k,l,o,q,r;return c("nativePromiseRegeneratorRuntime").async(function(t){while(1)switch(t.prev=t.next){case 0:f=a.table(d),g=new Set(),h=Object.keys(e),j=0;case 4:if(!(j<h.length)){t.next=26;break}k=h[j];l=n(b,f,k);o=e[k];t.next=10;return c("nativePromiseRegeneratorRuntime").awrap(i(l.getWithDefault(o)));case 10:q=t.sent;if(!(q!=null&&!g.has(q))){t.next=23;break}t.t0=p;t.t1=d;t.next=16;return c("nativePromiseRegeneratorRuntime").awrap(i(f.readDataExn(b,q)));case 16:t.t2=t.sent;r=t.t0(t.t1,t.t2);t.next=20;return c("nativePromiseRegeneratorRuntime").awrap(s(a,b,d,r));case 20:t.next=22;return c("nativePromiseRegeneratorRuntime").awrap(m(a,b,d,r,void 0));case 22:g.add(q);case 23:j++;t.next=4;break;case 26:case"end":return t.stop()}},null,this)}function w(a,b,d,e,f){var g,h,j,k,l,m;return c("nativePromiseRegeneratorRuntime").async(function(o){while(1)switch(o.prev=o.next){case 0:g=a.table(d),h=Object.keys(f),j=0;case 3:if(!(j<h.length)){o.next=12;break}k=h[j];l=n(b,g,k);m=f[k];o.next=9;return c("nativePromiseRegeneratorRuntime").awrap(i(l.set(m,e)));case 9:j++;o.next=3;break;case 12:case"end":return o.stop()}},null,this)}function x(a,f,g,j){var k,m,o,q,r,s,u,x,y;return c("nativePromiseRegeneratorRuntime").async(function(z){while(1)switch(z.prev=z.next){case 0:k=a.table(g);m=n(f,k);o=e.tableNames[g];if(!o.autoIncrement){z.next=11;break}q=j[e.tableNames[g].primaryKeyIds[0]];z.t0=d("I64");z.next=8;return c("nativePromiseRegeneratorRuntime").awrap(k.incrementSeed(f,q===void 0?q:h(q)));case 8:z.t1=z.sent,r=z.t0.of_float.call(z.t0,z.t1),j[e.tableNames[g].primaryKeyIds[0]]=r;case 11:s=l(j,o);u=p(g,s);if(!(u==null)){z.next=15;break}throw new Error("Evaluating the object store's key path did not yield a value");case 15:z.next=17;return c("nativePromiseRegeneratorRuntime").awrap(i(m.has(u)));case 17:if(z.sent){z.next=29;break}x=t(Object.keys(o.indexes),g,s);z.next=21;return c("nativePromiseRegeneratorRuntime").awrap(v(a,f,g,x));case 21:z.next=23;return c("nativePromiseRegeneratorRuntime").awrap(k.writeNewData(f,s));case 23:y=z.sent;z.next=26;return c("nativePromiseRegeneratorRuntime").awrap(i(m.set(u,y)));case 26:z.next=28;return c("nativePromiseRegeneratorRuntime").awrap(w(a,f,g,y,x));case 28:b(g,u,void 0,s);case 29:case"end":return z.stop()}},null,this)}function y(a,b,d,f){var g,h,l,m,o,p,q,r,s,u,x,y,z,A,B,C,D,E,F;return c("nativePromiseRegeneratorRuntime").async(function(G){while(1)switch(G.prev=G.next){case 0:g=a.table(d),h=f.map(function(a){return n(b,g,a)}),(l=h,m=Array.isArray(l),o=0,l=m?l:l[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 3:if(!m){G.next=9;break}if(!(o>=l.length)){G.next=6;break}return G.abrupt("break",18);case 6:p=l[o++];G.next=13;break;case 9:o=l.next();if(!o.done){G.next=12;break}return G.abrupt("break",18);case 12:p=o.value;case 13:q=p;G.next=16;return c("nativePromiseRegeneratorRuntime").awrap(i(q.clear()));case 16:G.next=3;break;case 18:r=f.filter(function(a){var b;return((b=e.tableNames[d])==null?void 0:b.indexes[a])!=null});if(!(r.length===0)){G.next=21;break}return G.abrupt("return");case 21:s=n(b,g);G.next=24;return c("nativePromiseRegeneratorRuntime").awrap(k(j(a,b,d,void 0,"asc",void 0)));case 24:u=G.sent,(x=u,y=Array.isArray(x),z=0,x=y?x:x[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 26:if(!y){G.next=32;break}if(!(z>=x.length)){G.next=29;break}return G.abrupt("break",49);case 29:A=x[z++];G.next=36;break;case 32:z=x.next();if(!z.done){G.next=35;break}return G.abrupt("break",49);case 35:A=z.value;case 36:B=A;C=B[0];D=B[1];E=t(r,d,D);G.next=42;return c("nativePromiseRegeneratorRuntime").awrap(v(a,b,d,E));case 42:G.next=44;return c("nativePromiseRegeneratorRuntime").awrap(i(s.get(C)));case 44:F=G.sent;G.next=47;return c("nativePromiseRegeneratorRuntime").awrap(w(a,b,d,F,E));case 47:G.next=26;break;case 49:case"end":return G.stop()}},null,this)}return{add:x,"delete":function(a,b,d,e){return c("nativePromiseRegeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return c("nativePromiseRegeneratorRuntime").awrap(s(a,b,d,e));case 2:f.next=4;return c("nativePromiseRegeneratorRuntime").awrap(m(a,b,d,e,void 0));case 4:case"end":return f.stop()}},null,this)},deleteThenInsert:function(a,b,d,e){return c("nativePromiseRegeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return c("nativePromiseRegeneratorRuntime").awrap(q(a,b,d,e));case 2:f.next=4;return c("nativePromiseRegeneratorRuntime").awrap(m(a,b,d,p(d,e),void 0));case 4:case"end":return f.stop()}},null,this)},entries:j,get:f,getKey:g,peekNextAutoIncrementId:o,put:q,rebuildIndices:y,upsert:function(a,b,d,e,f){return c("nativePromiseRegeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:g.next=2;return c("nativePromiseRegeneratorRuntime").awrap(r(a,b,d,e,f));case 2:g.next=4;return c("nativePromiseRegeneratorRuntime").awrap(m(a,b,d,e,p(d,f)));case 4:case"end":return g.stop()}},null,this)}}}function x(a,b){var c=new(d("ReStoreTransactionLock").ReStoreTransactionLock)();return{table:v(a,m(new(d("ReStoreTransactionLock").WaitForPromiseLock)(s),m(c,w(b))))}}function y(a,b){var d,e;return c("nativePromiseRegeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:d=f.createTransaction();g.next=3;return c("nativePromiseRegeneratorRuntime").awrap(a(x(d,b),d));case 3:e=g.sent;g.next=6;return c("nativePromiseRegeneratorRuntime").awrap(d.flush());case 6:return g.abrupt("return",e);case 7:case"end":return g.stop()}},null,this)}var z={background:{first:null,last:null},ui:{first:null,last:null}};function A(a,b){var d,e;return c("nativePromiseRegeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:z[b].last==null?z[b].first=z[b].last={value:a}:z[b].last=z[b].last.next={value:a};g.prev=1;g.next=4;return c("nativePromiseRegeneratorRuntime").awrap(f.waitForLock());case 4:d=z.ui.first==null?z.background:z.ui;if(!(d.first==null)){g.next=8;break}c("FBLogger")("messenger_web_product").mustfix("Expected work is missing");return g.abrupt("return");case 8:e=d.first;d.first===d.last&&(d.last=null);d.first=d.first.next;g.next=13;return c("nativePromiseRegeneratorRuntime").awrap(e.value());case 13:g.prev=13;g.next=16;return c("nativePromiseRegeneratorRuntime").awrap(f.releaseLockIfNeeded());case 16:return g.finish(13);case 17:case"end":return g.stop()}},null,this,[[1,,13,17]])}function B(a,b,d){d===void 0&&(d="background");var e=new Map(),f;c("gkx")("3827")&&(f=c("err")(""));return new Promise(function(b,h){q=q.then(function(){return A(function(){var d,i,j,k,l,m,n,o,p,q,r,s,t,u;return c("nativePromiseRegeneratorRuntime").async(function(v){while(1)switch(v.prev=v.next){case 0:v.prev=0;c("gkx")("3827")&&(d=c("setTimeout")(function(){c("FBLogger")("messenger_web_product").catching(f).mustfix("ReStore transaction took longer than 10 seconds to execute")},1e4));v.next=4;return c("nativePromiseRegeneratorRuntime").awrap(y(function(b,c){return a(b)},e));case 4:i=v.sent,d!=null&&c("clearTimeout")(d),j=new WeakMap(),(k=e,l=Array.isArray(k),m=0,k=l?k:k[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 8:if(!l){v.next=14;break}if(!(m>=k.length)){v.next=11;break}return v.abrupt("break",28);case 11:n=k[m++];v.next=18;break;case 14:m=k.next();if(!m.done){v.next=17;break}return v.abrupt("break",28);case 17:n=m.value;case 18:o=n;p=o[0];q=o[1];r=q[0];s=q[1];t=JSON.parse(p),u=t[0],t[1];v.next=26;return c("nativePromiseRegeneratorRuntime").awrap(g.notifyTableAndIndexSubscribers(u,r,s,j,!0));case 26:v.next=8;break;case 28:b(i);v.next=35;break;case 31:v.prev=31,v.t0=v["catch"](0),c("gkx")("3827")&&d!=null&&c("clearTimeout")(d),h(v.t0);case 35:g.notifyCommit(!0);case 36:case"end":return v.stop()}},null,this,[[0,31]])},d)})})}if(c("gkx")("4547")){var C=function(a,b,e){var f,g,h,i,j,l,m,n,o,p,q,r,s;return c("nativePromiseRegeneratorRuntime").async(function(t){while(1)switch(t.prev=t.next){case 0:f={};t.next=3;return c("nativePromiseRegeneratorRuntime").awrap(k(e.entries(b,a,d("ReStoreIndexMetadata").indicesTableName,void 0,"asc",void 0)));case 3:g=t.sent,(h=g,i=Array.isArray(h),j=0,h=i?h:h[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 5:if(!i){t.next=11;break}if(!(j>=h.length)){t.next=8;break}return t.abrupt("break",27);case 8:l=h[j++];t.next=15;break;case 11:j=h.next();if(!j.done){t.next=14;break}return t.abrupt("break",27);case 14:l=j.value;case 15:m=l;n=m[0];o=m[1];if(!(n!=null)){t.next=25;break}q=d("ReStoreIndexMetadata").tryParseIndexData(o);if(!(q==null)){t.next=22;break}return t.abrupt("continue",25);case 22:(r=q.indexName,s=q.tableName),f[s]=(p=f[s])!=null?p:{},f[s][r]={index:q.data,key:n};case 25:t.next=5;break;case 27:return t.abrupt("return",f);case 28:case"end":return t.stop()}},null,this)},D=function(a,b,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;return c("nativePromiseRegeneratorRuntime").async(function(y){while(1)switch(y.prev=y.next){case 0:y.next=2;return c("nativePromiseRegeneratorRuntime").awrap(C(a,b,e));case 2:g=y.sent;h={};for(i in f.tableNames){j=f.tableNames[i];for(k in j.indexes)m=j.indexes[k],n=(l=g[i])==null?void 0:l[k],d("ReStoreIndexMetadata").indicesDiffer(n==null?void 0:n.index,m)&&(h[i]=(o=h[i])!=null?o:{},h[i][k]=m)}p={};for(q in g){r=g[q];for(s in r)v=r[s],w=(t=f.tableNames[q])==null?void 0:(u=t.indexes)==null?void 0:u[s],w==null&&(p[q]=(x=p[q])!=null?x:{},p[q][s]=v)}return y.abrupt("return",{toRemove:p,toUpdate:h});case 8:case"end":return y.stop()}},null,this)},E=function(a,b,e,f){var g,h,i,j,k;return c("nativePromiseRegeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:l.t0=c("nativePromiseRegeneratorRuntime").keys(f);case 1:if((l.t1=l.t0()).done){l.next=15;break}g=l.t1.value;h=f[g];l.t2=c("nativePromiseRegeneratorRuntime").keys(h);case 5:if((l.t3=l.t2()).done){l.next=13;break}i=l.t3.value;j=h[i];k={data:j,indexName:i,tableName:g};l.next=11;return c("nativePromiseRegeneratorRuntime").awrap(e.put(b,a,d("ReStoreIndexMetadata").indicesTableName,d("ReStoreIndexMetadata").indexDataToValue(k)));case 11:l.next=5;break;case 13:l.next=1;break;case 15:case"end":return l.stop()}},null,this)},F=function(a,b,e,f){var g,h,i,j;return c("nativePromiseRegeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:k.t0=c("nativePromiseRegeneratorRuntime").keys(f);case 1:if((k.t1=k.t0()).done){k.next=14;break}g=k.t1.value;h=f[g];k.t2=c("nativePromiseRegeneratorRuntime").keys(h);case 5:if((k.t3=k.t2()).done){k.next=12;break}i=k.t3.value;j=h[i].key;k.next=10;return c("nativePromiseRegeneratorRuntime").awrap(e["delete"](b,a,d("ReStoreIndexMetadata").indicesTableName,j));case 10:k.next=5;break;case 12:k.next=1;break;case 14:case"end":return k.stop()}},null,this)},G=function(a,b,d){var e=new WeakMap();c("QuickPerformanceLogger").markerPoint(c("qpl")._(25305590,"1127"),"index_migration_started");var f=function(a,b){c("QuickPerformanceLogger").markerPoint(c("qpl")._(25305590,"1127"),"index_migration_end_failure"),c("QuickPerformanceLogger").markerAnnotate(c("qpl")._(25305590,"1127"),{string:{index_migration_failure_point:b,index_migration_failure_reason:String(a)}})};return D(e,a,d,b).then(function(f){var g,h,i,j,k,l,m,n;return c("nativePromiseRegeneratorRuntime").async(function(o){while(1)switch(o.prev=o.next){case 0:(g=f.toRemove,h=f.toUpdate),i=Array.from(new Set([].concat(Object.keys(h),Object.keys(g)))),c("QuickPerformanceLogger").markerAnnotate(c("qpl")._(25305590,"1127"),{"int":{index_migration_rebuild_tables_count:i.length},string_array:{index_migration_rebuilt_tables:i}}),j=0;case 4:if(!(j<i.length)){o.next=13;break}k=i[j];if(!(b.tableNames[k]!=null)){o.next=10;break}n=Array.from(new Set([].concat(Object.keys((l=h[k])!=null?l:{}),Object.keys((m=g[k])!=null?m:{}))));o.next=10;return c("nativePromiseRegeneratorRuntime").awrap(d.rebuildIndices(a,e,k,n));case 10:j++;o.next=4;break;case 13:o.next=15;return c("nativePromiseRegeneratorRuntime").awrap(E(e,a,d,h));case 15:o.next=17;return c("nativePromiseRegeneratorRuntime").awrap(F(e,a,d,g));case 17:c("QuickPerformanceLogger").markerPoint(c("qpl")._(25305590,"1127"),"index_migration_end_success");case 18:case"end":return o.stop()}},null,this)},function(a){return f(a,"findIndicesToUpdateOrRemove")})["catch"](function(a){return f(a,"rebuildIndices")})};q=q.then(function(){return A(function(){var a=new Map();return y(function(b,d){return c("nativePromiseRegeneratorRuntime").async(function(b){while(1)switch(b.prev=b.next){case 0:b.next=2;return c("nativePromiseRegeneratorRuntime").awrap(G(d,e,w(a)));case 2:case"end":return b.stop()}},null,this)},a)},"background")});s=q}return{clearCacheIfSupported:function(){var a=f;a instanceof Object&&a.clearCache!==void 0&&a.clearCache instanceof Function&&a.clearCache()},closeDb:function(){var a=f;a instanceof Object&&a.close!==void 0&&a.close()},getTableData:function(){return e},runInTransaction:B,subscribeToCommit:function(a){return g.subscribeToCommit(a)},subscriptionManager:g,table:function(a){return o(r,a,function(){var b=new Map(),c=m(new(d("ReStoreTransactionLock").WaitForPromiseLock)(s),w(new Map())),h=c.entries,i=c.get,k=c.getKey,l=c.peekNextAutoIncrementId;return{entries:function(b,c,e){c===void 0&&(c="asc");return j(h(f.createTransaction(),b,a,void 0,c,e),new(d("ReStoreTransactionLock").ReStoreTransactionLock)())},get:function(b,c){c===void 0&&(c=new WeakMap());return i(f.createTransaction(),c,a,void 0,b)},index:function(c){return o(b,c,function(){return{entries:function(b,e,g){e===void 0&&(e="asc");return j(h(f.createTransaction(),b,a,c,e,g),new(d("ReStoreTransactionLock").ReStoreTransactionLock)())},get:function(b,d){d===void 0&&(d=new WeakMap());return i(f.createTransaction(),d,a,c,b)},getKey:function(b){return k(f.createTransaction(),new WeakMap(),a,c,b)},subscribe:function(b,d){return g.subscribeIndex(a,c,b,u(d,e.tableNames[a].indexes[c]))}}})},peekNextAutoIncrementId:function(){return l(f.createTransaction(),new WeakMap(),a)},subscribe:function(b,c){return g.subscribeTable(a,b,u(c,e.tableNames[a].primaryKeyIds.length))}}})}}}a.TransactionClosedError=e;g["default"]=a}),98);
__d("createReStoreEphemeralPersistence",["ReStorePersistence","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,c){return(a.has(b)?a:a.set(b,c())).get(b)}function a(){var a=new Map();function c(b){return h(a,b,function(){return new Map()})}return{flush:function(a){return b("regeneratorRuntime").async(function(b){while(1)switch(b.prev=b.next){case 0:a.forEach(function(a,b){var e=c(b);a.forEach(function(a,b){a===d("ReStorePersistence").sentinelDeleted?e["delete"](b):e.set(b,a)})});case 1:case"end":return b.stop()}},null,this)},get:function(a,b,d){a=c(b);return a.get(d)},releaseLockIfNeeded:function(){return window.Promise.resolve()},waitForLock:function(){return window.Promise.resolve()}}}g["default"]=a}),98);