if (self.CavalryLogger) { CavalryLogger.start_js_script(document.currentScript); }/*FB_PKG_DELIM*/

__d("LSVersion",[],(function(a,b,c,d,e,f){e.exports="5155522201229027"}),null);
__d("LSTruncateTableAndSetShowError",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[];return b.seq([function(c){return b.seq([function(a){return b.fe(b.db.table(115).fetch(),function(a){return a["delete"]()})},function(c){return b.db.table(115).add({statusId:void 0,timestampMs:b.i64.of_float(Date.now()),errorShouldBeShown:a[0]})}])},function(a){return b.resolve(c)}])}e.exports=a}),null);
__d("LSDeleteAllAndInsertConnectivityStatus",["LSTruncateTableAndSetShowError"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[];return c.seq([function(d){return c.seq([function(a){return c.fe(c.db.table(114).fetch(),function(a){return a["delete"]()})},function(b){return c.db.table(114).add({statusId:void 0,timestampMs:c.i64.of_float(Date.now()),internetConnectionState:a[0]})},function(d){return c.sp(b("LSTruncateTableAndSetShowError"),c.i64.neq(a[0],[0,1]))}])},function(a){return c.resolve(d)}])}e.exports=a}),null);
__d("LSDataTraceCheckPoint.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").one;c=[0,2];d=[0,10];e=[0,11];b=[0,12];var g=[0,13],h=[0,20],i=[0,21],j=[0,22],k=[0,30],l=[0,31],m=[0,32],n=[0,33],o=[0,34],p=[0,35],q=[0,36],r=[0,37],s=[0,38],t=[0,39],u=[0,40],v=[0,41],w=[0,42],x=[0,43],y=[0,44],z=[0,45],A=[0,50],B=[0,51],C=[0,52],D=[0,53],E=[0,60],F=[0,61],G=[0,62],H=[0,63],I=[0,64],J=[0,65],K=[0,70],L=[0,71],M=[0,72],N=[0,80],O=[0,81],P=[0,82],Q=[0,83],R=[0,84],S=[0,85],T=[0,98],U=[0,99],V=[0,100],W=[0,101],X=[0,102],Y=[0,103],Z=[0,104],$=[0,105],aa=[0,106],ba=[0,107],ca=[0,108],da=[0,109],ea=[0,110],fa=[0,111],ga=[0,112],ha=[0,113],ia=[0,114],ja=[0,115],ka=[0,116],la=[0,117],ma=[0,118],na=[0,119],oa=[0,120],pa=[0,130],qa=[0,200],ra=[0,201],sa=[0,202],ta=[0,203],ua=[0,204],va=[0,205],wa=[0,206],xa=[0,207],ya=[0,300],za=[0,301],Aa=[0,1400],Ba=[0,1401],Ca=[0,1402],Da=[0,1403],Ea=[0,1404],Fa=[0,1405],Ga=[0,1406],Ha=[0,1407],Ia=[0,1410],Ja=[0,1411],Ka=[0,1412],La=[0,1413],Ma=[0,1414],Na=[0,1415],Oa=[0,1416],Pa=[0,1417],Qa=[0,1418],Ra=[0,1419],Sa=[0,1420],Ta=[0,1421],Ua=[0,1422],Va=[0,1423],Wa=[0,1424],Xa=[0,1425],Ya=[0,1426],Za=[0,1427],$a=[0,1428],ab=[0,1429],bb=[0,1430],cb=[0,1431],db=[0,1433],eb=[0,1434],fb=[0,1436],gb=[0,1437],hb=[0,1438],ib=[0,1439],jb=[0,1440],kb=[0,1441],lb=[0,1442],mb=[0,1450],nb=[0,1463],ob=[0,1464],pb=[0,1467],qb=[0,1468],rb=[0,1487],sb=[0,1488],tb=[0,1489],ub=[0,1490],vb=[0,1491],wb=[0,1492],xb=[0,1469],yb=[0,1451],zb=[0,1470],Ab=[0,1471],Bb=[0,1478],Cb=[0,1480],Db=[0,1481],Eb=[0,1482],Fb=[0,1497],Gb=[0,2500],Hb=[0,2501],Ib=[0,2502],Jb=[0,2503];f.clientDbOutbound=a;f.clientNetworkOutbound=c;f.clientNetworkInbound=d;f.clientDbInbound=e;f.clientEvaluateDasm=b;f.clientAppStateChange=g;f.clientCreateTask=h;f.clientRecipientPresence=i;f.clientEvaluateDasmBegin=j;f.mqttPublish=k;f.mqttPublishAck=l;f.mqttDisconnected=m;f.mqttConnecting=n;f.mqttConnected=o;f.mqttConnectionAcked=p;f.tincanReceiveMessage=q;f.tincanReceiveDecryptionComplete=r;f.tincanReceiveDecryptionFailed=s;f.tincanReceiveDrQueued=t;f.tincanReceiveDrSentToNetwork=u;f.tincanReceiveDrPublishToMqtt=v;f.tincanReceiveDrmqttPuback=w;f.tincanReceiveBounceTaskQueued=x;f.tincanReceiveBounceTaskSentToNetwork=y;f.tincanReceiveBounceTaskPublishToMqtt=z;f.richMediaDownloadStart=A;f.richMediaDownloadEnd=B;f.richMediaDownloadError=C;f.richMediaUploadStart=D;f.armadilloAct=E;f.armadilloActTaskPick=F;f.armadilloActSerialize=G;f.armadilloActGroupSend=H;f.armadilloActSendFailure=I;f.armadilloActMessageSend=J;f.networkDisconnected=K;f.networkConnected=L;f.networkUnknown=M;f.flowCreat=N;f.flowEnd=O;f.flowInterrupted=P;f.flowConnectId=Q;f.flowEndForFailure=R;f.flowEndAndFlush=S;f.traceCreated=T;f.clientReadyToFlush=U;f.pendingDelta=V;f.noPendingDelta=W;f.initSync=X;f.resnapshot=Y;f.catchUp=Z;f.periodicSync=$;f.catchUpFromRevision=aa;f.resnapshotContinue=ba;f.resnapshotEnd=ca;f.periodicSyncContinue=da;f.periodicSyncEnd=ea;f.contactSyncOptimistic=fa;f.contactSyncFromOmnistore=ga;f.contactSyncTamOptimistc=ha;f.contactSyncTamFromOmnistore=ia;f.contactSyncTamError=ja;f.verifyUserForSync=ka;f.snapshotStart=la;f.snapshotContinue=ma;f.snapshotEnd=na;f.fetchDelta=oa;f.deltaSummary=pa;f.receiveDeliveryReceipt=qa;f.taskDeserializationError=ra;f.optimisicMessageFailed=sa;f.sendServerAuthoritative=ta;f.threadRangeQueryComplete=ua;f.threadRangeQueryFailure=va;f.threadPointQueryComplete=wa;f.sendServerPartial=xa;f.xmsTransportMessageSendStart=ya;f.xmsTransportMessageSendFail=za;f.labyrinthInitializeBackupSproc=Aa;f.labyrinthInitializeBackupSuccessSproc=Ba;f.labyrinthInitializeBackupFailure=Ca;f.labyrinthCreateBackupMailboxSproc=Da;f.labyrinthHandleCreateBackupMailboxSuccessSproc=Ea;f.labyrinthOpenEpochSproc=Fa;f.labyrinthHandlerOpenEpochSuccessSproc=Ga;f.labyrinthHandlerOpenEpochFailureSproc=Ha;f.labyrinthCreateVirtualDeviceSproc=Ia;f.labyrinthHandleCreateVirtualDeviceSuccessSproc=Ja;f.labyrinthHandleCreateVirtualDeviceFailureSproc=Ka;f.labyrinthAddDeviceSproc=La;f.labyrinthAddDeviceFromVirtualSproc=Ma;f.labyrinthHandoleWrongRecoveryCodeSproc=Na;f.labyrinthHandleAddDeviceSuccessSproc=Oa;f.labyrinthHandleAddDeviceFailureSproc=Pa;f.labyrinthInitializeRestoreSproc=Qa;f.labyrinthDecryptThreadsSproc=Ra;f.labyrinthRequestMessagesFromThreadsSproc=Sa;f.labyrinthRequestMessagesFromRangeQuerySproc=Ta;f.labyrinthDecryptMessagesSproc=Ua;f.labyrinthDeleteBackupOnClientSproc=Va;f.labyrinthDeleteBackupsSproc=Wa;f.labyrinthHandleDeleteMailboxSproc=Xa;f.labyrinthIssueDeleteBackupTaskSproc=Ya;f.labyrinthBackupUploadBegin=Za;f.labyrinthBackupUploadSuccessSproc=$a;f.labyrinthCreateExtraVirtualDeviceSproc=ab;f.labyrinthQrInitAddDeviceSproc=bb;f.labyrinthQrInitAddDeviceSuccessSproc=cb;f.labyrinthQrInitGetSecretsSproc=db;f.labyrinthQrFinishAddPeerDeviceSproc=eb;f.labyrinthSyncEpochsStoredProcedureSproc=fb;f.labyrinthSyncEpochsSuccessSproc=gb;f.labyrinthSyncEpochsForwardDerivationEnd=hb;f.labyrinthSyncEpochsBackwardDerivationEnd=ib;f.labyrinthSyncEpochsOpenNewEpoch=jb;f.labyrinthPrepareOpenEpochSproc=kb;f.labyrinthPrepareOpenEpochSuccessSproc=lb;f.labyrinthBackupUploadFail=mb;f.labyrinthBackupUploadSerializeSucceed=nb;f.labyrinthBackupUploadSerializeFail=ob;f.labyrinthUpdateBackupTableSproc=pb;f.labyrinthFetchBackupIdsSproc=qb;f.labyrinthProcessBackupIdsSproc=rb;f.labyrinthBackupStatusNoInfo=sb;f.labyrinthBackupStatusFetchError=tb;f.labyrinthBackupStatusNotOnboarded=ub;f.labyrinthBackupStatusOnboarded=vb;f.labyrinthBackupStatusNoBackupsPresent=wb;f.labyrinthOptOutOfBackupSproc=xb;f.labyrinthBackupUploadSerialize=yb;f.labyrinthTriggerThirdPartyIdGenerationSproc=zb;f.labyrinthHandleTriggerThirdPartyIdGenerationSproc=Ab;f.labyrinthFetchBackupsMetadataSproc=Bb;f.labyrinthHandleBackupsMetadataResultSproc=Cb;f.labyrinthRestoreThreadsSuccess=Db;f.labyrinthRestoreMessagesSuccess=Eb;f.labyrinthBackupUploadGetEchoDoc=Fb;f.labyrinthFetchThreadIdsSproc=Gb;f.labyrinthFetchThreadIdsNativeOpSuccess=Hb;f.labyrinthFetchThreadIdsNativeOpFailure=Ib;f.labyrinthRequestMessagesFromFetchThreadIdsSproc=Jb}),null);
__d("ReQLTable.bs",["bs_curry"],(function(a,b,c,d,e,f){"use strict";c={};d={};function a(a,c,d){return a.get(c).then(function(e){return a.upsert(c,b("bs_curry")._1(d,e))})}f.Direction=c;f.Index=d;f.update=a}),null);
__d("LSFlushDataTrace.bs",["LS.bs","LSAppendDataTraceAddon","LSDataTraceCheckPoint.bs","ReQL.bs","ReQLTable.bs","bs_caml_int64","bs_curry","killswitch","requireDeferred","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";var g=b("requireDeferred")("LSDataTraceFlush.bs").__setRef("LSFlushDataTrace.bs");function h(a,c){return b("LSAppendDataTraceAddon")(c,b("LSDataTraceCheckPoint.bs").clientReadyToFlush,b("bs_caml_int64").neg_one,void 0,void 0,b("LS.bs").make(a)).then(function(d){return b("ReQLTable.bs").update(a.table("data_trace_meta"),{hd:c,tl:0},function(a){if(a!==void 0)return{traceId:a.traceId,initTimestampMs:a.initTimestampMs,foregroundTimestampMs:a.foregroundTimestampMs,traceType:a.traceType,shouldFlush:!0,contextOne:a.contextOne,contextTwo:a.contextTwo,contextThree:a.contextThree,predefinedId:a.predefinedId};else return b("unrecoverableViolation")("Data trace is missing "+c,"messenger_web_product")}).then(function(d){return g.load().then(function(d){return b("bs_curry")._2(d.flush,a,c)})})})}function a(a,c,d){if(b("killswitch")("MESSENGER_WEB_DATA_TRACE_ID"))return window.Promise.resolve(void 0);else return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("data_trace_meta")),{hd:d,tl:0})).then(function(b){if(b!==void 0)return h(a,d);else return window.Promise.resolve(void 0)})}f.$LSDataTraceFlush$Deferred=g;f.updateAndFlushTrace=h;f.call=a}),null);
__d("LSSerializeBackupPayloadIndirection.bs",["bs_curry","cr:280","cr:740","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d,e,f){if(b("cr:740")==null)if(b("cr:280")==null)return b("unrecoverableViolation")("LSSerializeBackupPayloadIndirection.res: messenger_armadillo_web:enable_armadillo OR messenger_armadillo_web:enable_encrypted_backups_shadow_test is not defined","labyrinth_web");else return b("bs_curry")._5(b("cr:280").call,a,c,d,e,f).then(function(a){return a});else return b("bs_curry")._5(b("cr:740").call,a,c,d,e,f).then(function(a){return a})}f.$LSSerializeBackupPayloadConditional$requireCond=b("cr:280");f.$LSSerializeBackupPayloadConditional$requireCond$1=b("cr:740");f.call=a}),null);
__d("LSRequestId",["uuid"],(function(a,b,c,d,e,f,g){"use strict";var h="0123456789abcdef",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function a(){var a=c("uuid")().replace(/[^0-9a-f]/gi,""),b=0,d=["#"];while(b<33){var e=h.indexOf(a.charAt(b))<<8,f=h.indexOf(a.charAt(b+1))<<4,g=h.indexOf(a.charAt(b+2));g=g|(f|e);f=g>>6;d.push(i.charAt(f));d.push(i.charAt(g&63));b+=3}return d.join("")}b={generate:a};g["default"]=b}),98);
__d("LSResult.bs",[],(function(a,b,c,d,e,f){"use strict";function a(a){return[a]}f.make=a}),null);
__d("LSCreateDataTraceID.bs",["LSRequestId","LSResult.bs"],(function(a,b,c,d,e,f){"use strict";function a(a,c){return window.Promise.resolve(b("LSResult.bs").make(b("LSRequestId").generate()))}f.call=a}),null);
__d("LSDeleteBackupOnClient",["LSAppendDataTraceAddon","LSFlushDataTrace.bs"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e;return c.seq([function(d){return c.seq([function(d){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsDeleteBackupOnClientStoredProcedure]Beginning execution."),a[3]!==e?c.sp(b("LSAppendDataTraceAddon"),a[3],[0,1423],[0,2],e,e):c.resolve()},function(b){return c.i64.neq(a[0],e)?c.fe(c.db.table(168).fetch([[[a[0]]]]),function(a){return a["delete"]()}):c.fe(c.db.table(168).fetch(),function(a){return a["delete"]()})},function(b){return a[2]?c.fe(c.db.table(172).fetch([[[[0,1]]]]),function(a){var b=a.update;a.item;return b({backupId:e})}):c.resolve()},function(d){return a[3]!==e?c.nop(b("LSFlushDataTrace.bs"),a[3]):c.resolve()},function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsDeleteBackupOnClientStoredProcedure]Finishing execution.")}])},function(a){return c.resolve(d)}])}e.exports=a}),null);
__d("LSSyncEpochs",["LSAppendDataTraceAddon","LSCreateDataTraceID.bs","LSDeleteBackupOnClient","LSFlushDataTrace.bs","LSIssueNewTask"],(function(a,b,c,d,e,f){function g(){var a=babelHelpers.taggedTemplateLiteralLoose(["0"]);g=function(){return a};return a}function a(){var a=arguments,c=a[a.length-1],d=c.n,e=[],f=[],h;return c.seq([function(a){return c.seq([function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]Beginning execution."),c.islc(c.ftr(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,[0,80])&&c.i64.eq(a.backupTenancy,[0,2])}),0,c.i64.to_float([0,1])).next().then(function(a,b){b=a.done;a=a.value;return b?e[0]=!1:(a.item,e[0]=!0)})},function(a){return e[0]?e[2]=c.i64.or_([0,78],[0,128]):e[2]=[0,78],c.nop(b("LSCreateDataTraceID.bs")).then(function(a){return a=a,e[3]=a[0],a})},function(a){return e[4]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][MEBTraceUtils]",e[4],"EncryptedBackups Trace ID",e[4],c.i64.to_string(e[2])].join("")),c.db.table(153).add({traceId:e[3],initTimestampMs:c.i64.of_float(Date.now()),traceType:e[2],shouldFlush:!1,contextThree:"synch_epochs"})},function(a){return e[3]!==h?c.sp(b("LSAppendDataTraceAddon"),e[3],[0,1436],[0,2],h,h):c.resolve()},function(a){return c.ftr(c.db.table(2).fetch(),function(a){return a.context===c.i64.to_string([0,50013])}).next().then(function(a,b){b=a.done;a=a.value;return b?e[5]=!1:(a.item,e[5]=!0)})},function(a){return e[5]?c.seq([function(a){return e[3]!==h?e[3]!==h?c.sp(b("LSAppendDataTraceAddon"),e[3],[0,84],[0,2],"[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]Another sync job is already in progress. Terminating this.",h):c.resolve():c.resolve()},function(a){return e[3]!==h?c.nop(b("LSFlushDataTrace.bs"),e[3]):c.resolve()}]):c.seq([function(a){return c.ct(c.ftr(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,[0,80])})).then(function(a){return e[7]=a})},function(a){return c.i64.eq(e[7],[0,1])?c.ftr(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,[0,80])}).next().then(function(a,f){var i=a.done;a=a.value;return i?0:(f=a.item,e[9]=f.backupId,e[8]=f.deviceId,c.i64.neq(e[8],h)?c.seq([function(a){return c.ct(c.db.table(169).fetch()).then(function(a){return e[10]=a})},function(a){return c.i64.neq(e[10],d(g()))?e[11]=!0:e[11]=!1,e[11]?(e[12]=new c.Map(),e[12].set("backup_id",e[9]),e[12].set("device_id",e[8]),e[12].set("trace_id",e[3]),e[13]=c.toJSON(e[12]),c.sp(b("LSIssueNewTask"),"messenger_encrypted_backups",[0,50013],e[13],h,h,[0,0],[0,0],h,h,[0,0])):c.seq([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]epochs table is null/empty. Cleaning backup on client"),e[3]!==h?e[3]!==h?c.sp(b("LSAppendDataTraceAddon"),e[3],[0,84],[0,2],"[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]epochs table is null/empty. Cleaning backup on client",h):c.resolve():c.resolve()},function(a){return c.sp(b("LSDeleteBackupOnClient"),e[9],"synch_epochs",!0,e[3])}])}]):c.seq([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]device_id is null. Cleaning backup on client"),e[3]!==h?e[3]!==h?c.sp(b("LSAppendDataTraceAddon"),e[3],[0,84],[0,2],"[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]device_id is null. Cleaning backup on client",h):c.resolve():c.resolve()},function(a){return c.sp(b("LSDeleteBackupOnClient"),e[9],"synch_epochs",!0,e[3])}]))}):c.seq([function(a){return e[3]!==h?e[3]!==h?c.sp(b("LSAppendDataTraceAddon"),e[3],[0,84],[0,2],"[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]Exactly 1 entry is expected in client_state_table",h):c.resolve():c.resolve()},function(a){return e[3]!==h?c.nop(b("LSFlushDataTrace.bs"),e[3]):c.resolve()},function(a){return c.ct(c.ftr(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,[0,80])})).then(function(a){return e[8]=a})},function(a){return e[9]="",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]",e[9],"Exactly 1 entry is expected in client_state_table. Found = ",e[9],c.i64.to_string(e[8])].join(""))}])}])},function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]Finishing execution.")}])},function(a){return c.resolve(f)}])}e.exports=a}),null);
__d("LSTaskSerializerMuteThreadV2",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d=[],e;return b.seq([function(f){return b.seq([function(d){return b.db.table(32).fetch([[[a[0]]]]).next().then(function(d,f){var g=d.done;d=d.value;return g?(c[3]=b.createArray(),c[4]=(c[3].push("TaskSerializerMuteThreadV2: Task ID not found"),c[3]),c[5]=(c[3].push(a[0]),c[3]),c[6]=b.toJSON(c[3]),function(a){b.logger(a).mustfix(a)}(c[6]),g=[e,e],c[0]=g[0],c[1]=g[1],g):(f=d.item,b.seq([function(a){return c[6]=f.threadKey,b.db.table(9).fetch([[[c[6]]]]).next().then(function(d,f){var a=d.done;d=d.value;return a?(c[7]=b.createArray(),c[8]=(c[7].push("TaskSerializerMuteThreadV2: Thread not found"),c[7]),c[9]=(c[7].push(c[6]),c[7]),c[10]=b.toJSON(c[7]),function(a){b.logger(a).mustfix(a)}(c[10]),a=[e,e],c[3]=a[0],c[4]=a[1],a):(f=d.item,b.seq([function(a){return b.db.table(9).fetch([[[c[6]]]]).next().then(function(d,f){var a=d.done;d=d.value;return a?c[7]=[0,1]:(f=d.item,c[12]=f.syncGroup,b.i64.neq(c[12],e)?c[11]=c[12]:c[11]=[0,1],c[7]=c[11])})},function(a){return c[9]=new b.Map(),c[9].set("thread_key",c[6]),c[9].set("mailbox_type",[0,0]),c[9].set("mute_expire_time_ms",f.muteExpireTimeMs),c[9].set("sync_group",c[7]),c[10]=b.toJSON(c[9]),a=[c[10],[0,144]],c[3]=a[0],c[4]=a[1],a}]))})},function(a){return a=[c[3],c[4]],c[0]=a[0],c[1]=a[1],a}]))})},function(a){return a=[c[0],c[1]],d[0]=a[0],d[1]=a[1],a}])},function(a){return b.resolve(d)}])}e.exports=a}),null);
__d("LSTaskSerializerRemoveThread",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d=[],e;return b.seq([function(f){return b.seq([function(d){return b.db.table(32).fetch([[[a[0]]]]).next().then(function(d,f){var g=d.done;d=d.value;return g?(c[3]=b.createArray(),c[4]=(c[3].push("TaskSerializerRemoveThreadV2: Task ID not found"),c[3]),c[5]=(c[3].push(a[0]),c[3]),c[6]=b.toJSON(c[3]),function(a){b.logger(a).mustfix(a)}(c[6]),g=[e,e],c[0]=g[0],c[1]=g[1],g):(f=d.item,c[5]=f.removeType,b.i64.neq(c[5],e)?(c[6]=new b.Map(),c[6].set("thread_key",f.threadKey),c[6].set("remove_type",c[5]),c[6].set("sync_group",f.syncGroup==null?[0,1]:f.syncGroup),c[7]=b.toJSON(c[6]),g=[c[7],[0,146]],c[3]=g[0],c[4]=g[1],g):(d=[e,e],c[3]=d[0],c[4]=d[1],d),f=[c[3],c[4]],c[0]=f[0],c[1]=f[1],f)})},function(a){return a=[c[0],c[1]],d[0]=a[0],d[1]=a[1],a}])},function(a){return b.resolve(d)}])}e.exports=a}),null);
__d("LSTaskSerializerSendMessageV2",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d=[],e;return b.seq([function(f){return b.seq([function(d){return b.db.table(31).fetch([[[a[0]]]]).next().then(function(d,f){var g=d.done;d=d.value;return g?(c[3]=b.createArray(),c[4]=(c[3].push("task ID not found"),c[3]),c[5]=(c[3].push(a[0]),c[3]),c[6]=b.toJSON(c[3]),function(a){b.logger(a).mustfix(a)}(c[6]),g=[e,e],c[0]=g[0],c[1]=g[1],g):(f=d.item,b.seq([function(d){return c[9]=f.offlineThreadingId,c[10]=f.messageId,c[14]=f.threadAttributionSource,c[7]=f.platformRef,c[8]=f.platformToken,c[6]=f.replySourceId,c[11]=f.replySourceType,c[13]=f.sendType,c[12]=f.initiatingSource,b.db.table(12).fetch([[[c[9]]],"optimistic"]).next().then(function(f,h){var d=f.done;f=f.value;return d?(c[15]=b.createArray(),c[16]=(c[15].push("OTID not found"),c[15]),c[17]=(c[15].push(c[9]),c[15]),c[18]=b.toJSON(c[15]),function(a){b.logger(a).mustfix(a)}(c[18]),d=[e,e],c[3]=d[0],c[4]=d[1],d):(h=f.item,b.seq([function(d){return c[21]=h.text,c[19]=h.threadKey,c[22]=h.messageId,c[20]=h.stickerId,c[24]=h.mentionOffsets,c[25]=h.mentionLengths,c[18]=h.mentionIds,c[26]=h.mentionTypes,c[29]=h.replyType,c[27]=h.isForwarded,c[23]=h.forwardScore,c[28]=h.hotEmojiSize,b.db.table(9).fetch([[[c[19]]]]).next().then(function(f,i){var d=f.done;f=f.value;return d?(c[30]=b.createArray(),c[31]=(c[30].push("thread not found"),c[30]),c[32]=(c[30].push(c[19]),c[30]),c[33]=b.toJSON(c[30]),function(a){b.logger(a).mustfix(a)}(c[33]),d=[e,e],c[15]=d[0],c[16]=d[1],d):(i=f.item,b.seq([function(d){return b.db.table(2).fetch([[[a[0]]]]).next().then(function(e,f){var d=e.done;e=e.value;return d?c[30]=!1:(f=e.item,b.seq([function(d){return b.islc(b.ftr(b.db.table(2).fetch(),function(a){return a.queueName===f.queueName}),0,b.i64.to_float([0,1])).next().then(function(e,f){var d=e.done;e=e.value;return d?c[34]=!1:(f=e.item,c[34]=b.i64.eq(f.taskId,a[0]))})},function(a){return c[30]=c[34]}]))})},function(a){return b.i64.eq(i.authorityLevel,[0,20])&&b.i64.eq(i.threadType,[0,2])&&c[30]?b.seq([function(a){return c[35]=c[13]==null?[0,1]:c[13],c[34]=new b.Map(),c[34].set("thread_id",c[19]),c[34].set("otid",c[9]),c[34].set("source",c[14]==null?[0,0]:c[14]),c[34].set("send_type",[0,1]),b.i64.eq(c[35],[0,1])?b.resolve(c[34].set("text",c[21])):b.i64.eq(c[35],[0,2])?b.resolve(b.i64.neq(c[20],e)?(c[34].set("sticker_id",c[20]),c[34].set("send_type",c[35])):0):b.i64.eq(c[35],[0,7])?b.seq([function(a){return b.db.table(16).fetch([[[c[19],c[22]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?(a=[e,e],c[43]=a[0],c[44]=a[1],a):(d=b.item,a=[d.filename,d.attributionAppId],c[43]=a[0],c[44]=a[1],a)})},function(a){return c[43]!==e?b.i64.neq(c[44],e)?(c[34].set("url",c[43]),c[34].set("attribution_app_id",c[44]),c[34].set("send_type",c[35])):0:0}]):b.i64.eq(c[35],[0,3])?b.seq([function(a){return c[34].set("text",c[21]),c[43]=b.createArray(),c[44]=b.createArray(),b.fe(b.sb(b.db.table(16).fetch([[[c[19],c[22]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return c[45]=a.offlineAttachmentId,c[46]=(c[43].push(b.i64.from_string(a.attachmentFbid)),c[43]),c[45]!==e?c[46]=(c[44].push(c[45]),c[44]):0})},function(a){return c[34].set("attachment_fbids",c[43]),b.i64.eq(c[35],[0,9])?c[34].set("offline_attachment_ids",c[44]):0,c[34].set("send_type",c[35])}]):b.i64.eq(c[35],[0,9])?b.seq([function(a){return c[34].set("text",c[21]),c[43]=b.createArray(),c[44]=b.createArray(),b.fe(b.sb(b.db.table(16).fetch([[[c[19],c[22]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return c[45]=a.offlineAttachmentId,c[46]=(c[43].push(b.i64.from_string(a.attachmentFbid)),c[43]),c[45]!==e?c[46]=(c[44].push(c[45]),c[44]):0})},function(a){return c[34].set("attachment_fbids",c[43]),b.i64.eq(c[35],[0,9])?c[34].set("offline_attachment_ids",c[44]):0,c[34].set("send_type",c[35])}]):b.i64.eq(c[35],[0,10])?b.seq([function(a){return c[34].set("text",c[21]),c[43]=b.createArray(),c[44]=b.createArray(),b.fe(b.sb(b.db.table(16).fetch([[[c[19],c[22]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return c[45]=a.offlineAttachmentId,c[46]=(c[43].push(b.i64.from_string(a.attachmentFbid)),c[43]),c[45]!==e?c[46]=(c[44].push(c[45]),c[44]):0})},function(a){return c[34].set("attachment_fbids",c[43]),b.i64.eq(c[35],[0,9])?c[34].set("offline_attachment_ids",c[44]):0,c[34].set("send_type",c[35])}]):b.i64.eq(c[35],[0,4])?b.seq([function(a){return b.db.table(16).fetch([[[c[19],c[22]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?c[43]=e:(d=b.item,c[43]=d.attachmentFbid)})},function(a){return c[43]!==e?(c[34].set("text",c[21]),c[34].set("forwarded_share_id",c[43]),c[34].set("send_type",c[35])):0}]):b.i64.eq(c[35],[0,5])?b.resolve(c[10]!==e?(c[34].set("forwarded_msg_id",c[10]),c[34].set("send_type",c[35]),b.i64.neq(c[23],e)?c[34].set("forward_score",c[23]):0):0):b.i64.eq(c[35],[0,6])?b.seq([function(a){return b.db.table(16).fetch([[[c[19],c[22]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?(a=[e,e],c[43]=a[0],c[44]=a[1],a):(d=b.item,a=[d.filename,d.attributionAppId],c[43]=a[0],c[44]=a[1],a)})},function(a){return c[43]!==e?(c[34].set("url",c[43]),c[34].set("text",c[21]),c[34].set("send_type",c[35])):0}]):b.resolve(0)},function(a){return c[39]=c[6]===""?e:c[6],c[39]!==e?b.i64.neq(c[11],e)?(c[43]=new b.Map(),c[43].set("reply_source_id",c[39]),c[43].set("reply_source_type",c[11]),c[43].set("reply_type",c[29]==null?[0,0]:c[29]),c[34].set("reply_metadata",c[43])):0:0,c[40]=c[18]===""?e:c[18],c[40]!==e?(c[43]=c[24]===""?e:c[24],c[43]!==e?(c[44]=c[25]===""?e:c[25],c[44]!==e?(c[45]=new b.Map(),c[45].set("mention_ids",c[40]),c[45].set("mention_offsets",c[43]),c[45].set("mention_lengths",c[44]),c[45].set("mention_types",c[26]===""?e:c[26]),c[34].set("mention_data",c[45])):0):0):0,c[27]!==e?c[34].set("is_forwarded",c[27]):0,c[41]=c[7]===""?e:c[7],c[41]!==e?c[34].set("platform_ref",c[41]):0,c[42]=c[8]===""?e:c[8],c[42]!==e?c[34].set("platform_token",c[42]):0,[[0,1],[0,2]].some(function(a){return b.i64.eq(c[35],a)})?b.i64.neq(c[28],e)?c[34].set("hot_emoji_size",c[28]):0:0,b.i64.neq(c[12],e)?c[34].set("initiating_source",c[12]):0,c[36]=b.createArray(),b.fe(b.db.table(14).fetch([[[c[19]]]]),function(a){a=a.item;return c[43]=(c[36].push(a.contactId),c[36])})},function(a){return c[37]=new b.Map(),c[37].set("participants",c[36]),c[37].set("send_payload",c[34]),b.fe(b.ftr(b.db.table(9).fetch(),function(a){return b.i64.eq(a.threadKey,i.threadKey)}),function(a){var b=a.update;a.item;return b({otidOfFirstMessage:h.offlineThreadingId})})},function(a){return c[38]=b.toJSON(c[37]),a=[c[38],[0,130]],c[32]=a[0],c[33]=a[1],a}]):b.seq([function(a){return c[35]=c[13]==null?[0,1]:c[13],c[34]=new b.Map(),c[34].set("thread_id",c[19]),c[34].set("otid",c[9]),c[34].set("source",c[14]==null?[0,0]:c[14]),c[34].set("send_type",[0,1]),b.i64.eq(c[35],[0,1])?b.resolve(c[34].set("text",c[21])):b.i64.eq(c[35],[0,2])?b.resolve(b.i64.neq(c[20],e)?(c[34].set("sticker_id",c[20]),c[34].set("send_type",c[35])):0):b.i64.eq(c[35],[0,7])?b.seq([function(a){return b.db.table(16).fetch([[[c[19],c[22]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?(a=[e,e],c[41]=a[0],c[42]=a[1],a):(d=b.item,a=[d.filename,d.attributionAppId],c[41]=a[0],c[42]=a[1],a)})},function(a){return c[41]!==e?b.i64.neq(c[42],e)?(c[34].set("url",c[41]),c[34].set("attribution_app_id",c[42]),c[34].set("send_type",c[35])):0:0}]):b.i64.eq(c[35],[0,3])?b.seq([function(a){return c[34].set("text",c[21]),c[41]=b.createArray(),c[42]=b.createArray(),b.fe(b.sb(b.db.table(16).fetch([[[c[19],c[22]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return c[43]=a.offlineAttachmentId,c[44]=(c[41].push(b.i64.from_string(a.attachmentFbid)),c[41]),c[43]!==e?c[44]=(c[42].push(c[43]),c[42]):0})},function(a){return c[34].set("attachment_fbids",c[41]),b.i64.eq(c[35],[0,9])?c[34].set("offline_attachment_ids",c[42]):0,c[34].set("send_type",c[35])}]):b.i64.eq(c[35],[0,9])?b.seq([function(a){return c[34].set("text",c[21]),c[41]=b.createArray(),c[42]=b.createArray(),b.fe(b.sb(b.db.table(16).fetch([[[c[19],c[22]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return c[43]=a.offlineAttachmentId,c[44]=(c[41].push(b.i64.from_string(a.attachmentFbid)),c[41]),c[43]!==e?c[44]=(c[42].push(c[43]),c[42]):0})},function(a){return c[34].set("attachment_fbids",c[41]),b.i64.eq(c[35],[0,9])?c[34].set("offline_attachment_ids",c[42]):0,c[34].set("send_type",c[35])}]):b.i64.eq(c[35],[0,10])?b.seq([function(a){return c[34].set("text",c[21]),c[41]=b.createArray(),c[42]=b.createArray(),b.fe(b.sb(b.db.table(16).fetch([[[c[19],c[22]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return c[43]=a.offlineAttachmentId,c[44]=(c[41].push(b.i64.from_string(a.attachmentFbid)),c[41]),c[43]!==e?c[44]=(c[42].push(c[43]),c[42]):0})},function(a){return c[34].set("attachment_fbids",c[41]),b.i64.eq(c[35],[0,9])?c[34].set("offline_attachment_ids",c[42]):0,c[34].set("send_type",c[35])}]):b.i64.eq(c[35],[0,4])?b.seq([function(a){return b.db.table(16).fetch([[[c[19],c[22]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?c[41]=e:(d=b.item,c[41]=d.attachmentFbid)})},function(a){return c[41]!==e?(c[34].set("text",c[21]),c[34].set("forwarded_share_id",c[41]),c[34].set("send_type",c[35])):0}]):b.i64.eq(c[35],[0,5])?b.resolve(c[10]!==e?(c[34].set("forwarded_msg_id",c[10]),c[34].set("send_type",c[35]),b.i64.neq(c[23],e)?c[34].set("forward_score",c[23]):0):0):b.i64.eq(c[35],[0,6])?b.seq([function(a){return b.db.table(16).fetch([[[c[19],c[22]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?(a=[e,e],c[41]=a[0],c[42]=a[1],a):(d=b.item,a=[d.filename,d.attributionAppId],c[41]=a[0],c[42]=a[1],a)})},function(a){return c[41]!==e?(c[34].set("url",c[41]),c[34].set("text",c[21]),c[34].set("send_type",c[35])):0}]):b.resolve(0)},function(a){return c[37]=c[6]===""?e:c[6],c[37]!==e?b.i64.neq(c[11],e)?(c[41]=new b.Map(),c[41].set("reply_source_id",c[37]),c[41].set("reply_source_type",c[11]),c[41].set("reply_type",c[29]==null?[0,0]:c[29]),c[34].set("reply_metadata",c[41])):0:0,c[38]=c[18]===""?e:c[18],c[38]!==e?(c[41]=c[24]===""?e:c[24],c[41]!==e?(c[42]=c[25]===""?e:c[25],c[42]!==e?(c[43]=new b.Map(),c[43].set("mention_ids",c[38]),c[43].set("mention_offsets",c[41]),c[43].set("mention_lengths",c[42]),c[43].set("mention_types",c[26]===""?e:c[26]),c[34].set("mention_data",c[43])):0):0):0,c[27]!==e?c[34].set("is_forwarded",c[27]):0,c[39]=c[7]===""?e:c[7],c[39]!==e?c[34].set("platform_ref",c[39]):0,c[40]=c[8]===""?e:c[8],c[40]!==e?c[34].set("platform_token",c[40]):0,[[0,1],[0,2]].some(function(a){return b.i64.eq(c[35],a)})?b.i64.neq(c[28],e)?c[34].set("hot_emoji_size",c[28]):0:0,b.i64.neq(c[12],e)?c[34].set("initiating_source",c[12]):0,c[36]=b.toJSON(c[34]),a=[c[36],[0,46]],c[32]=a[0],c[33]=a[1],a}])},function(a){return a=[c[32],c[33]],c[15]=a[0],c[16]=a[1],a}]))})},function(a){return a=[c[15],c[16]],c[3]=a[0],c[4]=a[1],a}]))})},function(a){return a=[c[3],c[4]],c[0]=a[0],c[1]=a[1],a}]))})},function(a){return a=[c[0],c[1]],d[0]=a[0],d[1]=a[1],a}])},function(a){return b.resolve(d)}])}e.exports=a}),null);
__d("LSBeginHandlingPendingTasksForQueue",["LSAppendDataTraceAddon","LSFlushDataTrace.bs","LSSerializeBackupPayloadIndirection.bs","LSSyncEpochs","LSTaskSerializerMuteThreadV2","LSTaskSerializerRemoveThread","LSTaskSerializerSendMessageV2","gkx","qex"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(g){return c.seq([function(b){return c.ftr(c.db.table(3).fetch([[[a[0]]]]),function(b){return c.i64.neq(b.epochId,f)&&b.taskQueueName===a[0]}).next().then(function(a,b){b=a.done;a=a.value;return b?d[0]=!1:(a.item,d[0]=!0)})},function(e){return d[2]=new c.Map(),d[2].set("queue_name",a[0]),d[2].set("next_sync_ms",f),d[2].set("work_item_type",[0,4]),d[2].set("network_payload",f),d[2].set("http_url_override",f),d[2].set("skip_realtime_gateway",!1),d[3]=d[2],d[0]?c.resolve():c.seq([function(b){return c.islc(c.ftr(c.db.table(2).fetch(),function(b){return b.queueName===a[0]}),0,c.i64.to_float([0,1])).next().then(function(a,b){var c=a.done;a=a.value;return c?(c=["",[-1,4294967295],[0,0],[-1,4294967295],f,f],d[4]=c[0],d[5]=c[1],d[6]=c[2],d[7]=c[3],d[8]=c[4],d[9]=c[5],c):(b=a.item,c=[b.queueName,b.minTimeToSyncTimestampMs,b.pluginType,b.failureCount,b.context,b.httpUrlOverride],d[4]=c[0],d[5]=c[1],d[6]=c[2],d[7]=c[3],d[8]=c[4],d[9]=c[5],c)})},function(b){return c.db.table(3).fetch([[[a[0]]]]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[11]=[0,0]:(b=a.item,d[11]=b.lastSyncRequestTimestampMs)})},function(e){return d[14]=c.i64.sub(d[5],c.i64.of_float(Date.now())),c.i64.le(d[14],[0,0])?(c.i64.eq(d[7],[0,0])||a[1]?d[15]=[0,0]:(c.i64.gt(d[7],[0,7])?d[17]=c.i64.sub(d[7],[0,7]):d[17]=d[7],d[18]=c.i64.sub(d[17],[0,1]),d[19]=c.i64.mul(c.i64.lsl_([0,1],c.i64.to_int32(c.i64.lt(d[18],[0,7])?d[18]:[0,7])),[0,500]),d[15]=c.i64.lt(d[19],[0,3e4])?d[19]:[0,3e4]),d[16]=c.i64.sub(c.i64.add(d[11],d[15]),c.i64.of_float(Date.now())),d[13]=c.i64.gt(d[16],[0,0])?d[16]:[0,0]):d[13]=d[14],c.i64.neq(d[13],[0,0])?c.resolve((d[15]=new c.Map(),d[15].set("queue_name",a[0]),d[15].set("next_sync_ms",d[13]),d[15].set("work_item_type",[0,3]),d[15].set("network_payload",f),d[15].set("http_url_override",f),d[15].set("skip_realtime_gateway",!1),d[3]=d[15])):c.seq([function(a){return c.i64.neq(d[6],[0,0])||d[8]==="16"||d[8]==="4"?c.resolve((a=[d[4],f,[0,2],f,f,!1],d[15]=a[0],d[16]=a[1],d[17]=a[2],d[18]=a[3],d[19]=a[4],d[20]=a[5],a)):c.seq([function(a){return d[22]=c.createArray(),d[23]=!0,c.islc(c.ftr(c.db.table(2).fetch(),function(a){return a.queueName===d[4]}),0,c.i64.to_float([0,1])).next().then(function(a,b){var c=a.done;a=a.value;return c?(c=["",[-1,4294967295],[0,0],[-1,4294967295],f,f],d[24]=c[0],d[25]=c[1],d[26]=c[2],d[27]=c[3],d[28]=c[4],d[29]=c[5],c):(b=a.item,c=[b.queueName,b.minTimeToSyncTimestampMs,b.pluginType,b.failureCount,b.context,b.httpUrlOverride],d[24]=c[0],d[25]=c[1],d[26]=c[2],d[27]=c[3],d[28]=c[4],d[29]=c[5],c)})},function(a){return c.ftr(c.db.table(2).fetch(),function(a){return a.queueName===d[4]}).next().then(function(a,b){b=a.done;a=a.value;return b?d[31]=!0:(a.item,d[31]=!0)})},function(a){return c.fe(c.ftr(c.db.table(2).fetch(),function(a){return a.queueName===d[4]}),function(a){var e=a.item;return d[42]=e.taskId,d[40]=e.context,d[43]=e.failureCount,d[41]=e.timeoutTimestampMs,d[23]=e.httpUrlOverride===d[29]&&!0===d[31]&&d[23],d[23]?c.seq([function(a){return d[40]===f?c.seq([function(a){return c.fe(c.ftr(c.db.table(2).fetch(),function(a){return c.i64.eq(a.taskId,d[42])}),function(a){return a["delete"]()})},function(a){return d[44]=f}]):c.seq([function(a){return c.i64.neq(d[41],f)?d[49]=c.i64.ge(c.i64.of_float(Date.now()),d[41]):d[49]=!1,d[49]?c.seq([function(a){return c.fe(c.ftr(c.db.table(2).fetch(),function(a){return c.i64.eq(a.taskId,d[42])}),function(a){return a["delete"]()})},function(a){return d[50]=f}]):c.seq([function(a){return c.seq([function(a){return d[40]==="46"?c.seq([function(a){return c.sp(b("LSTaskSerializerSendMessageV2"),d[42]).then(function(a){return a=a,d[58]=a[0],d[59]=a[1],a})},function(a){return a=[d[58],c.i64.to_string(d[59])],d[54]=a[0],d[55]=a[1],a}]):c.seq([function(a){return d[40]==="144"?c.seq([function(a){return c.sp(b("LSTaskSerializerMuteThreadV2"),d[42]).then(function(a){return a=a,d[60]=a[0],d[61]=a[1],a})},function(a){return a=[d[60],c.i64.to_string(d[61])],d[58]=a[0],d[59]=a[1],a}]):c.seq([function(a){return d[40]==="146"?c.seq([function(a){return c.sp(b("LSTaskSerializerRemoveThread"),d[42]).then(function(a){return a=a,d[62]=a[0],d[63]=a[1],a})},function(a){return a=[d[62],c.i64.to_string(d[63])],d[60]=a[0],d[61]=a[1],a}]):c.seq([function(a){return d[40]==="32"?c.seq([function(a){return c.seq([function(a){return c.db.table(32).fetch([[[d[42]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?(d[69]=c.createArray(),d[70]=(d[69].push("taskSerializerUpdateThreadName: Task ID not found"),d[69]),d[71]=(d[69].push(d[42]),d[69]),d[72]=c.toJSON(d[69]),function(a){c.logger(a).mustfix(a)}(d[72]),e=[f,f],d[66]=e[0],d[67]=e[1],e):(b=a.item,c.seq([function(a){return d[72]=b.threadKey,c.db.table(9).fetch([[[d[72]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[73]=c.createArray(),d[74]=(d[73].push("taskSerializerUpdateThreadName: Thread not found"),d[73]),d[75]=(d[73].push(d[72]),d[73]),d[76]=c.toJSON(d[73]),function(a){c.logger(a).mustfix(a)}(d[76]),a=[f,f],d[69]=a[0],d[70]=a[1],a):(e=b.item,c.seq([function(a){return c.db.table(9).fetch([[[d[72]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[73]=[0,1]:(e=b.item,d[78]=e.syncGroup,c.i64.neq(d[78],f)?d[77]=d[78]:d[77]=[0,1],d[73]=d[77])})},function(a){return d[75]=new c.Map(),d[75].set("thread_key",d[72]),d[75].set("thread_name",e.threadName==null?"":e.threadName),d[75].set("sync_group",d[73]),d[76]=c.toJSON(d[75]),a=[d[76],[0,32]],d[69]=a[0],d[70]=a[1],a}]))})},function(a){return a=[d[69],d[70]],d[66]=a[0],d[67]=a[1],a}]))})},function(a){return a=[d[66],d[67]],d[64]=a[0],d[65]=a[1],a}])},function(a){return a=[d[64],c.i64.to_string(d[65])],d[62]=a[0],d[63]=a[1],a}]):c.seq([function(a){return d[40]==="362"?c.resolve((a=[f,f],d[66]=a[0],d[67]=a[1],a,a=[d[66],c.i64.to_string(d[67])],d[64]=a[0],d[65]=a[1],a)):c.seq([function(a){return d[40]==="50015"?c.seq([function(a){return c.seq([function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure]Beginning execution."),c.db.table(168).fetch().next().then(function(a,e){var h=a.done;a=a.value;return h?(h=[f,f],d[70]=h[0],d[71]=h[1],h):(e=a.item,c.seq([function(a){return d[75]=e.deviceId,c.i64.neq(d[75],f)?c.seq([function(a){return c.db.table(190).fetch([[[d[42]]]]).next().then(function(e,i){var a=e.done;e=e.value;return a?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure]No restore payload context found."),a=[f,f],d[76]=a[0],d[77]=a[1],a):(i=e.item,c.seq([function(a){return c.seq([function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsGetOpenEpochKeysStoredProcedure]Beginning execution."),c.ct(c.ftr(c.db.table(169).fetch(),function(a){return c.i64.eq(a.epochStatus,[0,1])&&c.i64.eq(a.authorityLevel,[0,80])})).then(function(a){return d[83]=a})},function(a){return c.i64.le(d[83],[0,1])?c.seq([function(a){return c.ftr(c.db.table(169).fetch(),function(a){return c.i64.eq(a.epochStatus,[0,1])&&c.i64.eq(a.authorityLevel,[0,80])}).next().then(function(e,i){var a=e.done;e=e.value;return a?c.seq([function(a){return d[88]=function(a){return a==f?f:a}(b("qex")._("2159")),d[88]!==f?d[87]=d[88]:d[87]=!1,d[87]===!1?function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsGetOpenEpochKeysStoredProcedure]Epoch rotation is disabled but open epoch count is not 1. Executing sync"):0,c.sp(b("LSSyncEpochs"))},function(a){return d[85]=f}]):(i=e.item,d[87]=new c.Map(),d[87].set("epoch_id",i.epochId),d[87].set("epoch_root_key",i.epochRootKeyBlob),d[87].set("epoch_anon_id",i.epochAnonIdBlob),d[85]=d[87])})},function(a){return d[84]=d[85]}]):c.seq([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsSecureEncryptedBackupsEpochsTable]Error! More than 1 open epoch was found. Calling the sync flow and returning empty results"),c.sp(b("LSSyncEpochs"))},function(a){return c.ftr(c.db.table(169).fetch(),function(a){return!1}).next().then(function(e,i){var a=e.done;e=e.value;return a?c.seq([function(a){return d[88]=function(a){return a==f?f:a}(b("qex")._("2159")),d[88]!==f?d[87]=d[88]:d[87]=!1,d[87]===!1?function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsGetOpenEpochKeysStoredProcedure]Epoch rotation is disabled but open epoch count is not 1. Executing sync"):0,c.sp(b("LSSyncEpochs"))},function(a){return d[85]=f}]):(i=e.item,d[87]=new c.Map(),d[87].set("epoch_id",i.epochId),d[87].set("epoch_root_key",i.epochRootKeyBlob),d[87].set("epoch_anon_id",i.epochAnonIdBlob),d[85]=d[87])})},function(a){return d[84]=d[85]}])},function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsGetOpenEpochKeysStoredProcedure]Finishing execution."),d[79]=d[84]}])},function(a){return d[79]!==f?(d[83]=d[79].get("epoch_id"),d[79],d[80]=d[83]):d[80]=f,d[81]=new c.Map(),d[81].set("content_type",i.contentType),d[81].set("device_id",d[75]),d[81].set("epoch_id",d[80]),d[81].set("list_id",i.listId),d[81].set("num_items",i.numItems),d[81].set("start_sort_key",i.startSortKey),d[81].set("mailbox_partial_id",i.mailboxPartialId),d[81].set("trace_id",i.traceId),d[82]=c.toJSON(d[81]),a=[d[82],[0,50015]],d[76]=a[0],d[77]=a[1],a}]))})},function(a){return a=[d[76],d[77]],d[73]=a[0],d[74]=a[1],a}]):c.resolve((function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure]Unexpected error: Device ID is null."),a=[f,f],d[73]=a[0],d[74]=a[1],a))},function(a){return a=[d[73],d[74]],d[70]=a[0],d[71]=a[1],a}]))})},function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure]Finishing execution."),a=[d[70],d[71]],d[68]=a[0],d[69]=a[1],a}])},function(a){return a=[d[68],c.i64.to_string(d[69])],d[66]=a[0],d[67]=a[1],a}]):c.seq([function(a){return d[40]==="319"?c.seq([function(a){return c.seq([function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure]Beginning execution."),c.db.table(177).fetch([[[d[42]]],"fk_pending_tasks"]).next().then(function(a,e){var h=a.done;a=a.value;return h?c.seq([function(a){return c.ftr(c.db.table(2).fetch(),function(a){return c.i64.eq(a.taskId,d[42])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure]Task not found."),d[77]=f):(e=b.item,d[77]=e.dataTraceId)})},function(a){return d[77]!==f?d[77]!==f?c.sp(b("LSAppendDataTraceAddon"),d[77],[0,84],[0,2],"[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure]Pending backup context not found",f):c.resolve():c.resolve()},function(a){return d[77]!==f?c.nop(b("LSFlushDataTrace.bs"),d[77]):c.resolve()},function(a){return d[72]=f}]):(e=a.item,d[72]=e.lsTraceId)})},function(a){return d[72]!==f?c.sp(b("LSAppendDataTraceAddon"),d[72],[0,1451],[0,2],f,f):c.resolve()},function(a){return d[72]!==f?0:function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure]Trace ID is null"),c.db.table(177).fetch([[[d[42]]],"fk_pending_tasks"]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[74]=f:(b=a.item,d[74]=b.echoContent)})},function(a){return c.nop(b("LSSerializeBackupPayloadIndirection.bs"),d[42],d[74],d[72]).then(function(a){return a=a,d[76]=a[0],a})},function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure]Finishing execution."),a=[d[76],[0,319]],d[70]=a[0],d[71]=a[1],a}])},function(a){return a=[d[70],c.i64.to_string(d[71])],d[68]=a[0],d[69]=a[1],a}]):c.resolve((a=[e.taskValue,d[40]],d[68]=a[0],d[69]=a[1],a))},function(a){return a=[d[68],d[69]],d[66]=a[0],d[67]=a[1],a}])},function(a){return a=[d[66],d[67]],d[64]=a[0],d[65]=a[1],a}])},function(a){return a=[d[64],d[65]],d[62]=a[0],d[63]=a[1],a}])},function(a){return a=[d[62],d[63]],d[60]=a[0],d[61]=a[1],a}])},function(a){return a=[d[60],d[61]],d[58]=a[0],d[59]=a[1],a}])},function(a){return a=[d[58],d[59]],d[54]=a[0],d[55]=a[1],a}])},function(a){return d[31]?(a=[d[54],d[55]],d[56]=a[0],d[57]=a[1],a):(a=[f,f],d[58]=a[0],d[59]=a[1],a,a=[d[58],c.i64.to_string(d[59])],d[56]=a[0],d[57]=a[1],a),a=[d[56],d[57]],d[51]=a[0],d[52]=a[1],a}])},function(a){return d[51]!==f?(d[54]=new c.Map(),d[54].set("label",d[52]),d[54].set("payload",d[51]),d[54].set("queue_name",e.queueName),d[54].set("task_id",d[42]),d[54].set("failure_count",c.i64.eq(d[43],[0,0])?f:d[43]),d[53]=d[54]):d[53]=f,d[50]=d[53]}])},function(a){return d[44]=d[50]}])},function(a){return d[44]?d[45]=!1:d[45]=!0,d[45]?0:d[49]=(d[22].push(d[44]),d[22]),d[46]=c.i64.of_int32(d[22].length),b("gkx")("6280")?d[47]=[0,50]:d[47]=[0,5],d[40]!==f?d[48]=["90","130","153"].includes(d[40]):d[48]=!1,d[23]=!(c.i64.ge(d[46],d[47])||d[48])}]):c.resolve()})},function(a){return d[33]=c.i64.of_int32(d[22].length),c.i64.eq(d[33],[0,0])?c.resolve((a=[d[4],f,[0,4],f,f,!1],d[34]=a[0],d[35]=a[1],d[36]=a[2],d[37]=a[3],d[38]=a[4],d[39]=a[5],a)):c.seq([function(a){return d[40]=c.i64.random(),d[50]=c.i64.and_(c.i64.or_(c.i64.lsl_(c.i64.of_float(Date.now()),c.i64.to_int32([0,22])),c.i64.and_(d[40],[0,4194303])),[2147483647,4294967295]),c.db.table(3).fetch([[[d[4],[-1,4294967295]]]]).next().then(function(a,b){b=a.done;a=a.value;return b?c.db.table(3).add({syncDatabaseId:[-1,4294967295],taskQueueName:d[4],failureCount:[0,0],lastSentTimestampMs:[0,0],lastSyncRequestTimestampMs:c.i64.of_float(Date.now()),epochId:d[50]}):(a.item,c.fe(c.db.table(3).fetch([[[d[4],[-1,4294967295]]]]),function(a){var b=a.update;a.item;return b({epochId:d[50],lastSyncRequestTimestampMs:c.i64.of_float(Date.now())})}))})},function(a){return c.islc(c.ftr(c.db.table(2).fetch(),function(a){return a.queueName===d[4]}),0,c.i64.to_float([0,1])).next().then(function(a,b){var c=a.done;a=a.value;return c?(c=["",[-1,4294967295],[0,0],[-1,4294967295],f,f],d[42]=c[0],d[43]=c[1],d[44]=c[2],d[45]=c[3],d[46]=c[4],d[47]=c[5],c):(b=a.item,c=[b.queueName,b.minTimeToSyncTimestampMs,b.pluginType,b.failureCount,b.context,b.httpUrlOverride],d[42]=c[0],d[43]=c[1],d[44]=c[2],d[45]=c[3],d[46]=c[4],d[47]=c[5],c)})},function(a){return d[49]=new c.Map(),d[49].set("tasks",d[22]),d[49].set("epoch_id",d[50]),a=[d[4],f,[0,1],d[49],d[47],!(d[47]===f)||c.i64.gt(d[45],[0,7])],d[34]=a[0],d[35]=a[1],d[36]=a[2],d[37]=a[3],d[38]=a[4],d[39]=a[5],a}])},function(a){return a=[d[34],d[35],d[36],d[37],d[38],d[39]],d[15]=a[0],d[16]=a[1],d[17]=a[2],d[18]=a[3],d[19]=a[4],d[20]=a[5],a}])},function(a){return d[21]=new c.Map(),d[21].set("queue_name",d[15]),d[21].set("next_sync_ms",d[16]),d[21].set("work_item_type",d[17]),d[21].set("network_payload",d[18]),d[21].set("http_url_override",d[19]),d[21].set("skip_realtime_gateway",d[20]),d[3]=d[21]}])}])},function(a){return e[0]=d[3]}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSBeginHandlingPendingTasks",["LSBeginHandlingPendingTasksForQueue"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(g){return c.seq([function(e){return d[0]=c.createArray(),c.gb(c.sb(c.db.table(2).fetch(),[["queueName","ASC"]]),"queueName").forEach(function(e){return c.seq([function(f){return c.sp(b("LSBeginHandlingPendingTasksForQueue"),e.queueName,a[0]).then(function(a){return a=a,d[1]=a[0],a})},function(a){return d[2]=(d[0].push(d[1]),d[0])}])})},function(a){return c.gb(c.sb(c.db.table(5).fetch(),[["queueName","ASC"]]),"queueName").forEach(function(a){return d[1]=a.queueName,c.seq([function(a){return d[2]=c.createArray(),c.fe(c.ftr(c.db.table(5).fetch(),function(a){return a.queueName===d[1]}),function(a){a=a.item;return d[5]=new c.Map(),d[5].set("label",a.context),d[5].set("payload",a.taskValue),d[5].set("queue_name",a.queueName),d[5].set("task_id",a.taskId),d[5].set("failure_count",c.i64.eq([0,0],[0,0])?f:[0,0]),d[6]=(d[2].push(d[5]),d[2])})},function(a){return d[3]=new c.Map(),d[3].set("tasks",d[2]),d[3].set("epoch_id",f),d[4]=new c.Map(),d[4].set("queue_name",d[1]),d[4].set("next_sync_ms",f),d[4].set("work_item_type",[0,5]),d[4].set("network_payload",d[3]),d[4].set("http_url_override",f),d[4].set("skip_realtime_gateway",!1),d[5]=(d[0].push(d[4]),d[0])}])})},function(a){return c.fe(c.db.table(5).fetch(),function(a){return a["delete"]()})},function(a){return e[0]=d[0]}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSBeginHandlingSyncForSyncGroup",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d=[],e;return b.seq([function(f){return b.seq([function(d){return b.db.table(1).fetch([[[a[0]]]]).next().then(function(a,d){var f=a.done;a=a.value;return f?c[0]=e:(d=a.item,c[9]=new b.Map(),c[9].set("group_id",d.groupId),c[9].set("current_cursor",d.currentCursor),c[9].set("sync_status",d.syncStatus),c[9].set("sync_params",d.syncParams),c[9].set("send_sync_params",d.sendSyncParams),c[9].set("min_time_to_sync_timestamp_ms",d.minTimeToSyncTimestampMs),c[9].set("can_ignore_timestamp",d.canIgnoreTimestamp),c[9].set("sync_channel",d.syncChannel),c[9].set("last_sync_request_timestamp_ms",d.lastSyncRequestTimestampMs),c[0]=c[9])})},function(d){return c[0]?c[2]=!1:c[2]=!0,c[2]?b.resolve((d=[a[0],e,[0,4],e,!1],c[3]=d[0],c[4]=d[1],c[5]=d[2],c[6]=d[3],c[7]=d[4],d)):b.seq([function(a){return c[9]=c[0].get("group_id"),c[0],b.ftr(b.db.table(3).fetch(),function(a){return b.i64.neq(a.epochId,e)&&b.i64.eq(a.syncDatabaseId,c[9])}).next().then(function(a,b){b=a.done;a=a.value;return b?c[10]=!1:(a.item,c[10]=!0)})},function(d){return c[10]?b.resolve((c[17]=c[0].get("group_id"),c[0],d=[c[17],e,[0,4],e,!1],c[12]=d[0],c[13]=d[1],c[14]=d[2],c[15]=d[3],c[16]=d[4],d)):b.seq([function(d){return c[27]=b.i64.of_float(Date.now()),c[17]=c[0].get("min_time_to_sync_timestamp_ms"),c[0],c[18]=c[0].get("last_sync_request_timestamp_ms"),c[0],c[19]=c[0].get("can_ignore_timestamp"),c[0],c[19]&&a[1]||b.i64.ge(c[27],c[17])?b.seq([function(d){return a[1]?b.resolve(c[28]=[0,0]):b.seq([function(a){return c[29]=c[0].get("group_id"),c[0],b.db.table(3).fetch([[["",c[29]]]]).next().then(function(a,b){var d=a.done;a=a.value;return d?c[30]=[0,0]:(b=a.item,c[30]=b.failureCount)})},function(a){return c[32]=b.i64.mul(b.i64.sub(b.i64.lsl_([0,1],b.i64.to_int32(b.i64.lt([0,15],c[30])?[0,15]:c[30])),[0,1]),[0,500]),c[33]=b.i64.sub(b.i64.add(c[18]==null?[0,0]:c[18],b.i64.lt(c[32],[0,3e4])?c[32]:[0,3e4]),c[27]),c[28]=b.i64.gt(c[33],[0,0])?c[33]:[0,0]}])},function(a){return c[20]=c[28]}]):b.resolve(c[20]=b.i64.sub(c[17],c[27]))},function(a){return c[21]=c[0].get("group_id"),c[0],b.i64.gt(c[20],[0,0])?b.seq([function(a){return b.fe(b.ftr(b.db.table(3).fetch(),function(a){return b.i64.eq(a.syncDatabaseId,c[21])}),function(a){var c=a.update;a.item;return c({lastDelayedRequestTimestampMs:b.i64.of_float(Date.now())})})},function(a){return a=[c[21],c[20],[0,3],e,!1],c[22]=a[0],c[23]=a[1],c[24]=a[2],c[25]=a[3],c[26]=a[4],a}]):b.seq([function(a){return b.fe(b.db.table(1).fetch([[[c[21]]]]),function(a){var c=a.update;a.item;return c({lastSyncRequestTimestampMs:b.i64.of_float(Date.now())})})},function(a){return b.fe(b.ftr(b.db.table(3).fetch(),function(a){return b.i64.eq(a.syncDatabaseId,c[21])}),function(a){var c=a.update;a.item;return c({lastSyncRequestTimestampMs:b.i64.of_float(Date.now())})})},function(a){return c[28]=c[0].get("group_id"),c[0],c[29]=b.i64.random(),c[42]=b.i64.and_(b.i64.or_(b.i64.lsl_(b.i64.of_float(Date.now()),b.i64.to_int32([0,22])),b.i64.and_(c[29],[0,4194303])),[2147483647,4294967295]),b.db.table(3).fetch([[["",c[28]]]]).next().then(function(a,d){d=a.done;a=a.value;return d?b.db.table(3).add({syncDatabaseId:c[28],taskQueueName:"",failureCount:[0,0],lastSentTimestampMs:[0,0],lastSyncRequestTimestampMs:[0,0],epochId:c[42]}):(a.item,b.fe(b.db.table(3).fetch([[["",c[28]]]]),function(a){var b=a.update;a.item;return b({epochId:c[42]})}))})},function(a){return c[31]=c[0].get("group_id"),c[0],b.db.table(3).fetch([[["",c[31]]]]).next().then(function(a,b){var d=a.done;a=a.value;return d?c[32]=[0,0]:(b=a.item,c[32]=b.failureCount)})},function(a){return c[34]=c[0].get("send_sync_params"),c[0],c[35]=c[0].get("sync_params"),c[0],c[36]=c[0].get("current_cursor"),c[0],c[37]=new b.Map(),c[37].set("database",c[31]),c[37].set("version",[-1,4294967295]),c[37].set("epoch_id",c[42]),c[37].set("last_applied_cursor",c[36]),c[37].set("sync_params",c[34]?c[35]:e),c[37].set("failure_count",b.i64.gt(c[32],[0,0])?c[32]:e),c[38]=c[0].get("current_cursor"),c[0],e===c[38]?c[39]=[0,1]:c[39]=[0,2],c[40]=new b.Map(),c[40].set("type",c[39]),c[40].set("request_payload",c[37]),c[41]=c[0].get("sync_channel"),c[0],a=[c[28],e,[0,1],c[40],b.i64.eq(c[41],[0,2])],c[22]=a[0],c[23]=a[1],c[24]=a[2],c[25]=a[3],c[26]=a[4],a}])},function(a){return a=[c[22],c[23],c[24],c[25],c[26]],c[12]=a[0],c[13]=a[1],c[14]=a[2],c[15]=a[3],c[16]=a[4],a}])},function(a){return a=[c[12],c[13],c[14],c[15],c[16]],c[3]=a[0],c[4]=a[1],c[5]=a[2],c[6]=a[3],c[7]=a[4],a}])},function(a){return c[8]=new b.Map(),c[8].set("sync_group_id",c[3]),c[8].set("next_sync_ms",c[4]),c[8].set("work_item_type",c[5]),c[8].set("network_payload",c[6]),c[8].set("skip_realtime_gateway",c[7]),d[0]=c[8]}])},function(a){return b.resolve(d)}])}e.exports=a}),null);
__d("LSBeginHandlingSync",["LSBeginHandlingSyncForSyncGroup"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[];return c.seq([function(f){return c.seq([function(e){return d[0]=c.createArray(),c.fe(c.db.table(1).fetch(),function(e){var f=e.item;return c.seq([function(e){return c.sp(b("LSBeginHandlingSyncForSyncGroup"),f.groupId,a[0]).then(function(a){return a=a,d[1]=a[0],a})},function(a){return d[2]=(d[0].push(d[1]),d[0])}])})},function(a){return e[0]=d[0]}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSCancelTaskByQueueName",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[];return b.seq([function(c){return b.fe(b.ftr(b.db.table(2).fetch(),function(c){return c.queueName===a[0]&&c.context===b.i64.to_string(a[1])}),function(a){return a["delete"]()})},function(a){return b.resolve(c)}])}e.exports=a}),null);
__d("LSHandleTaskSendFailureForQueue",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d=[],e;return b.seq([function(d){return b.seq([function(d){return b.islc(b.ftr(b.db.table(2).fetch(),function(b){return a[0]===b.queueName}),0,b.i64.to_float([0,1])).next().then(function(a,d){var f=a.done;a=a.value;return f?0:(d=a.item,b.ftr(b.db.table(2).fetch(),function(a){return b.i64.eq(a.taskId,d.taskId)}).next().then(function(d,f){var a=d.done;d=d.value;return a?0:(f=d.item,b.i64.neq(e,e)?c[1]=b.i64.add(b.i64.of_float(Date.now()),e):c[1]=f.minTimeToSyncTimestampMs,b.fe(b.ftr(b.db.table(2).fetch(),function(a){return b.i64.eq(a.taskId,f.taskId)}),function(a){var d=a.update;a.item;return d({failureCount:b.i64.add(f.failureCount,[0,1]),minTimeToSyncTimestampMs:c[1]})}))}))})},function(c){return b.fe(b.db.table(3).fetch([[[a[0],[-1,4294967295]]]]),function(a){var c=a.update;a=a.item;return c({failureCount:b.i64.add(a.failureCount,[0,1])})})},function(c){return b.fe(b.db.table(3).fetch([[[a[0],[-1,4294967295]]]]),function(a){var b=a.update;a.item;return b({epochId:e,networkTaskIdentifier:e})})}])},function(a){return b.resolve(d)}])}e.exports=a}),null);
__d("LSHandleTaskSendSuccessForQueue",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d;return b.seq([function(c){return b.fe(b.ftr(b.db.table(3).fetch([[[a[0],[-1,4294967295]]]]),function(c){return c.taskQueueName===a[0]&&b.i64.eq(c.syncDatabaseId,[-1,4294967295])&&!b.i64.eq(c.epochId,d)}),function(a){return a["delete"]()})},function(a){return b.resolve(c)}])}e.exports=a}),null);
__d("LSPredefineTraceForTask",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d=[];return b.seq([function(d){return b.seq([function(d){return c[0]=b.i64.of_float(Date.now()),b.fe(b.db.table(2).fetch([[[a[1]]]]),function(b){var d=b.update;b.item;return d({dataTraceId:a[0],initTraceTimestampMs:c[0]})})},function(d){return b.db.table(153).add({traceId:a[0],initTimestampMs:c[0],foregroundTimestampMs:[0,0],traceType:[0,1],shouldFlush:!1,contextOne:a[2],contextTwo:b.i64.to_string(a[1]),predefinedId:a[3]})}])},function(a){return b.resolve(d)}])}e.exports=a}),null);
__d("LSBumpE2EEMetadataThread",["LSCancelTaskByQueueName","LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return c.seq([function(e){return d[0]=new c.Map(),d[0].set("bump_timestamp_ms",a[1]),d[0].set("thread_key",a[0]),d[0].set("bumped_by_local_device_send",a[2]),d[1]=d[0].get("thread_key"),d[0],c.sp(b("LSCancelTaskByQueueName"),c.i64.to_string(d[1]),[0,389])},function(e){return d[2]=new c.Map(),d[2].set("bump_timestamp_ms",a[1]),d[2].set("thread_key",a[0]),d[2].set("bumped_by_local_device_send",a[2]),d[3]=d[2].get("thread_key"),d[2],d[4]=c.toJSON(d[2]),c.sp(b("LSIssueNewTask"),c.i64.to_string(d[3]),[0,389],d[4],f,f,[0,0],[0,0],f,f,[0,0])}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSUpdateE2EEMetadataParticipants",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return d[0]=new c.Map(),d[0].set("thread_key",a[0]),d[1]=d[0].get("thread_key"),d[0],d[2]=c.toJSON(d[0]),c.sp(b("LSIssueNewTask"),c.i64.to_string(d[1]),[0,394],d[2],f,f,[0,0],[0,0],f,f,[0,0])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSSerializeThreadListKey",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d=[];return function(a){b.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsSerializeThreadListKeyStoredProcedure]Beginning execution."),c[0]=b.createArray(),c[2]=(c[0].push(a[0]),c[0]),c[2]=(c[0].push(a[1]),c[0]),c[2]=(c[0].push(a[2]),c[0]),c[1]=b.toJSON(c[0]),function(a){b.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsSerializeThreadListKeyStoredProcedure]Finishing execution."),d[0]=c[1],b.resolve(d)}e.exports=a}),null);
__d("LSUploadMessage",["LSIssueNewTaskAndGetTaskID"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return c.seq([function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsUploadMessageStoredProcedure]Beginning execution."),c.islc(c.ftr(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,[0,80])}),0,c.i64.to_float([0,1])).next().then(function(a,b){var e=a.done;a=a.value;return e?(e=[f,f,f,f,f,[0,1]],d[0]=e[0],d[1]=e[1],d[2]=e[2],d[3]=e[3],d[4]=e[4],d[5]=e[5],e):(b=a.item,d[8]=b.backupTenancy,c.i64.neq(d[8],f)?d[7]=d[8]:d[7]=[0,1],e=[b.backupId,b.deviceId,b.mailboxRootKeyBlob,b.ocmfClientStateBlob,b.encryptionVersion,d[7]],d[0]=e[0],d[1]=e[1],d[2]=e[2],d[3]=e[3],d[4]=e[4],d[5]=e[5],e)})},function(e){return c.i64.neq(d[0],f)&&c.i64.neq(d[1],f)&&c.blobs.neq(d[3],f)&&!0?c.seq([function(a){return c.sp(b("LSIssueNewTaskAndGetTaskID"),"encrypted_backups_upload",[0,319],"",f,f,[0,0],[0,0],[0,93],f,[0,0]).then(function(a){return a=a,d[7]=a[0],a})},function(b){return c.i64.eq(d[7],[-1,4294967295])?c.resolve(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsUploadMessageStoredProcedure]issueNewTaskAndGetTaskIdFromParams failed")):c.db.table(177).add({pk:void 0,pendingBackupTaskId:d[7],persistentId:"",actionType:a[4],contentType:[0,1],backupStatus:[0,1],listKey:a[0],uniqueKey:a[1],sortKey:c.i64.to_string(a[2]),echoContent:a[3]})}]):c.resolve()},function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsUploadMessageStoredProcedure]Finishing execution.")}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSUploadThread",["LSIssueNewTaskAndGetTaskID","LSSerializeThreadListKey"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return c.seq([function(e){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsUploadThreadStoredProcedure]Beginning execution."),c.ftr(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,[0,80])}).next().then(function(e,g){var h=e.done;e=e.value;return h?function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsUploadThreadStoredProcedure]backup_id is not available"):(g=e.item,c.seq([function(e){return c.sp(b("LSSerializeThreadListKey"),a[1],c.i64.to_string(g.backupId),a[2]).then(function(a){return a=a,d[1]=a[0],a})},function(a){return c.sp(b("LSIssueNewTaskAndGetTaskID"),"encrypted_backups_upload",[0,319],"",f,f,[0,0],[0,0],[0,93],f,[0,0]).then(function(a){return a=a,d[2]=a[0],a})},function(b){return c.i64.eq(d[2],[-1,4294967295])?c.resolve(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsUploadThreadStoredProcedure]issueNewTaskAndGetTaskIdFromParams failed")):c.db.table(177).add({pk:void 0,pendingBackupTaskId:d[2],persistentId:"",actionType:a[5],contentType:[0,2],backupStatus:[0,1],listKey:d[1],uniqueKey:a[0],sortKey:c.i64.to_string(a[3]),echoContent:a[4]})}]))})},function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsUploadThreadStoredProcedure]Finishing execution.")}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSDeleteThread",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d=[],e;return b.seq([function(d){return b.seq([function(d){return b.db.table(9).fetch([[[a[0]]]]).next().then(function(a,b){var d=a.done;a=a.value;return d?(d=[[0,0],e],c[0]=d[0],c[1]=d[1],d):(b=a.item,d=[b.parentThreadKey,b.disappearingThreadKey],c[0]=d[0],c[1]=d[1],d)})},function(a){return b.ct(b.db.table(9).fetch([[[c[0]]],"parentThreadKeyLastActivityTimestampMs"])).then(function(a){return c[3]=a})},function(d){return a[1]&&b.i64.neq(c[0],[0,0])&&b.i64.eq(c[3],[0,1])?b.seq([function(d){return b.fe(b.db.table(9).fetch([[[a[0]],[c[0]]]]),function(a){return a["delete"]()})},function(a){return b.i64.neq(c[1],e)?0:0}]):b.seq([function(c){return b.fe(b.db.table(9).fetch([[[a[0]]]]),function(a){return a["delete"]()})},function(a){return b.i64.neq(c[1],e)?0:0}])}])},function(a){return b.resolve(d)}])}e.exports=a}),null);
__d("LSOptimisticRemoveThread",["LSDeleteThread","LSIssueNewTaskAndGetTaskID"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return c.seq([function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?d[0]=[0,1]:(b=a.item,d[4]=b.syncGroup,c.i64.neq(d[4],f)?d[3]=d[4]:d[3]=[0,1],d[0]=d[3])})},function(d){return c.i64.eq(a[1],[0,1])?c.db.table(9).fetch([[[a[0]]]]).next().then(function(b,d){d=b.done;b=b.value;return d?0:(b.item,c.fe(c.db.table(9).fetch([[[a[0]]]]),function(a){var b=a.update;a.item;return b({folderName:"",parentThreadKey:[-1,4294967286]})}))}):c.sp(b("LSDeleteThread"),a[0],!1)},function(e){return c.sp(b("LSIssueNewTaskAndGetTaskID"),c.i64.to_string(a[0]),[0,146],"",f,f,[0,0],[0,0],d[0],f,[0,0]).then(function(a){return a=a,d[2]=a[0],a})},function(b){return c.db.table(32).add({taskId:d[2],threadKey:a[0],removeType:a[1],syncGroup:d[0]})}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSUpsertAttachmentRange",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[];return b.seq([function(c){return b.seq([function(c){return b.fe(b.db.table(17).fetch([[[a[0],a[1]]]]),function(a){return a["delete"]()})},function(c){return b.db.table(17).add({threadKey:a[0],mediaGroup:a[1],minTimestampMs:a[2],maxTimestampMs:[2328,1316134911],hasMoreBefore:a[3],hasMoreAfter:!1,isLoadingBefore:!1,isLoadingAfter:!1})}])},function(a){return b.resolve(c)}])}e.exports=a}),null);
__d("MAWCatQuery.graphql",["cr:11203"],(function(a,b,c,d,e,f){"use strict";e.exports=b("cr:11203")}),null);
__d("MAWCatQuery_instagramRelayOperation",[],(function(a,b,c,d,e,f){e.exports="4109748649143331"}),null);
__d("MAWCatQuery.instagram.graphql",["MAWCatQuery_instagramRelayOperation","relay-runtime"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{alias:null,args:null,concreteType:"SecureMessageOverWACATGraphResult",kind:"LinkedField",name:"secure_message_over_wa_cat_query",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"encrypted_serialized_cat",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiration_time_in_seconds",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MAWCatQuery",selections:a,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"MAWCatQuery",selections:a},params:{id:b("MAWCatQuery_instagramRelayOperation"),metadata:{},name:"MAWCatQuery",operationKind:"query",text:null}}}();b("relay-runtime").PreloadableQueryRegistry.set(a.params.id,a);e.exports=a}),null);
__d("LSPlatformGraphQLLightspeedRequestForIGDQuery.graphql",["relay-runtime"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"deviceId"},{defaultValue:null,kind:"LocalArgument",name:"requestId"},{defaultValue:null,kind:"LocalArgument",name:"requestPayload"},{defaultValue:null,kind:"LocalArgument",name:"requestType"}],b=[{alias:null,args:[{kind:"Variable",name:"device_id",variableName:"deviceId"},{kind:"Variable",name:"request_id",variableName:"requestId"},{kind:"Variable",name:"request_payload",variableName:"requestPayload"},{kind:"Variable",name:"request_type",variableName:"requestType"}],concreteType:"LightspeedWebResponse",kind:"LinkedField",name:"lightspeed_web_request_for_igd",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"payload",storageKey:null},{alias:null,args:null,concreteType:"LightspeedWebRequestDependency",kind:"LinkedField",name:"dependencies",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experiments",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"LSPlatformGraphQLLightspeedRequestForIGDQuery",selections:b,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"LSPlatformGraphQLLightspeedRequestForIGDQuery",selections:b},params:{id:"5041233345961613",metadata:{},name:"LSPlatformGraphQLLightspeedRequestForIGDQuery",operationKind:"query",text:null}}}();b("relay-runtime").PreloadableQueryRegistry.set(a.params.id,a);e.exports=a}),null);
__d("useShouldRenderFullTopNav",["CometRouterRouteTopNavTypeContext","gkx","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react").useContext,i=c("gkx")("1266082");function a(){var a=h(c("CometRouterRouteTopNavTypeContext"));return a==="default"&&i}g["default"]=a}),98);
__d("useShouldShowMessagingEntrypoint",["ProfilePlusMessaging","gkx","useShouldRenderFullTopNav"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var d=c("useShouldRenderFullTopNav")();if(!d||a==null)return!1;if(!c("gkx")("1673554")||!c("gkx")("1812744"))return!1;if(b!=="JEWEL"&&c("ProfilePlusMessaging").shouldRedirectMessagesForAP)return!1;return b==="JEWEL"&&a.routeType==="media_viewer"?!0:!Boolean(a.hideChat)}g["default"]=a}),98);
__d("useShouldShowMessagingEntrypointInCometRoot",["useCometRouterState","useShouldShowMessagingEntrypoint"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=c("useCometRouterState")(),d=b==null?void 0:b.main;b=b==null?void 0:b.pushViewStack;b=b&&b.length>0?b[b.length-1]:d;return c("useShouldShowMessagingEntrypoint")(b==null?void 0:b.route,a)}g["default"]=a}),98);
__d("MAWCatQuery",["MAWCatQuery.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h!==void 0?h:h=b("MAWCatQuery.graphql");c=a;g["default"]=c}),98);
__d("LSPlatformGraphQLLightspeedRequestForIGD",["CometRelay","CometRelayEnvironment","LSPlatformGraphQLLightspeedRequestForIGDQuery.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,e,f,g){return d("CometRelay").fetchQuery(c("CometRelayEnvironment"),h!==void 0?h:h=b("LSPlatformGraphQLLightspeedRequestForIGDQuery.graphql"),{deviceId:a,requestId:e,requestPayload:f,requestType:g}).toPromise().then(function(a){return a==null?void 0:a.lightspeed_web_request_for_igd})}g["default"]=a}),98);
__d("LSClearEpochBeforeResumeSync.bs",["LSTransaction.bs","Promise","ReQL.bs","bs_caml","bs_caml_int64","gkx","killswitch"],(function(a,b,c,d,e,f){"use strict";function a(a){if(!b("killswitch")("MESSENGER_WEB_PERSISTED_DB")&&b("gkx")("3174"))return b("LSTransaction.bs").run(a,function(a){var c;return(c=b("ReQL.bs")).toArray(c.mergeJoin(c.fromTableAscending(a.table("sync_groups")),c.getKeyRange(c.fromTableAscending(a.table("network_requests")),{hd:"",tl:0}))).then(function(c){return b("Promise").all(c.map(function(c){var d=c[0];if(!(d.currentCursor!==void 0||b("bs_caml").i64_eq(d.syncStatus,b("bs_caml_int64").zero)))return b("Promise").resolve(void 0);d=c[1];return a.table("network_requests").put({taskQueueName:d.taskQueueName,syncDatabaseId:d.syncDatabaseId,epochId:void 0,networkTaskIdentifier:d.networkTaskIdentifier,lastSentTimestampMs:d.lastSentTimestampMs,failureCount:d.failureCount,lastSyncRequestTimestampMs:d.lastSyncRequestTimestampMs,lastDelayedRequestTimestampMs:d.lastDelayedRequestTimestampMs})}))}).then(function(c){return b("ReQL.bs").toArray(b("ReQL.bs").filter(b("ReQL.bs").fromTableAscending(a.table("network_requests")),function(a){return a.taskQueueName!==""})).then(function(c){return b("Promise").all(c.map(function(b){return a.table("network_requests").put({taskQueueName:b.taskQueueName,syncDatabaseId:b.syncDatabaseId,epochId:void 0,networkTaskIdentifier:b.networkTaskIdentifier,lastSentTimestampMs:b.lastSentTimestampMs,failureCount:b.failureCount,lastSyncRequestTimestampMs:b.lastSyncRequestTimestampMs,lastDelayedRequestTimestampMs:b.lastDelayedRequestTimestampMs})}))})})},"readWrite").then(function(a){return b("Promise").resolve(void 0)});else return b("Promise").resolve(void 0)}f.call=a}),null);
__d("LSDataTraceFlushDeferred.bs",["bs_curry","killswitch","requireDeferred"],(function(a,b,c,d,e,f){"use strict";var g=b("requireDeferred")("LSDataTraceFlush.bs").__setRef("LSDataTraceFlushDeferred.bs");function a(a){if(!b("killswitch")("MESSENGER_WEB_DATA_TRACE_ID")){g.onReady(function(c){return b("bs_curry")._1(c.flushExpiredDataTraces,a)});return}}f.$LSDataTraceFlush$Deferred=g;f.watchForExpiredTraces=a}),null);
__d("MAWGating.re",["MAWGating.bs"],(function(a,b,c,d,e,f){c=(a=b("MAWGating.bs")).isArmadillo;f.isArmadillo=c;d=a.isGifEnabled;f.isGifEnabled=d;e=a.isGifSearchEnabled;f.isGifSearchEnabled=e;b=a.isStickerEnabled;f.isStickerEnabled=b;c=a.getArmadilloDbVersion;f.getArmadilloDbVersion=c;d=a.wellBeingFeaturesEnabled;f.wellBeingFeaturesEnabled=d;e=a.isEphemeralMessagesEnabled;f.isEphemeralMessagesEnabled=e;b=a.isDualSendWebOrCrossApp;f.isDualSendWebOrCrossApp=b;c=a.isOneToOneDualSendTextEnabled;f.isOneToOneDualSendTextEnabled=c;d=a.isOneToOneDualSendMediaEnabled;f.isOneToOneDualSendMediaEnabled=d;e=a.isForwardEnabled;f.isForwardEnabled=e;b=a.isCrossForwardEnabled;f.isCrossForwardEnabled=b;c=a.isVaultingEnabled;f.isVaultingEnabled=c;d=a.isSharedWorkerEnabled;f.isSharedWorkerEnabled=d;e=a.isReportingEnabled;f.isReportingEnabled=e;b=a.isAdaptiveTrickleModeEnabled;f.isAdaptiveTrickleModeEnabled=b;c=a.isFeatureLimitEnabled;f.isFeatureLimitEnabled=c;d=a.isReactionsEnabled;f.isReactionsEnabled=d;e=a.isCustomReactionsEnabled;f.isCustomReactionsEnabled=e;b=a.isICDCEnabled;f.isICDCEnabled=b;c=a.isICDCErrorEnabled;f.isICDCErrorEnabled=c;d=a.isClientTimeoutsEnabled;f.isClientTimeoutsEnabled=d;e=a.isOptedOutOfTimeouts;f.isOptedOutOfTimeouts=e;b=a.isUnsendGlobalEnabled;f.isUnsendGlobalEnabled=b;c=a.isUnsendLocallyEnabled;f.isUnsendLocallyEnabled=c;d=a.isOccamadillo;f.isOccamadillo=d;e=a.isOccamadilloInitSyncEnabled;f.isOccamadilloInitSyncEnabled=e;b=a.isEncryptionAtRestEnabled;f.isEncryptionAtRestEnabled=b;c=a.isDevserverDeviceEnabled;f.isDevserverDeviceEnabled=c;d=a.isBlockEnabled;f.isBlockEnabled=d;e=a.isRestrictEnabled;f.isRestrictEnabled=e;b=a.isReactionsCleanerEnabled;f.isReactionsCleanerEnabled=b;c=a.isRepliesEnabled;f.isRepliesEnabled=c;d=a.isPersistedDbEnabled;f.isPersistedDbEnabled=d;e=a.isSearchEnabled;f.isSearchEnabled=e;b=a.isContentSearchEnabled;f.isContentSearchEnabled=b;c=a.isSecurityAlertEnabled;f.isSecurityAlertEnabled=c;d=a.isThreadLevelCutoverEnabled;f.isThreadLevelCutoverEnabled=d;e=a.isXMAFeedPostShareEnabled;f.isXMAFeedPostShareEnabled=e;b=a.isLabyrinthOnWebEnabled;f.isLabyrinthOnWebEnabled=b;c=a.isMailboxUploadEnabled;f.isMailboxUploadEnabled=c;d=a.isShadowTestCleanupOnWebEnabled;f.isShadowTestCleanupOnWebEnabled=d;e=a.isAttachmentBackupEnabled;f.isAttachmentBackupEnabled=e;b=a.isGroupInvitesEnabled;f.isGroupInvitesEnabled=b;c=a.isArmadilloMessageSortedOrderChanged;f.isArmadilloMessageSortedOrderChanged=c;d=a.isHotLikeEnabled;f.isHotLikeEnabled=d;e=a.isShadowTestRestoreFlowOnWebEnabled;f.isShadowTestRestoreFlowOnWebEnabled=e;b=a.isPushNotificationEnabled;f.isPushNotificationEnabled=b;c=a.isPinCodeFirstEnabled;f.isPinCodeFirstEnabled=c;d=a.isPresenceEnabled;f.isPresenceEnabled=d;e=a.isMobileExternalIdFormatEnabled;f.isMobileExternalIdFormatEnabled=e;b=a.isAdminMsgOptEnabled;f.isAdminMsgOptEnabled=b;c=a.isWebLoadStateEnabled;f.isWebLoadStateEnabled=c;d=a.isInitSyncApiImprovementsEnabled;f.isInitSyncApiImprovementsEnabled=d;e=a.isMRInitSyncImprovementsEnabled;f.isMRInitSyncImprovementsEnabled=e}),null);
__d("LSPlatformDevtoolsHelpers.bs",["CometDevToolsLightspeedEvents.bs","LSDict","bs_curry","bs_int64","cr:1489419"],(function(a,b,c,d,e,f){"use strict";function a(a){if(!(b("cr:1489419")==null))return b("bs_curry")._1(b("cr:1489419").sendMessageToDevTools,[b("CometDevToolsLightspeedEvents.bs").task,a.map(function(a){return b("LSDict").shapeToRecord(a)}).map(function(a){return{status:"sending",queueName:a.queue_name,payload:a.payload,failureCount:a.failure_count,taskId:b("bs_int64").to_string(a.task_id),startTime:Date.now()}})])}function c(a){if(!(b("cr:1489419")==null))return b("bs_curry")._1(b("cr:1489419").sendMessageToDevTools,[b("CometDevToolsLightspeedEvents.bs").armadilloBridge,a])}function d(a,c){if(!(b("cr:1489419")==null))return b("bs_curry")._1(b("cr:1489419").sendMessageToDevTools,[b("CometDevToolsLightspeedEvents.bs").task,a.map(function(a){return b("LSDict").shapeToRecord(a)}).map(function(a){return{status:"sent",queueName:a.queue_name,response:c,failureCount:a.failure_count,taskId:b("bs_int64").to_string(a.task_id),endTime:Date.now()}})])}function e(a){if(!(b("cr:1489419")==null)){b("bs_curry")._1(b("cr:1489419").registerStorage,a);return}}function g(a){if(b("cr:1489419")==null)return a;else return b("bs_curry")._1(b("cr:1489419").registerDatascriptExec,a)}f.$CometDevToolsLightspeedInterop$OR$null$requireCond=b("cr:1489419");f.recordTaskSending=a;f.recordBridgeUIEvent=c;f.recordTaskSent=d;f.registerDb=e;f.$CometDevToolsLightspeedInterop$requireCond=b("cr:1489419");f.evalWithDevtoolSupport=g}),null);
__d("LSPlatformGraphQLTransport.bs",["FBLogger","LSDynamicDependencies","LSLogHistory.bs","Promise","Promise.bs","bs_belt_Option","bs_caml_exceptions","bs_caml_int64","bs_caml_option","bs_int64"],(function(a,b,c,d,e,f){"use strict";var g=b("bs_caml_exceptions").create("LSPlatformGraphQLTransport.ServerError");function a(a,c,d,e,f){return b("Promise.bs").$$catch(f(a,c,e,b("bs_caml_int64").to_int32(d)),function(a){if(a.RE_EXN_ID===b("Promise.bs").JsError){a=a._1;var c=a.message;b("LSLogHistory.bs").log("Error sending Graphql Request. Type: "+b("bs_int64").to_string(d)+" Message: "+(c!==void 0?c:"None"),"error");b("FBLogger")("messenger_web_product").catching(a).debug("Relay or Graphql Server error in LSPlatformGraphqlTransport")}throw{RE_EXN_ID:g,Error:new Error()}}).then(function(c){c=b("bs_belt_Option").getExn(c==null?void 0:b("bs_caml_option").some(c));var a=b("bs_belt_Option").getExn(b("bs_caml_option").nullable_to_opt(c.payload)),d=c.dependencies;d=d==null?b("Promise").resolve(void 0):b("LSDynamicDependencies").downloadRelayDependencies(d);return[d,a,b("bs_caml_option").nullable_to_opt(c.experiments)]})}f.ServerError=g;f.publish=a}),null);
__d("LSRequestType.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").one;c=[0,2];d=[0,3];e=[0,4];f.initSync=a;f.resumeSync=c;f.taskBatch=d;f.fireForget=e}),null);
__d("MWPBumpEntityKey.bs",["CurrentUser","ODS"],(function(a,b,c,d,e,f){"use strict";function g(a,c){b("ODS").bumpEntityKey(3185,a,c)}function a(a,c){var d=b("CurrentUser").getAppID();d=d==null?"unknown":d;return g(a,c+"."+d)}f.bumpEntityKey=g;f.bumpEntityKeyWithAppId=a}),null);
__d("LSPlatformHardcodedInitSync.bs",["IntlCurrentLocale","LSDatabaseType.bs","LSDict","LSJson","LSPlatformGraphQLTransport.bs","LSRequestType.bs","LSTransaction.bs","MAWGating.bs","MWPBumpEntityKey.bs","Promise","Promise.bs","QPLUserFlow","ReQL.bs","bs_belt_Option","bs_caml_format","bs_caml_int64","bs_caml_option","bs_curry","qpl","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";var g=(c=b("bs_caml_int64")).zero;function h(a){return b("LSTransaction.bs").run(a,function(a){var c;return b("Promise").all([a.table("network_requests").put({taskQueueName:"",syncDatabaseId:b("LSDatabaseType.bs").mailbox,epochId:void 0,networkTaskIdentifier:void 0,lastSentTimestampMs:(c=b("bs_caml_int64")).zero,failureCount:c.zero,lastSyncRequestTimestampMs:c.zero,lastDelayedRequestTimestampMs:void 0}),a.table("network_requests").put({taskQueueName:"",syncDatabaseId:b("LSDatabaseType.bs").contact,epochId:void 0,networkTaskIdentifier:void 0,lastSentTimestampMs:c.zero,failureCount:c.zero,lastSyncRequestTimestampMs:c.zero,lastDelayedRequestTimestampMs:void 0}),b("MAWGating.bs").isOccamadillo(void 0)?a.table("network_requests").put({taskQueueName:"",syncDatabaseId:b("LSDatabaseType.bs").e2eeMessagingMetadataMailbox,epochId:void 0,networkTaskIdentifier:void 0,lastSentTimestampMs:b("bs_caml_int64").zero,failureCount:b("bs_caml_int64").zero,lastSyncRequestTimestampMs:b("bs_caml_int64").zero,lastDelayedRequestTimestampMs:void 0}):b("Promise").resolve(void 0)])},"readWrite").then(function(a){return b("Promise").resolve(void 0)})}function i(a){return b("LSTransaction.bs").run(a,function(a){var c;return b("Promise").all([(c=b("ReQL.bs")).first(c.getKeyRange(c.fromTableAscending(a.table("network_requests")),{hd:"",tl:{hd:b("LSDatabaseType.bs").mailbox,tl:0}})),c.first(c.getKeyRange(c.fromTableAscending(a.table("network_requests")),{hd:"",tl:{hd:b("LSDatabaseType.bs").contact,tl:0}})),b("MAWGating.bs").isOccamadillo(void 0)?b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("network_requests")),{hd:"",tl:{hd:b("LSDatabaseType.bs").e2eeMessagingMetadataMailbox,tl:0}})):b("Promise").resolve(void 0)]).then(function(c){var d=c[2],e=c[1];c=c[0];c=c!==void 0&&e!==void 0?b("Promise").all([a.table("network_requests").put({taskQueueName:c.taskQueueName,syncDatabaseId:c.syncDatabaseId,epochId:g,networkTaskIdentifier:c.networkTaskIdentifier,lastSentTimestampMs:c.lastSentTimestampMs,failureCount:c.failureCount,lastSyncRequestTimestampMs:c.lastSyncRequestTimestampMs,lastDelayedRequestTimestampMs:c.lastDelayedRequestTimestampMs}),a.table("network_requests").put({taskQueueName:e.taskQueueName,syncDatabaseId:e.syncDatabaseId,epochId:g,networkTaskIdentifier:e.networkTaskIdentifier,lastSentTimestampMs:e.lastSentTimestampMs,failureCount:e.failureCount,lastSyncRequestTimestampMs:e.lastSyncRequestTimestampMs,lastDelayedRequestTimestampMs:e.lastDelayedRequestTimestampMs})]).then(function(a){}):b("Promise").resolve(void 0);e=b("MAWGating.bs").isOccamadillo(void 0);e=e&&d!==void 0?a.table("network_requests").put({taskQueueName:d.taskQueueName,syncDatabaseId:d.syncDatabaseId,epochId:g,networkTaskIdentifier:d.networkTaskIdentifier,lastSentTimestampMs:d.lastSentTimestampMs,failureCount:d.failureCount,lastSyncRequestTimestampMs:d.lastSyncRequestTimestampMs,lastDelayedRequestTimestampMs:d.lastDelayedRequestTimestampMs}):b("Promise").resolve(void 0);return b("Promise").all([c,e]).then(function(a){})})},"readWrite")}function a(a,c,d){b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("mw_graphql","init_sync.success");b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("mw_ls","init_sync.success");return i(d).then(function(e){return b("Promise.bs").$$catch(b("Promise").all([(e=b("ReQL.bs")).first(e.getKeyRange(e.fromTableAscending(d.table("sync_groups")),{hd:b("LSDatabaseType.bs").mailbox,tl:0})),e.first(e.getKeyRange(e.fromTableAscending(d.table("sync_groups")),{hd:b("LSDatabaseType.bs").contact,tl:0})),b("MAWGating.bs").isOccamadillo(void 0)?b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(d.table("sync_groups")),{hd:b("LSDatabaseType.bs").e2eeMessagingMetadataMailbox,tl:0})):b("Promise").resolve(void 0)]).then(function(c){var d,e=(d=b("bs_belt_Option")).mapWithDefault(c[0],void 0,function(a){return a.currentCursor}),f=d.mapWithDefault(c[1],void 0,function(a){return a.currentCursor});c=d.mapWithDefault(c[2],void 0,function(a){return a.currentCursor});var h=new(b("LSDict"))().set("database",b("LSDatabaseType.bs").mailbox).set("version",b("bs_caml_format").caml_int64_of_string(a.schemaVersion)).set("sync_params",d.getExn(JSON.stringify({scale:1,preview_height:200,preview_width:a.previewWidth,preview_height_large:400,preview_width_large:a.previewWidthLarge,full_height:200,snapshot_num_threads_per_page:a.numThreads,locale:b("IntlCurrentLocale").code}))).set("epoch_id",g).set("last_applied_cursor",e),i=new(b("LSDict"))().set("database",b("LSDatabaseType.bs").contact).set("version",b("bs_caml_format").caml_int64_of_string(a.schemaVersion)).set("sync_params",d.getExn(JSON.stringify({locale:b("IntlCurrentLocale").code}))).set("epoch_id",g).set("last_applied_cursor",f);d=new(b("LSDict"))().set("database",b("LSDatabaseType.bs").e2eeMessagingMetadataMailbox).set("version",b("bs_caml_format").caml_int64_of_string(a.schemaVersion)).set("sync_params",d.getExn(JSON.stringify({scale:1,preview_height:200,preview_width:a.previewWidth,preview_height_large:400,preview_width_large:a.previewWidthLarge,full_height:200,snapshot_num_threads_per_page:a.numThreads,locale:b("IntlCurrentLocale").code}))).set("epoch_id",g).set("last_applied_cursor",c);return b("Promise").all([b("LSPlatformGraphQLTransport.bs").publish(a.deviceId,0,b("bs_belt_Option").isSome(e)?b("LSRequestType.bs").resumeSync:b("LSRequestType.bs").initSync,b("LSJson").stringify(h),a.executeGraphQLLightSpeedRequest),b("LSPlatformGraphQLTransport.bs").publish(a.deviceId,1,b("bs_belt_Option").isSome(f)?b("LSRequestType.bs").resumeSync:b("LSRequestType.bs").initSync,b("LSJson").stringify(i),a.executeGraphQLLightSpeedRequest),b("MAWGating.bs").isOccamadillo(void 0)?b("LSPlatformGraphQLTransport.bs").publish(a.deviceId,0,b("bs_belt_Option").isSome(c)?b("LSRequestType.bs").resumeSync:b("LSRequestType.bs").initSync,b("LSJson").stringify(d),a.executeGraphQLLightSpeedRequest):b("Promise").resolve([b("Promise").resolve(void 0),"",void 0])])}).then(function(a){var d=a[2],e=d[2],f=d[1],g=a[1],h=g[2],i=g[1];a=a[0];var j=a[2],k=a[1];b("QPLUserFlow").addPoint(b("qpl")._(25305590,"1127"),"gql_payload_received",void 0);return b("Promise").all([a[0],g[0],d[0]]).then(function(a){b("QPLUserFlow").addPoint(b("qpl")._(25305590,"1127"),"gql_deps_downloaded",void 0);return b("bs_curry")._1(c,{experiments:j,syncScript:k})}).then(function(a){return b("bs_curry")._1(c,{experiments:h,syncScript:i})}).then(function(a){if(b("MAWGating.bs").isOccamadillo(void 0))return b("bs_curry")._1(c,{experiments:e,syncScript:f});else return b("Promise").resolve(void 0)})}).then(function(a){b("QPLUserFlow").addPoint(b("qpl")._(25305590,"1127"),"success_with_init_sync",void 0)}),function(a){b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("mw_ls","init_sync.fail");b("QPLUserFlow").endFailure(b("qpl")._(25305590,"1127"),"failure_during_init_sync",void 0);a.RE_EXN_ID===b("LSPlatformGraphQLTransport.bs").ServerError||a.RE_EXN_ID!==b("Promise.bs").JsError||b("recoverableViolation")("Encountered an error while performining preloaded init sync request via graphql","messenger_web_product",{error:b("bs_caml_option").some(a._1)});return h(d)})})}d={taskQueueName:"",syncDatabaseId:c.zero,epochId:void 0,networkTaskIdentifier:void 0,lastSentTimestampMs:c.zero,failureCount:c.zero,lastSyncRequestTimestampMs:c.zero,lastDelayedRequestTimestampMs:void 0};f.defaultNetworkRequest=d;f.initialEpochId=g;f.handlePreloadedSyncFailure=h;f.setEpochId=i;f.sendHardcodedInitSync=a}),null);
__d("JSMap.bs",["bs_belt_Option","bs_caml_option","bs_curry"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d){return b("bs_belt_Option").getExn(b("bs_caml_option").nullable_to_opt((a.has(c)?a:a.set(c,b("bs_curry")._1(d,void 0))).get(c)))}f.getOrMake=a}),null);
__d("LSPlatformRealtimeTransport.bs",["JSMap.bs","LSDict","LSDynamicDependencies","LSJson","LSRequestType.bs","LSSyncChannel.bs","Promise","bs_caml","bs_caml_exceptions","bs_curry","bs_int64","clearTimeout","promiseDone","qex","setTimeout"],(function(a,b,c,d,e,f){"use strict";d=b("bs_caml_exceptions").create("LSPlatformRealtimeTransport.NotConnected");var g=b("bs_caml_exceptions").create("LSPlatformRealtimeTransport.Timeout");function a(a,c,d){return b("LSDynamicDependencies").downloadBootloaderDependencies(a,c,d)}function h(a){var c=new Map();return{getOrStart:function(d){return b("JSMap.bs").getOrMake(c,b("bs_int64").to_string(d),function(c){return b("bs_curry")._1(a,d)})},getAll:function(a){return Array.from(c.values())}}}e={make:h};function i(){}function j(a){}function c(a,c){var d=new Map(),e={contents:i},f={contents:j},k=new Map(),l=[],m=h(function(c){c=b("bs_curry")._1(a,c);l.push(c.subscribe(function(a){var c=JSON.parse(a),e=b("LSDynamicDependencies").downloadBootloaderDependencies(c.sp,c.nop,c.ntop);a=c.request_id;var f;if(a!==void 0){var g=d.get(a);g==null?f=!1:(b("clearTimeout")(g.timeoutId),g.resolve({_0:e,_1:c}),d["delete"](a),f=!0)}else f=!1;if(!f){Array.from(k.entries()).forEach(function(a){return a[1](e,c)});return}}));l.push(c.onReconnect(function(){return e.contents()}));l.push(c.onConnectionStatusChange(function(a){return f.contents(a)}));return c});b("bs_curry")._1(m.getOrStart,b("LSSyncChannel.bs").mqtt);var n=b("qex")._("461");!(n==null)&&n&&b("bs_curry")._1(m.getOrStart,b("LSSyncChannel.bs").dgw);return{subscribeToNonTaskResponses:function(a){var b={};k.set(b,a);return function(a){k["delete"](b)}},onReconnect:function(a){e.contents=a;return function(a){e.contents=i}},onConnectionStatusChange:function(a){f.contents=a;return function(a){f.contents=j}},publish:function(a,e,f,h,i){return new(b("Promise"))(function(j,k){if(b("bs_caml").i64_eq(h,b("LSRequestType.bs").taskBatch)){var l=b("setTimeout")(function(a){a=d.get(f);a==null||(d["delete"](f),a.reject({RE_EXN_ID:g}));return k({RE_EXN_ID:g})},3e4);d.set(f,{timestamp:Date.now(),queueName:e,timeoutId:l,resolve:j,reject:k})}b("promiseDone")(b("bs_curry")._2(b("bs_curry")._1(m.getOrStart,a).publish,b("LSJson").stringify(b("LSDict").fromObject({request_id:f,type:h,payload:i,app_id:c})),h),function(a){if(b("bs_caml").i64_neq(h,b("LSRequestType.bs").taskBatch))return j(0)},function(a){return k(a)})})},cleanup:function(){l.forEach(function(a){return b("bs_curry")._1(a,void 0)}),b("bs_curry")._1(m.getAll,void 0).forEach(function(a){return a.cleanup()})}}}f.NotConnected=d;f.Timeout=g;f.downloadDependencies=a;f.Transports=e;f.defaultReconnectHandler=i;f.defaultConnectionChangedHandler=j;f.make=c}),null);
__d("bs_js_json",["bs_caml_option"],(function(a,b,c,d,e,f){"use strict";function a(a){var b=typeof a;if(b==="string")return{TAG:0,_0:a};else if(b==="number")return{TAG:1,_0:a};else if(b==="boolean")if(a===!0)return 1;else return 0;else if(a===null)return 2;else if(Array.isArray(a))return{TAG:3,_0:a};else return{TAG:2,_0:a}}function c(a,b){switch(b){case 0:return typeof a==="string";case 1:return typeof a==="number";case 2:if(a!==null&&typeof a==="object")return!Array.isArray(a);else return!1;case 3:return Array.isArray(a);case 4:return typeof a==="boolean";case 5:return a===null}}function d(a){if(typeof a==="string")return a}function e(a){if(typeof a==="number")return a}function g(a){if(typeof a==="object"&&!Array.isArray(a)&&a!==null)return b("bs_caml_option").some(a)}function h(a){if(Array.isArray(a))return a}function i(a){if(typeof a==="boolean")return a}function j(a){if(a===null)return null}var k=function(a){a=[a];var b=[{kind:0,i:0,parent:a}];while(b.length!==0){var c=b[b.length-1];c.kind===0?(c.val=c.parent[c.i],++c.i===c.parent.length&&b.pop()):b.pop();var d=c.val;if(typeof d==="object")if(Array.isArray(d)&&d.length!==0)b.push({kind:0,i:0,parent:d,val:void 0});else for(var e in d){if(e==="RE_PRIVATE_NONE"){c.kind===0?c.parent[c.i-1]=void 0:c.parent[c.i]=void 0;continue}b.push({kind:1,i:e,parent:d,val:d[e]})}}return a[0]};function l(a){return function(a){a=JSON.stringify(a,function(a,b){return b===void 0?{RE_PRIVATE_NONE:!0}:b});if(a===void 0)throw new TypeError("output is undefined");return a}(a)}function m(a){return k(JSON.parse(a))}f.classify=a;f.test=c;f.decodeString=d;f.decodeNumber=e;f.decodeObject=g;f.decodeArray=h;f.decodeBoolean=i;f.decodeNull=j;f.deserializeUnsafe=m;f.serializeExn=l}),null);
__d("LSCookie.bs",["Cookie","LSPersistedDbGating","MqttWebDeviceID","Promise","bs_belt_Option","bs_js_dict","bs_js_json","gkx","killswitch","promiseDone","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";var g="m_ls";d={};var h={d:b("MqttWebDeviceID").clientID,c:d},i={contents:void 0};function j(a){if(!(!b("killswitch")("MESSENGER_WEB_PERSISTED_DB")&&b("gkx")("3174")&&b("LSPersistedDbGating").allTablesPersisted))return b("Promise").resolve(i.contents);var c=JSON.stringify(a);if(c!==void 0)try{return cookieStore.set(g,encodeURIComponent(c),{domain:window.location.hostname}).then(function(c){i.contents=a;return b("Promise").resolve(i.contents)})}catch(d){b("Cookie").set(g,c);i.contents=a;return b("Promise").resolve(i.contents)}else{b("recoverableViolation")("Failed to serialize Cookie","messenger");return b("Promise").resolve(i.contents)}}function a(a){try{return cookieStore["delete"]({name:g}).then(function(a){i.contents=void 0})}catch(a){b("Cookie").clear(g);i.contents=void 0;return b("Promise").resolve(void 0)}}function c(a){if(!(!b("killswitch")("MESSENGER_WEB_PERSISTED_DB")&&b("gkx")("3174")&&b("LSPersistedDbGating").allTablesPersisted))return h;a=i.contents;if(a!==void 0)return a;else{a=b("Cookie").get("m_ls");if(a!==void 0)try{a=b("bs_belt_Option").getExn(b("bs_js_json").decodeObject(JSON.parse(a)));var c=b("bs_belt_Option").getExn(b("bs_js_json").decodeString(b("bs_belt_Option").getExn(b("bs_js_dict").get(a,"d"))));c=c!==""?c:void 0;var d=b("bs_belt_Option").getWithDefault(c,b("MqttWebDeviceID").clientID);a=b("bs_js_dict").fromArray(b("bs_js_dict").entries(b("bs_belt_Option").getExn(b("bs_js_json").decodeObject(b("bs_belt_Option").getExn(b("bs_js_dict").get(a,"c"))))).map(function(a){return[a[0],b("bs_belt_Option").getExn(b("bs_js_json").decodeString(a[1]))]}));d={d:d,c:a};if(c!==void 0)i.contents=d;else{a=j(d);b("promiseDone")(a,void 0,void 0)}return d}catch(a){c=j(h);b("promiseDone")(c,void 0,void 0);return h}else{a=j(h);b("promiseDone")(a,void 0,void 0);return h}}}f.cookie=i;f.writeCookie=j;f.deleteCookie=a;f.get=c}),null);
__d("LSPlatformRequestId",[],(function(a,b,c,d,e,f){"use strict";var g=2;function a(){var a=g;g+=1;return a}b={generate:a};f["default"]=b}),66);
__d("LSPlatformRequestScheduler.bs",["bs_curry","clearTimeout","setTimeout"],(function(a,b,c,d,e,f){"use strict";function a(a){return new Map()}function c(a,c,d,e){var f=a.get(d);f==null||b("clearTimeout")(f);f=b("setTimeout")(function(a){return b("bs_curry")._1(c,void 0)},e);a.set(d,f)}f.make=a;f.schedule=c}),null);
__d("LSPlatformServerResponseHandler",["Promise","regeneratorRuntime"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.eval=a,this.currentlyRunning=b("Promise").resolve()}var c=a.prototype;c.evalWhenReady=function(a,c){return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:d.next=2;return b("regeneratorRuntime").awrap(a);case 2:d.next=4;return b("regeneratorRuntime").awrap(this.eval(c));case 4:case"end":return d.stop()}},null,this)};c.evalInOrderReceived=function(a,b){var c=this,d=this.currentlyRunning.then(function(){return c.evalWhenReady(a,b)});this.currentlyRunning=d;return d};return a}();f["default"]=a}),66);
__d("LSTaskWorkItemType.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").one;c=[0,2];d=[0,3];e=[0,4];b=[0,5];f.workItemTypeSendToServer=a;f.workItemTypeHandleNative=c;f.workItemTypeDelayHandling=d;f.workItemTypeNone=e;f.workItemTypeSendToServerFireAndForget=b}),null);
__d("LSPlatformSyncSystem.bs",["LS.bs","LSBeginHandlingSync","LSBeginHandlingSyncForSyncGroup","LSCookie.bs","LSDict","LSJson","LSLogHistory.bs","LSPersistedDbGating","LSPlatformGraphQLTransport.bs","LSPlatformRealtimeTransport.bs","LSPlatformRequestId","LSPlatformRequestScheduler.bs","LSPlatformServerResponseHandler","LSSyncChannel.bs","LSTaskWorkItemType.bs","LSTransaction.bs","MWPBumpEntityKey.bs","Promise","Promise.bs","ReQL.bs","SortedAsyncIterable.bs","bs_belt_Option","bs_caml","bs_caml_format","bs_caml_int64","bs_caml_obj","bs_caml_option","bs_curry","bs_int64","bs_js_dict","gkx","killswitch","promiseDone","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d,e,f,g){var h=new(b("LSPlatformServerResponseHandler"))(d),i=function(a,c){return b("LSTransaction.bs").run(a,function(a){return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("network_requests")),{hd:"",tl:{hd:c,tl:0}})).then(function(c){if(c!==void 0)return a.table("network_requests").put({taskQueueName:c.taskQueueName,syncDatabaseId:c.syncDatabaseId,epochId:void 0,networkTaskIdentifier:c.networkTaskIdentifier,lastSentTimestampMs:c.lastSentTimestampMs,failureCount:b("bs_caml_int64").add(c.failureCount,b("bs_caml_int64").one),lastSyncRequestTimestampMs:c.lastSyncRequestTimestampMs,lastDelayedRequestTimestampMs:c.lastDelayedRequestTimestampMs});else return b("Promise").resolve(void 0)})},"readWrite")},j=b("LSPlatformRequestScheduler.bs").make(void 0),k=function(a,h,i){i=b("LSDict").shapeToRecord(i);var j=b("LSDict").shapeToRecord(i.request_payload),k=i.type,l=b("LSPlatformRequestId").generate(),m=b("LSJson").stringify(b("LSDict").fromObject({database:j.database,version:b("bs_caml_format").caml_int64_of_string(e),epoch_id:j.epoch_id,last_applied_cursor:j.last_applied_cursor,failure_count:j.failure_count,sync_params:j.sync_params}));if(h.skip_realtime_gateway)return b("LSPlatformGraphQLTransport.bs").publish(f,l,k,m,g).then(function(a){return b("bs_curry")._1(d,{experiments:a[2],syncScript:a[1]}).then(function(a){return b("Promise").resolve(void 0)})});else return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("sync_groups")),{hd:h.sync_group_id,tl:0})).then(function(a){a=a!==void 0?a.syncChannel:b("LSSyncChannel.bs").mqtt;return b("bs_curry")._5(c.publish,a,void 0,l,k,m).then(function(a){return b("Promise").resolve(void 0)})})},l=function a(c,d){var e=function(d){return b("LSTransaction.bs").run(c,function(a){return b("LSBeginHandlingSyncForSyncGroup")(d,!1,b("LS.bs").make(a))},"readWrite").then(function(b){return a(c,b[0])})},f=function(a,c){return b("LSPlatformRequestScheduler.bs").schedule(j,function(c){b("promiseDone")(e(a),void 0,void 0)},b("bs_int64").to_string(a),b("bs_caml_int64").to_float(c))},g=b("LSDict").shapeToRecord(d);d=g.work_item_type;if(b("bs_caml").i64_eq(d,b("LSTaskWorkItemType.bs").workItemTypeSendToServer)||b("bs_caml").i64_eq(d,b("LSTaskWorkItemType.bs").workItemTypeSendToServerFireAndForget)){var h=g.network_payload;if(h!==void 0)return b("Promise.bs").$$catch(k(c,g,b("bs_caml_option").valFromOption(h)),function(a){a.RE_EXN_ID===b("LSPlatformGraphQLTransport.bs").ServerError?b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_sync","send_sync_request_graphql_error"):a.RE_EXN_ID===b("Promise.bs").JsError?(b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_sync","send_sync_request_js_error"),b("recoverableViolation")("Encountered an JS error while publishing a LS sync request","messenger_web_product",{error:b("bs_caml_option").some(a._1)})):a.RE_EXN_ID===b("LSPlatformRealtimeTransport.bs").Timeout||a.RE_EXN_ID===b("LSPlatformRealtimeTransport.bs").NotConnected?b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_sync","send_sync_request_timeout_or_disc"):(b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_sync","send_sync_request_other_error"),b("recoverableViolation")("Encountered an error while publishing a LS sync request with non JS error error","messenger_web_product"));return i(c,g.sync_group_id).then(function(a){return e(g.sync_group_id)})});else{b("recoverableViolation")("Expected networkpayload for sync request but didn't get any","messenger_web_product");return b("Promise").resolve(void 0)}}if(!b("bs_caml").i64_eq(d,b("LSTaskWorkItemType.bs").workItemTypeDelayHandling))if(b("bs_caml").i64_eq(d,b("LSTaskWorkItemType.bs").workItemTypeNone)||!b("bs_caml").i64_eq(d,b("LSTaskWorkItemType.bs").workItemTypeHandleNative))return b("Promise").resolve(void 0);else{b("recoverableViolation")("Native handling for sync group not implemented yet","messenger_web_product");return b("Promise").resolve(void 0)}h=g.next_sync_ms;if(h!==void 0){f(g.sync_group_id,h);return b("Promise").resolve(void 0)}else{b("recoverableViolation")("Expected delay for delayed sync request but didn't get any","messenger_web_product");return b("Promise").resolve(void 0)}},m=function(c){return b("Promise").all(c[0].map(function(b){return l(a,b)}))},n=function(){b("promiseDone")(b("LSTransaction.bs").run(a,function(a){return b("LSBeginHandlingSync")(!1,b("LS.bs").make(a))},"readWrite").then(m),void 0,void 0)},o=function(){return b("SortedAsyncIterable.bs").subscribe(b("ReQL.bs").fromTableAscending(a.table("sync_groups")),function(a,b){return n()})},p=function(){return c.subscribeToNonTaskResponses(function(a,c){var e=c.ex;c=c.payload;e={experiments:e,syncScript:c};b("promiseDone")(b("gkx")("4463")?h.evalInOrderReceived(a,e):b("bs_curry")._1(d,e),function(a){return n()},function(a){b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_sync","handle_sync_response_failure"),a.RE_EXN_ID===b("Promise.bs").JsError?b("recoverableViolation")("Error encountered handling response from MQTT","messenger_web_product",{error:b("bs_caml_option").some(a._1)}):b("recoverableViolation")("Error encountered handling response from MQTT with unknown error","messenger_web_product")})})},q=function(a){var c=b("SortedAsyncIterable.bs").subscribe(b("ReQL.bs").fromTableAscending(a.table("sync_groups")),function(a,c){a=a.hd;var d=b("LSCookie.bs").get(void 0),e=d.c,f,g;if(typeof c==="number")f=1;else if(c.TAG===0){var h=c._0.currentCursor;h!==void 0?(g=h,f=2):f=1}else{h=c._0.currentCursor;h!==void 0?(g=h,f=2):f=1}switch(f){case 1:if(!b("bs_belt_Option").isSome(b("bs_js_dict").get(e,b("bs_int64").to_string(a))))return;b("bs_js_dict").unsafeDeleteKey(e,b("bs_int64").to_string(a));c=b("LSCookie.bs").writeCookie(d);b("promiseDone")(c,void 0,void 0);return;case 2:if(!b("bs_caml_obj").caml_notequal(b("bs_js_dict").get(e,b("bs_int64").to_string(a)),g))return;e[b("bs_int64").to_string(a)]=g;h=b("LSCookie.bs").writeCookie(d);b("promiseDone")(h,void 0,void 0);return}});return function(a){return b("bs_curry")._1(c,void 0)}},r=function(){return c.onReconnect(function(){b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_sync","resume_sync_reconnect"),b("LSLogHistory.bs").log("LS Sync System reconnecting","debug"),b("promiseDone")(b("LSTransaction.bs").run(a,function(a){var c;return(c=b("ReQL.bs")).toArray(c.mergeJoin(c.fromTableAscending(a.table("sync_groups")),c.getKeyRange(c.fromTableAscending(a.table("network_requests")),{hd:"",tl:0}))).then(function(c){return b("Promise").all(c.map(function(c){var d=c[0];if(!(d.currentCursor!==void 0||b("bs_caml").i64_eq(d.syncStatus,b("bs_caml_int64").zero)))return window.Promise.resolve(void 0);d=c[1];return a.table("network_requests").put({taskQueueName:d.taskQueueName,syncDatabaseId:d.syncDatabaseId,epochId:void 0,networkTaskIdentifier:d.networkTaskIdentifier,lastSentTimestampMs:d.lastSentTimestampMs,failureCount:d.failureCount,lastSyncRequestTimestampMs:d.lastSyncRequestTimestampMs,lastDelayedRequestTimestampMs:d.lastDelayedRequestTimestampMs})}))}).then(function(c){return b("LSBeginHandlingSync")(!1,b("LS.bs").make(a))})},"readWrite").then(m),void 0,void 0)})},s=o(),t=p(),u=r(),v=!b("killswitch")("MESSENGER_WEB_PERSISTED_DB")&&b("gkx")("3174")&&b("LSPersistedDbGating").allTablesPersisted?q(a):function(a){};n();return{cleanup:function(){var a;(a=b("bs_curry"))._1(s,void 0);a._1(u,void 0);a._1(t,void 0);return a._1(v,void 0)}}}f.make=a}),null);
__d("LS.re",["LS.bs"],(function(a,b,c,d,e,f){a=b("LS.bs").make;f.make=a}),null);
__d("LSGenerateTraceId",["LSRequestId","killswitch"],(function(a,b,c,d,e,f,g){"use strict";function a(){if(!c("killswitch")("MESSENGER_WEB_DATA_TRACE_ID"))return c("LSRequestId").generate();else return void 0}g["default"]=a}),98);
__d("LSPlatformTraceTasks",["LS.re","LSGenerateTraceId","LSPredefineTraceForTask","gkx","justknobx","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h=new Set();c("gkx")("4729")&&h.add("207");function a(a,e){var f,g,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:if(!c("justknobx")._("506")){k.next=12;break}f=0;case 2:if(!(f<e.length)){k.next=12;break}g=e[f];if(!((g.dataTraceId==null||g.dataTraceId==="")&&h.has(g.context))){k.next=9;break}i=c("LSGenerateTraceId")();if(!(i!=null)){k.next=9;break}k.next=9;return b("regeneratorRuntime").awrap(c("LSPredefineTraceForTask")(i,g.taskId,(j=g.context)!=null?j:"","",d("LS.re").make(a)));case 9:f++;k.next=2;break;case 12:case"end":return k.stop()}},null,this)}e={startTraceForTaskIfEligible:a};g["default"]=e}),98);
__d("bs_js_int",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){return a===b}b=2147483647;c=-2147483648;f.equal=a;f.max=b;f.min=c}),null);
__d("bs_js_math",["bs_js_int"],(function(a,b,c,d,e,f){"use strict";function a(a){return Math.ceil(a)}function c(a){if(a>b("bs_js_int").max)return b("bs_js_int").max;else if(a<b("bs_js_int").min)return b("bs_js_int").min;else return Math.ceil(a)}function d(a){return Math.floor(a)}function g(a){if(a>b("bs_js_int").max)return b("bs_js_int").max;else if(a<b("bs_js_int").min)return b("bs_js_int").min;else return Math.floor(a)}function e(a,b){return g(Math.random()*(b-a|0))+a|0}var h=c,i=g;f.unsafe_ceil=a;f.ceil_int=c;f.ceil=h;f.unsafe_floor=d;f.floor_int=g;f.floor=i;f.random_int=e}),null);
__d("bs_belt_Array",["bs_caml","bs_caml_option","bs_curry","bs_js_math"],(function(a,b,c,d,e,f){"use strict";function a(a,c){if(c>=0&&c<a.length)return b("bs_caml_option").some(a[c])}function c(a,b){if(!(b>=0&&b<a.length))throw{RE_EXN_ID:"Assert_failure",_1:["belt_Array.ml",27,4],Error:new Error()};return a[b]}function d(a,b,c){if(b>=0&&b<a.length){a[b]=c;return!0}else return!1}function e(a,b,c){if(!(b>=0&&b<a.length))throw{RE_EXN_ID:"Assert_failure",_1:["belt_Array.ml",33,2],Error:new Error()};a[b]=c}function g(a,b,c){var d=a[b];a[b]=a[c];a[c]=d}function h(a){var c=a.length;for(var d=0;d<c;++d)g(a,d,b("bs_js_math").random_int(d,c))}function i(a){a=a.slice(0);h(a);return a}function j(a){var b=a.length,c=0;for(var d=0,e=b/2|0;d<e;++d)g(a,c+d|0,((c+b|0)-d|0)-1|0)}function k(a){var b=a.length,c=new Array(b);for(var d=0;d<b;++d)c[d]=a[(b-1|0)-d|0];return c}function l(a,b){if(a<=0)return[];var c=new Array(a);for(var d=0;d<a;++d)c[d]=b;return c}function m(a,b){if(a<=0)return[];var c=new Array(a);for(var d=0;d<a;++d)c[d]=b(d);return c}function n(a,c){return m(a,b("bs_curry").__1(c))}function o(a,b){a=m(a,b);h(a);return a}function p(a,c){return o(a,b("bs_curry").__1(c))}function q(a,b){b=b-a|0;if(b<0)return[];var c=new Array(b+1|0);for(var d=0;d<=b;++d)c[d]=a+d|0;return c}function r(a,b,c){b=b-a|0;if(b<0||c<=0)return[];b=(b/c|0)+1|0;var d=new Array(b);a=a;for(var e=0;e<b;++e)d[e]=a,a=a+c|0;return d}function s(a,b){var c=a.length,d=b.length;c=c<d?c:d;d=new Array(c);for(var e=0;e<c;++e)d[e]=[a[e],b[e]];return d}function t(a,b,c){var d=a.length,e=b.length;d=d<e?d:e;e=new Array(d);for(var f=0;f<d;++f)e[f]=c(a[f],b[f]);return e}function u(a,c,d){return t(a,c,b("bs_curry").__2(d))}function v(a,b){var c=a.length,d=b.length,e=new Array(c+d|0);for(var f=0;f<c;++f)e[f]=a[f];for(var a=0;a<d;++a)e[c+a|0]=b[a];return e}function w(a){var b=a.length,c=0;for(var d=0;d<b;++d)c=c+a[d].length|0;d=new Array(c);c=0;for(var e=0;e<b;++e){var f=a[e];for(var g=0,h=f.length;g<h;++g)d[c]=f[g],c=c+1|0}return d}function x(a,c,d){if(d<=0)return[];var e=a.length;c=c<0?b("bs_caml").caml_int_max(e+c|0,0):c;e=e-c|0;e=e<d?e:d;if(e<=0)return[];d=new Array(e);for(var f=0;f<e;++f)d[f]=a[c+f|0];return d}function y(a,c){var d=a.length;c=c<0?b("bs_caml").caml_int_max(d+c|0,0):c;d=d-c|0;var e=new Array(d);for(var f=0;f<d;++f)e[f]=a[c+f|0];return e}function z(a,c,d,e){if(d<=0)return;var f=a.length;c=c<0?b("bs_caml").caml_int_max(f+c|0,0):c;f=f-c|0;f=f<d?f:d;if(f<=0)return;for(var d=c,c=c+f|0;d<c;++d)a[d]=e}function A(a,b,c,d,e){if(d<=b){for(var f=0;f<e;++f)c[f+d|0]=a[f+b|0];return}for(var f=e-1|0;f>=0;--f)c[f+d|0]=a[f+b|0]}function B(a,c,d,e,f){var g=a.length,h=d.length;c=c<0?b("bs_caml").caml_int_max(g+c|0,0):c;e=e<0?b("bs_caml").caml_int_max(h+e|0,0):e;f=b("bs_caml").caml_int_min(f,b("bs_caml").caml_int_min(g-c|0,h-e|0));if(e<=c){for(var g=0;g<f;++g)d[g+e|0]=a[g+c|0];return}for(var h=f-1|0;h>=0;--h)d[h+e|0]=a[h+c|0]}function C(a,b){for(var c=0,d=a.length;c<d;++c)b(a[c])}function D(a,c){return C(a,b("bs_curry").__1(c))}function E(a,b){var c=a.length,d=new Array(c);for(var e=0;e<c;++e)d[e]=b(a[e]);return d}function F(a,c){return E(a,b("bs_curry").__1(c))}function G(a,c){var d=a.length,e=0,f;while(f===void 0&&e<d){var g=a[e];c(g)&&(f=b("bs_caml_option").some(g));e=e+1|0}return f}function H(a,c){return G(a,b("bs_curry").__1(c))}function I(a,b){var c=a.length,d=0,e;while(e===void 0&&d<c){var f=a[d];b(f)&&(e=d);d=d+1|0}return e}function aa(a,c){return I(a,b("bs_curry").__1(c))}function J(a,b){var c=a.length,d=new Array(c),e=0;for(var f=0;f<c;++f){var g=a[f];b(g)&&(d[e]=g,e=e+1|0)}d.length=e;return d}function ba(a,c){return J(a,b("bs_curry").__1(c))}function K(a,b){var c=a.length,d=new Array(c),e=0;for(var f=0;f<c;++f){var g=a[f];b(g,f)&&(d[e]=g,e=e+1|0)}d.length=e;return d}function ca(a,c){return K(a,b("bs_curry").__2(c))}function L(a,c){var d=a.length,e=new Array(d),f=0;for(var g=0;g<d;++g){var h=a[g];h=c(h);h!==void 0&&(e[f]=b("bs_caml_option").valFromOption(h),f=f+1|0)}e.length=f;return e}function da(a,c){return L(a,b("bs_curry").__1(c))}function M(a,b){for(var c=0,d=a.length;c<d;++c)b(c,a[c])}function ea(a,c){return M(a,b("bs_curry").__2(c))}function N(a,b){var c=a.length,d=new Array(c);for(var e=0;e<c;++e)d[e]=b(e,a[e]);return d}function fa(a,c){return N(a,b("bs_curry").__2(c))}function O(a,b,c){b=b;for(var d=0,e=a.length;d<e;++d)b=c(b,a[d]);return b}function ga(a,c,d){return O(a,c,b("bs_curry").__2(d))}function P(a,b,c){b=b;for(var d=a.length-1|0;d>=0;--d)b=c(b,a[d]);return b}function ha(a,c,d){return P(a,c,b("bs_curry").__2(d))}function Q(a,c,d,e){d=d;var f=b("bs_caml").caml_int_min(a.length,c.length);for(var f=f-1|0;f>=0;--f)d=e(d,a[f],c[f]);return d}function ia(a,c,d,e){return Q(a,c,d,b("bs_curry").__3(e))}function R(a,b,c){b=b;for(var d=0,e=a.length;d<e;++d)b=c(b,a[d],d);return b}function ja(a,c,d){return R(a,c,b("bs_curry").__3(d))}function S(a,b){var c=a.length,d=0;while(!0){var e=d;if(e===c)return!0;if(!b(a[e]))return!1;d=e+1|0;continue}}function ka(a,c){return S(a,b("bs_curry").__1(c))}function T(a,b){var c=a.length,d=0;while(!0){var e=d;if(e===c)return!1;if(b(a[e]))return!0;d=e+1|0;continue}}function la(a,c){return T(a,b("bs_curry").__1(c))}function U(a,b,c,d,e){while(!0){var f=c;if(f===e)return!0;if(!d(a[f],b[f]))return!1;c=f+1|0;continue}}function V(a,c,d){return U(a,c,0,d,b("bs_caml").caml_int_min(a.length,c.length))}function ma(a,c,d){return V(a,c,b("bs_curry").__2(d))}function W(a,c,d){var e=0,f=b("bs_caml").caml_int_min(a.length,c.length);while(!0){var g=e;if(g===f)return!1;if(d(a[g],c[g]))return!0;e=g+1|0;continue}}function na(a,c,d){return W(a,c,b("bs_curry").__2(d))}function X(a,b,c){var d=a.length,e=b.length;if(d===e)return U(a,b,0,c,d);else return!1}function oa(a,c,d){return X(a,c,b("bs_curry").__2(d))}function Y(a,b,c){var d=a.length,e=b.length;if(d>e)return 1;else if(d<e)return-1;else{e=0;while(!0){var f=e;if(f===d)return 0;var g=c(a[f],b[f]);if(g!==0)return g;e=f+1|0;continue}}}function pa(a,c,d){return Y(a,c,b("bs_curry").__2(d))}function Z(a,b){var c=a.length,d=0,e=0,f=new Array(c),g=new Array(c);for(var h=0;h<c;++h){var i=a[h];b(i)?(f[d]=i,d=d+1|0):(g[e]=i,e=e+1|0)}f.length=d;g.length=e;return[f,g]}function qa(a,c){return Z(a,b("bs_curry").__1(c))}function ra(a){var b=a.length,c=new Array(b),d=new Array(b);for(var e=0;e<b;++e){var f=a[e];c[e]=f[0];d[e]=f[1]}return[c,d]}function $(a,b,c){var d=a.length;if(d===0)return"";d=d-1|0;var e=0,f="";while(!0){var g=f,h=e;if(h===d)return g+c(a[h]);f=g+(c(a[h])+b);e=h+1|0;continue}}function sa(a,c,d){return $(a,c,b("bs_curry").__1(d))}f.get=a;f.getExn=c;f.set=d;f.setExn=e;f.shuffleInPlace=h;f.shuffle=i;f.reverseInPlace=j;f.reverse=k;f.make=l;f.range=q;f.rangeBy=r;f.makeByU=m;f.makeBy=n;f.makeByAndShuffleU=o;f.makeByAndShuffle=p;f.zip=s;f.zipByU=t;f.zipBy=u;f.unzip=ra;f.concat=v;f.concatMany=w;f.slice=x;f.sliceToEnd=y;f.fill=z;f.blit=B;f.blitUnsafe=A;f.forEachU=C;f.forEach=D;f.mapU=E;f.map=F;f.getByU=G;f.getBy=H;f.getIndexByU=I;f.getIndexBy=aa;f.keepU=J;f.keep=ba;f.keepWithIndexU=K;f.keepWithIndex=ca;f.keepMapU=L;f.keepMap=da;f.forEachWithIndexU=M;f.forEachWithIndex=ea;f.mapWithIndexU=N;f.mapWithIndex=fa;f.partitionU=Z;f.partition=qa;f.reduceU=O;f.reduce=ga;f.reduceReverseU=P;f.reduceReverse=ha;f.reduceReverse2U=Q;f.reduceReverse2=ia;f.reduceWithIndexU=R;f.reduceWithIndex=ja;f.joinWithU=$;f.joinWith=sa;f.someU=T;f.some=la;f.everyU=S;f.every=ka;f.every2U=V;f.every2=ma;f.some2U=W;f.some2=na;f.cmpU=Y;f.cmp=pa;f.eqU=X;f.eq=oa}),null);
__d("LSPlatformTaskSystem.bs",["LS.bs","LSBeginHandlingPendingTasks","LSBeginHandlingPendingTasksForQueue","LSDict","LSHandleTaskSendFailureForQueue","LSHandleTaskSendSuccessForQueue","LSJson","LSPlatformDevtoolsHelpers.bs","LSPlatformRealtimeTransport.bs","LSPlatformRequestId","LSPlatformRequestScheduler.bs","LSPlatformServerResponseHandler","LSPlatformTraceTasks","LSRequestType.bs","LSSyncChannel.bs","LSTaskWorkItemType.bs","LSTransaction.bs","MWPBumpEntityKey.bs","Promise","Promise.bs","ReQL.bs","SortedAsyncIterable.bs","bs_belt_Array","bs_belt_Option","bs_caml","bs_caml_int64","bs_caml_obj","bs_caml_option","bs_curry","bs_int64","gkx","promiseDone","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d,e){var f=[],g=b("LSPlatformRequestScheduler.bs").make(void 0),h=function(c){c=b("bs_belt_Option").map(c.network_payload,function(a){return b("LSDict").shapeToRecord(a)});if(c!==void 0)return b("bs_belt_Option").mapWithDefault(b("bs_belt_Array").get(c.tasks,0),b("Promise").resolve(void 0),function(c){c=b("LSDict").shapeToRecord(c).task_id;return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("pending_tasks")),{hd:c,tl:0})).then(function(a){return b("Promise").resolve(a!==void 0?a.dataTraceId:void 0)})});else return b("Promise").resolve(void 0)},i=function(c){return b("LSTransaction.bs").run(a,function(a){return b("LSHandleTaskSendFailureForQueue")(c,b("LS.bs").make(a))},"readWrite")},j=new(b("LSPlatformServerResponseHandler"))(d),k=function f(k){var l=function(c,d){return b("LSPlatformRequestScheduler.bs").schedule(g,function(d){b("promiseDone")(b("LSTransaction.bs").run(a,function(a){return b("LSBeginHandlingPendingTasksForQueue")(c,!1,b("LS.bs").make(a))},"readWrite").then(function(a){return f(b("LSDict").shapeToRecord(a[0]))}),void 0,void 0)},c,b("bs_caml_int64").to_float(d))},m=b("LSPlatformRequestId").generate(),n=b("bs_belt_Option").map(k.network_payload,function(a){return b("LSDict").shapeToRecord(a)}),o=k.work_item_type;if(n!==void 0){if(b("bs_caml").i64_eq(o,b("LSTaskWorkItemType.bs").workItemTypeSendToServer)){var p=n.epoch_id,q=n.tasks,r=k.queue_name;b("LSPlatformDevtoolsHelpers.bs").recordTaskSending(q);return b("Promise.bs").$$catch(h(k).then(function(a){return b("bs_curry")._5(c.publish,b("LSSyncChannel.bs").mqtt,r,m,b("LSRequestType.bs").taskBatch,b("LSJson").stringify(b("LSDict").fromObject({version_id:e,tasks:q,epoch_id:p,data_trace_id:a})))}).then(function(c){if(c){var e=c._1,f=e.ex,g=e.payload;f={experiments:f,syncScript:g};return b("Promise.bs").$$catch((b("gkx")("4463")?j.evalWhenReady(c._0,f):b("bs_curry")._1(d,f)).then(function(c){b("LSPlatformDevtoolsHelpers.bs").recordTaskSent(q,e.payload);return b("LSTransaction.bs").run(a,function(a){return b("LSHandleTaskSendSuccessForQueue")(r,b("LS.bs").make(a))},"readWrite")}),function(a){b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_tasks","handle_task_failure");a.RE_EXN_ID===b("Promise.bs").JsError?b("recoverableViolation")("Encountered an error while processing a task response via realtime transport","messenger_web_product",{error:b("bs_caml_option").some(a._1)}):b("recoverableViolation")("Encountered an error while processing a task response via realtime transport","messenger_web_product",{error:a});return i(r)})}b("recoverableViolation")("Expected a response for a non fire forget task","messenger_web_product");return b("Promise").resolve(void 0)}),function(a){a.RE_EXN_ID===b("Promise.bs").JsError?(b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_tasks","send_fail_timeout"),b("recoverableViolation")("Encountered an error while publishing a LS task payload via realtime transport","messenger_web_product",{error:b("bs_caml_option").some(a._1)})):a.RE_EXN_ID===b("LSPlatformRealtimeTransport.bs").Timeout||a.RE_EXN_ID===b("LSPlatformRealtimeTransport.bs").NotConnected||(b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_tasks","send_fail_generic"),b("recoverableViolation")("Encountered an error while publishing a LS task payload via realtime transport","messenger_web_product",{error:a}));return i(r)})}if(b("bs_caml").i64_eq(o,b("LSTaskWorkItemType.bs").workItemTypeSendToServerFireAndForget))return b("Promise.bs").$$catch(b("Promise").all(n.tasks.map(function(a){return b("LSDict").shapeToRecord(a)}).map(function(a){return b("bs_curry")._5(c.publish,b("LSSyncChannel.bs").mqtt,void 0,m,b("LSRequestType.bs").fireForget,b("LSJson").stringify(b("LSDict").fromObject({label:a.label,payload:a.payload,version:e})))})).then(function(a){return b("Promise").resolve(void 0)}),function(a){return b("Promise").resolve(void 0)})}if(b("bs_caml").i64_eq(o,b("LSTaskWorkItemType.bs").workItemTypeDelayHandling)){l(k.queue_name,k.next_sync_ms);return b("Promise").resolve(void 0)}else if(b("bs_caml").i64_eq(o,b("LSTaskWorkItemType.bs").workItemTypeNone))return b("Promise").resolve(void 0);else if(b("bs_caml").i64_eq(o,b("LSTaskWorkItemType.bs").workItemTypeHandleNative)){b("recoverableViolation")("Native tasks not supported so far","messenger_web_product");return b("Promise").resolve(void 0)}else{b("recoverableViolation")("Unknown Task type of "+b("bs_int64").to_string(o),"messenger_web_product");return b("Promise").resolve(void 0)}},l=function(c){b("promiseDone")(b("LSTransaction.bs").run(a,function(a){return(c.length>0?b("Promise.bs").$$catch(b("LSPlatformTraceTasks").startTraceForTaskIfEligible(a,c),function(a){return b("Promise").resolve(void 0)}):b("Promise").resolve(void 0)).then(function(c){return b("LSBeginHandlingPendingTasks")(!1,b("LS.bs").make(a))})},"readWrite").then(function(a){return b("Promise").all(a[0].map(function(a){return b("LSDict").shapeToRecord(a)}).map(k))}),void 0,void 0)},m=function(){var c,d={contents:!1},e={contents:[]},g=b("SortedAsyncIterable.bs").subscribe((c=b("ReQL.bs")).fromTableAscending(a.table("pending_tasks")),function(a,c){d.contents=!0;if(typeof c==="number")return;if(c.TAG===0)a=c._0;else{c=c._0;if(b("bs_caml").i64_gt(c.failureCount,b("bs_caml_int64").one))return b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_tasks","tasks_failure_count_gt_one");a=c}if(a.dataTraceId===void 0||b("bs_caml_obj").caml_equal(a.dataTraceId,"")){e.contents.push(a);return}}),h=b("SortedAsyncIterable.bs").subscribe(c.fromTableAscending(a.table("pending_fire_and_forget_tasks")),function(a,b){return l(f)}),i=b("SortedAsyncIterable.bs").subscribe(c.filter(c.fromTableAscending(a.table("network_requests")),function(a){return a.taskQueueName!==""}),function(a,c){if(typeof c==="number"){d.contents=!0;return}else if(c.TAG===0||!b("bs_caml").i64_gt(c._0.failureCount,b("bs_caml_int64").one))return;else return b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_tasks","network_failure_count_gt_one")}),j=a.subscribeToCommit(function(a){if(!d.contents)return;a=e.contents;e.contents=[];d.contents=!1;return l(a)});return function(){var a;(a=b("bs_curry"))._1(g,void 0);a._1(h,void 0);a._1(i,void 0);return a._1(j,void 0)}},n=function(){return c.onReconnect(function(){b("promiseDone")(b("LSTransaction.bs").run(a,function(a){return b("ReQL.bs").toArray(b("ReQL.bs").bounds(b("ReQL.bs").fromTableAscending(a.table("network_requests")),{NAME:"greaterThan",VAL:{hd:"",tl:0}})).then(function(c){return b("Promise").all(c.map(function(c){return b("LSHandleTaskSendFailureForQueue")(c.taskQueueName,b("LS.bs").make(a))}))})},"readWrite"),void 0,void 0)})},o=m(),p=n();l(f);return{cleanup:function(){o();return b("bs_curry")._1(p,void 0)}}}f.make=a}),null);
__d("LSPlatformClient.bs",["ExecutionEnvironment","LSClearEpochBeforeResumeSync.bs","LSDataTraceFlushDeferred.bs","LSJSInMemoryStorage.bs","LSMetadata","LSPlatformDevtoolsHelpers.bs","LSPlatformHardcodedInitSync.bs","LSPlatformRealtimeTransport.bs","LSPlatformSyncSystem.bs","LSPlatformTaskSystem.bs","Promise","bs_curry","cr:3238"],(function(a,b,c,d,e,f){"use strict";function a(a){var c={contents:0};if(b("ExecutionEnvironment").canUseDOM)return a.getDb().then(function(d){return b("bs_curry")._1(a.getEval,void 0).then(function(e){b("LSPlatformDevtoolsHelpers.bs").registerDb(d);var f=b("bs_curry")._2(b("LSPlatformDevtoolsHelpers.bs").evalWithDevtoolSupport(e),void 0,d);return b("LSClearEpochBeforeResumeSync.bs").call(d).then(function(c){if(a.sendHardcodedInitSync)return b("LSPlatformHardcodedInitSync.bs").sendHardcodedInitSync(a,f,d);else return b("Promise").resolve(void 0)}).then(function(e){e=function(e){e=c.contents;if(typeof e!=="number")return b("Promise").resolve(void 0);e=c.contents===1?b("LSClearEpochBeforeResumeSync.bs").call(d):b("Promise").resolve(void 0);return e.then(function(e){var g=b("LSPlatformRealtimeTransport.bs").make(a.realtimeUnderylingTransport,a.appId),h=b("LSPlatformTaskSystem.bs").make(d,g,f,a.schemaVersion),i=b("LSPlatformSyncSystem.bs").make(d,g,f,a.schemaVersion,a.deviceId,a.executeGraphQLLightSpeedRequest);e=function(a){h.cleanup(),i.cleanup(),g.cleanup(),c.contents=1};c.contents={_0:e,_1:g.onConnectionStatusChange}})};return b("Promise").resolve({start:e,cleanup:function(a){a=c.contents;if(typeof a==="number")return;else return b("bs_curry")._1(a._0,void 0)},db:d,onConnectionStatusChange:function(a){var b=c.contents;if(typeof b==="number")return function(a){};else return b._1(a)}})})})}).then(function(a){b("LSDataTraceFlushDeferred.bs").watchForExpiredTraces(a.db);b("cr:3238")==null||b("bs_curry")._1(b("cr:3238").listenForChangesToBackupState,a.db);return a});else return b("Promise").resolve({start:function(a){return b("Promise").resolve(void 0)},cleanup:function(a){},db:b("LSJSInMemoryStorage.bs").make(b("LSMetadata").metadata),onConnectionStatusChange:function(a){return function(a){}}})}f.$MWEncryptedBackupsListenForChangesToBackupStateInitPath$requireCond=b("cr:3238");f.make=a}),null);
__d("LSPlatformClientSingleton.bs",["Promise","bs_caml_exceptions"],(function(a,b,c,d,e,f){"use strict";var g=b("bs_caml_exceptions").create("LSPlatformClientSingleton.LSPlatformConfigIsUnavaiable"),h={contents:void 0};function a(a){return new(b("Promise"))(function(a,b){var c=h.contents;if(c!==void 0)return a(c.db);else return b({RE_EXN_ID:g})})}function c(a){h.contents=a}f.LSPlatformConfigIsUnavaiable=g;f.getDB=a;f.saveInstance=c}),null);
__d("WeakMap.bs",["bs_belt_Option","bs_curry"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d){return b("bs_belt_Option").getExn((a.has(c)?a:a.set(c,b("bs_curry")._1(d,void 0))).get(c))}f.getOrMake=a}),null);
__d("LSPlatformClientInstances.bs",["ExecutionEnvironment","LSPlatformClientSingleton.bs","MAWGating.bs","Promise","Promise.bs","QPLUserFlow","WeakMap.bs","bs_curry","qpl"],(function(a,b,c,d,e,f){"use strict";var g=new WeakMap(),h={contents:!1};function a(a,c){h.contents===!1&&(h.contents=!0,b("QPLUserFlow").start(b("qpl")._(25305590,"1127"),{cancelOnUnload:!0,timeoutInMs:b("ExecutionEnvironment").canUseDOM?6e4:0}),b("MAWGating.bs").isOccamadillo(void 0)&&b("QPLUserFlow").start(b("qpl")._(1056844945,"700"),{cancelOnUnload:!0,timeoutInMs:b("ExecutionEnvironment").canUseDOM?6e4:0}));return b("WeakMap.bs").getOrMake(g,a,function(d){return{TAG:0,_0:b("Promise.bs").$$catch(b("bs_curry")._1(c,void 0).then(function(c){return b("bs_curry")._1(c.make,a).then(function(c){return b("bs_curry")._1(c.start,void 0).then(function(d){b("LSPlatformClientSingleton.bs").saveInstance(c),g.set(a,{TAG:2,_0:c})})})}),function(c){g.set(a,{TAG:1,_0:c});return b("Promise").resolve(void 0)})}})}f.isSetupExecuted=h;f.getOrInit=a}),null);
__d("LSPlatformConfig.bs",["LSSuspense.bs","bs_caml_exceptions","react","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";var g,h=g||b("react");d=b("bs_caml_exceptions").create("LSPlatformConfig.NoLSPlatformProviderFound");e=b("LSSuspense.bs").make(void 0);e.contents={TAG:1,_0:{RE_EXN_ID:d}};var i=h.createContext(e);function a(a){var b=a.children;a=a.config;return h.createElement(i.Provider,{value:a,children:b})}a={make:a};function c(a){a=h.useContext(i);a=a.contents;if(typeof a==="number")return b("unrecoverableViolation")("Tried to get an instance of LSPlatformConfig but got a config that was uninitialised","messenger_web_product");switch(a.TAG|0){case 0:return b("LSSuspense.bs").$$throw(a._0);case 1:return b("LSSuspense.bs").throwError(a._0);case 2:return a._0}}f.NoLSPlatformProviderFound=d;f.$$default=e;f["default"]=e;f.__esModule=!0;f.Provider=a;f.useOrSuspend=c}),null);
__d("LSInternetConnectionState.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;f.notConnected=a;f.connected=c}),null);
__d("MqttState.bs",[],(function(a,b,c,d,e,f){"use strict";a="Connected";b="Disconnected";c="Connecting";f.connected=a;f.disconnected=b;f.connecting=c}),null);
__d("LSPlatformConnectionStatusContext.bs",["LS.bs","LSDeleteAllAndInsertConnectivityStatus","LSInternetConnectionState.bs","LSPersistedDbGating","LSTransaction.bs","MqttState.bs","bs_caml_array","bs_caml_option","bs_curry","cr:2731","cr:434","promiseDone","react","useReStore"],(function(a,b,c,d,e,f){"use strict";var g,h=g||b("react");function a(a){}a={status:b("MqttState.bs").connected,setStatus:a};var i=h.createContext(a);function c(a){var c=a.children,d=a.onConnectionStatusChange,e=b("useReStore")();a=h.useState(function(){return b("MqttState.bs").connected});var f=a[1],g=a[0];h.useEffect(function(){return d(function(a){return b("bs_curry")._1(f,function(b){return a})})},[]);h.useEffect(function(){(g===b("MqttState.bs").connected||g===b("MqttState.bs").disconnected)&&b("promiseDone")(b("LSTransaction.bs").run(e,function(a){return b("LSDeleteAllAndInsertConnectivityStatus")(g===b("MqttState.bs").connected?b("LSInternetConnectionState.bs").connected:b("LSInternetConnectionState.bs").notConnected,b("LS.bs").make(a))},"readWrite"),void 0,void 0)},[e,g]);a=h.useCallback(function(a){return b("bs_curry")._1(f,function(b){return a})},[f]);a={status:g,setStatus:a};return h.createElement(i.Provider,{value:a,children:c})}function d(a){return h.useContext(i)}var j=b("cr:2731")==null?void 0:b("bs_caml_option").some(b("cr:2731")),k=b("cr:434")==null?void 0:b("bs_caml_option").some(b("cr:434"));function e(a){a=h.useContext(i);var c=a.setStatus;return h.useMemo(function(){return function(a){if(!(b("cr:2731")==null)&&!(b("cr:434")==null)&&b("LSPersistedDbGating").oneMqttConnectionAcrossTabs){b("bs_curry")._1(b("cr:2731").hasLock,void 0)&&(b("bs_curry")._1(c,a),b("bs_curry")._2(b("cr:434").postMessage,"connection",[a]));return b("bs_curry")._2(b("cr:434").onEventReceive,"connection",function(a){if(!b("bs_curry")._1(b("cr:2731").hasLock,void 0))return b("bs_curry")._1(c,b("bs_caml_array").get(a,0))})}else return b("bs_curry")._1(c,a)}},[c])}c=c;f.emptyValue=a;f.context=i;f.make=c;f.useContext=d;f.$MWDBLock$requireCond=b("cr:2731");f.appLock=j;f.$MWTabNotifier$requireCond=b("cr:434");f.tabNotifier=k;f.useStatusChangeHandler=e}),null);
__d("LSPlatformLogout.bs",["LSCookie.bs","Promise","Promise.bs","QPLUserFlow","bs_curry","cr:1342","qpl","react"],(function(a,b,c,d,e,f){"use strict";var g,h=g||b("react"),i=h.createContext(void 0);function a(a){var b=a.client;a=a.children;return h.jsx(i.Provider,{value:b,children:a})}d={make:a};function c(a){var c=h.useContext(i);return h.useCallback(function(a){if(b("cr:1342")==null)return b("Promise").resolve(void 0);else{b("QPLUserFlow").start(b("qpl")._(25311266,"236"),{cancelOnUnload:!0,timeoutInMs:3e3});c!==void 0&&b("bs_curry")._1(c.cleanup,void 0);return b("Promise.bs").$$catch(b("Promise").all([b("bs_curry")._1(b("cr:1342").deleteDB,void 0),b("LSCookie.bs").deleteCookie(void 0)]).then(function(a){b("QPLUserFlow").endSuccess(b("qpl")._(25311266,"236"),void 0);return b("Promise").resolve(void 0)}),function(a){b("QPLUserFlow").endFailure(b("qpl")._(25311266,"236"),"fail",void 0);return b("Promise").resolve(void 0)})}},[c])}f.Provider=d;f.$LSPersistedDatabaseProvider$requireCond=b("cr:1342");f.useHook=c}),null);
__d("LSPlatformClientProvider.bs",["CometPlaceholder.react","LSPersistedDbGating","LSPlatformClientInstances.bs","LSPlatformConfig.bs","LSPlatformConnectionStatusContext.bs","LSPlatformLogout.bs","LSSuspense.bs","ReStore.bs","bs_caml_option","bs_curry","cr:2073","react","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";var g,h=g||b("react");function i(a){var c=b("LSPlatformConfig.bs").useOrSuspend(void 0);c=b("LSPlatformClientInstances.bs").getOrInit(c,a);if(typeof c==="number")return b("unrecoverableViolation")("Did not expect a LSPlatformClient that has not started initialising","messenger_web_product");switch(c.TAG|0){case 0:return b("LSSuspense.bs").$$throw(c._0);case 1:return b("LSSuspense.bs").throwError(c._0);case 2:return c._0}}var j;c=0;b("cr:2073")==null||!b("LSPersistedDbGating").oneMqttConnectionAcrossTabs?c=1:j=b("cr:2073").usePauseClientWhenTabIsntLeader;c===1&&(j=function(a){});function k(a){var c=a.children,d=a.cleanup;a=a.loadLSPlatformClient;var e=i(a);b("bs_curry")._1(j,e);h.useEffect(function(){return function(a){if(d)return b("bs_curry")._1(e.cleanup,void 0)}},[d,e]);return h.jsx(b("ReStore.bs").Provider.make,{db:e.db,children:h.jsx(b("LSPlatformConnectionStatusContext.bs").make,{children:h.jsx(b("LSPlatformLogout.bs").Provider.make,{client:e,children:c}),onConnectionStatusChange:e.onConnectionStatusChange})})}d={usePauseClientWhenTabIsntLeader:j,make:k};function a(a){var c=a.children,d=a.cleanup,e=a.loadLSPlatformClient;a=a.placeholder;d=d!==void 0?d:!1;a=a!==void 0?b("bs_caml_option").valFromOption(a):null;return h.jsx(b("CometPlaceholder.react"),{children:h.jsx(k,{children:c,cleanup:d,loadLSPlatformClient:e}),fallback:a})}e=a;f.$MWSetupLock$requireCond=b("cr:2073");f.Inner=d;f.make=e}),null);
__d("LSPlatformClientProviderWithImmediateLoadingStrategy.bs",["LSPlatformClient.bs","LSPlatformClientProvider.bs","Promise","bs_caml_option","react"],(function(a,b,c,d,e,f){"use strict";var g,h=g||b("react");function i(a){return b("Promise").resolve({make:b("LSPlatformClient.bs").make})}function a(a){var c=a.children,d=a.cleanup;a=a.placeholder;d=d!==void 0?d:!1;a=a!==void 0?b("bs_caml_option").valFromOption(a):null;return h.jsx(b("LSPlatformClientProvider.bs").make,{children:c,cleanup:d,loadLSPlatformClient:i,placeholder:a})}c=a;f.loadLSPlatformClient=i;f.make=c}),null);
__d("LSPlatformClientProviderWithImmediateLoadingStrategy.re",["LSPlatformClientProviderWithImmediateLoadingStrategy.bs"],(function(a,b,c,d,e,f){a=b("LSPlatformClientProviderWithImmediateLoadingStrategy.bs").make;f.make=a}),null);
__d("LSPlatformConfig.re",["LSPlatformConfig.bs","bs_curry"],(function(a,b,c,d,e,f){a=b("LSPlatformConfig.bs").Provider.make;f.Provider_make=a;c=function(){var a=b("LSPlatformConfig.bs").useOrSuspend();return{region:a.region,deviceId:a.deviceId,appId:a.appId,schemaVersion:a.schemaVersion,numThreads:a.numThreads,getDb:a.getDb,realtimeUnderylingTransport:function(c){var d=a.realtimeUnderylingTransport(c);return{subscribe:d.subscribe,onConnectionStatusChange:d.onConnectionStatusChange,onReconnect:d.onReconnect,publish:function(a,c){a=b("bs_curry")._2(d.publish,a,c);return a},cleanup:d.cleanup}},getEval:function(){var c=a.getEval();return c.then(function(a){return function(c,d){c=b("bs_curry")._2(a,c.onBefore,d);return c}})},executeGraphQLLightSpeedRequest:a.executeGraphQLLightSpeedRequest,previewWidthLarge:a.previewWidthLarge,previewWidth:a.previewWidth,sendHardcodedInitSync:a.sendHardcodedInitSync}};f.useOrSuspend=c;d=b("LSPlatformConfig.bs").Provider;f.Provider=d}),null);
__d("FacebookAppIDs",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({FACEBOOK_FOR_ANDROID:74769995908,FACEBOOK_FOR_ANDROID2:350685531728,FACEBOOK_FOR_EMERGING_MARKET_ANDROID:275254692598279,TURDUCKEN:400954310366822,FACEBOOK_MEDIA_EFFECTS:1779302845618373,MOST_RECENT_FEED:608920319153834,SAVED_FOR_LATER:586254444758776,TRANSLATIONS:4329892722,MESSENGERDOTCOM:772021112871879,MESSENGER_DESKTOP:195376314393036,WWW:256281040558,WWW_COMET:2220391788200892,FBPAGES:2530096808,ADS_PAYMENT:123097351040126,ADS_AMI_ONBOARDING:2806896492660535,EVENTS:2344061033,BUSINESS_ACCOUNTS:436761779744620,ADS_EVENTS_MANAGER:2094176354154603,WORKPLACE_BILLING:1350397358363828,WORKPLACE_FOR_EVERY_PHONE:1263749867021676,WORKPLACE_DESKTOP:267999183646265,CHATPROXY_WEB:229895473858072,MARKETPLACE:1606854132932955,WHATSAPP_BUSINESS_ACCOUNT_MANAGER:225181538219344,LIFT_STUDY_VIEW:1501349520163380,LIFT_STUDY_CREATION:367378623468359,INTERN_ADS_PREVIEW_GENERATION_APP:2004203579636813,MESSENGER_DESKTOP_ARCHON_MACOS:451384735309667,MESSENGER_DESKTOP_ARCHON_WINDOWS:1931350367173590,PAGE_INBOX:263902037430900,MEDIA_MANAGER:2007914219485853,ACCOUNT_QUALITY:293651901511648,ADS_AMI_BRAZIL_ONBOARDING:616624215510791,MQTT_WEB:219994525426954,WIT:197968810559097,UNIFIED_AMI_ONBOARDING:685960845183976,M_TOUCH_SITE:333176286769482,M_SITE:412378670482,FACEBOOK_FOR_IPHONE:6628568379,WHATSAPP_ANDROID:994766073959253,WHATSAPP_IPHONE:306069495113,WHATSAPP_KAIOS:412254059643627,WHATSAPP_WEB:167028690535322,WHATSAPP_MAC:346387865799334,WHATSAPP_WINDOWS:120781038571451,WHATSAPP_SMB_ANDROID:473039703209605,WHATSAPP_SMB_IPHONE:450645302121512,WHATSAPP_WINDOWS_PHONE:1904280676561321,BIZWEB:514771569228061,BUSINESS_MANAGER_WORKPLACE_LOGIN:190532008697732,ADS_INCUBATOR:306597163753304,POSTS:1042244359201256,BOOSTED_PAGE:1146105192114219,BOOSTED_INSTAGRAM_MEDIA_MOBILE:871306629649317,INSTAGRAM_FOR_ANDROID_ANALYTICS_ONLY:567067343352427,INSTAGRAM_WEB:1217981644879628,INSTAGRAM_WEB_DESKTOP:936619743392459,INSTAGRAM_CARBON:905593853150754,FACEBOOK_MESSENGER_FOR_ANDROID:256002347743983,ARMADILLO_WEB_DEVSERVER_CLIENT:1019394685547802,OCULUS_IOS_TWILIGHT:147781309031234,OCULUS_IOS_TWILIGHT_DEV:1635404796768116,OCULUS_IOS_TWILIGHT_IN_HOUSE:1543576032349914,OCULUS_IOS_TWILIGHT_LOCAL:1680871178595114,OCULUS_ANDROID_TWILIGHT:624536201004543,SHOPIFY_CONFIGURATION:3046464678944642,SHOPIFY_3P_CURL_INTEGRATION:699341854433150})}),null);
__d("IGDOverLSMqttChannel",["CurrentUser","Env","FacebookAppIDs","MqttChannel","MqttEnv","MqttEnvInitializer","MqttWebConfig"],(function(a,b,c,d,e,f,g){"use strict";c("MqttEnvInitializer").initialize();d("MqttEnv").setIsUserLoggedInNow(c("CurrentUser").isLoggedIn);a=c("CurrentUser").getAppID()==null?d("FacebookAppIDs").INSTAGRAM_WEB_DESKTOP:Number(c("CurrentUser").getAppID());b=new(c("MqttChannel"))({endpoint:c("Env").ig_mqtt_wss_endpoint||"wss://edge-chat.instagram.com/chat",pollingEndpoint:c("Env").ig_mqtt_polling_endpoint||"https://edge-chat.instagram.com/mqtt/pull",userFbid:c("CurrentUser").getPossiblyNonFacebookUserID(),appId:a,initialSubscribedTopics:c("MqttWebConfig").subscribedTopics,capabilities:c("MqttWebConfig").capabilities,clientCapabilities:c("MqttWebConfig").clientCapabilities,chatVisibility:!0,clientType:"cookie_auth",phpOverride:c("MqttWebConfig").hostNameOverride});e=b;g["default"]=e}),98);
__d("IGMqttChannel.bs",["IGDOverLSMqttChannel"],(function(a,b,c,d,e,f){"use strict";function a(a){return b("IGDOverLSMqttChannel")}f.getInstance=a}),null);
__d("LSDatascriptEvaluatorMaybeDeferred",["cr:974"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:974")}),98);
__d("LSDedicatedMqttChannel.bs",["cr:11792"],(function(a,b,c,d,e,f){"use strict";a=b("cr:11792").getInstance;c=b("cr:11792").shutdownAndClear;f.$LSMqttChannel$OR$FBMqttChannel$requireCond=b("cr:11792");f.getInstance=a;f.shutdownAndClear=c}),null);
__d("LSPlatformDefaultUnderlyingApi.bs",["Promise"],(function(a,b,c,d,e,f){"use strict";function a(a){return function(a){}}function c(a){return function(a){}}function d(a){return function(a){}}function e(a,c){return b("Promise").resolve(void 0)}function g(){}a={subscribe:a,onConnectionStatusChange:c,onReconnect:d,publish:e,cleanup:g};f.defaultUnderlyingApi=a}),null);
__d("LSPlatformMqttRealtimeTransport.bs",["ExecutionEnvironment","LSDedicatedMqttChannel.bs","LSPersistedDbGating","LSPlatformDefaultUnderlyingApi.bs","LSPlatformRealtimeTransport.bs","LSRequestType.bs","MqttState.bs","Promise","QPLUserFlow","bs_caml","bs_curry","gkx","killswitch","promiseDone","qex","qpl"],(function(a,b,c,d,e,f){"use strict";function g(a){b("QPLUserFlow").addPoint(b("qpl")._(25305590,"1127"),"mqtt_started",void 0);return[{topic:"/ls_app_settings",payload:JSON.stringify({ls_sv:a,ls_fdid:""}),qos:1}]}function h(a){var c=a.getConnectionState(),d=function(c,d){return new(b("Promise"))(function(e,f){b("promiseDone")(a.publish("/ls_req",c,{qos:b("bs_caml").i64_eq(d,b("LSRequestType.bs").fireForget)?0:1,skipBuffer:!1,listener:{onEvent:function(a){if(a==="NOT_CONNECTED")return f({RE_EXN_ID:b("LSPlatformRealtimeTransport.bs").NotConnected})}}}),function(a){return e(void 0)},function(a){return f(a)})})};if(c===b("MqttState.bs").connected)return[function(a){},d];var e={contents:function(a){}},f=new(b("Promise"))(function(a,b){e.contents=a}),g={onMQTTStateChanged:function(a){if(a===b("MqttState.bs").connected)return e.contents(void 0)}};a.subscribeChannelEvents(g);return[function(b){a.unsubscribeChannelEvents(g)},function(a,b){return f.then(function(c){return d(a,b)})}]}var i={contents:void 0};function a(a,c){if(!b("ExecutionEnvironment").canUseDOM)return b("LSPlatformDefaultUnderlyingApi.bs").defaultUnderlyingApi;var d={contents:!1},e=b("bs_curry")._1(c,void 0),f={getPublishMessages:function(b){return g(a)}};e.registerExtraConnectPayloadProvider(f);var j={onMQTTStateChanged:function(a){var b=i.contents;if(b!==void 0)return b(a)}};e.subscribeChannelEvents(j);var k=e.subscribe("/ls_foreground_state",function(a){});c=h(e);var l=c[0];return{subscribe:function(a){return e.subscribe("/ls_resp",function(c){d.contents||(b("QPLUserFlow").addPoint(b("qpl")._(25305590,"1127"),"mqtt_first_payload_received",void 0),b("qex")._("461")!==!0&&b("QPLUserFlow").endSuccess(b("qpl")._(25305590,"1127"),void 0),d.contents=!0);return a(c)})},onConnectionStatusChange:function(a){i.contents=a;return function(a){i.contents=void 0}},onReconnect:function(a){var c={contents:e.getConnectionState()},d={contents:c.contents===b("MqttState.bs").connected},f={onMQTTStateChanged:function(e){e===b("MqttState.bs").connected&&(d.contents&&c.contents!==b("MqttState.bs").connected&&a(),d.contents=!0),c.contents=e}};e.subscribeChannelEvents(f);return function(a){e.unsubscribeChannelEvents(f)}},publish:c[1],cleanup:function(){e.unregisterExtraConnectPayloadProvider(f);!b("killswitch")("MESSENGER_WEB_PERSISTED_DB")&&b("gkx")("3174")&&b("LSPersistedDbGating").oneMqttConnectionAcrossTabs&&b("bs_curry")._1(b("LSDedicatedMqttChannel.bs").shutdownAndClear,void 0);e.unsubscribeChannelEvents(j);b("bs_curry")._1(k,void 0);return b("bs_curry")._1(l,void 0)}}}f.sendSchemaVersion=g;f.makePublish=h;f.connectionHandler=i;f.make=a}),null);
__d("MessengerWebRegion.bs",["MessengerWebRegion","gkx","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";function a(a){a=b("MessengerWebRegion").regionNullable;if(a==null)if(b("gkx")("1993339"))return b("unrecoverableViolation")("Tried to load mailbox for a user that does not have a mailbox","messenger_web_product");else return"";else return a}f.getRegion=a}),null);
__d("LSPlatformInstagramConfig.bs",["ChannelClientID","CurrentUser","FBID.bs","IGDDB.bs","IGMqttChannel.bs","LSDatabaseType.bs","LSDatascriptEvaluatorMaybeDeferred","LSDict","LSJson","LSPlatformGraphQLLightspeedRequestForIGD","LSPlatformMqttRealtimeTransport.bs","LSSyncChannel.bs","LSTransaction.bs","LSVersion","MNetRankType.bs","MessengerWebRegion.bs","Promise","bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";var g={mnet_rank_types:[b("MNetRankType.bs").instagramDirectSearchNullstate].map((e=b("bs_caml_int64")).to_int32)},h=b("LSJson").stringify(new(b("LSDict"))([])),i=[2328,1316134911];i={groupId:e.zero,currentCursor:void 0,syncStatus:e.zero,syncParams:h,sendSyncParams:!0,minTimeToSyncTimestampMs:i,canIgnoreTimestamp:!1,priority:e.zero,lastSyncRequestTimestampMs:e.zero,regionHint:void 0,lastSyncCompletedTimestampMs:void 0,dataTraceId:void 0,initTraceTimestampMs:void 0,syncChannel:b("LSSyncChannel.bs").mqtt};function j(a){return b("LSTransaction.bs").run(a,function(a){var c,d,e;return b("Promise").all([a.table("sync_groups").put({groupId:(c=b("LSDatabaseType.bs")).mailbox,currentCursor:void 0,syncStatus:(d=b("bs_caml_int64")).zero,syncParams:h,sendSyncParams:!0,minTimeToSyncTimestampMs:d.neg_one,canIgnoreTimestamp:!1,priority:d.zero,lastSyncRequestTimestampMs:d.zero,regionHint:void 0,lastSyncCompletedTimestampMs:void 0,dataTraceId:void 0,initTraceTimestampMs:void 0,syncChannel:(e=b("LSSyncChannel.bs")).mqtt}),a.table("sync_groups").put({groupId:c.contact,currentCursor:void 0,syncStatus:d.zero,syncParams:h,sendSyncParams:!0,minTimeToSyncTimestampMs:d.neg_one,canIgnoreTimestamp:!1,priority:d.zero,lastSyncRequestTimestampMs:d.zero,regionHint:void 0,lastSyncCompletedTimestampMs:void 0,dataTraceId:void 0,initTraceTimestampMs:void 0,syncChannel:e.mqtt}),a.table("sync_groups").put({groupId:c.presence,currentCursor:void 0,syncStatus:d.zero,syncParams:h,sendSyncParams:!0,minTimeToSyncTimestampMs:d.neg_one,canIgnoreTimestamp:!1,priority:d.zero,lastSyncRequestTimestampMs:d.zero,regionHint:void 0,lastSyncCompletedTimestampMs:void 0,dataTraceId:void 0,initTraceTimestampMs:void 0,syncChannel:e.mqtt}),a.table("sync_groups").put({groupId:c.ranking,currentCursor:void 0,syncStatus:d.zero,syncParams:JSON.stringify(g),sendSyncParams:!0,minTimeToSyncTimestampMs:d.neg_one,canIgnoreTimestamp:!1,priority:d.zero,lastSyncRequestTimestampMs:d.zero,regionHint:void 0,lastSyncCompletedTimestampMs:void 0,dataTraceId:void 0,initTraceTimestampMs:void 0,syncChannel:e.mqtt}),a.table("sync_groups").put({groupId:c.settings,currentCursor:void 0,syncStatus:d.zero,syncParams:h,sendSyncParams:!0,minTimeToSyncTimestampMs:d.neg_one,canIgnoreTimestamp:!1,priority:d.zero,lastSyncRequestTimestampMs:d.zero,regionHint:void 0,lastSyncCompletedTimestampMs:void 0,dataTraceId:void 0,initTraceTimestampMs:void 0,syncChannel:e.mqtt}),a.table("network_requests").put({taskQueueName:"",syncDatabaseId:c.mailbox,epochId:void 0,networkTaskIdentifier:void 0,lastSentTimestampMs:d.zero,failureCount:d.zero,lastSyncRequestTimestampMs:d.zero,lastDelayedRequestTimestampMs:void 0}),a.table("network_requests").put({taskQueueName:"",syncDatabaseId:c.contact,epochId:void 0,networkTaskIdentifier:void 0,lastSentTimestampMs:d.zero,failureCount:d.zero,lastSyncRequestTimestampMs:d.zero,lastDelayedRequestTimestampMs:void 0}),a.table("network_requests").put({taskQueueName:"",syncDatabaseId:c.presence,epochId:void 0,networkTaskIdentifier:void 0,lastSentTimestampMs:d.zero,failureCount:d.zero,lastSyncRequestTimestampMs:d.zero,lastDelayedRequestTimestampMs:void 0}),a.table("network_requests").put({taskQueueName:"",syncDatabaseId:c.settings,epochId:void 0,networkTaskIdentifier:void 0,lastSentTimestampMs:d.zero,failureCount:d.zero,lastSyncRequestTimestampMs:d.zero,lastDelayedRequestTimestampMs:void 0})])},"readWrite").then(function(b){return a})}e=b("CurrentUser").getAppID();var k=b("MessengerWebRegion.bs").getRegion(void 0),l=b("ChannelClientID").getID();e=e==null?b("FBID.bs").ofStringExn("1217981644879628"):e;function a(){return b("IGDDB.bs").db.then(j)}function c(a){return b("LSPlatformMqttRealtimeTransport.bs").make(b("LSVersion"),b("IGMqttChannel.bs").getInstance)}function d(a){return b("LSDatascriptEvaluatorMaybeDeferred")()}k={region:k,deviceId:l,appId:e,schemaVersion:b("LSVersion"),numThreads:15,getDb:a,realtimeUnderylingTransport:c,getEval:d,executeGraphQLLightSpeedRequest:b("LSPlatformGraphQLLightspeedRequestForIGD"),previewWidthLarge:300,previewWidth:150,sendHardcodedInitSync:!0};l={contents:{TAG:2,_0:k}};e={taskQueueName:"",syncDatabaseId:b("bs_caml_int64").zero,epochId:void 0,networkTaskIdentifier:void 0,lastSentTimestampMs:b("bs_caml_int64").zero,failureCount:b("bs_caml_int64").zero,lastSyncRequestTimestampMs:b("bs_caml_int64").zero,lastDelayedRequestTimestampMs:void 0};f.syncRankingParams=g;f.defaultSyncGroup=i;f.defaultNetworkRequest=e;f.seed=j;f.config=k;f.configEagerlyLoaded=l}),null);
__d("LSPlatformInstagramConfig.re",["LSPlatformInstagramConfig.bs"],(function(a,b,c,d,e,f){a=b("LSPlatformInstagramConfig.bs").configEagerlyLoaded;f.configEagerlyLoaded=a}),null);
__d("MWChatStateV2.re",["MWChatStateV2.bs"],(function(a,b,c,d,e,f){a=b("MWChatStateV2.bs").make;f.make=a}),null);
__d("WebStorage.bs",["WebStorage","bs_caml_option"],(function(a,b,c,d,e,f){"use strict";var g;function a(a){return b("bs_caml_option").nullable_to_opt((g||(g=b("WebStorage"))).getLocalStorage())}function c(a){return b("bs_caml_option").nullable_to_opt((g||(g=b("WebStorage"))).getSessionStorage())}f.getLocalStorage=a;f.getSessionStorage=c}),null);
__d("MAWSessionStorage.bs",["MAWGating.bs","WebStorage.bs","bs_belt_Option","bs_caml_option"],(function(a,b,c,d,e,f){"use strict";var g="armadillo_msgr_recent_secure_thread_key",h=b("WebStorage.bs").getSessionStorage(void 0);function a(a){if(b("MAWGating.bs").isOccamadillo(void 0))return;else return b("bs_belt_Option").flatMap(h,function(a){return b("bs_caml_option").nullable_to_opt(a.getItem(g))})}function c(a){if(!b("MAWGating.bs").isOccamadillo(void 0))return b("bs_belt_Option").forEach(h,function(b){return b.setItem(g,a)})}function d(a){if(!b("MAWGating.bs").isOccamadillo(void 0))return b("bs_belt_Option").forEach(h,function(a){return a.removeItem(g)})}f.getMostRecentSecureThreadKey=a;f.setMostRecentSecureThreadKey=c;f.deleteMostRecentSecureThreadKey=d}),null);
__d("MAWThreadId.bs",["MAWGating.bs","MAWHexUtils","Promise","ReQL.bs","bs_caml_int64","bs_int64","recoverableViolation","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";var g=[-1,4294966296];function a(a){return b("MAWHexUtils").orderPreservingHex(a)}function c(a,c){if(b("MAWGating.bs").isOccamadillo(void 0))return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromIndexAscending(a.table("mi_act_mapping_table").index("chat_id")),{hd:b("bs_caml_int64").of_int32(c),tl:0})).then(function(a){if(a!==void 0)return a.serverThreadKey;else return b("unrecoverableViolation")("Tried to convert a rowId to thread key but couldn't find a\n          corresponding row in the mapping table. This can mean that\n          there is a race condition between the time a thread was created\n          on the WA backend, and the time it was inserted into the mapping table.\n          i.e. this function is called before the fn that inserts the mapping\n          into the mapping table","messenger_web_product")});else{return b("Promise").resolve((a=b("bs_caml_int64")).add(a.mul(a.of_int32(c),a.neg_one),g))}}function h(a){if(b("MAWGating.bs").isOccamadillo(void 0)){b("recoverableViolation")("Checking if a threadKey is a secure thread key in Occamadillo. We should be\n      checking the thread's thread type instead","messenger_web_product");return!1}else return b("bs_int64").compare(a,g)===-1}function i(a,c){if(b("MAWGating.bs").isOccamadillo(void 0))return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("mi_act_mapping_table")),{hd:c,tl:0})).then(function(a){if(a!==void 0)return b("bs_caml_int64").to_int32(a.clientThreadPk)});else return b("Promise").resolve(h(c)?b("bs_caml_int64").to_int32(b("bs_caml_int64").mul(b("bs_caml_int64").sub(c,g),b("bs_caml_int64").neg_one)):void 0)}function d(a,c){!b("MAWGating.bs").isOccamadillo(void 0)&&!h(c)&&b("recoverableViolation")("We are using a thread key which is not a ChatId as a ChatId. This will likely result in a privacy SEV","messenger_web_product");return i(a,c).then(function(a){if(a!==void 0)return{_0:a};else return 0})}f.orderPreservingHex=a;f.ofThreadKey=d;f.toThreadKey=c;f.isThreadId=h}),null);
__d("jsExtraRouteBuilder",["jsRouteBuilder","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,d,e){var f=c("jsRouteBuilder")(a,b,e),g=d.reduce(function(a,d){a===void 0&&(a={});typeof d==="string"&&(a[d]=c("jsRouteBuilder")(d,b,e,null,!0).buildURL);return a},{});return{buildExtraURL:function(a,b){if(typeof a!=="string"||g[a]==null)throw c("unrecoverableViolation")("Route builder for extra path does not exist","comet_infra");return g[a](b)},buildURL:function(a){return f.buildURL(a)}}}g["default"]=a}),98);
__d("XPolarisDirectInboxControllerRouteBuilder",["jsExtraRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsExtraRouteBuilder")("/direct/inbox/",Object.freeze({}),["/direct/t/{?thread_key}/","/direct/{?subpage}/{?folder}/"],void 0);b=a;g["default"]=b}),98);
__d("MWLSThreadDisplayContext.bs",["react"],(function(a,b,c,d,e,f){"use strict";var g,h=g||b("react"),i=h.createContext(void 0);function a(a){var b=a.children;a=a.value;return h.createElement(i.Provider,{value:a,children:b})}d={make:a};function c(a){return h.useContext(i)}f.context=i;f.Provider=d;f.useHook=c}),null);
__d("XCometArchivedThreadsControllerRouteBuilder",["jsExtraRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsExtraRouteBuilder")("/messages/archived/t/{thread_key}/",Object.freeze({}),["/messages/archived/"],void 0);b=a;g["default"]=b}),98);
__d("XMessengerDotComCometArchivedThreadsControllerRouteBuilder",["jsExtraRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsExtraRouteBuilder")("/archived/t/{thread_key}/",Object.freeze({}),["/archived/"],void 0);b=a;g["default"]=b}),98);
__d("MWInboxArchivedThreadsRouteBuilder.bs",["CurrentEnvironment","XCometArchivedThreadsControllerRouteBuilder","XMessengerDotComCometArchivedThreadsControllerRouteBuilder"],(function(a,b,c,d,e,f){"use strict";a=b("CurrentEnvironment").facebookdotcom?{buildURL:function(a){return b("XCometArchivedThreadsControllerRouteBuilder").buildURL(a)},buildURLWithoutThread:function(a){return b("XCometArchivedThreadsControllerRouteBuilder").buildExtraURL("/messages/archived/",a)}}:{buildURL:function(a){return b("XMessengerDotComCometArchivedThreadsControllerRouteBuilder").buildURL(a)},buildURLWithoutThread:function(a){return b("XMessengerDotComCometArchivedThreadsControllerRouteBuilder").buildExtraURL("/archived/",a)}};c=a.buildURL;d=a.buildURLWithoutThread;f.routeBuilderModule=a;f.buildURL=c;f.buildURLWithoutThread=d}),null);
__d("XCometMarketplaceThreadsControllerRouteBuilder",["jsExtraRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsExtraRouteBuilder")("/messages/marketplace/t/{thread_key}/",Object.freeze({}),["/messages/marketplace/"],void 0);b=a;g["default"]=b}),98);
__d("XMessengerDotComCometMarketplaceThreadsControllerRouteBuilder",["jsExtraRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsExtraRouteBuilder")("/marketplace/t/{thread_key}/",Object.freeze({}),["/marketplace/"],void 0);b=a;g["default"]=b}),98);
__d("MWInboxMarketplaceThreadsRouteBuilder.bs",["CurrentEnvironment","XCometMarketplaceThreadsControllerRouteBuilder","XMessengerDotComCometMarketplaceThreadsControllerRouteBuilder"],(function(a,b,c,d,e,f){"use strict";a=b("CurrentEnvironment").facebookdotcom?{buildURL:function(a){return b("XCometMarketplaceThreadsControllerRouteBuilder").buildURL(a)},buildURLWithoutThread:function(a){return b("XCometMarketplaceThreadsControllerRouteBuilder").buildExtraURL("/messages/marketplace/",a)}}:{buildURL:function(a){return b("XMessengerDotComCometMarketplaceThreadsControllerRouteBuilder").buildURL(a)},buildURLWithoutThread:function(a){return b("XMessengerDotComCometMarketplaceThreadsControllerRouteBuilder").buildExtraURL("/marketplace/",a)}};c=a.buildURL;d=a.buildURLWithoutThread;f.routeBuilderModule=a;f.buildURL=c;f.buildURLWithoutThread=d}),null);
__d("XCometMessageRequestsControllerRouteBuilder",["jsExtraRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsExtraRouteBuilder")("/messages/requests/t/{thread_key}/",Object.freeze({}),["/messages/requests/"],void 0);b=a;g["default"]=b}),98);
__d("XMessengerDotComCometMessageRequestsControllerRouteBuilder",["jsExtraRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsExtraRouteBuilder")("/requests/t/{thread_key}/",Object.freeze({}),["/requests/"],void 0);b=a;g["default"]=b}),98);
__d("MWInboxMessageRequestsRouteBuilder.bs",["CurrentEnvironment","XCometMessageRequestsControllerRouteBuilder","XMessengerDotComCometMessageRequestsControllerRouteBuilder"],(function(a,b,c,d,e,f){"use strict";a=b("CurrentEnvironment").facebookdotcom?{buildURL:function(a){return b("XCometMessageRequestsControllerRouteBuilder").buildURL(a)},buildURLWithoutThread:function(a){return b("XCometMessageRequestsControllerRouteBuilder").buildExtraURL("/messages/requests/",a)}}:{buildURL:function(a){return b("XMessengerDotComCometMessageRequestsControllerRouteBuilder").buildURL(a)},buildURLWithoutThread:function(a){return b("XMessengerDotComCometMessageRequestsControllerRouteBuilder").buildExtraURL("/requests/",a)}};c=a.buildURL;d=a.buildURLWithoutThread;f.routeBuilderModule=a;f.buildURL=c;f.buildURLWithoutThread=d}),null);
__d("XCometMessengerControllerRouteBuilder",["jsExtraRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsExtraRouteBuilder")("/messages/t/{?thread_key}/{?*extra_junk}/",Object.freeze({}),["/messages/archived/new/","/messages/filtered/","/messages/filtered/new/","/messages/filtered/t/{?thread_key}/","/messages/gallery/","/messages/groups/","/messages/groups/new/","/messages/groups/t/{?thread_key}/","/messages/people/","/messages/people/new/","/messages/people/t/{?thread_key}/","/messages/requests/new/","/messages/new/","/messages/read/","/messages/search/","/messages/search/t/{?thread_key}/","/messages/search/new/"],void 0);b=a;g["default"]=b}),98);
__d("XMessengerDotComCometMainControllerRouteBuilder",["jsExtraRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsExtraRouteBuilder")("/t/{thread_key}/",Object.freeze({}),["/archived/new/","/filtered/","/filtered/new/","/filtered/t/{?thread_key}/","/people/","/people/new/","/people/t/{?thread_key}/","/requests/new/","/new/","/folders/{folder_key}/t/{?thread_key}/","/gallery/"],void 0);b=a;g["default"]=b}),98);
__d("XMessengerDotComCometRootControllerRouteBuilder",["jsExtraRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsExtraRouteBuilder")("/",Object.freeze({no_rdr:!1}),["/t/"],void 0);b=a;g["default"]=b}),98);
__d("MWInboxRouteBuilder.bs",["CurrentEnvironment","XCometMessengerControllerRouteBuilder","XMessengerDotComCometMainControllerRouteBuilder","XMessengerDotComCometRootControllerRouteBuilder"],(function(a,b,c,d,e,f){"use strict";a=b("CurrentEnvironment").facebookdotcom?{buildURL:function(a){return b("XCometMessengerControllerRouteBuilder").buildURL(a)},buildHomeURL:function(a){return b("XCometMessengerControllerRouteBuilder").buildURL(a)},buildNewThreadURL:function(a){return b("XCometMessengerControllerRouteBuilder").buildExtraURL("/messages/new/",a)}}:{buildURL:function(a){return b("XMessengerDotComCometMainControllerRouteBuilder").buildURL(a)},buildHomeURL:function(a){return b("XMessengerDotComCometRootControllerRouteBuilder").buildExtraURL("/t/",a)},buildNewThreadURL:function(a){return b("XMessengerDotComCometMainControllerRouteBuilder").buildExtraURL("/new/",a)}};c=a.buildURL;d=a.buildHomeURL;e=a.buildNewThreadURL;f.routeBuilderModule=a;f.buildURL=c;f.buildHomeURL=d;f.buildNewThreadURL=e}),null);
__d("useMWV2ChatOpenTabTraceProvider",["CometHeroLogging","ODS","qpl","react","useCometInteractionTracing"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react").useCallback,i=!1;function j(a){return a===15||a===16}function a(){var a=c("useCometInteractionTracing")(c("qpl")._(30605380,"18"),"responsive","INTERACTION"),b=h(function(b,e,f,g){d("ODS").bumpEntityKey(3185,"mwchat_tab","open_tab_start");var h=j(e);a(function(a){var g=c("CometHeroLogging").genHeroInteractionUUIDAndMarkStart(a.getTraceId());a.onComplete(function(){d("ODS").bumpEntityKey(3185,"mwchat_tab","open_tab_completed"),a.addMetadata("threadType",e),a.addMetadata("entrypoint",f),a.addMetadata("version",2),a.addMetadata("isSecure",h?1:0),i?a.addMetadata("revisit",1):(a.addMetadata("revisit",0),i=!0)});b(g)},void 0,void 0,void 0,g)},[a]);return b}g["default"]=a}),98);
__d("MWV2OpenTabOrThread.bs",["CurrentEnvironment","LSThreadAttributionStore.bs","MAWGating.bs","MWChatInteraction.bs","MWChatStateActions.bs","MWChatStateV2.bs","MWInboxArchivedThreadsRouteBuilder.bs","MWInboxMarketplaceThreadsRouteBuilder.bs","MWInboxMessageRequestsRouteBuilder.bs","MWInboxRouteBuilder.bs","XCometMessengerControllerRouteBuilder","bs_belt_Option","bs_caml_int64","bs_caml_option","bs_curry","bs_int64","cr:1369","cr:2299","react","useCometEntityKey","useCometFeedNoRoutingNavigationEventLogger","useCometRouterDispatcher","useMWV2ChatOpenTabTraceProvider","useShouldShowMessagingEntrypointInCometRoot"],(function(a,b,c,d,e,f){"use strict";var g,h=g||b("react"),i=h.createContext(void 0);function a(a){var b=a.children;a=a.value;return h.createElement(i.Provider,{value:a,children:b})}d={make:a};var j=b("cr:1369")==null?void 0:b("bs_caml_option").some(b("cr:1369")),k=b("cr:2299")==null?void 0:b("bs_caml_option").some(b("cr:2299"));function l(a){var c=b("MWChatStateV2.bs").useDispatch(void 0),d=b("useCometFeedNoRoutingNavigationEventLogger")(),e=b("useMWV2ChatOpenTabTraceProvider")();return h.useCallback(function(a){return function(f,g){d(Date.now(),"","messenger");return e(function(d){b("MWChatInteraction.bs").set(b("bs_int64").to_string(a.threadKey),d);return b("bs_curry")._1(c,b("MWChatStateActions.bs").openTab(Date.now(),{shouldFocus:!0},{TAG:1,_0:a}))},b("bs_caml_int64").to_int32(a.threadType),g,b("bs_int64").to_string(a.threadKey))}},[c,d,e])}function c(a){var c=b("useShouldShowMessagingEntrypointInCometRoot")("CHAT"),d=b("useCometRouterDispatcher")(),e=h.useContext(i),f=l(void 0),g=b("bs_belt_Option").getWithDefault(b("bs_belt_Option").map(b("bs_caml_option").nullable_to_opt(b("useCometEntityKey")()),function(a){return b("bs_caml_option").nullable_to_opt(a.entity_type)}),void 0);return h.useMemo(function(){var a=b("bs_belt_Option").getWithDefault(e,function(a){var c=b("bs_int64").to_string(a);if(!(b("cr:2299")==null)&&!b("MAWGating.bs").isOccamadillo(void 0)&&b("bs_curry")._1(k.isThreadId,a))if(b("CurrentEnvironment").facebookdotcom)return b("XCometMessengerControllerRouteBuilder").buildURL({});else return"/";if(g===void 0)return b("bs_curry")._1(b("MWInboxRouteBuilder.bs").buildURL,{thread_key:c});switch(g){case"archived":return b("bs_curry")._1(b("MWInboxArchivedThreadsRouteBuilder.bs").buildURL,{thread_key:c});case"marketplace":return b("bs_curry")._1(b("MWInboxMarketplaceThreadsRouteBuilder.bs").buildURL,{thread_key:c});case"message_requests":return b("bs_curry")._1(b("MWInboxMessageRequestsRouteBuilder.bs").buildURL,{thread_key:c});default:return b("bs_curry")._1(b("MWInboxRouteBuilder.bs").buildURL,{thread_key:c})}}),h=function(c){c=c.threadKey;!(b("cr:2299")==null)&&!(b("cr:1369")==null)&&!b("MAWGating.bs").isOccamadillo(void 0)&&b("bs_curry")._1(k.isThreadId,c)&&b("bs_curry")._1(j.setMostRecentSecureThreadKey,b("bs_int64").to_string(c));if(!(d==null)){d.go(b("bs_curry")._1(a,c));return}},i=function(a,c){return b("LSThreadAttributionStore.bs").setSource(b("bs_int64").to_string(a.threadKey),c)};return{getUrlFromThreadKey:a,openInbox:function(a,b){i(a,b);return h(a)},openTabOrInbox:function(a,d,e){a=a!==void 0?a:!0;i(d,e);if(c)return b("bs_curry")._3(f,d,a,e);else return h(d)}}},[c,d,f])}f.Provider=d;f.$MAWSessionStorage$requireCondXplat=b("cr:1369");f.$MAWThreadId$requireCondXplat=b("cr:2299");f.useHook=c}),null);
__d("MWIGDPageSetup.react",["LSPlatformClientProviderWithImmediateLoadingStrategy.re","LSPlatformConfig.re","LSPlatformInstagramConfig.re","MWChatStateV2.re","MWIGDPageSetupReason.re","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function a(a){var b=a.children;a=a.placeholder;a=a===void 0?null:a;return h.jsx(d("LSPlatformConfig.re").Provider_make,{config:d("LSPlatformInstagramConfig.re").configEagerlyLoaded,children:h.jsx(d("LSPlatformClientProviderWithImmediateLoadingStrategy.re").make,{placeholder:a,children:h.jsx(c("MWChatStateV2.re").make,{children:h.jsx(c("MWIGDPageSetupReason.re").make,{refParam:void 0,threadKey:void 0,children:b})})})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MAWEncryptedBackupUtils.bs",["Promise","ReQL.bs"],(function(a,b,c,d,e,f){"use strict";function a(a){return b("ReQL.bs").first(b("ReQL.bs").fromTableAscending(a.table("secure_encrypted_backups_client_state"))).then(function(a){if(a===void 0)return b("Promise").resolve(void 0);a=a.backupTenancy;if(a!==void 0)return b("Promise").resolve(a);else return b("Promise").resolve(void 0)})}f.getBackupTenancy=a}),null);
__d("WAAssertUnreachable",[],(function(a,b,c,d,e,f){e.exports=function(a){throw new Error("Impossible value, the default statement should never be reached for value: "+a)}}),null);
__d("WAJids",["WAAssertUnreachable"],(function(a,b,c,d,e,f,g){var h=0,i="@me",j="@system",k="status@broadcast",l="0@s.whatsapp.net",m="@g.us",n=/^([1-9][0-9]{0,19}|(?!10)[1-9][0-9]{4,19}-[1-9][0-9]{9})@g.us$/,o="@msgr",p="msgr",aa="@call",q=/^([1-9][0-9]{0,19}(:[1-9][0-9]{0,2})?)@msgr$/,r=/^([1-9][0-9]{0,19})@msgr$/,s=/^([1-9][0-9]{0,19})(:0)?@msgr$/,ba="@s.whatsapp.net",ca="s.whatsapp.net",t="@s.whatsapp.net",da="s.whatsapp.net",ea="@call",u=/^(0|((?!10)[1-9][0-9]{4,19}(\.[0-9]{1,2})?(:[0-9]{1,2})))@s.whatsapp.net$/,v=/^(0|((?!10)[1-9][0-9]{4,19})(\.[0-9]{1,2})?)@s.whatsapp.net$/,w="@lid",fa="lid",x=/^([1-9][0-9]{0,14})@lid$/,y=/^([1-9][0-9]{0,14}(:[0-9]{1,2})?)@lid$/,ga="@broadcast",z=/^(status|location|[1-9][0-9]{0,19})@broadcast$/,A=/^([0-9a-fA-F]{18,32})@call$/,ha="16505361212"+t,ia=/([0-9a-zA-Z-:]+)@(g\.us|call|s\.whatsapp\.net|broadcast|msgr|lid)/g;function a(a){return""+a+t}function b(a){return""+a+w}function B(a){return""+a+o}function d(a){return a.endsWith(m)?a:""+a+m}function e(){return m}function C(a){if(a.endsWith(t))return a.slice(0,-t.length);else if(a.endsWith(o))return a.slice(0,-o.length);else if(a.endsWith(w))return a.slice(0,-w.length);else throw new Error('userIdFromJid called with non-user jid "'+a+'"')}function f(a,b){return T(C(a)+":"+b+t)}function ja(a,b){return U(C(a)+":"+b+o)}function D(a,b){return V(I(a)+":"+b+w)}function ka(a,b){return S(C(a)+":"+b+R(a))}function la(a){return""+a+ga}function E(a){return a.split("@")[0]}function F(a){a=a.split("@")[0];a=a.split(":");var b=a[0];a=a[1];a=parseInt(a,10);return{userId:b,deviceID:a}}function G(a){a=F(a);return a.deviceID}function ma(a,b){if(a===i||a===j)return b;else return E(a)}function na(a){return a===i||a===j?null:a}function oa(a){if(a===i||a===j)return null;return!a.endsWith(t)?null:a}function pa(a){if(!a.endsWith(t))throw new Error('phoneNumberFromJid called with non-user jid "'+a+'"');return a.slice(0,-t.length)}function H(a){return a.endsWith(t)||a.endsWith(o)||a.endsWith(w)?a:null}function qa(a){return a.endsWith(t)?a:null}function ra(a){return a===k?null:Z(a)}function sa(a){return a===k?null:Z(a)}function ta(a){return a===k?k:null}function I(a){if(!a.endsWith(w))throw new Error('lidFromLidUserJid called with non-LidUserJid "'+a+'"');return a.slice(0,-w.length)}function J(a){a=a.split("@");var b=a[0];a=a[1];b=b.split(":")[0];b=b.split(".")[0];return W(b+"@"+a)}function ua(a){return J(a)}function va(a){if(a.jidType==="phoneDevice")return a.deviceJid;else if(a.jidType==="lidDevice")return a.deviceJid;else if(a.jidType==="msgrDevice")return a.deviceJid;else if(a.jidType==="lidUser")return a.userJid;else if(a.jidType==="msgrUser")return a.userJid;else if(a.jidType==="phoneUser")return a.userJid;else if(a.jidType==="group")return a.groupJid;else if(a.jidType==="status")return a.statusJid;else if(a.jidType==="call")return a.callJid;else{a.jidType;return a.broadcastJid}}function wa(a){return T(C(a)+":"+h+t)}function xa(a){return U(C(a)+":"+h+o)}function ya(a){return D(a,h)}function za(a){return G(a)===h}function Aa(a){return $(a)}function Ba(a){return a}function K(a){a=a.split("@");var b=a[0];a=a[1];b=b.split(":");var c=b[0];b=b[1];c=c.split(".");var d=c[0];c=c[1];return{user:d,device:b,agent:c,server:a}}function Ca(a){a=K(a);var b=a.user,c=a.agent;c=c===void 0?"0":c;var d=a.device;d=d===void 0?"0":d;a=a.server;return b+"."+c+":"+d+"@"+a}function L(a){switch(a.jidType){case"lidUser":return a.userJid;case"msgrUser":return a.userJid;case"phoneUser":return a.userJid;case"group":return a.groupJid;case"status":return a.statusJid;case"lidDevice":return a.deviceJid;case"msgrDevice":return a.deviceJid;case"phoneDevice":return a.deviceJid;case"broadcast":return a.broadcastJid;case"call":return a.callJid;default:return c("WAAssertUnreachable")(a.jidType)}}function M(a){if(a===k)return{jidType:"status",statusJid:k};else if(v.test(a))return{jidType:"phoneUser",userJid:X(a)};else if(r.test(a))return{jidType:"msgrUser",userJid:Y(a)};else if(s.test(a)){var b=a.substr(0,a.indexOf(":"));return{jidType:"msgrUser",userJid:B(b)}}else if(u.test(a))return{jidType:"phoneDevice",deviceJid:T(a)};else if(q.test(a))return{jidType:"msgrDevice",deviceJid:U(a)};else if(n.test(a))return{jidType:"group",groupJid:a.endsWith(m)?a:""+a+m};else if(z.test(a))return{jidType:"broadcast",broadcastJid:a};else if(A.test(a))return{jidType:"call",callJid:a};else if(x.test(a))return{jidType:"lidUser",userJid:a};else if(y.test(a))return{jidType:"lidDevice",deviceJid:a};else return{jidType:"unknown"}}function Da(a){return a==="status@broadcast"?a:null}function Ea(a){if(v.test(a)||r.test(a)||x.test(a))return a;else if(s.test(a)){a=a.substr(0,a.indexOf(":"));return B(a)}else return null}function Fa(a){return z.test(a)?a:null}function Ga(a){return u.test(a)||q.test(a)||y.test(a)?a:null}function Ha(a){return n.test(a)?a:null}function Ia(a){return A.test(a)?a:null}function Ja(a){return a==="s.whatsapp.net"||a==="g.us"?a:null}function Ka(a){return H(a)==null?Z(a):null}function La(a){a=K(a);var b=a.user,c=a.device;c=c===void 0?"0":c;a=a.server;return T(b+":"+c+"@"+a)}function Ma(a){if(a.endsWith(m))return a.slice(0,-m.length);else throw new Error('groupId called with non-group jid "'+a+'"')}function N(a){var b=M(a);if(b.jidType==="unknown")return a;if(b.jidType==="status")return b.statusJid;b.jidType;return L(b).replace(/^([^@]*)([^@][^@][^@][^@])@(.*)$/,"...$2@$3")}function Na(a){return!a.includes("@")?a:a.replace(ia,N)}function O(a){if(a.endsWith(m))return Z(a);else return null}function P(a,b){if(a.endsWith(t))return b.phoneUser(a);else if(a.endsWith(o))return b.msgrUser(a);else if(a.endsWith(w))return b.lidUser(a);else if(O(a)!=null)return b.group(Z(a));throw new Error("Can not switch on chat jid "+a)}function Oa(a,b){if(a.endsWith(o))return b.user(a);else if(O(a)!=null)return b.group(a);throw new Error("Can not switch on chat jid "+a)}function Q(a,b){if(a.endsWith(t))return b.user(a);else if(O(a)!=null)return b.group(a);throw new Error("Can not switch on chat jid "+a)}function Pa(a,b){return a===k?b.status():Q(a,{user:b.user,group:b.group})}function Qa(a,b){return a===k?b.status():P(a,{phoneUser:b.phoneUser,msgrUser:b.msgrUser,lidUser:b.lidUser,group:b.group})}function Ra(a,b){return a===k?b.multicast(k):Q(a,{user:b.user,group:b.multicast})}function Sa(a){return a==="@me"}function Ta(a){return a==="@system"}function Ua(){return o}function Va(){return t}function Wa(){return ba}function R(a){if(a.endsWith(t))return t;else if(a.endsWith(o))return o;else if(a.endsWith(w))return w;else throw new Error('userDomainFromJid called with non-user jid "'+a+'"')}function Xa(a){return S(C(a)+":"+h+R(a))}function Ya(a){a=a.platform;var b=a==="msgr"?o:t,c=a==="msgr"?aa:ea;function d(a){return""+a+b}function e(){return b}function f(){return c}return{toUserJid:d,getUserDomain:e,getGroupCallDomain:f}}function S(a){return a}function T(a){return a}function U(a){return a}function V(a){return a}function W(a){return a}function X(a){return a}function Y(a){return a}function Z(a){return a}function $(a){return a}g.DEFAULT_DEVICE_ID=h;g.AUTHOR_ME=i;g.AUTHOR_SYSTEM=j;g.STATUS_JID=k;g.PSA_JID=l;g.MSGR_USER_DOMAIN=o;g.MSGR_USER_JID_SUFFIX=p;g.WA_SERVER_JID_SUFFIX=ca;g.WA_USER_DOMAIN=t;g.WA_USER_JID_SUFFIX=da;g.LID_DOMAIN=w;g.LID_SUFFIX=fa;g.SURVEY_USER_JID=ha;g.toPhoneUserJid=a;g.toLidUserJid=b;g.toMsgrUserJid=B;g.toGroupJid=d;g.getGroupDomain=e;g.userIdFromJid=C;g.toPhoneDeviceJid=f;g.toMsgrDeviceJid=ja;g.toLidDeviceJid=D;g.toDeviceJid=ka;g.toBroadcastJid=la;g.extractUserId=E;g.extractDeviceIDParts=F;g.extractDeviceId=G;g.authorToUserId=ma;g.authorAsUserJid=na;g.authorAsPhoneUserJid=oa;g.phoneNumberFromJid=pa;g.interpretAsUserJid=H;g.interpretAsPhoneUserJid=qa;g.asChatJid=ra;g.asPhoneChatJid=sa;g.asStatusJid=ta;g.lidFromLidUserJid=I;g.extractUserJid=J;g.extractPhoneUserJid=ua;g.extractJidFromJidWithType=va;g.defaultPhoneDeviceJidForUser=wa;g.defaultMsgrDeviceJidForUser=xa;g.defaultLidDeviceJidForLidUserJid=ya;g.isPrimaryDevice=za;g.interpretAsDeviceId=Aa;g.interpretAsNumber=Ba;g.parseJidParts=K;g.fullFormDeviceJidString=Ca;g.extractFromJid=L;g.interpretAndValidateJid=M;g.validateStatusJid=Da;g.validateUserJid=Ea;g.validateBroadcastJid=Fa;g.validateDeviceJid=Ga;g.validateGroupJid=Ha;g.validateCallJid=Ia;g.validateDomainJid=Ja;g.asMulticastJid=Ka;g.stripAgentIdFromPhoneDeviceJid=La;g.groupIdFromJid=Ma;g.sanitizeJidForLogging=N;g.maybeSanitizeLogLineText=Na;g.interpretAsGroupJid=O;g.switchOnChatJidType=P;g.switchOnMsgrChatJidType=Oa;g.switchOnPhoneChatJidType=Q;g.switchOnPhoneJidType=Pa;g.switchOnJidType=Qa;g.switchOnMulticastJidType=Ra;g.isAuthorMe=Sa;g.isAuthorSystem=Ta;g.getMsgrUserDomain=Ua;g.getWhatsappUserDomain=Va;g.getServerDomain=Wa;g.defaultDeviceJidForUser=Xa;g.createJidUtils=Ya;g.unsafeCoerceToDeviceJid=S;g.unsafeCoerceToPhoneDeviceJid=T;g.unsafeCoerceToMsgrDeviceJid=U;g.unsafeCoerceToLidDeviceJid=V;g.unsafeCoerceToUserJid=W;g.unsafeCoerceToPhoneUserJid=X;g.unsafeCoerceToMsgrUserJid=Y;g.unsafeCoerceToGroupJid=Z;g.unsafeCoerceToDeviceId=$}),98);
__d("WAHex",[],(function(a,b,c,d,e,f){var g=16,h=[48,49,50,51,52,53,54,55,56,57,65,66,67,68,69,70],i=[48,49,50,51,52,53,54,55,56,57,97,98,99,100,101,102];function a(a){a=new Uint8Array(a);self.crypto.getRandomValues(a);return j(a)}function j(a){var b=[];for(var c=0;c<a.length;c++){var d=a[c];b.push(h[d>>4],h[d&15])}return String.fromCharCode.apply(String,b)}function b(a){var b=[];for(var c=0;c<a.length;c++){var d=a[c];b.push(i[d>>4],i[d&15])}return String.fromCharCode.apply(String,b)}function c(a){a=l(a);if(a.length%2!==0)throw new Error('parseHex given hex "'+a+'" which is not a multiple of 8-bits.');var b=new Uint8Array(a.length>>1);for(var c=0,d=0;c<a.length;c+=2,d++)b[d]=k(a,c)<<4|k(a,c+1);return b.buffer}function k(a,b){a=a.charCodeAt(b);if(a<=57)return a-48;else if(a<=70)return 10+a-65;else return 10+a-97}function l(a){if(/[^0-9a-fA-F]/.test(a))throw new Error('"'+a+'" is not a valid hex');return a}function d(a){var b=a.buffer;return a.byteOffset===0&&a.length===b.byteLength?b:b.slice(a.byteOffset,a.byteOffset+a.length)}function e(a){var b=!0,c=a.length;while(b&&c){var d=a[--c];b=32<=d&&d<127}if(b)return JSON.stringify(String.fromCharCode.apply(String,a));else return j(a)}function m(a,b){b===void 0&&(b=!1);a=l(a);u(a,g);return(b?"-":"")+"0x"+o(a,g)}function n(a,b,c){c===void 0&&(c=!1);a=v(a);b=v(b);return(c?"-":"")+"0x"+a+b}function o(a,b){b=b-a.length;a=a;for(var c=0;c<b;c++)a="0"+a;return a}function p(a){var b=a<0;a=b?(-a).toString(16):a.toString(16);return m(a,b)}function q(a){return a.substring(a.indexOf("0x")+2)}function r(a){return a[0]==="-"}function s(a,b){var c=r(a),d=r(b);if(c!==d)return!c;d=q(a)>q(b);return c?!d:d}function t(a){return r(a)?a.slice(1):"-"+a}function u(a,b){if(a.length>b)throw new Error('"'+a+'" is longer than '+b*4+" bits.")}function v(a){if(a>4294967295||a<-4294967296)throw new Error("uint32ToLowerCaseHex given number over 32 bits");a=(a>=0?a:4294967296+a).toString(16);return o(a,8)}f.NUM_HEX_IN_LONG=g;f.HEX_LOWER=i;f.randomHex=a;f.toHex=j;f.toLowerCaseHex=b;f.parseHex=c;f.hexAt=k;f.hexOrThrow=l;f.bytesToBuffer=d;f.bytesToDebugString=e;f.createHexLong=m;f.createHexLongFrom32Bits=n;f.hexLongFromNumber=p;f.hexLongToHex=q;f.hexLongIsNegative=r;f.isBiggerHexLong=s;f.negateHexLong=t}),66);
__d("WATimeUtils",["Promise","WAHex"],(function(a,b,c,d,e,f,g){var h=60*60,i=24*h,j=7*i,k=365*i,l=60*1e3,m=h*1e3,n=24*m,o=7*n,p=1<<31,q=~p,r=p+1,s={time:0,day:-4},t=0;function a(){return t}function c(a){t=a}function e(a){return Q(a).toUTCString()}function u(a){a=a|0;return Math.max(r,Math.min(a,q))}function f(a){if(typeof a!=="number")if(d("WAHex").hexLongIsNegative(a))return r;else return q;else return u(a)}function v(a){return a<r||a>q}function w(a,b){var c=B();a=Math.max(a+b-c,0);return Math.min(1e3*a,~(1<<31))}function x(a,b){b=b!=null?b:B();return u(Math.ceil(b+Math.max(a,0)))}function y(a,b){b=b!=null?b:B();return u(Math.ceil(b-Math.max(a,0)))}function z(a){a=Math.max(a-B(),0);return Math.min(1e3*a,~(1<<31))}function A(a){var c=z(a);return new(b("Promise"))(function(a){return void setTimeout(a,c)})}function B(){return u(Date.now()/1e3-t)}function C(){return u(Date.now()/1e3)}function D(){return u(new Date().setHours(0,0,0,0)/1e3-t)}function E(a){return u(Q(a).setHours(0,0,0,0)/1e3-t)}function F(){return Date.now()-t*1e3}function G(a){return Math.max(a-B(),0)}function H(a){return G(a)>0}function I(){return performance.now()}function J(a){return Math.floor(performance.now()-a)}function K(a,b){return a<b?a:b}var L=function(){function a(){var a=I();this.$1=a;this.$2=a}var b=a.prototype;b.reset=function(){this.$2=I()};b.elapsed=function(){return J(this.$2)};b.cumulative=function(){return J(this.$1)};return a}();function M(a){return Math.max(B()-a,0)}function N(){return new Date()}function O(a,b,c){return Math.abs(a-b)<=c}function P(a,b){return O(B(),a,b)}function Q(a){return new Date(a*1e3)}function R(a,b){if(Math.abs(a-b)>i)return!1;a=s.time===a?s.day:Q(a+t).getDay();var c=s.time===b?s.day:Q(b+t).getDay();s.time=b;s.day=c;return a===c}function S(a){a=a-B();return a<=i}function T(){return Date.now()}g.HOUR_SECONDS=h;g.DAY_SECONDS=i;g.WEEK_SECONDS=j;g.YEAR_SECONDS=k;g.MINUTE_MILLISECONDS=l;g.HOUR_MILLISECONDS=m;g.DAY_MILLISECONDS=n;g.WEEK_MILLISECONDS=o;g.DUMMY_UNIXTIME=p;g.MAX_INT=q;g.getClockSkew=a;g.setClockSkew=c;g.toHttpHeaderDate=e;g.castToUnixTime=u;g.castLongIntToUnixTime=f;g.isOverflowTime=v;g.timeoutFor=w;g.futureUnixTime=x;g.pastUnixTime=y;g.cappedMillisecondsUntil=z;g.delayUntil=A;g.unixTime=B;g.unixTimeWithoutClockSkewCorrection=C;g.midnight=D;g.midnightOn=E;g.unixTimeMs=F;g.secondsUntil=G;g.isInFuture=H;g.monotonicTime=I;g.monotonicTimeSince=J;g.oldest=K;g.MonotonicTimer=L;g.timeSince_USE_ONLY_IF_APPROVED=M;g.unskewedDate_USE_ONLY_IF_APPROVED=N;g.happenedWithinAt=O;g.happenedWithin=P;g.toDate=Q;g.sameDay=R;g.isWithinNext24h=S;g.performanceAbsoluteNow=T}),98);
__d("bs_js_exn",["bs_caml_js_exceptions"],(function(a,b,c,d,e,f){"use strict";var g=b("bs_caml_js_exceptions").internalToOCamlException;function a(a){throw new Error(a)}function c(a){throw new EvalError(a)}function d(a){throw new RangeError(a)}function e(a){throw new ReferenceError(a)}function h(a){throw new SyntaxError(a)}function i(a){throw new TypeError(a)}function j(a){throw new URIError(a)}b=b("bs_caml_js_exceptions").$$Error;f.$$Error=b;f.anyToExnInternal=g;f.raiseError=a;f.raiseEvalError=c;f.raiseRangeError=d;f.raiseReferenceError=e;f.raiseSyntaxError=h;f.raiseTypeError=i;f.raiseUriError=j}),null);
__d("Crypto.bs",["bs_js_exn"],(function(a,b,c,d,e,f){"use strict";function a(a){return new Uint8Array(a)}function g(a){var b=new TextEncoder();return b.encode(a)}function h(a){var b=new TextDecoder();return b.decode(a)}function c(a){return h(new Uint8Array(a))}function d(a){return g(a).buffer}function e(a,c){var d=a.byteLength,e=c.byteLength;d!==e&&b("bs_js_exn").raiseError("Mismatched lengths for modAdd, "+d+" != "+e);var f=new Uint8Array(d);new Uint8Array(d).reduceRight(function(b,d,e){d=a[e];var g=c[e];d=(d+g|0)+b|0;g=d>255?[d-256|0,1]:[d,0];f[e]=g[0];return g[1]},0);return f}function i(a){return crypto.getRandomValues(a)}function j(a){return crypto.getRandomValues(a)}function k(a,b,c){return crypto.subtle.encrypt(a,b,c)}function l(a,b,c){return crypto.subtle.decrypt(a,b,c)}function m(a,b,c,d,e){return crypto.subtle.importKey(a,b,c.VAL,d,e)}function n(a,b,c){return crypto.subtle.sign(a,b,c)}function o(a,b){return crypto.subtle.exportKey(a,b)}function p(a,b,c){return crypto.subtle.generateKey(a.VAL,b,c)}function q(a,b,c,d,e){return crypto.subtle.deriveKey(a.VAL,b,c.VAL,d,e)}function r(a,b,c){return crypto.subtle.deriveBits(a.VAL,b,c)}function s(a,b){return crypto.subtle.digest(a,b)}a={bufToUint8:a,strToUint8:g,uint8ToStr:h,strToBuf:d,modAddBytes:e,bufToStr:c};f.getRandomValues=i;f.getRandomValues32=j;f.encrypt=k;f.decrypt=l;f.importKey=m;f.sign=n;f.exportKey=o;f.generateKey=p;f.deriveKey=q;f.deriveBits=r;f.digest=s;f.Utils=a}),null);
__d("OfflineThreadingId.bs",["Crypto.bs","bs_caml_int64","bs_int64"],(function(a,b,c,d,e,f){"use strict";function a(a){var c=(a=b("bs_caml_int64")).of_float(Date.now()),d=b("Crypto.bs").getRandomValues(new Uint8Array(8));d=new DataView(d.buffer);d=a.add(a.lsl_(a.of_int32(d.getUint32(0)),32),a.of_int32(d.getUint32(4)));return b("bs_int64").to_string(a.and_(a.or_(a.lsl_(c,22),a.and_(d,[0,4194303])),a.max_int))}f.make=a}),null);
__d("OfflineThreadingId.re",["OfflineThreadingId.bs"],(function(a,b,c,d,e,f){a=b("OfflineThreadingId.bs").make;f.make=a}),null);
__d("WAMsgType",[],(function(a,b,c,d,e,f){a="Text";b="Futureproof";c="Ciphertext";d="Unavailable";e="Image";var g="Video",h="Ptt",i="Admin",j="Revoked",k="Gif",l="Sticker",m="ExpiredEphemeral",n="EphemeralSettingAdmin",o="EphemeralSyncResponse",p="EphemeralScreenshotAction",q="DeleteForMe",r="EphemeralSettingChangeFromCurrentDevice",s="AlertICDC",t="GroupInvite",u="XMA",v="Reaction",w={TEXT:a,FUTUREPROOF:b,CIPHERTEXT:c,UNAVAILABLE:d,EXPIRED_EPHEMERAL:m,IMAGE:e,VIDEO:g,PTT:h,ADMIN:i,REVOKED:j,GIF:k,STICKER:l,EPHEMERAL_SETTING_ADMIN:n,EPHEMERAL_SYNC_RESPONSE:o,EPHEMERAL_SCREENSHOT_ACTION:p,DELETE_FOR_ME:q,EPHEMERAL_SETTING_CHANGE_FROM_CURRENT_DEVICE:r,ICDC_ALERT:s,GROUP_INVITE:t,XMA:u,REACTION:v},x=new Set([w.TEXT,w.IMAGE,w.VIDEO,w.PTT,w.GIF,w.STICKER,w.UNAVAILABLE,w.EXPIRED_EPHEMERAL,w.XMA]),y=function(a){return x.has(a)};f.TEXT=a;f.FUTUREPROOF=b;f.CIPHERTEXT=c;f.UNAVAILABLE=d;f.IMAGE=e;f.VIDEO=g;f.PTT=h;f.ADMIN=i;f.REVOKED=j;f.GIF=k;f.STICKER=l;f.EXPIRED_EPHEMERAL=m;f.EPHEMERAL_SETTING_ADMIN=n;f.EPHEMERAL_SYNC_RESPONSE=o;f.EPHEMERAL_SCREENSHOT_ACTION=p;f.DELETE_FOR_ME=q;f.EPHEMERAL_SETTING_CHANGE_FROM_CURRENT_DEVICE=r;f.ICDC_ALERT=s;f.GROUP_INVITE=t;f.XMA=u;f.REACTION=v;f.MSG_TYPE=w;f.isQuotedMsgType=y}),66);
__d("bs_js_mapperRt",[],(function(a,b,c,d,e,f){"use strict";function a(a){if(a==null)throw{RE_EXN_ID:"Not_found",Error:new Error()};return a}function b(a,b,c){var d=0;while(!0){var e=d;if(e===a)return;var f=b[e];if(f===c)return e;d=e+1|0;continue}}function c(a,b,c){var d=0;while(!0){var e=d;if(e===a)throw{RE_EXN_ID:"Not_found",Error:new Error()};var f=b[e];if(f===c)return e;d=e+1|0;continue}}f.raiseWhenNotFound=a;f.fromInt=b;f.fromIntAssert=c}),null);
__d("MAWBridgeNewXMAHandler.bs",["MAWDbMsg","MAWThreadId.bs","MAWXMA.bs","MessagingAttachmentType.bs","Promise","ReQL.bs","bs_belt_Array","bs_belt_Option","bs_caml_int64","bs_caml_option"],(function(a,b,c,d,e,f){"use strict";function g(a,c){if(a===void 0)return;a=b("bs_belt_Array").get(a,c-1|0);if(a===void 0)return;c=a.buttonType;if(c!==void 0)return b("MAWXMA.bs").extendedContentCTAButtonTypeToLSCTAType(c)}function h(a,c){if(a===void 0)return;a=b("bs_belt_Array").get(a,c-1|0);if(a!==void 0)return a.title}function i(a,c){return b("MAWThreadId.bs").toThreadKey(a,c.threadId).then(function(d){var e=String(c.xmaId),f=c.msgId;if(f!==void 0)return b("ReQL.bs").first(b("ReQL.bs").fromTableDescending(a.table("attachment_ctas"))).then(function(g){var h=g!==void 0?b("bs_caml_int64").add(g.ctaId,b("bs_caml_int64").one):b("bs_caml_int64").one;g=c.defaultCTA;if(g===void 0)return b("Promise").resolve([void 0,h]);var i=g.actionUrl,j=g.nativeUrl;return a.table("attachment_ctas").add({ctaId:h,attachmentFbid:e,attachmentIndex:b("bs_caml_int64").zero,threadKey:d,messageId:f,title:b("bs_belt_Option").getWithDefault(g.title,""),type_:"xma_web_url",platformToken:void 0,actionUrl:i!==void 0?i:g.nativeUrl,nativeUrl:j!==void 0?j:g.actionUrl,urlWebviewType:void 0,actionContentBlob:void 0,enableExtensions:!1,extensionHeightType:void 0,targetId:void 0}).then(function(a){return b("Promise").resolve([h,h])})}).then(function(g){var h=g[1],i=g[0],j=[];g=c.ctas;if(g===void 0)return b("Promise").resolve([i,[]]);g=g.map(function(c,g){g=b("bs_caml_int64").add(h,b("bs_caml_int64").of_int32(g+1|0));j.push(g);var i=c.actionUrl,k=c.nativeUrl;return a.table("attachment_ctas").add({ctaId:g,attachmentFbid:e,attachmentIndex:b("bs_caml_int64").zero,threadKey:d,messageId:f,title:b("bs_belt_Option").getWithDefault(c.title,"Tap to view status update"),type_:"xma_web_url",platformToken:void 0,actionUrl:i!==void 0?i:c.nativeUrl,nativeUrl:k!==void 0?k:c.actionUrl,urlWebviewType:void 0,actionContentBlob:void 0,enableExtensions:!1,extensionHeightType:void 0,targetId:void 0})});return b("Promise").all(g).then(function(a){return b("Promise").resolve([i,j])})}).then(function(i){var j=i[1],k=b("bs_caml_int64").of_int32(b("MAWDbMsg").getInChatMsgIdFromMsgId(f)),l=b("MAWXMA.bs").ExtendedContentTargetType.tFromJs(c.targetType),m,n=0;l===13?m={width:[0,72],height:[0,108],xmaContentType:"xma_montage_share"}:n=1;n===1&&(m={width:b("bs_belt_Option").map(b("bs_caml_option").nullable_to_opt(c.previewWidth),b("bs_caml_int64").of_int32),height:b("bs_belt_Option").map(b("bs_caml_option").nullable_to_opt(c.previewHeight),b("bs_caml_int64").of_int32),xmaContentType:"xma_web_url"});return a.table("attachments").add({threadKey:d,timestampMs:k,messageId:f,offlineAttachmentId:e,attachmentFbid:e,attachmentType:b("MessagingAttachmentType.bs").xma,originalPageSenderId:void 0,filename:void 0,filesize:b("bs_belt_Option").map(c.filesize,b("bs_caml_int64").of_int32),hasMedia:!1,isSharable:!0,hasXma:!0,xmaLayoutType:b("bs_belt_Option").map(c.xmaLayoutType,b("bs_caml_int64").of_int32),xmasTemplateType:b("bs_belt_Option").map(c.xmaLayoutType,b("bs_caml_int64").of_int32),defaultCtaId:i[0],defaultCtaTitle:b("bs_belt_Option").getWithDefault(b("bs_belt_Option").map(c.defaultCTA,function(a){return a.title}),void 0),defaultCtaType:m.xmaContentType,attachmentCta1Id:b("bs_belt_Array").get(j,0),cta1Title:h(c.ctas,1),cta1Type:g(c.ctas,1),attachmentCta2Id:b("bs_belt_Array").get(j,1),cta2Title:h(c.ctas,2),cta2Type:g(c.ctas,2),attachmentCta3Id:b("bs_belt_Array").get(j,2),cta3Title:h(c.ctas,3),cta3Type:g(c.ctas,3),playableUrl:void 0,playableUrlFallback:void 0,playableUrlExpirationTimestampMs:void 0,playableUrlMimeType:void 0,dashManifest:void 0,previewUrl:void 0,previewUrlFallback:void 0,previewUrlExpirationTimestampMs:void 0,previewUrlMimeType:void 0,miniPreview:void 0,previewWidth:m.width,previewHeight:m.height,imageUrl:void 0,imageUrlFallback:void 0,imageUrlExpirationTimestampMs:void 0,imageUrlMimeType:void 0,actionUrl:void 0,titleText:c.titleText,subtitleText:c.subtitleText,maxTitleNumOfLines:b("bs_belt_Option").map(c.maxTitleNumOfLines,b("bs_caml_int64").of_int32),maxSubtitleNumOfLines:b("bs_belt_Option").map(c.maxSubtitleNumOfLines,b("bs_caml_int64").of_int32),descriptionText:void 0,sourceText:void 0,attributionAppId:void 0,attributionAppName:void 0,attributionAppIcon:void 0,attributionAppIconFallback:void 0,attributionAppIconUrlExpirationTimestampMs:void 0,localPlayableUrl:void 0,playableDurationMs:void 0,attachmentIndex:b("bs_caml_int64").zero,faviconUrl:void 0,faviconUrlFallback:void 0,faviconUrlExpirationTimestampMs:void 0,decryptionKey:void 0,accessibilitySummaryText:void 0,isPreviewImage:void 0,listItemsId:void 0,listItemsDescriptionText:void 0,listItemsSecondaryDescriptionText:void 0,listItemId1:void 0,listItemTitleText1:void 0,listItemContactUrlList1:void 0,listItemProgressBarFilledPercentage1:void 0,listItemContactUrlExpirationTimestampList1:void 0,listItemContactUrlFallbackList1:void 0,listItemAccessibilityText1:void 0,listItemId2:void 0,listItemTitleText2:void 0,listItemContactUrlList2:void 0,listItemProgressBarFilledPercentage2:void 0,listItemContactUrlExpirationTimestampList2:void 0,listItemContactUrlFallbackList2:void 0,listItemAccessibilityText2:void 0,listItemId3:void 0,listItemTitleText3:void 0,listItemContactUrlList3:void 0,listItemProgressBarFilledPercentage3:void 0,listItemContactUrlExpirationTimestampList3:void 0,listItemContactUrlFallbackList3:void 0,listItemAccessibilityText3:void 0,originalFileHash:void 0,isBorderless:void 0,headerImageUrl:void 0,headerImageUrlFallback:void 0,headerImageUrlExpirationTimestampMs:void 0,headerImageUrlMimeType:void 0,headerTitle:void 0,previewImageDecorationType:void 0,shouldHighlightHeaderTitleInTitle:void 0,targetId:void 0,shouldRespectServerPreviewSize:void 0,authorityLevel:b("bs_caml_int64").zero,ephemeralMediaState:void 0,viewerSeenTimestampMs:void 0,shouldAutoplayVideo:void 0,previewUrlLarge:void 0,previewWidthLarge:b("bs_belt_Option").map(b("bs_caml_option").nullable_to_opt(c.previewWidthLarge),b("bs_caml_int64").of_int32),previewHeightLarge:b("bs_belt_Option").map(b("bs_caml_option").nullable_to_opt(c.previewHeightLarge),b("bs_caml_int64").of_int32),subtitleIconUrl:void 0,preheaderText:void 0,listItemsDescriptionSubtitleText:void 0,avatarViewUrlList:void 0,avatarViewUrlExpirationTimestampList:void 0,avatarViewUrlFallbackList:void 0,avatarViewTitleList:void 0,avatarViewAccessibilityLabel:void 0,listItemProfilePictureUrl1:void 0,listItemProfilePictureUrlExpirationTimestamp1:void 0,listItemProfilePictureUrlFallback1:void 0,listItemProfilePictureUrl2:void 0,listItemProfilePictureUrlExpirationTimestamp2:void 0,listItemProfilePictureUrlFallback2:void 0,listItemProfilePictureUrl3:void 0,listItemProfilePictureUrlExpirationTimestamp3:void 0,listItemProfilePictureUrlFallback3:void 0,attachmentLoggingType:void 0,waveformData:void 0,samplingFrequencyHz:void 0,gatingType:b("bs_belt_Option").map(c.overlayIconGlyph,function(a){return String(a)}),gatingTitle:void 0})});else return b("Promise").resolve(void 0)})}function a(a,b){return i(a,b).then(function(a){})}f.getCTAType=g;f.getCTATitle=h;f.call=a}),null);
__d("MAWBridgeTypes.bs",[],(function(a,b,c,d,e,f){"use strict";function a(a){return{TAG:1,_0:a}}function b(a){return{TAG:2,_0:a}}function c(a){return{TAG:0,_0:a}}function d(a){return{TAG:0,_0:a}}function e(a){return{TAG:1,_0:a}}function g(a){return 0}f.makeInitialThreadRange=a;f.makeThreadRangeForLoadBefore=b;f.makeThreadRangeNoThreads=c;f.makeInitialRange=d;f.makeExtendBefore=e;f.makeNoMsg=g}),null);
__d("MAWBridgeTypes.re",["MAWBridgeTypes.bs"],(function(a,b,c,d,e,f){c=(a=b("MAWBridgeTypes.bs")).makeInitialThreadRange;f.makeInitialThreadRange=c;d=a.makeThreadRangeForLoadBefore;f.makeThreadRangeForLoadBefore=d;e=a.makeThreadRangeNoThreads;f.makeThreadRangeNoThreads=e;b=a.makeInitialRange;f.makeInitialRange=b;c=a.makeExtendBefore;f.makeExtendBefore=c;d=a.makeNoMsg;f.makeNoMsg=d}),null);
__d("MAWBridgeTypesWrapper",["MAWAckLevel"],(function(a,b,c,d,e,f,g){"use strict";function h(a){switch(a){case 0:return"User";case 1:return"Group"}}function i(a){switch(a){case"User":return 0;case"Group":return 1}}function a(a){return babelHelpers["extends"]({},a,{ack:d("MAWAckLevel").ackLevelToJS(a.ack)})}function b(a){return babelHelpers["extends"]({},a,{ack:d("MAWAckLevel").ackLevelToRE(a.ack)})}function c(a){return babelHelpers["extends"]({},a,{ack:d("MAWAckLevel").ackLevelToJS(a.ack),threadType:h(a.threadType)})}function e(a){return babelHelpers["extends"]({},a,{ack:d("MAWAckLevel").ackLevelToRE(a.ack),threadType:i(a.threadType)})}g.bridgeMsgToJS=a;g.bridgeMsgToRE=b;g.bridgeStartTraceDataToJS=c;g.bridgeStartTraceDataToRE=e}),98);
__d("MAWAbPropsTypes",[],(function(a,b,c,d,e,f){var g={client_group_participants_limit:[618,257],client_group_name_length_limit:[1200,25],msgrw_test_bool:[704,!1],msgrw_test_int:[705,0],msgrw_test_string:[706,"test_string"],msgrw_test_float:[707,1],msgrw_icdc_alert_trigger_failure_count:[1233,6],msgrw_icdc_cooldown_interval_in_minutes:[1234,10],msgrw_icdc_interval_in_minutes:[1236,1500],msgrw_logger_entries:[1298,0]};function a(a){return a}function b(a){return g[a][1]}f.AbPropConfigs=g;f.asAbCode=a;f.getAbDefault=b}),66);
__d("MAWAbPropsClient.bs",["MAWAbPropsToUI"],(function(a,b,c,d,e,f){"use strict";d={};var g={contents:b("MAWAbPropsToUI").prepareAbPropsForUI()};function a(a){g.contents=a}function c(a){return g.contents}f.Internal=d;f.rewrite=a;f.getAbProps=c}),null);
__d("MAWBridgeAbPropsUpdatedHandler.bs",["MAWAbPropsClient.bs"],(function(a,b,c,d,e,f){"use strict";function a(a){b("MAWAbPropsClient.bs").rewrite(a);return window.Promise.resolve(void 0)}f.call=a}),null);
__d("MAWBridgeClockSkewUpdatedHandler.bs",["WATimeUtils"],(function(a,b,c,d,e,f){"use strict";function a(a,c){b("WATimeUtils").setClockSkew(c);return window.Promise.resolve(void 0)}f.call=a}),null);
__d("MAWBridgeDeleteMessagesHandler.bs",["MAWThreadId.bs","MAWTimeUtils.bs","Promise"],(function(a,b,c,d,e,f){"use strict";function a(a,c){return b("MAWThreadId.bs").toThreadKey(a,c.threadId).then(function(d){var e=c.messages.map(function(c){return a.table("messages")["delete"]({hd:d,tl:{hd:b("MAWTimeUtils.bs").toTimestamp(c.ts),tl:{hd:c.msgId,tl:0}}})});return b("Promise").all(e).then(function(a){})})}f.call=a}),null);
__d("MAWBridgeDeleteReactionHandler.bs",["MAWThreadId.bs","bs_caml_format"],(function(a,b,c,d,e,f){"use strict";function g(a,c){return b("MAWThreadId.bs").toThreadKey(a,c.threadId).then(function(d){return a.table("reactions")["delete"]({hd:d,tl:{hd:c.messageId,tl:{hd:b("bs_caml_format").caml_int64_of_string(c.actorId),tl:0}}})})}function a(a,b){return g(a,b).then(function(a){})}f.call=a}),null);
__d("LSMessagingThreadTypeUtil.bs",["LSThreadBitOffset.bs","LSThreadCapabilityBitOffset.bs","MWCMThreadTypes.bs","MessagingThreadType.bs","bs_caml"],(function(a,b,c,d,e,f){"use strict";function a(a){if(b("bs_caml").i64_eq(a,b("MessagingThreadType.bs").group)||b("bs_caml").i64_eq(a,b("MessagingThreadType.bs").tincanGroupDisappearing)||b("bs_caml").i64_eq(a,b("MessagingThreadType.bs").secureMessageOverWaGroup)||b("bs_caml").i64_eq(a,b("MessagingThreadType.bs").marketplace)||b("MWCMThreadTypes.bs").isAnyCMThread(a)||b("bs_caml").i64_eq(a,b("MessagingThreadType.bs").room))return!0;else return!1}function c(a){if(b("bs_caml").i64_eq(a,b("MessagingThreadType.bs").oneToOne)||b("bs_caml").i64_eq(a,b("MessagingThreadType.bs").tincanOneToOne)||b("bs_caml").i64_eq(a,b("MessagingThreadType.bs").carrierMessagingOneToOne)||b("bs_caml").i64_eq(a,b("MessagingThreadType.bs").tincanOneToOneDisappearing)||b("bs_caml").i64_eq(a,b("MessagingThreadType.bs").secureMessageOverWaOneToOne))return!0;else return!1}function d(a){if(b("bs_caml").i64_eq(a,b("MessagingThreadType.bs").secureMessageOverWaOneToOne)||b("bs_caml").i64_eq(a,b("MessagingThreadType.bs").secureMessageOverWaGroup))return!0;else return!1}function e(a){a=a.NAME;if(a==="Group")return b("MessagingThreadType.bs").group;else if(a==="User"||a==="Page")return b("MessagingThreadType.bs").oneToOne;else return b("MessagingThreadType.bs").tincanOneToOne}function g(a){return b("LSThreadBitOffset.bs").has(b("LSThreadCapabilityBitOffset.bs").messageRequestComposerBanner,a)}f.isGroup=a;f.isOneToOne=c;f.isSecure=d;f.ofThreadId=e;f.isMessageRequest=g}),null);
__d("MAWBridgeDropAllSecureThreadsHandler.bs",["LSMessagingThreadTypeUtil.bs","Promise","ReQL.bs"],(function(a,b,c,d,e,f){"use strict";function g(a){return b("ReQL.bs").toArray(b("ReQL.bs").filter(b("ReQL.bs").fromTableAscending(a.table("threads")),function(a){return b("LSMessagingThreadTypeUtil.bs").isSecure(a.threadType)})).then(function(c){return c.reduce(function(b,c){return b.then(function(b){return a.table("threads")["delete"]({hd:c.threadKey,tl:0})})},b("Promise").resolve(void 0))})}function a(a){return g(a).then(function(a){})}f.dropAllInSecureThreads=g;f.call=a}),null);
__d("MAWBridgeGroupInfoUpdatedHandler.bs",["MAWThreadId.bs","Promise","ReQL.bs","bs_caml_obj","bs_caml_option","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";function g(a,c){return b("MAWThreadId.bs").toThreadKey(a,c.threadId).then(function(d){var e=c.threadName,f=e==null?void 0:b("bs_caml_option").some(e);return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("threads")),{hd:d,tl:0})).then(function(c){if(c!==void 0){c=b("bs_caml_obj").caml_obj_dup(c);return a.table("threads").put((c.threadName=f,c))}b("recoverableViolation")("Trying to update group thread name with non-existing group thread","messenger_e2ee_web");return b("Promise").resolve(void 0)})})}function a(a,b){return g(a,b).then(function(a){})}f.call=a}),null);
__d("LSAuthorityLevel.bs",[],(function(a,b,c,d,e,f){"use strict";a=[0,20];b=[0,40];c=[0,60];d=[0,75];e=[0,80];var g=[0,100];f.optimistic=a;f.clientPartial=b;f.serverPartial=c;f.authoritativePendingReplacement=d;f.authoritative=e;f.clientAuthoritativeDelete=g}),null);
__d("LSContactBlockedByViewerStatus.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;d=[0,2];f.unblocked=a;f.messageBlocked=c;f.fullyBlocked=d}),null);
__d("WADynamicRouter",["Promise"],(function(a,b,c,d,e,f){var g={sentinel:"RESPONSE_NAMESPACE"},h={sentinel:"NOT_HANDLED"};a=function(){function a(){var a=this;this.$1=b("Promise").resolve();this.$2=new Map();this.$3=0;this.$4=null;this.$5=null;this.$6=null;this.fireAndForget=function(b,c,d,e){e===void 0&&(e=!1),a.$8(b,c,d,null,e)};this.sendAndReceive=function(c,d,e,f){f===void 0&&(f=!1);return new(b("Promise"))(function(b,h){a.$8(c,d,e,function(c){try{var d=k(c);d?d.call(c,function(c){a.$8(g,"",c,b,f)},function(b){a.$8(g,"",b,h,!1)}):a.$8(g,"",c,b,f)}catch(b){a.$8(g,"",b,h,!1)}},f)})};this.$7=function(){var b=a.$5;if(!b)return;var c=a.$2,d;while(b&&!(d=i(c,b)))a.$5=b=b.nextRoute;if(!b||!d)return;c=a.$9(d,b);var e=!0;if(c!==h){var f=b.prevRoute,g=b.nextRoute;a.$5===b&&(a.$5=g);f?f.nextRoute=g:a.$4=g;g?g.prevRoute=f:(e=!1,a.$6=f)}e&&a.$1.then(a.$7);return c}}var c=a.prototype;c.hasHandlerForNamespace=function(a){return this.$2.has(a)};c.getHandledNamespaces=function(){return Array.from(this.$2.keys())};c.setNamespaceHandler=function(a,b){var c=this.$2,d=c.get(a);if(d===b)return;++this.$3;c.set(a,b);if(!d){c=this.$4;c&&(this.$5||this.$1.then(this.$7),this.$5=c)}};c.setHandlers=function(a,b){function c(a,c,d){a=b[a](c);d&&d(a)}this.setNamespaceHandler(a,c)};c.$8=function(a,b,c,d,e){var f=this.$6;a={namespace:a,route:b,arg:c,resolver:d,prevRoute:f,nextRoute:null,silentLog:e};this.$6=a;b=!0;f?(f.nextRoute=a,b=!this.$5):this.$4=a;b&&i(this.$2,a)&&(this.$5=a,this.$1.then(this.$7))};c.$9=function(a,c){var d=c.route,e=c.arg,f=c.resolver;c=c.silentLog;var g=this.$3,i=null,j=null;try{i=a(d,e,f,c)}catch(a){j=b("Promise").reject(a)}if(i===h)if(g===this.$3)j=b("Promise").reject(new Error("DynamicRouter: NOT_HANDLED can only be used when updating handlers"));else return h;if(f){j&&f(j);return}else return j};return a}();function i(a,b){b=b.namespace;return b===g?j:a.get(b)}function j(a,b,c){c(b)}function k(a){if(a!=null&&(typeof a==="object"||typeof a==="function")){a=a.then;return typeof a==="function"?a:null}return null}f.NOT_HANDLED=h;f.DynamicRouter=a}),66);
__d("WABridge",["WADynamicRouter"],(function(a,b,c,d,e,f,g){"use strict";var h=new(d("WADynamicRouter").DynamicRouter)();function a(){return h}g.getBridge=a}),98);
__d("MAWBridge",["WABridge"],(function(a,b,c,d,e,f,g){"use strict";function a(){return d("WABridge").getBridge()}g.getBridge=a}),98);
__d("WACustomError",[],(function(a,b,c,d,e,f){var g=Object.create(Error.prototype,{constructor:{value:void 0,writable:!0,configurable:!0}});function a(a,b,c){b===void 0&&(b=!0);function d(c){var d=Error.call(this,c);this.message=c;d.name=a;this.name=a;b&&(this.stack=d.stack)}d.prototype=Object.create(c?c.prototype:g);d.prototype.constructor=d;return d}function h(a){if(a.length===0)return"No errors";return a.length===1?a[0].message:a.map(function(a){return"- "+a.message}).join("\n")}e=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c){c=c!=null&&c.length>0?c:h(b);c=a.call(this,c)||this;c.errors=b;return c}return b}(a("AggregateError",!0));var i=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}return a}(a("TimeoutError",!1)),j=function(b){babelHelpers.inheritsLoose(a,b);function a(a,c){a=b.call(this,a)||this;a.code=c;return a}return a}(a("HttpError",!1)),k=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}return a}(a("UnimplementedMethod")),l=!1;function b(a){if(a==null||a.name!=="QuotaExceededError")throw a;l=!0}function c(){return l}function d(a){return JSON.stringify(a,Object.getOwnPropertyNames(a))}var m=function(b){babelHelpers.inheritsLoose(a,b);function a(a,c){a=b.call(this,a)||this;a.inner=c;return a}return a}(babelHelpers.wrapNativeSuper(Error));f.customError=a;f.AggregateError=e;f.TimeoutError=i;f.HttpError=j;f.UnimplementedMethod=k;f.supressQuotaExceededError=b;f.hasSupressedQuotaExceededError=c;f.obtainErrorSummary=d;f.WrappedError=m}),66);
__d("WAAbortError",["WACustomError"],(function(a,b,c,d,e,f,g){b=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(d("WACustomError").customError("AbortError"));var h="AbortError";function a(a){return function(b){if(b.name===h)return a(b);else throw b}}g.AbortError=b;g.ABORT_ERROR=h;g.catchAbort=a}),98);
__d("WAPromiseDelays",["Promise","WAAbortError"],(function(a,b,c,d,e,f,g){function a(a,c){return new(b("Promise"))(function(b,e){if(c==null?void 0:c.aborted)throw new(d("WAAbortError").AbortError)();var f=setTimeout(g,a);c==null?void 0:c.addEventListener("abort",h);function g(){c==null?void 0:c.removeEventListener("abort",h),b()}function h(){c==null?void 0:c.removeEventListener("abort",h),clearTimeout(f),e(new(d("WAAbortError").AbortError)())}})}function c(a,c,d){return new(b("Promise"))(function(b,e){var f=setTimeout(function(){try{b(d())}catch(a){e(a)}},c);a.then(function(a){clearTimeout(f),b(a)},function(a){clearTimeout(f),e(a)})})}g.delayMs=a;g.withTimeout=c}),98);
__d("MAWTimedBridge",["FBLogger","MAWMaybeWithTimeout","MAWWaitForBackendSetup"],(function(a,b,c,d,e,f,g){"use strict";var h=6e4;function a(a,b,e){e===void 0&&(e=h);return d("MAWMaybeWithTimeout").maybeWithTimeout(d("MAWWaitForBackendSetup").waitForBackendSetup(b).then(function(){return a}),e,function(){throw c("FBLogger")("messenger_e2ee_web").mustfixThrow("Failed to complete bridge route "+b+" in time")},b)}g.bridgeTimeout=a}),98);
__d("MAWBridge.bs",["MAWBridge","MAWTimedBridge","MAWWaitForBackendSetup"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d){return{fireAndForget:function(e){b("MAWWaitForBackendSetup").runAfterBackendSetup(function(e){b("MAWBridge").getBridge().fireAndForget(a,c,d)},c)},sendAndReceive:function(e){return b("MAWTimedBridge").bridgeTimeout(b("MAWBridge").getBridge().sendAndReceive(a,c,d),c)},sendAndReceiveWithTimeout:function(e){return b("MAWTimedBridge").bridgeTimeout(b("MAWBridge").getBridge().sendAndReceive(a,c,d),c,e)}}}f.createApi=a}),null);
__d("MAWBackendBridge.bs",["MAWBridge.bs"],(function(a,b,c,d,e,f){"use strict";var g="backend",h="insertAdminMessageInCutoverThreads",i={$$event:h},j="archiveThread",k={$$event:j},l="unarchiveThread",m={$$event:l},n="changeSecurityAlertSetting",o={$$event:n},p="getSecurityAlertSetting",aa={$$event:p},q="clearSignalAndTempStores",ba={$$event:q},ca={$$event:"createThread"},r="createThreadThroughMI",da={$$event:r},s="deleteThread",ea={$$event:s},t="getCurrentUserDeviceInfo",fa={$$event:t},u="getIdentityKeys",ga={$$event:u},v="markThreadAsUnread",ha={$$event:v},w="updateThreadMuteSetting",ia={$$event:w},x="initSync",ja={$$event:x},y="loadMoreThreads",ka={$$event:y},z="loadMoreMsgs",la={$$event:z},A="loadMoreMedia",ma={$$event:A},B="getBlobDataUrlByMediaId",na={$$event:B},C="getBlobDataUrlByXMAId",oa={$$event:C},D="getGroupSuperAdmin",pa={$$event:D},E="getShadowGroupByOpenThreadKey",qa={$$event:E},F="compareThreadParticipants",ra={$$event:F},G="getEphemeralSettings",sa={$$event:G},H="setEphemeralSettingsFromFrontend",ta={$$event:H},I="getDualSendMediaByFileType",ua={$$event:I},J="getThumbnailBlobDataUrlByMediaId",va={$$event:J},K="backfillThreadsForOccamadillo",wa={$$event:K},L="retryUploadMedia",xa={$$event:L},M="optimisticUploadMedia",ya={$$event:M},N="sendChatStateFromComposer",za={$$event:N},O="getThreadJidByChatId",Aa={$$event:O},P="getProtocolMsgIdByMsgId",Ba={$$event:P},Q="GetProtocolMsgIdByMediaMsgId",Ca={$$event:Q};function a(a){return{TAG:0,_0:a}}function c(a){return{TAG:1,_0:a}}function d(a){return{TAG:2,_0:a}}function e(a){return{TAG:3,_0:a}}var R="search",Da={$$event:R},S="getThreadDevicesInfo",Ea={$$event:S},T="getAllThreadDevicesCount",Fa={$$event:T},U="getContact",Ga={$$event:U},V="updateContact",Ha={$$event:V},W="updateParticipantName",Ia={$$event:W},X="fetchExistingThread",Ja={$$event:X},Y="fetchExistingThreadForContact",Ka={$$event:Y},Z="getThreadIdByChatJid",La={$$event:Z},$="getAllThreadsAsJson",Ma={$$event:$};function Na(a){return b("MAWBridge.bs").createApi(g,j,a)}function Oa(a){return b("MAWBridge.bs").createApi(g,K,a)}function Pa(a){return b("MAWBridge.bs").createApi(g,l,a)}function Qa(a){return b("MAWBridge.bs").createApi(g,n,a)}function Ra(a){return b("MAWBridge.bs").createApi(g,p,a)}function Sa(a){return b("MAWBridge.bs").createApi(g,q,a)}function Ta(a){return b("MAWBridge.bs").createApi(g,r,a)}function Ua(a){return b("MAWBridge.bs").createApi(g,s,a)}function Va(a){return b("MAWBridge.bs").createApi(g,t,a)}function Wa(a){return b("MAWBridge.bs").createApi(g,u,a)}function Xa(a){return b("MAWBridge.bs").createApi(g,v,a)}function Ya(a){return b("MAWBridge.bs").createApi(g,w,a)}function Za(a){return b("MAWBridge.bs").createApi(g,x,a)}function $a(a){return b("MAWBridge.bs").createApi(g,y,a)}function ab(a){return b("MAWBridge.bs").createApi(g,z,a)}function bb(a){return b("MAWBridge.bs").createApi(g,A,a)}function cb(a){return b("MAWBridge.bs").createApi(g,B,a)}function db(a){return b("MAWBridge.bs").createApi(g,C,a)}function eb(a){return b("MAWBridge.bs").createApi(g,U,a)}function fb(a){return b("MAWBridge.bs").createApi(g,E,a)}function gb(a){return b("MAWBridge.bs").createApi(g,F,a)}function hb(a){return b("MAWBridge.bs").createApi(g,D,a)}function ib(a){return b("MAWBridge.bs").createApi(g,J,a)}function jb(a){return b("MAWBridge.bs").createApi(g,S,a)}function kb(a){return b("MAWBridge.bs").createApi(g,T,a)}function lb(a){return b("MAWBridge.bs").createApi(g,L,a)}function mb(a){return b("MAWBridge.bs").createApi(g,M,a)}function nb(a){return b("MAWBridge.bs").createApi(g,V,a)}function ob(a){return b("MAWBridge.bs").createApi(g,W,a)}function pb(a){return b("MAWBridge.bs").createApi(g,X,a)}function qb(a){return b("MAWBridge.bs").createApi(g,R,a)}function rb(a){return b("MAWBridge.bs").createApi(g,N,a)}function sb(a){return b("MAWBridge.bs").createApi(g,O,a)}function tb(a){return b("MAWBridge.bs").createApi(g,P,a)}function ub(a){return b("MAWBridge.bs").createApi(g,Q,a)}function vb(a){return b("MAWBridge.bs").createApi(g,Z,a)}function wb(a){return b("MAWBridge.bs").createApi(g,$,a)}function xb(a){return b("MAWBridge.bs").createApi(g,G,a)}function yb(a){return b("MAWBridge.bs").createApi(g,H,a)}function zb(a){return b("MAWBridge.bs").createApi(g,I,a)}function Ab(a){return b("MAWBridge.bs").createApi(g,h,a)}function Bb(a){return b("MAWBridge.bs").createApi(g,Y,a)}f.namespace=g;f.InsertAdminMessageInCutoverThreads=i;f.ArchiveThread=k;f.UnarchiveThread=m;f.ChangeSecurityAlertSetting=o;f.GetSecurityAlertSetting=aa;f.ClearSignalAndTempStores=ba;f.CreateThread=ca;f.CreateThreadThroughMI=da;f.DeleteThread=ea;f.GetCurrentUserDeviceInfo=fa;f.GetIdentityKeys=ga;f.MarkThreadAsUnread=ha;f.UpdateThreadMuteSetting=ia;f.InitSync=ja;f.LoadMoreThreads=ka;f.LoadMoreMsgs=la;f.LoadMoreMedia=ma;f.GetBlobDataUrlByMediaId=na;f.GetBlobDataUrlByXMAId=oa;f.GetGroupSuperAdmin=pa;f.GetShadowGroupByOpenThreadKey=qa;f.CompareThreadParticipants=ra;f.GetEphemeralSettings=sa;f.SetEphemeralSettingsFromFrontend=ta;f.GetDualSendMediaByFileType=ua;f.GetThumbnailBlobDataUrlByMediaId=va;f.BackfillThreadsForOccamadillo=wa;f.RetryUploadMedia=xa;f.OptimisticUploadMedia=ya;f.SendChatStateFromComposer=za;f.GetThreadJidByChatId=Aa;f.GetProtocolMsgIdByMsgId=Ba;f.GetProtocolMsgIdByMediaMsgId=Ca;f.bridgeMsg=a;f.bridgeGroupInfo=c;f.bridgeContact=d;f.bridgeParticipant=e;f.Search=Da;f.GetThreadDevicesInfo=Ea;f.GetAllThreadDevicesCount=Fa;f.GetContact=Ga;f.UpdateContact=Ha;f.UpdateParticipantName=Ia;f.FetchExistingThread=Ja;f.FetchExistingThreadForContact=Ka;f.GetThreadIdByChatJid=La;f.GetAllThreadsAsJson=Ma;f.archiveThread=Na;f.backfillThreadsForOccamadillo=Oa;f.unarchiveThread=Pa;f.changeSecurityAlertSetting=Qa;f.getSecurityAlertSetting=Ra;f.clearSignalAndTempStores=Sa;f.createThreadThroughMI=Ta;f.deleteThread=Ua;f.getCurrentUserDeviceInfo=Va;f.getIdentityKeys=Wa;f.markThreadAsUnread=Xa;f.updateThreadMuteSetting=Ya;f.initSync=Za;f.loadMoreThreads=$a;f.loadMoreMsgs=ab;f.loadMoreMedia=bb;f.getBlobDataUrlByMediaId=cb;f.getBlobDataUrlByXMAId=db;f.getContact=eb;f.getShadowGroupByOpenThreadKey=fb;f.compareThreadParticipants=gb;f.getGroupSuperAdmin=hb;f.getThumbnailBlobDataUrlByMediaId=ib;f.getThreadDevicesInfo=jb;f.getAllThreadDevicesCount=kb;f.retryUploadMedia=lb;f.optimisticUploadMedia=mb;f.updateContact=nb;f.updateParticipantName=ob;f.fetchExistingThread=pb;f.search=qb;f.sendChatStateFromComposer=rb;f.getThreadJidByChatId=sb;f.getProtocolMsgIdByMsgId=tb;f.getProtocolMsgIdByMediaMsgId=ub;f.getThreadIdByChatJid=vb;f.getAllThreadsAsJson=wb;f.getEphemeralSettings=xb;f.setEphemeralSettingsFromFrontend=yb;f.getDualSendFileByFileType=zb;f.insertAdminMessageInCutoverThreads=Ab;f.fetchExistingThreadForContact=Bb}),null);
__d("LSContactUserBlockAction.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;d=[0,2];e=[0,3];f.mnUnblock=a;f.mnBlock=c;f.fbUnblock=d;f.fbBlock=e}),null);
__d("MAWBlockUtils.bs",["LSContactUserBlockAction.bs","LSThreadBitOffset.bs","LSThreadCapabilityBitOffset.bs","LSTransaction.bs","MessagingThreadType.bs","Promise","ReQL.bs","ReQLSuspense","bs_caml","bs_caml_obj","bs_caml_option","promiseDone","useReStore"],(function(a,b,c,d,e,f){"use strict";var g=[(c=b("LSThreadCapabilityBitOffset.bs")).payment,c.locationSharing,c.createGroup,c.roomCreation,c.filePicker,c.selfieSticker,c.rtcVideoCall,c.rtcVoiceCall,c.createGroup,c.muteThread,c.restrictContact],h=[c.payment,c.locationSharing,c.createGroup,c.roomCreation,c.filePicker,c.selfieSticker,c.rtcVideoCall,c.rtcVoiceCall,c.createGroup,c.muteThread,c.restrictContact,c.threadDetailsProfileButton,c.inThreadProfileButton],i=[c.createGroup,c.muteThread,c.restrictContact,c.filePicker];function a(a){var c=b("useReStore")();return function(a,d){var e;e=(e=b("ReQL.bs")).first(e.filter(e.map(e.filter(e.fromTableAscending(c.table("participants")),function(c){return b("bs_caml").i64_eq(c.contactId,a)}),function(a){return b("ReQLSuspense").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(c.table("threads")),{hd:a.threadKey,tl:0}))}),function(a){if(a!==void 0)return b("bs_caml").i64_eq(a.threadType,b("MessagingThreadType.bs").secureMessageOverWaOneToOne);else return!1})).then(function(a){if(a===void 0)return b("Promise").resolve(void 0);var e=b("bs_caml_option").valFromOption(a);if(e===void 0)return b("Promise").resolve(void 0);a=b("bs_caml").i64_eq(d,b("LSContactUserBlockAction.bs").mnBlock)?b("LSThreadBitOffset.bs").clear(g,e.capabilities,e.capabilities2,e.capabilities3):b("bs_caml").i64_eq(d,b("LSContactUserBlockAction.bs").fbBlock)?b("LSThreadBitOffset.bs").clear(h,e.capabilities,e.capabilities2,e.capabilities3):b("LSThreadBitOffset.bs").set(i,e.capabilities,e.capabilities2,e.capabilities3);var f=a[1],j=a[0];a=b("LSTransaction.bs").run(c,function(a){var c=b("bs_caml_obj").caml_obj_dup(e);return a.table("threads").put((c.capabilities2=f,c.capabilities=j,c))},"readWrite");b("promiseDone")(a,void 0,void 0);return b("Promise").resolve(void 0)});b("promiseDone")(e,void 0,void 0)}}f.clearedMnBlockCapabilities=g;f.clearedFbBlockCapabilities=h;f.setBlockCapabilities=i;f.useHook=a}),null);
__d("MAWMessageRequestUtil.bs",["LSMessagingThreadTypeUtil.bs","LSThreadCapabilityBitOffset.bs","bs_caml","bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";function g(a){if(a==="pending")return!0;else return a==="other"}function a(a){if(b("LSMessagingThreadTypeUtil.bs").isOneToOne(a.threadType))return g(a.folderName);else return!1}function h(a,c){var d=a.folderName;a=a.lastActivityTimestampMs;if(c!==void 0)if(d==="pending"||d==="other")return!0;else if(d==="inbox"&&b("bs_caml").i64_lt(c[1].contactViewerRelationship,[0,2]))return b("bs_caml").i64_neq(a,b("bs_caml_int64").zero);else return!1;else return!1}function c(a,c){if(b("LSMessagingThreadTypeUtil.bs").isOneToOne(a.threadType))return h(a,c);else return!1}e=[(d=b("LSThreadCapabilityBitOffset.bs")).threadDetailsProfileButton,d.reactions,d.muteThread,d.searchInConversation,d.rtcVideoCall,d.rtcVoiceCall,d.messageUnsend];d=[d.messageRequestComposerBanner,d.topLevelSelfRemediation];f.isMessageRequestFolder=g;f.isOneOnOneMessageRequest=a;f.isMessageRequest=h;f.useIsOneOnOneMessageRequestV2=c;f.disabledThreadCapabilitiesForIncomingRequest=e;f.enabledThreadCapabilitiesForIncomingRequest=d}),null);
__d("LSContactMessengerRestrictAction.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;f.restrict=a;f.unrestrict=c}),null);
__d("MAWMessengerRestrictUtils.bs",["LSContactMessengerRestrictAction.bs","LSThreadBitOffset.bs","LSThreadCapabilityBitOffset.bs","LSTransaction.bs","MessagingThreadType.bs","Promise","ReQL.bs","ReQLSuspense","bs_caml","bs_caml_obj","bs_caml_option","promiseDone","useReStore"],(function(a,b,c,d,e,f){"use strict";var g=[(c=b("LSThreadCapabilityBitOffset.bs")).payment,c.locationSharing,c.createGroup,c.roomCreation,c.filePicker,c.selfieSticker,c.rtcVideoCall,c.rtcVoiceCall,c.createGroup,c.muteThread],h=[c.createGroup,c.muteThread,c.filePicker];function a(a){var c=b("useReStore")();return function(a,d){var e;e=(e=b("ReQL.bs")).first(e.filter(e.map(e.filter(e.fromTableAscending(c.table("participants")),function(c){return b("bs_caml").i64_eq(c.contactId,a)}),function(a){return b("ReQLSuspense").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(c.table("threads")),{hd:a.threadKey,tl:0}))}),function(a){if(a!==void 0)return b("bs_caml").i64_eq(a.threadType,b("MessagingThreadType.bs").secureMessageOverWaOneToOne);else return!1})).then(function(a){if(a===void 0)return b("Promise").resolve(void 0);var e=b("bs_caml_option").valFromOption(a);if(e===void 0)return b("Promise").resolve(void 0);a=b("bs_caml").i64_eq(d,b("LSContactMessengerRestrictAction.bs").restrict)?b("LSThreadBitOffset.bs").clear(g,e.capabilities,e.capabilities2,e.capabilities3):b("LSThreadBitOffset.bs").set(h,e.capabilities,e.capabilities2,e.capabilities3);var f=a[2],i=a[1],j=a[0];a=b("LSTransaction.bs").run(c,function(a){var c=b("bs_caml_obj").caml_obj_dup(e);return a.table("threads").put((c.capabilities3=f,c.capabilities2=i,c.capabilities=j,c))},"readWrite");b("promiseDone")(a,void 0,void 0);return b("Promise").resolve(void 0)});b("promiseDone")(e,void 0,void 0)}}f.clearedMnRestrictCapabilities=g;f.setMnRestrictCapabilities=h;f.useHook=a}),null);
__d("MAWUpdateLSThreadCapabilities.bs",["LSAuthorityLevel.bs","LSBitOffset.bs","LSContactBitOffset.bs","LSContactBlockedByViewerStatus.bs","LSContactCapabilityBitOffset.bs","LSMessagingThreadTypeUtil.bs","LSThreadBitOffset.bs","LSThreadCapabilityBitOffset.bs","MAWBackendBridge.bs","MAWBlockUtils.bs","MAWContact.bs","MAWCurrentUser","MAWMessageRequestUtil.bs","MAWMessengerRestrictUtils.bs","Promise","ReQL.bs","SortedAsyncIterable.bs","bs_belt_Option","bs_caml","bs_caml_format","bs_caml_int64","bs_caml_obj","bs_curry"],(function(a,b,c,d,e,f){"use strict";var g=b("MAWCurrentUser").getID(),h=b("bs_caml_format").caml_int64_of_string(g);function a(a,c){return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("threads")),{hd:c,tl:0})).then(function(c){if(c===void 0)return b("Promise").resolve(void 0);var d=b("LSBitOffset.bs").set(b("LSThreadCapabilityBitOffset.bs").addMember,c.capabilities);c=b("bs_caml_obj").caml_obj_dup(c);return a.table("threads").put((c.capabilities=d,c))}).then(function(a){})}function c(a,c){return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("threads")),{hd:c,tl:0})).then(function(c){if(c===void 0)return b("Promise").resolve(void 0);var d=b("LSBitOffset.bs").clear(b("LSThreadCapabilityBitOffset.bs").addMember,c.capabilities);c=b("bs_caml_obj").caml_obj_dup(c);return a.table("threads").put((c.capabilities=d,c))}).then(function(a){})}function d(a,c){return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("threads")),{hd:c,tl:0})).then(function(d){if(d===void 0)return b("Promise").resolve([void 0,void 0]);var e=b("ReQL.bs").first(b("LSMessagingThreadTypeUtil.bs").isOneToOne(d.threadType)?b("ReQL.bs").map(b("ReQL.bs").filter(b("ReQL.bs").mergeJoin(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("participants")),{hd:c,tl:0}),b("ReQL.bs").fromTableAscending(a.table("contacts"))),function(a){return b("bs_caml").i64_neq(a[1].id,h)}),function(a){return a[1]}):b("SortedAsyncIterable.bs").empty(void 0));return b("Promise").all([b("Promise").resolve(d),e])}).then(function(c){var d=c[0];if(d===void 0)return b("Promise").resolve(void 0);c=c[1];if(c===void 0)return b("Promise").resolve(void 0);var e=b("bs_caml").i64_eq(c.blockedByViewerStatus,b("LSContactBlockedByViewerStatus.bs").messageBlocked),f=b("bs_caml").i64_eq(c.blockedByViewerStatus,b("LSContactBlockedByViewerStatus.bs").fullyBlocked);c=b("bs_belt_Option").getWithDefault(b("LSContactBitOffset.bs").has(b("LSContactCapabilityBitOffset.bs").restrictPlaced,c),!1);f=f?b("LSThreadBitOffset.bs").clear(b("MAWBlockUtils.bs").clearedFbBlockCapabilities,d.capabilities,d.capabilities2,d.capabilities3):e?b("LSThreadBitOffset.bs").clear(b("MAWBlockUtils.bs").clearedMnBlockCapabilities,d.capabilities,d.capabilities2,d.capabilities3):c?b("LSThreadBitOffset.bs").clear(b("MAWMessengerRestrictUtils.bs").clearedMnRestrictCapabilities,d.capabilities,d.capabilities2,d.capabilities3):[d.capabilities,d.capabilities2,d.capabilities3];e=b("bs_caml_obj").caml_obj_dup(d);return a.table("threads").put((e.capabilities3=f[2],e.capabilities2=f[1],e.capabilities=f[0],e)).then(function(a){})})}function e(a,c,d){return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("threads")),{hd:d,tl:0})).then(function(e){if(e===void 0)return b("Promise").resolve([void 0,void 0,void 0]);var f=b("ReQL.bs").first(b("LSMessagingThreadTypeUtil.bs").isOneToOne(e.threadType)?b("ReQL.bs").map(b("ReQL.bs").filter(b("ReQL.bs").mergeJoin(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("participants")),{hd:d,tl:0}),b("ReQL.bs").fromTableAscending(a.table("contacts"))),function(a){return b("bs_caml").i64_neq(a[1].id,h)}),function(a){return a[1]}):b("SortedAsyncIterable.bs").empty(void 0)),g=b("LSMessagingThreadTypeUtil.bs").isOneToOne(e.threadType)?b("bs_curry")._1(b("MAWBackendBridge.bs").getContact({fbid:c}).sendAndReceive,void 0).then(function(a){return a.relationship}):b("Promise").resolve(void 0);return b("Promise").all([b("Promise").resolve(e),f,g])}).then(function(c){var d=c[0];if(d===void 0)return b("Promise").resolve(void 0);var e=c[1];if(e===void 0)return b("Promise").resolve(void 0);c=c[2];if(c===void 0)return b("Promise").resolve(void 0);c=b("bs_caml").i64_neq(e.authorityLevel,b("LSAuthorityLevel.bs").authoritative)?c:b("MAWContact.bs").lsContactToContactRelationshipType(e);if(d.folderName==="pending"||d.folderName==="other"||d.folderName==="inbox"&&c!==b("MAWContact.bs").twoWayContact&&c!==b("MAWContact.bs").oneWayContact&&b("bs_caml").i64_neq(d.lastActivityTimestampMs,b("bs_caml_int64").zero)){e=b("LSThreadBitOffset.bs").clear(b("MAWMessageRequestUtil.bs").disabledThreadCapabilitiesForIncomingRequest,d.capabilities,d.capabilities2,d.capabilities3);c=b("LSThreadBitOffset.bs").set(b("MAWMessageRequestUtil.bs").enabledThreadCapabilitiesForIncomingRequest,e[0],e[1],e[2])}else c=[d.capabilities,d.capabilities2,d.capabilities3];e=b("bs_caml_obj").caml_obj_dup(d);return a.table("threads").put((e.capabilities3=c[2],e.capabilities2=c[1],e.capabilities=c[0],e)).then(function(a){})})}function i(a,c){var d=b("LSThreadBitOffset.bs").clear(b("MAWMessageRequestUtil.bs").enabledThreadCapabilitiesForIncomingRequest,c.capabilities,c.capabilities2,c.capabilities3);d=b("LSThreadBitOffset.bs").set(b("MAWMessageRequestUtil.bs").disabledThreadCapabilitiesForIncomingRequest,d[0],d[1],d[2]);c=b("bs_caml_obj").caml_obj_dup(c);return a.table("threads").put((c.capabilities3=d[2],c.capabilities2=d[1],c.capabilities=d[0],c)).then(function(a){})}function j(a,c){return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("threads")),{hd:c,tl:0})).then(function(c){if(c===void 0)return b("Promise").resolve(void 0);var d=b("LSThreadBitOffset.bs").set([b("LSThreadCapabilityBitOffset.bs").messageRequestGroupInvite],c.capabilities,c.capabilities2,c.capabilities3);c=b("bs_caml_obj").caml_obj_dup(c);return a.table("threads").put((c.capabilities3=d[2],c.capabilities2=d[1],c.capabilities=d[0],c))}).then(function(a){})}f.currentUserId=g;f.currentUserIdAsInt64=h;f.enableAddMembersTxn=a;f.disableAddMembersTxn=c;f.disableBlockerCapabilitiesTxn=d;f.updateMessageRequestThreadCapabilitiesTxn=e;f.updateNonMessageRequestThreadCapabilitiesTxn=i;f.setGroupInviteTxn=j}),null);
__d("MAWBridgeGroupInviteUpdateHandler.bs",["MAWThreadId.bs","MAWTimeUtils.bs","MAWUpdateLSThreadCapabilities.bs","bs_caml_format","bs_caml_option"],(function(a,b,c,d,e,f){"use strict";function g(a,c){return b("MAWThreadId.bs").toThreadKey(a,c.threadId).then(function(d){return a.table("group_invites").put({threadKey:d,inviterId:b("bs_caml_format").caml_int64_of_string(c.inviterId),inviteeId:b("bs_caml_format").caml_int64_of_string(c.inviteeId),inviteCode:c.inviteCode,inviteExpirationTimestampMs:b("MAWTimeUtils.bs").toTimestamp(c.inviteExpireTs),caption:b("bs_caml_option").nullable_to_opt(c.caption)}).then(function(c){return b("MAWUpdateLSThreadCapabilities.bs").setGroupInviteTxn(a,d)})})}function a(a,b){return g(a,b).then(function(a){})}f.call=a}),null);
__d("CometDebounce",["clearTimeout","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){b=b===void 0?babelHelpers["extends"]({},null):b;var d=b.leading,e=b.wait,f=!0,g;function h(){for(var b=arguments.length,i=new Array(b),j=0;j<b;j++)i[j]=arguments[j];var k;if(d===!0){k=function(){f=!0,g=null};if(!f){c("clearTimeout")(g);g=c("setTimeout")(k,e);return}f=!1;a.apply(void 0,i)}else h.reset(),k=function(){g=null,a.apply(void 0,i)};g=c("setTimeout")(k,e)}h.isPending=function(){return g!=null};h.reset=function(){c("clearTimeout")(g),g=null,f=!0};return h}g["default"]=a}),98);
__d("MAWBridgeInitSyncCompleteHandler.bs",["CurrentLocale","LSDict","LSJson","LSLogHistory.bs","LSSyncChannel.bs","LSSyncStatus.bs","MAWInitSyncComplete.bs","MAWThreadLoadMeasurement","Promise","bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";function g(a){return a.table("sync_groups").add({groupId:b("MAWInitSyncComplete.bs").id,currentCursor:void 0,syncStatus:b("LSSyncStatus.bs").complete,syncParams:b("LSJson").stringify(new(b("LSDict"))([["locale",b("CurrentLocale").get()]])),sendSyncParams:!0,minTimeToSyncTimestampMs:[2328,1316134911],canIgnoreTimestamp:!1,priority:b("bs_caml_int64").zero,lastSyncRequestTimestampMs:b("bs_caml_int64").zero,regionHint:void 0,lastSyncCompletedTimestampMs:void 0,dataTraceId:void 0,initTraceTimestampMs:void 0,syncChannel:b("LSSyncChannel.bs").mqtt})}function h(a){return a.table("network_requests").add({taskQueueName:"",syncDatabaseId:b("MAWInitSyncComplete.bs").id,epochId:(a=b("bs_caml_int64")).neg_one,networkTaskIdentifier:void 0,lastSentTimestampMs:a.zero,failureCount:a.zero,lastSyncRequestTimestampMs:a.zero,lastDelayedRequestTimestampMs:void 0})}function a(a){b("LSLogHistory.bs").log("Init Sync Complete","debug");b("MAWThreadLoadMeasurement").logInitSyncComplete();return window.Promise.all([g(a),h(a)]).then(function(a){return b("Promise").resolve(void 0)})}f.completeLocalArmadilloSyncCursor=g;f.completeLocalArmadilloNetworkRequest=h;f.call=a}),null);
__d("MAWBridgeMediaExpiredHandler.bs",["MAWThreadId.bs"],(function(a,b,c,d,e,f){"use strict";function a(a,c){var d=String(c.mediaId);return b("MAWThreadId.bs").toThreadKey(a,c.threadId).then(function(b){return a.table("attachments")["delete"]({hd:b,tl:{hd:c.msgId,tl:{hd:d,tl:0}}})})}f.call=a}),null);
__d("MAWEphemeralMessageExpirationStorage.bs",["MAWBridgeDeleteMessagesHandler.bs","bs_belt_Array","clearTimeout","promiseDone","setTimeout"],(function(a,b,c,d,e,f){"use strict";var g=new Map();function h(a,c,d){b("bs_belt_Array").forEach(c,function(c){var d=c.ts,e=c.chatId,f=c.msgId;d={ts:d,threadId:e,msgId:f};e=c.chatId;f=[d];c={threadId:e,messages:f};b("promiseDone")(b("MAWBridgeDeleteMessagesHandler.bs").call(a,c),void 0,void 0)});return g["delete"](d)}function i(a,c,d,e){return b("setTimeout")(function(b){h(a,c,d)},e)}function a(a,c,d,e){var f=g.get(d);c=f==null?[c]:(b("clearTimeout")(f.timeoutId),f.msgs.map(function(a){return a.msgId}).indexOf(c.msgId)===-1?(f.msgs.push(c),void 0):void 0,f.msgs);f=i(a,c,d,e);g.set(d,{expirationTs:d,msgs:c,timeoutId:f})}function c(a){var b=a.msgId;a=g.get(a.countdownTs);if(a==null)return;b=a.msgs.map(function(a){return a.msgId}).indexOf(b);if(b>-1){a.msgs.splice(b,1);return}}f.setMessageForExpiration=a;f.clearMessageFromExpiration=c}),null);
__d("MAWBridgeMsgClearCountdownHandler.bs",["MAWEphemeralMessageExpirationStorage.bs","Promise"],(function(a,b,c,d,e,f){"use strict";function a(a){b("MAWEphemeralMessageExpirationStorage.bs").clearMessageFromExpiration(a);return b("Promise").resolve(void 0)}f.call=a}),null);
__d("LSMessageUnsendabilityStatus.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;d=[0,2];e=[0,3];b=[0,4];var g=[0,5],h=[0,6],i=[0,7];f.canUnsend=a;f.denyLogMessage=c;f.denyTombstoneMessage=d;f.denyForNonSender=e;f.denyP2pPayment=b;f.denyStoryReaction=g;f.denyBlobAttachment=h;f.denyMessageNotFound=i}),null);
__d("LSMessageSendStatus.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;d=[0,2];e=[0,4];b=[0,5];f.none=a;f.sendingToServer=c;f.serverReceived=d;f.nonRetriableError=e;f.retriableError=b}),null);
__d("LSMessageSendStatusV2.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;d=[0,2];e=[0,4];b=[0,5];var g=[0,6];f.none=a;f.sendingToServer=c;f.serverReceived=d;f.nonRetriableError=e;f.retriableError=b;f.sentOnly=g}),null);
__d("WAErr",[],(function(a,b,c,d,e,f){"use strict";function a(a){a=new Error(a);if(a.stack===void 0)try{throw a}catch(a){}return a}f["default"]=a}),66);
__d("WABaseGlobals",["WAErr"],(function(a,b,c,d,e,f,g){"use strict";var h=null;function a(a){h=a}function i(){if(h==null)throw c("WAErr")("Trying to access WAGlobals before being set");return h}function b(a){var b=i();b.myJids=a}function d(){var a;a=(a=i().myJids)==null?void 0:a.deviceJid;if(a==null)throw c("WAErr")("Trying to access myDeviceJid, but it's not set");return a}function e(){var a;a=(a=i().myJids)==null?void 0:a.userJid;if(a==null)throw c("WAErr")("Trying to access myUserJid, but it's not set");return a}function f(){return i().db}function j(){return i().jidUtils}function k(){return i().config}function l(a,b){return i().runInTransaction(a,b)}g.setGlobals=a;g.setMyJids=b;g.getMyDeviceJid=d;g.getMyUserJid=e;g.getDbImpls=f;g.getJidUtilsApi=j;g.getConfig=k;g.runInTransaction=l}),98);
__d("WAGlobals",["WABaseGlobals","WAErr","WAJids"],(function(a,b,c,d,e,f,g){"use strict";var h=null;function a(a){h=a,d("WABaseGlobals").setGlobals(a)}function i(){if(h==null)throw c("WAErr")("WaMsgr api called before set");return h}function b(a,b){var d=i();if(d.myJids!=null)throw c("WAErr")("Trying to set UserJid and DeviceJid but they are already set");d.myJids={userJid:a,deviceJid:b}}function j(){var a;a=(a=i().myJids)==null?void 0:a.deviceJid;if(a==null)throw c("WAErr")("Trying to access myDeviceJid, but it's not set");return a}function e(){var a;a=(a=i().myJids)==null?void 0:a.userJid;if(a==null)throw c("WAErr")("Trying to access myUserJid, but it's not set");return a}function f(){return i().db}function k(){return i().jobResultConverter}function l(){return i().persistedJobs.api}function m(){return i().persistedJobs.manager}function n(a){return d("WAJids").extractUserJid(a)===d("WAJids").extractUserJid(j())}function o(){return i().jidUtils}function p(){return i().crypto.manager}function q(){return i().crypto.inMemoryManager}function r(){return i().crypto.inMemorySignal}function s(){return i().config}function t(){return i().dependencies}function u(a){var b=i().config;a.icdcCooldownIntervalInMinutes!=null&&(b.icdcCooldownIntervalInMinutes=a.icdcCooldownIntervalInMinutes);a.icdcIntervalInMinutes!=null&&(b.icdcIntervalInMinutes=a.icdcIntervalInMinutes);a.icdcAlertTriggerFailureCounter!=null&&(b.icdcAlertTriggerFailureCounter=a.icdcAlertTriggerFailureCounter)}function v(a,b,c){return i().runInTransaction(a,b,c)}g.setGlobals=a;g.setMyJids=b;g.getMyDeviceJid=j;g.getMyUserJid=e;g.getDbImpls=f;g.getJobResultConvertersImpls=k;g.getPersistedJobsApi=l;g.getJobManager=m;g.isPeerDevice=n;g.getJidUtilsApi=o;g.getCryptoManager=p;g.getInMemoryCryptoManager=q;g.getInMemorySignal=r;g.getConfig=s;g.getDependencies=t;g.setConfig=u;g.runInTransaction=v}),98);
__d("WAStanzaUtils",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a}f.toStanzaId=a}),66);
__d("WAExternalIdFromRandomHex",["WAHex","WAStanzaUtils"],(function(a,b,c,d,e,f,g){function a(a){a=new Uint8Array(d("WAHex").parseHex(a));var b=new Uint8Array(a.length+1),c=0;for(var e=0;e<a.length;e++)c^=a[e],b[e]=a[e];b[a.length]=c;return d("WAStanzaUtils").toStanzaId(d("WAHex").toHex(b))}g.externalIdFromRandomHex=a}),98);
__d("LSMessageContentType.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").one;c=[0,2];d=[0,4];e=[0,8];b=[0,16];var g=[0,32],h=[0,64],i=[0,128],j=[0,256],k=[0,512],l=[0,1024],m=[0,2048],n=[0,4096],o=[0,8192],p=[0,16384],q=[0,32768],r=[0,65536],s=[0,131072],t=[0,262144];f.text=a;f.mediaPreview=c;f.audioClip=d;f.xmaFallback=e;f.lwaWave=b;f.admin=g;f.fileAttachment=h;f.glyph=i;f.tombstone=j;f.storyReply=k;f.singleXma=l;f.hscrollXma=m;f.sticker=n;f.forwardIndicator=o;f.animatedImage=p;f.nullState=q;f.encryptionPlaceholder=r;f.futureproofPlaceholder=s;f.unavailablePlaceholder=t}),null);
__d("LSMessageReplySourceType.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;d=[0,2];e=[0,3];b=[0,4];var g=[0,5],h=[0,6];f.none=a;f.message=c;f.story=d;f.forward=e;f.fbStoryShare=b;f.igStoryShare=g;f.lightweightStatus=h}),null);
__d("LSContactGender.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;d=[0,2];e=[0,3];f.unknown=a;f.female=c;f.male=d;f.neuter=e}),null);
__d("LSContactIdType.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;d=[0,2];f.unknown=a;f.fbid=c;f.smsLocalId=d}),null);
__d("LSContactType.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;d=[0,2];e=[0,3];f.unknown=a;f.user=c;f.page=d;f.pagePersona=e}),null);
__d("LSContactViewerRelationship.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;d=[0,2];e=[0,3];b=[0,4];f.unknown=a;f.notContact=c;f.contactOfViewer=d;f.facebookFriend=e;f.softContact=b}),null);
__d("LSContactWorkForeignEntityType.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;d=[0,2];e=[0,3];f.unknown=a;f.foreign=c;f.notForeign=d;f.notForeignLimited=e}),null);
__d("memoizeByIdentity",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=new Map();return function(c){b.has(c)||b.set(c,a.call(this,c));return b.get(c)}}f["default"]=a}),66);
__d("MWPMessageAuthor.bs",["LS.bs","LSAuthorityLevel.bs","LSContactBlockedByViewerStatus.bs","LSContactGender.bs","LSContactIdType.bs","LSContactType.bs","LSContactViewerRelationship.bs","LSContactWorkForeignEntityType.bs","LSTransaction.bs","LSVerifyContactRowExists","ReQL.bs","ReQLSubscription.bs","ReQLSuspense","bs_belt_Option","bs_caml","memoizeByIdentity","promiseDone","react","useReStore"],(function(a,b,c,d,e,f){"use strict";var g,h=g||b("react"),i=h.createContext({contact:void 0,nickname:void 0});function j(a){var c=a.contactId;a=a.children;var d=b("useReStore")(),e=b("ReQLSubscription.bs").useFirst(h.useMemo(function(){return b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(d.table("contacts")),{hd:c,tl:0})},[d,JSON.stringify(c)])),f=h.useMemo(function(){var a=e!==void 0?e.name:void 0;return{contact:e,nickname:a}},[e]);h.useEffect(function(){b("promiseDone")(b("LSTransaction.bs").run(d,function(a){return b("LSVerifyContactRowExists")(c,b("LSContactIdType.bs").fbid,void 0,void 0,b("LSContactType.bs").user,void 0,void 0,void 0,void 0,!1,!1,b("LSContactBlockedByViewerStatus.bs").unblocked,void 0,!1,b("LSAuthorityLevel.bs").clientPartial,void 0,void 0,b("LSContactWorkForeignEntityType.bs").unknown,b("LSContactGender.bs").unknown,b("LSContactViewerRelationship.bs").unknown,void 0,b("LS.bs").make(a))},"readWrite"),void 0,void 0)},[d,JSON.stringify(c)]);return h.createElement(i.Provider,{children:a,value:f})}e={make:j};function k(a){var b=a.contact,c=a.nickname;a=a.children;var d=h.useMemo(function(){return{contact:b,nickname:c}},[b,c]);return h.createElement(i.Provider,{children:a,value:d})}var l={make:k};function a(a){var c=a.children,d=a.contactId,e=a.threadKey,f=b("useReStore")();a=b("ReQLSuspense").useFirst(function(){return b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(f.table("contacts")),{hd:d,tl:0})},[d]);var g=b("bs_belt_Option").flatMap(b("ReQLSuspense").useFirst(function(){return b("ReQL.bs").map(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(f.table("participants")),{hd:e,tl:{hd:d,tl:0}}),b("memoizeByIdentity")(function(a){return a.nickname}))},[d,e]),function(a){return a});if(a!==void 0)if(b("bs_caml").i64_ge(a.authorityLevel,b("LSAuthorityLevel.bs").authoritativePendingReplacement))return h.jsx(k,{contact:a,nickname:g,children:c});else return h.jsx(j,{contactId:d,children:c});else return h.jsx(j,{contactId:d,children:c})}a=h.memo(a,function(a,c){if(b("bs_caml").i64_eq(a.contactId,c.contactId)&&b("bs_caml").i64_eq(a.threadKey,c.threadKey))return a.children===c.children;else return!1});function c(a){a=h.useContext(i);var b=a.nickname;a=a.contact;if(b!==void 0)b=b;else if(a!==void 0){var c=a.firstName;b=c!==void 0?c:a.name}else b=void 0;return[b,a]}function d(a){a=h.useContext(i);a=a.contact;var b=a!==void 0?a.name:void 0;return[b,a]}f.ctx=i;f.MissingContactProvider=e;f.Provider=l;f.make=a;f.useAuthorName=c;f.useAuthorFullName=d}),null);
__d("LSMessageReplySourceTypeV2.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;d=[0,2];e=[0,3];b=[0,4];var g=[0,5],h=[0,6],i=[0,7],j=[0,8];f.none=a;f.message=c;f.story=d;f.forward=e;f.fbStoryShare=b;f.igStoryShare=g;f.storyBase64Encoded=h;f.lightweightStatus=i;f.closeFriends=j}),null);
__d("LSReplyMessageAttachmentType.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;d=[0,2];e=[0,3];b=[0,4];var g=[0,5],h=[0,6],i=[0,7],j=[0,8],k=[0,9];f.other=a;f.photo=c;f.video=d;f.gif=e;f.sticker=b;f.link=g;f.multiphoto=h;f.permanentRavenPhoto=i;f.permanentRavenVideo=j;f.soundBite=k}),null);
__d("LSReplyMessageStatus.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;d=[0,2];e=[0,3];b=[0,4];f.unknown=a;f.valid=c;f.deleted=d;f.temporaryUnavailable=e;f.expired=b}),null);
__d("MAWMsgReply.bs",["fbt","LSMessageReplySourceTypeV2.bs","LSReplyMessageAttachmentType.bs","LSReplyMessageStatus.bs","MAWGating.bs","MAWMedia.bs","MAWXMA.bs","ODS","Promise","ReQL.bs","bs_belt_Option","bs_caml_array","bs_caml_format","bs_caml_int64","bs_caml_option","bs_curry","bs_int64","cr:385"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return!b("bs_belt_Option").isNone(a.replySourceId)}function c(a){a=a.replyToUserId;if(a!==void 0)return b("bs_caml_format").caml_int64_of_string(b("bs_caml_option").valFromOption(a))}function d(a){var c=a.isForwarded,d=!b("bs_belt_Option").isNone(a.replySourceId),e=a.isStoryReply;a=a.isStoryShare;if(c)return b("LSMessageReplySourceTypeV2.bs").forward;if(a!==void 0&&a)return b("LSMessageReplySourceTypeV2.bs").fbStoryShare;if(d)if(e!==void 0&&e)return b("LSMessageReplySourceTypeV2.bs").story;else return b("LSMessageReplySourceTypeV2.bs").message}function e(a){var c=!b("bs_belt_Option").isNone(a.replySourceId),d=a.isStoryReply;a=a.isStoryShare;if(a!==void 0&&a)return b("LSMessageReplySourceTypeV2.bs").fbStoryShare;if(c)if(d!==void 0&&d)return b("LSMessageReplySourceTypeV2.bs").story;else return b("LSMessageReplySourceTypeV2.bs").message}function h(a){if(!b("bs_belt_Option").isNone(a.replySourceId))return a.replySourceId}function i(a){if(!b("bs_belt_Option").isNone(a.replySourceId))return a.replyMessageText}function j(a){a=a.replyStatusType;if(a===void 0)return;switch(a){case"EphemeralScreenshotAction":case"EphemeralSettingAdmin":case"EphemeralSettingChangeFromCurrentDevice":case"EphemeralSyncResponse":return b("LSReplyMessageStatus.bs").unknown;case"ExpiredEphemeral":return b("LSReplyMessageStatus.bs").expired;case"DeleteForMe":case"Revoked":return b("LSReplyMessageStatus.bs").deleted;case"Ciphertext":case"Futureproof":case"Unavailable":return b("LSReplyMessageStatus.bs").temporaryUnavailable;case"Admin":case"Gif":case"Image":case"Ptt":case"Sticker":case"Text":case"Video":case"XMA":return b("LSReplyMessageStatus.bs").valid;default:return}}function k(a){if(b("bs_belt_Option").isNone(a.replySourceId))return!1;else return b("bs_belt_Option").isSome(a.replyMediaUrlMimeType)}function l(a){if(k(a))return a.replyMediaUrlMimeType}function m(a){if(k(a))return b("bs_belt_Option").map(a.replyMediaPreviewHeight,b("bs_caml_int64").of_int32)}function n(a){if(k(a))return b("bs_belt_Option").map(a.replyMediaPreviewWidth,b("bs_caml_int64").of_int32)}function o(a){var c=a.replyMessageText;c=c!==void 0?b("cr:385")==null?c:b("bs_curry")._1(b("cr:385").unvault,c):"";c=c==="\ud83d\udc4d"&&a.replyStatusType==="Sticker"&&b("MAWGating.bs").isHotLikeEnabled(void 0);var d=k(a);a=a.replyStatusType;if(d){if(a===void 0)return;switch(a){case"Gif":if(c)return;else return b("LSReplyMessageAttachmentType.bs").gif;case"Ptt":if(c)return;else return b("LSReplyMessageAttachmentType.bs").other;case"Sticker":if(!c)return b("LSReplyMessageAttachmentType.bs").sticker;break;case"Video":if(c)return;else return b("LSReplyMessageAttachmentType.bs").video;case"Image":case"XMA":if(c)return;else return b("LSReplyMessageAttachmentType.bs").photo;default:}}if(a!==void 0&&a==="Sticker"&&c)return b("LSReplyMessageAttachmentType.bs").sticker}function p(a){var c=k(a),d=a.replyMediaId;a=a.replyXMAId;if(c&&d!==void 0)if(a!==void 0)return;else return b("bs_belt_Option").map(d,b("MAWMedia.bs").mediaIdToIntExn);if(d!==void 0||a===void 0)return;else return b("bs_belt_Option").map(a,b("MAWXMA.bs").xmaIdToIntExn)}function q(a){var c=a.replyStatusType,d=o(a),e=p(a),f=a.replyMessageText;a=a.isStoryReply;if(c!==void 0&&c==="XMA"&&d===void 0){if(e!==void 0)return;if(f===void 0)return b("bs_caml_int64").zero}if(e!==void 0||!(a!==void 0&&a))return;else return b("bs_caml_int64").zero}function r(a){if(a.length>0)return a}function s(a,c){return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("contacts")),{hd:c,tl:0}))}function t(a,c,d){if(b("bs_belt_Option").isNone(d.replySourceId)){c=d.isStoryShare;if(c===void 0)return b("Promise").resolve(void 0);if(!c)return b("Promise").resolve(void 0);c=b("bs_caml_format").caml_int64_of_string(d.sender);return s(a,c).then(function(a){a=b("bs_belt_Option").flatMap(a,function(a){var b=a.firstName;if(b!==void 0)return r(b);else return r(a.name)});b("ODS").bumpEntityKey(3185,"armadillo_reply","creating_reply_snippet");var c=d.isAuthorMe;if(c)if(a!==void 0)return g._(/*FBT_CALL*/"You shared a story"/*FBT_CALL*/).toString();else return;else if(a!==void 0)return g._(/*FBT_CALL*/"{user} shared a story"/*FBT_CALL*/,[g._param("user",a)]).toString();else return})}var e=b("bs_belt_Option").getExn(d.replyToUserId)===d.sender;c=b("bs_caml_format").caml_int64_of_string(b("bs_belt_Option").getExn(d.replyToUserId));var f=b("bs_caml_format").caml_int64_of_string(d.sender);return b("Promise").all([s(a,c),s(a,f)]).then(function(a){var c=b("bs_belt_Option").flatMap(b("bs_caml_array").get(a,0),function(a){return r(a.name)});a=b("bs_belt_Option").flatMap(b("bs_caml_array").get(a,1),function(a){return r(a.name)});var f=function(a){return b("bs_belt_Option").eq(j(d),a,function(a,c){return b("bs_int64").compare(a,c)===0})};f=f(b("LSReplyMessageStatus.bs").deleted)||f(b("LSReplyMessageStatus.bs").temporaryUnavailable)||f(b("LSReplyMessageStatus.bs").expired);b("ODS").bumpEntityKey(3185,"armadillo_reply","creating_reply_snippet");var h=d.isAuthorMe,i=d.replySenderIsMe,k=d.isStoryReply;if(f){if(h)return g._(/*FBT_CALL*/"You replied to a removed message"/*FBT_CALL*/).toString();if(a!==void 0)return g._(/*FBT_CALL*/"{name} replied to a removed message"/*FBT_CALL*/,[g._param("name",a)]).toString();f=2}else if(h)if(i!==void 0){if(i)return g._(/*FBT_CALL*/"You replied to yourself"/*FBT_CALL*/).toString();if(e||c===void 0)f=2;else{if(k!==void 0)if(k)return g._(/*FBT_CALL*/"You replied to {name}'s story"/*FBT_CALL*/,[g._param("name",c)]).toString();else return g._(/*FBT_CALL*/"You replied to {other_name}"/*FBT_CALL*/,[g._param("other_name",c)]).toString();f=2}}else f=2;else if(i!==void 0)if(i)if(e||a===void 0)f=2;else{if(k!==void 0)if(k)return g._(/*FBT_CALL*/"{name} replied to your story"/*FBT_CALL*/,[g._param("name",a)]).toString();else return g._(/*FBT_CALL*/"{other_name} replied to you"/*FBT_CALL*/,[g._param("other_name",a)]).toString();f=2}else if(e){if(a!==void 0)return g._(/*FBT_CALL*/"{other} replied to themself"/*FBT_CALL*/,[g._param("other",a)]).toString();f=2}else if(c!==void 0){if(a!==void 0)return g._(/*FBT_CALL*/"{other} replied to {other_name}"/*FBT_CALL*/,[g._param("other",a),g._param("other_name",c)]).toString();f=2}else f=2;else f=2;if(f===2)if(c!==void 0){if(a===void 0){b("ODS").bumpEntityKey(3185,"armadillo_reply","missing_reply_to");return g._(/*FBT_CALL*/"Someone replied to {name}"/*FBT_CALL*/,[g._param("name",c)]).toString()}}else if(a!==void 0){b("ODS").bumpEntityKey(3185,"armadillo_reply","missing_sender");return g._(/*FBT_CALL*/"{name} replied to participant"/*FBT_CALL*/,[g._param("name",a)]).toString()}b("ODS").bumpEntityKey(3185,"armadillo_reply","missing_both");return g._(/*FBT_CALL*/"Someone replied to participant"/*FBT_CALL*/).toString()})}f.hasReply=a;f.getReplyUserId=c;f.getReplySourceTypeV2=d;f.getReplySourceType=e;f.getReplySourceId=h;f.getReplyMessageText=i;f.getReplyStatus=j;f.hasReplyMedia=k;f.getReplyMediaMimeType=l;f.getReplyMediaHeight=m;f.getReplyMediaWidth=n;f.$MAWVault$requireCond=b("cr:385");f.getReplyAttachmentType=o;f.getReplyAttachmentId=p;f.getReplyMediaExpirationTimestampMs=q;f.getReplySnippet=t}),null);
__d("WANullthrows",[],(function(a,b,c,d,e,f){function a(a,b){b===void 0&&(b="?");if(a==null)throw new Error("Unexpected null or undefined: "+b);return a}f["default"]=a}),66);
__d("WALogger",["WAHex","WANullthrows"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] ",""]);h=function(){return a};return a}var i=null;function a(a){i=a}function j(a,b){return{verbose:function(){return j(a,b)},color:function(c){return j(a,b)},devConsole:function(){var d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];(d=c("WANullthrows")(i,"WA devConsole logger called before initialization")).devConsole.apply(d,[a,b].concat(f));return j(a,b)},sendLogs:function(c){return a!=="ERROR"&&a!=="CATCHING"?m(h(),c,b):j(a,b)},tags:function(){return j(a,b)}}}function b(a){for(var b=arguments.length,d=new Array(b>1?b-1:0),e=1;e<b;e++)d[e-1]=arguments[e];var f=n(a,d);c("WANullthrows")(i,"WA DEV logger called before initialization").debug(f);return j("DEV",f)}function e(a){for(var b=arguments.length,d=new Array(b>1?b-1:0),e=1;e<b;e++)d[e-1]=arguments[e];var f=n(a,d);c("WANullthrows")(i,"WA DEV_XMPP logger called before initialization").debug(f);return j("DEV_XMPP",f)}function f(a){return function(b){for(var d=arguments.length,e=new Array(d>1?d-1:0),f=1;f<d;f++)e[f-1]=arguments[f];var g=n(b,e);c("WANullthrows")(i,"WA WARN logger called before initialization").error(g,a);return j("CATCHING",g)}}function k(a){for(var b=arguments.length,d=new Array(b>1?b-1:0),e=1;e<b;e++)d[e-1]=arguments[e];var f=n(a,d);c("WANullthrows")(i,"WA LOG logger called before initialization").info(f);return j("LOG",f)}function l(a){for(var b=arguments.length,d=new Array(b>1?b-1:0),e=1;e<b;e++)d[e-1]=arguments[e];var f=n(a,d);c("WANullthrows")(i,"WA WARN logger called before initialization").warn(f);return j("WARN",f)}function m(a){for(var b=arguments.length,d=new Array(b>1?b-1:0),e=1;e<b;e++)d[e-1]=arguments[e];var f=n(a,d),g=void 0;for(var h=0;h<d.length;h++){var k=d[h];if(k instanceof Error){g=k;break}}var l=c("WANullthrows")(i,"WA ERROR logger called before initialization");g!=null?l.error(f,g):l.error(f);return j("ERROR",f)}function n(a,b){var c=[a[0]];b.forEach(function(b,d){c.push(o(b),a[d+1])});return c.join("")}function o(a){if(typeof a==="string")return"'"+a+"'";else if(a==null||typeof a!=="object")return String(a);else if(Array.isArray(a))return"["+a.join(",")+"]";else if(a instanceof Uint8Array)if(a.length<64)return"<<"+p(a)+">>";else{var b=a.subarray(0,32);return"<<"+p(b)+", "+(a.length-b.length)+" more bytes>>"}else if(a.toString===Object.prototype.toString)return JSON.stringify(a,function(a,b){return a?String(b):b});else return String(a)}function p(a){var b=!0,c=a.length;while(b&&c){var e=a[--c];b=32<=e&&e<127}if(b)return JSON.stringify(String.fromCharCode.apply(String,a));else return d("WAHex").toHex(a)}g.initializeWaLogger=a;g.DEV=b;g.DEV_XMPP=e;g.CATCHING=f;g.LOG=k;g.WARN=l;g.ERROR=m;g.debugStr=o;g.bytesToDebugString=p}),98);
__d("WABase64",["WALogger"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Found unexpected character code while decoding B64 at index ",", length ",": ",""]);h=function(){return a};return a}var i=43,j=47,k=61,l=45,m=95,n=3e3,o="data:image/jpeg;base64,";function a(a){return p(a,i,j,!0)}function b(a,b){b===void 0&&(b=!1);return p(a,l,m,b)}function p(a,b,c,d){a=Array.isArray(a)||a instanceof ArrayBuffer?new Uint8Array(a):a;if(a.length<=n)return q(a,b,c,d);else{var e=[];for(var f=0;f<a.length;f+=n)e.push(q(a.subarray(f,f+n),b,c,d));return e.join("")}}function q(a,b,c,d){var e=Math.ceil(a.length*4/3),f=4*Math.ceil(a.length/3),g=new Array(f);for(var h=0,i=0;h<f;h+=4,i+=3){var j=a[i]<<16|a[i+1]<<8|a[i+2];g[h]=j>>18;g[h+1]=j>>12&63;g[h+2]=j>>6&63;g[h+3]=j&63}for(var j=0;j<e;j++){a=g[j];a<26?g[j]=65+a:a<52?g[j]=71+a:a<62?g[j]=a-4:a===62?g[j]=b:g[j]=c}for(var h=e;h<f;h++)g[h]=61;i=String.fromCharCode.apply(String,g);return d?i:i.substring(0,e)}function r(a,b,c,e){var f=a.length,g=new Int32Array(f+f%4);for(var i=0;i<f;i++){var j=a.charCodeAt(i);if(65<=j&&j<=90)g[i]=j-65;else if(97<=j&&j<=122)g[i]=j-71;else if(48<=j&&j<=57)g[i]=j+4;else if(j===b)g[i]=62;else if(j===c)g[i]=63;else if(j===e){f=i;break}else{self.ERROR!=null&&d("WALogger").ERROR(h(),i,f,j);return null}}j=g.length/4;for(var b=0,c=0;b<j;b++,c+=4)g[b]=g[c]<<18|g[c+1]<<12|g[c+2]<<6|g[c+3];e=Math.floor(f*3/4);i=new Uint8Array(e);a=0;b=0;for(;b+3<=e;a++,b+=3){j=g[a];i[b]=j>>16;i[b+1]=j>>8&255;i[b+2]=j&255}switch(e-b){case 2:i[b]=g[a]>>16;i[b+1]=g[a]>>8&255;break;case 1:i[b]=g[a]>>16}return i}function c(a){a=r(a,i,j,k);if(a)return a.buffer;else throw new Error("Base64.decode given invalid string")}function e(a,b){b===void 0&&(b=!1);a=r(a,l,m,b?k:-1);if(a)return a.buffer;else throw new Error("Base64.decode given invalid string")}function f(a){a=a instanceof ArrayBuffer?new Uint8Array(a):r(a,i,j,k);return a&&Array.from(a)}function s(a){return Math.floor(a.length*3/4)}g.BASE64_DATA_URL_SCHEME=o;g.encodeB64=a;g.encodeB64UrlSafe=b;g.decodeB64=c;g.decodeB64UrlSafe=e;g.decodeB64ToJsArray=f;g.sizeWhenB64Decoded=s}),98);
/**
 * License: https://www.facebook.com/legal/license/OKBVmODmb-W/
 */
__d("tweetnacl-1.0.3",[],(function(a,b,c,d,e,f){"use strict";b={};var g={exports:b};function h(){(function(a){var b=function(a){var b,c=new Float64Array(16);if(a)for(b=0;b<a.length;b++)c[b]=a[b];return c},c=function(){throw new Error("no PRNG")},d=new Uint8Array(16),e=new Uint8Array(32);e[0]=9;var f=b(),g=b([1]),h=b([56129,1]),i=b([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),j=b([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),k=b([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),l=b([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),m=b([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function n(a,b,c,d){a[b]=c>>24&255,a[b+1]=c>>16&255,a[b+2]=c>>8&255,a[b+3]=c&255,a[b+4]=d>>24&255,a[b+5]=d>>16&255,a[b+6]=d>>8&255,a[b+7]=d&255}function o(a,b,c,d,e){var f,g=0;for(f=0;f<e;f++)g|=a[b+f]^c[d+f];return(1&g-1>>>8)-1}function p(a,b,c,d){return o(a,b,c,d,16)}function q(a,b,c,d){return o(a,b,c,d,32)}function r(a,b,c,d){var e=d[0]&255|(d[1]&255)<<8|(d[2]&255)<<16|(d[3]&255)<<24,f=c[0]&255|(c[1]&255)<<8|(c[2]&255)<<16|(c[3]&255)<<24,g=c[4]&255|(c[5]&255)<<8|(c[6]&255)<<16|(c[7]&255)<<24,h=c[8]&255|(c[9]&255)<<8|(c[10]&255)<<16|(c[11]&255)<<24,i=c[12]&255|(c[13]&255)<<8|(c[14]&255)<<16|(c[15]&255)<<24,j=d[4]&255|(d[5]&255)<<8|(d[6]&255)<<16|(d[7]&255)<<24,k=b[0]&255|(b[1]&255)<<8|(b[2]&255)<<16|(b[3]&255)<<24,l=b[4]&255|(b[5]&255)<<8|(b[6]&255)<<16|(b[7]&255)<<24,m=b[8]&255|(b[9]&255)<<8|(b[10]&255)<<16|(b[11]&255)<<24;b=b[12]&255|(b[13]&255)<<8|(b[14]&255)<<16|(b[15]&255)<<24;var n=d[8]&255|(d[9]&255)<<8|(d[10]&255)<<16|(d[11]&255)<<24,o=c[16]&255|(c[17]&255)<<8|(c[18]&255)<<16|(c[19]&255)<<24,p=c[20]&255|(c[21]&255)<<8|(c[22]&255)<<16|(c[23]&255)<<24,q=c[24]&255|(c[25]&255)<<8|(c[26]&255)<<16|(c[27]&255)<<24;c=c[28]&255|(c[29]&255)<<8|(c[30]&255)<<16|(c[31]&255)<<24;d=d[12]&255|(d[13]&255)<<8|(d[14]&255)<<16|(d[15]&255)<<24;var r=e,s=f,t=g,u=h,v=i,w=j,x=k,y=l,z=m,A=b,B=n,C=o,D=p,E=q,F=c,G=d,H;for(var I=0;I<20;I+=2)H=r+D|0,v^=H<<7|H>>>32-7,H=v+r|0,z^=H<<9|H>>>32-9,H=z+v|0,D^=H<<13|H>>>32-13,H=D+z|0,r^=H<<18|H>>>32-18,H=w+s|0,A^=H<<7|H>>>32-7,H=A+w|0,E^=H<<9|H>>>32-9,H=E+A|0,s^=H<<13|H>>>32-13,H=s+E|0,w^=H<<18|H>>>32-18,H=B+x|0,F^=H<<7|H>>>32-7,H=F+B|0,t^=H<<9|H>>>32-9,H=t+F|0,x^=H<<13|H>>>32-13,H=x+t|0,B^=H<<18|H>>>32-18,H=G+C|0,u^=H<<7|H>>>32-7,H=u+G|0,y^=H<<9|H>>>32-9,H=y+u|0,C^=H<<13|H>>>32-13,H=C+y|0,G^=H<<18|H>>>32-18,H=r+u|0,s^=H<<7|H>>>32-7,H=s+r|0,t^=H<<9|H>>>32-9,H=t+s|0,u^=H<<13|H>>>32-13,H=u+t|0,r^=H<<18|H>>>32-18,H=w+v|0,x^=H<<7|H>>>32-7,H=x+w|0,y^=H<<9|H>>>32-9,H=y+x|0,v^=H<<13|H>>>32-13,H=v+y|0,w^=H<<18|H>>>32-18,H=B+A|0,C^=H<<7|H>>>32-7,H=C+B|0,z^=H<<9|H>>>32-9,H=z+C|0,A^=H<<13|H>>>32-13,H=A+z|0,B^=H<<18|H>>>32-18,H=G+F|0,D^=H<<7|H>>>32-7,H=D+G|0,E^=H<<9|H>>>32-9,H=E+D|0,F^=H<<13|H>>>32-13,H=F+E|0,G^=H<<18|H>>>32-18;r=r+e|0;s=s+f|0;t=t+g|0;u=u+h|0;v=v+i|0;w=w+j|0;x=x+k|0;y=y+l|0;z=z+m|0;A=A+b|0;B=B+n|0;C=C+o|0;D=D+p|0;E=E+q|0;F=F+c|0;G=G+d|0;a[0]=r>>>0&255;a[1]=r>>>8&255;a[2]=r>>>16&255;a[3]=r>>>24&255;a[4]=s>>>0&255;a[5]=s>>>8&255;a[6]=s>>>16&255;a[7]=s>>>24&255;a[8]=t>>>0&255;a[9]=t>>>8&255;a[10]=t>>>16&255;a[11]=t>>>24&255;a[12]=u>>>0&255;a[13]=u>>>8&255;a[14]=u>>>16&255;a[15]=u>>>24&255;a[16]=v>>>0&255;a[17]=v>>>8&255;a[18]=v>>>16&255;a[19]=v>>>24&255;a[20]=w>>>0&255;a[21]=w>>>8&255;a[22]=w>>>16&255;a[23]=w>>>24&255;a[24]=x>>>0&255;a[25]=x>>>8&255;a[26]=x>>>16&255;a[27]=x>>>24&255;a[28]=y>>>0&255;a[29]=y>>>8&255;a[30]=y>>>16&255;a[31]=y>>>24&255;a[32]=z>>>0&255;a[33]=z>>>8&255;a[34]=z>>>16&255;a[35]=z>>>24&255;a[36]=A>>>0&255;a[37]=A>>>8&255;a[38]=A>>>16&255;a[39]=A>>>24&255;a[40]=B>>>0&255;a[41]=B>>>8&255;a[42]=B>>>16&255;a[43]=B>>>24&255;a[44]=C>>>0&255;a[45]=C>>>8&255;a[46]=C>>>16&255;a[47]=C>>>24&255;a[48]=D>>>0&255;a[49]=D>>>8&255;a[50]=D>>>16&255;a[51]=D>>>24&255;a[52]=E>>>0&255;a[53]=E>>>8&255;a[54]=E>>>16&255;a[55]=E>>>24&255;a[56]=F>>>0&255;a[57]=F>>>8&255;a[58]=F>>>16&255;a[59]=F>>>24&255;a[60]=G>>>0&255;a[61]=G>>>8&255;a[62]=G>>>16&255;a[63]=G>>>24&255}function s(a,b,c,d){var e=d[0]&255|(d[1]&255)<<8|(d[2]&255)<<16|(d[3]&255)<<24,f=c[0]&255|(c[1]&255)<<8|(c[2]&255)<<16|(c[3]&255)<<24,g=c[4]&255|(c[5]&255)<<8|(c[6]&255)<<16|(c[7]&255)<<24,h=c[8]&255|(c[9]&255)<<8|(c[10]&255)<<16|(c[11]&255)<<24,i=c[12]&255|(c[13]&255)<<8|(c[14]&255)<<16|(c[15]&255)<<24,j=d[4]&255|(d[5]&255)<<8|(d[6]&255)<<16|(d[7]&255)<<24,k=b[0]&255|(b[1]&255)<<8|(b[2]&255)<<16|(b[3]&255)<<24,l=b[4]&255|(b[5]&255)<<8|(b[6]&255)<<16|(b[7]&255)<<24,m=b[8]&255|(b[9]&255)<<8|(b[10]&255)<<16|(b[11]&255)<<24;b=b[12]&255|(b[13]&255)<<8|(b[14]&255)<<16|(b[15]&255)<<24;var n=d[8]&255|(d[9]&255)<<8|(d[10]&255)<<16|(d[11]&255)<<24,o=c[16]&255|(c[17]&255)<<8|(c[18]&255)<<16|(c[19]&255)<<24,p=c[20]&255|(c[21]&255)<<8|(c[22]&255)<<16|(c[23]&255)<<24,q=c[24]&255|(c[25]&255)<<8|(c[26]&255)<<16|(c[27]&255)<<24;c=c[28]&255|(c[29]&255)<<8|(c[30]&255)<<16|(c[31]&255)<<24;d=d[12]&255|(d[13]&255)<<8|(d[14]&255)<<16|(d[15]&255)<<24;e=e;f=f;g=g;h=h;i=i;j=j;k=k;l=l;m=m;b=b;n=n;o=o;p=p;q=q;c=c;d=d;var r;for(var s=0;s<20;s+=2)r=e+p|0,i^=r<<7|r>>>32-7,r=i+e|0,m^=r<<9|r>>>32-9,r=m+i|0,p^=r<<13|r>>>32-13,r=p+m|0,e^=r<<18|r>>>32-18,r=j+f|0,b^=r<<7|r>>>32-7,r=b+j|0,q^=r<<9|r>>>32-9,r=q+b|0,f^=r<<13|r>>>32-13,r=f+q|0,j^=r<<18|r>>>32-18,r=n+k|0,c^=r<<7|r>>>32-7,r=c+n|0,g^=r<<9|r>>>32-9,r=g+c|0,k^=r<<13|r>>>32-13,r=k+g|0,n^=r<<18|r>>>32-18,r=d+o|0,h^=r<<7|r>>>32-7,r=h+d|0,l^=r<<9|r>>>32-9,r=l+h|0,o^=r<<13|r>>>32-13,r=o+l|0,d^=r<<18|r>>>32-18,r=e+h|0,f^=r<<7|r>>>32-7,r=f+e|0,g^=r<<9|r>>>32-9,r=g+f|0,h^=r<<13|r>>>32-13,r=h+g|0,e^=r<<18|r>>>32-18,r=j+i|0,k^=r<<7|r>>>32-7,r=k+j|0,l^=r<<9|r>>>32-9,r=l+k|0,i^=r<<13|r>>>32-13,r=i+l|0,j^=r<<18|r>>>32-18,r=n+b|0,o^=r<<7|r>>>32-7,r=o+n|0,m^=r<<9|r>>>32-9,r=m+o|0,b^=r<<13|r>>>32-13,r=b+m|0,n^=r<<18|r>>>32-18,r=d+c|0,p^=r<<7|r>>>32-7,r=p+d|0,q^=r<<9|r>>>32-9,r=q+p|0,c^=r<<13|r>>>32-13,r=c+q|0,d^=r<<18|r>>>32-18;a[0]=e>>>0&255;a[1]=e>>>8&255;a[2]=e>>>16&255;a[3]=e>>>24&255;a[4]=j>>>0&255;a[5]=j>>>8&255;a[6]=j>>>16&255;a[7]=j>>>24&255;a[8]=n>>>0&255;a[9]=n>>>8&255;a[10]=n>>>16&255;a[11]=n>>>24&255;a[12]=d>>>0&255;a[13]=d>>>8&255;a[14]=d>>>16&255;a[15]=d>>>24&255;a[16]=k>>>0&255;a[17]=k>>>8&255;a[18]=k>>>16&255;a[19]=k>>>24&255;a[20]=l>>>0&255;a[21]=l>>>8&255;a[22]=l>>>16&255;a[23]=l>>>24&255;a[24]=m>>>0&255;a[25]=m>>>8&255;a[26]=m>>>16&255;a[27]=m>>>24&255;a[28]=b>>>0&255;a[29]=b>>>8&255;a[30]=b>>>16&255;a[31]=b>>>24&255}function t(a,b,c,d){r(a,b,c,d)}function u(a,b,c,d){s(a,b,c,d)}var v=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function w(a,b,c,d,e,f,g){var h=new Uint8Array(16),i=new Uint8Array(64),j;for(j=0;j<16;j++)h[j]=0;for(j=0;j<8;j++)h[j]=f[j];while(e>=64){t(i,h,g,v);for(j=0;j<64;j++)a[b+j]=c[d+j]^i[j];f=1;for(j=8;j<16;j++)f=f+(h[j]&255)|0,h[j]=f&255,f>>>=8;e-=64;b+=64;d+=64}if(e>0){t(i,h,g,v);for(j=0;j<e;j++)a[b+j]=c[d+j]^i[j]}return 0}function x(a,b,c,d,e){var f=new Uint8Array(16),g=new Uint8Array(64),h;for(h=0;h<16;h++)f[h]=0;for(h=0;h<8;h++)f[h]=d[h];while(c>=64){t(g,f,e,v);for(h=0;h<64;h++)a[b+h]=g[h];d=1;for(h=8;h<16;h++)d=d+(f[h]&255)|0,f[h]=d&255,d>>>=8;c-=64;b+=64}if(c>0){t(g,f,e,v);for(h=0;h<c;h++)a[b+h]=g[h]}return 0}function y(a,b,c,d,e){var f=new Uint8Array(32);u(f,d,e,v);e=new Uint8Array(8);for(var g=0;g<8;g++)e[g]=d[g+16];return x(a,b,c,e,f)}function z(a,b,c,d,e,f,g){var h=new Uint8Array(32);u(h,f,g,v);g=new Uint8Array(8);for(var i=0;i<8;i++)g[i]=f[i+16];return w(a,b,c,d,e,g,h)}var A=function(a){this.buffer=new Uint8Array(16);this.r=new Uint16Array(10);this.h=new Uint16Array(10);this.pad=new Uint16Array(8);this.leftover=0;this.fin=0;var b,c;b=a[0]&255|(a[1]&255)<<8;this.r[0]=b&8191;c=a[2]&255|(a[3]&255)<<8;this.r[1]=(b>>>13|c<<3)&8191;b=a[4]&255|(a[5]&255)<<8;this.r[2]=(c>>>10|b<<6)&7939;c=a[6]&255|(a[7]&255)<<8;this.r[3]=(b>>>7|c<<9)&8191;b=a[8]&255|(a[9]&255)<<8;this.r[4]=(c>>>4|b<<12)&255;this.r[5]=b>>>1&8190;c=a[10]&255|(a[11]&255)<<8;this.r[6]=(b>>>14|c<<2)&8191;b=a[12]&255|(a[13]&255)<<8;this.r[7]=(c>>>11|b<<5)&8065;c=a[14]&255|(a[15]&255)<<8;this.r[8]=(b>>>8|c<<8)&8191;this.r[9]=c>>>5&127;this.pad[0]=a[16]&255|(a[17]&255)<<8;this.pad[1]=a[18]&255|(a[19]&255)<<8;this.pad[2]=a[20]&255|(a[21]&255)<<8;this.pad[3]=a[22]&255|(a[23]&255)<<8;this.pad[4]=a[24]&255|(a[25]&255)<<8;this.pad[5]=a[26]&255|(a[27]&255)<<8;this.pad[6]=a[28]&255|(a[29]&255)<<8;this.pad[7]=a[30]&255|(a[31]&255)<<8};A.prototype.blocks=function(a,b,c){var d=this.fin?0:1<<11,e,f,g,h,i,j,k,l,m,n,o,p=this.h[0],q=this.h[1],r=this.h[2],s=this.h[3],t=this.h[4],u=this.h[5],v=this.h[6],w=this.h[7],x=this.h[8],y=this.h[9],z=this.r[0],A=this.r[1],B=this.r[2],C=this.r[3],D=this.r[4],E=this.r[5],F=this.r[6],G=this.r[7],H=this.r[8],I=this.r[9];while(c>=16)e=a[b+0]&255|(a[b+1]&255)<<8,p+=e&8191,f=a[b+2]&255|(a[b+3]&255)<<8,q+=(e>>>13|f<<3)&8191,e=a[b+4]&255|(a[b+5]&255)<<8,r+=(f>>>10|e<<6)&8191,f=a[b+6]&255|(a[b+7]&255)<<8,s+=(e>>>7|f<<9)&8191,e=a[b+8]&255|(a[b+9]&255)<<8,t+=(f>>>4|e<<12)&8191,u+=e>>>1&8191,f=a[b+10]&255|(a[b+11]&255)<<8,v+=(e>>>14|f<<2)&8191,e=a[b+12]&255|(a[b+13]&255)<<8,w+=(f>>>11|e<<5)&8191,f=a[b+14]&255|(a[b+15]&255)<<8,x+=(e>>>8|f<<8)&8191,y+=f>>>5|d,e=0,f=e,f+=p*z,f+=q*(5*I),f+=r*(5*H),f+=s*(5*G),f+=t*(5*F),e=f>>>13,f&=8191,f+=u*(5*E),f+=v*(5*D),f+=w*(5*C),f+=x*(5*B),f+=y*(5*A),e+=f>>>13,f&=8191,g=e,g+=p*A,g+=q*z,g+=r*(5*I),g+=s*(5*H),g+=t*(5*G),e=g>>>13,g&=8191,g+=u*(5*F),g+=v*(5*E),g+=w*(5*D),g+=x*(5*C),g+=y*(5*B),e+=g>>>13,g&=8191,h=e,h+=p*B,h+=q*A,h+=r*z,h+=s*(5*I),h+=t*(5*H),e=h>>>13,h&=8191,h+=u*(5*G),h+=v*(5*F),h+=w*(5*E),h+=x*(5*D),h+=y*(5*C),e+=h>>>13,h&=8191,i=e,i+=p*C,i+=q*B,i+=r*A,i+=s*z,i+=t*(5*I),e=i>>>13,i&=8191,i+=u*(5*H),i+=v*(5*G),i+=w*(5*F),i+=x*(5*E),i+=y*(5*D),e+=i>>>13,i&=8191,j=e,j+=p*D,j+=q*C,j+=r*B,j+=s*A,j+=t*z,e=j>>>13,j&=8191,j+=u*(5*I),j+=v*(5*H),j+=w*(5*G),j+=x*(5*F),j+=y*(5*E),e+=j>>>13,j&=8191,k=e,k+=p*E,k+=q*D,k+=r*C,k+=s*B,k+=t*A,e=k>>>13,k&=8191,k+=u*z,k+=v*(5*I),k+=w*(5*H),k+=x*(5*G),k+=y*(5*F),e+=k>>>13,k&=8191,l=e,l+=p*F,l+=q*E,l+=r*D,l+=s*C,l+=t*B,e=l>>>13,l&=8191,l+=u*A,l+=v*z,l+=w*(5*I),l+=x*(5*H),l+=y*(5*G),e+=l>>>13,l&=8191,m=e,m+=p*G,m+=q*F,m+=r*E,m+=s*D,m+=t*C,e=m>>>13,m&=8191,m+=u*B,m+=v*A,m+=w*z,m+=x*(5*I),m+=y*(5*H),e+=m>>>13,m&=8191,n=e,n+=p*H,n+=q*G,n+=r*F,n+=s*E,n+=t*D,e=n>>>13,n&=8191,n+=u*C,n+=v*B,n+=w*A,n+=x*z,n+=y*(5*I),e+=n>>>13,n&=8191,o=e,o+=p*I,o+=q*H,o+=r*G,o+=s*F,o+=t*E,e=o>>>13,o&=8191,o+=u*D,o+=v*C,o+=w*B,o+=x*A,o+=y*z,e+=o>>>13,o&=8191,e=(e<<2)+e|0,e=e+f|0,f=e&8191,e=e>>>13,g+=e,p=f,q=g,r=h,s=i,t=j,u=k,v=l,w=m,x=n,y=o,b+=16,c-=16;this.h[0]=p;this.h[1]=q;this.h[2]=r;this.h[3]=s;this.h[4]=t;this.h[5]=u;this.h[6]=v;this.h[7]=w;this.h[8]=x;this.h[9]=y};A.prototype.finish=function(a,b){var c=new Uint16Array(10),d,e;if(this.leftover){e=this.leftover;this.buffer[e++]=1;for(;e<16;e++)this.buffer[e]=0;this.fin=1;this.blocks(this.buffer,0,16)}d=this.h[1]>>>13;this.h[1]&=8191;for(e=2;e<10;e++)this.h[e]+=d,d=this.h[e]>>>13,this.h[e]&=8191;this.h[0]+=d*5;d=this.h[0]>>>13;this.h[0]&=8191;this.h[1]+=d;d=this.h[1]>>>13;this.h[1]&=8191;this.h[2]+=d;c[0]=this.h[0]+5;d=c[0]>>>13;c[0]&=8191;for(e=1;e<10;e++)c[e]=this.h[e]+d,d=c[e]>>>13,c[e]&=8191;c[9]-=1<<13;d=(d^1)-1;for(e=0;e<10;e++)c[e]&=d;d=~d;for(e=0;e<10;e++)this.h[e]=this.h[e]&d|c[e];this.h[0]=(this.h[0]|this.h[1]<<13)&65535;this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535;this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535;this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535;this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535;this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535;this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535;this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535;c=this.h[0]+this.pad[0];this.h[0]=c&65535;for(e=1;e<8;e++)c=(this.h[e]+this.pad[e]|0)+(c>>>16)|0,this.h[e]=c&65535;a[b+0]=this.h[0]>>>0&255;a[b+1]=this.h[0]>>>8&255;a[b+2]=this.h[1]>>>0&255;a[b+3]=this.h[1]>>>8&255;a[b+4]=this.h[2]>>>0&255;a[b+5]=this.h[2]>>>8&255;a[b+6]=this.h[3]>>>0&255;a[b+7]=this.h[3]>>>8&255;a[b+8]=this.h[4]>>>0&255;a[b+9]=this.h[4]>>>8&255;a[b+10]=this.h[5]>>>0&255;a[b+11]=this.h[5]>>>8&255;a[b+12]=this.h[6]>>>0&255;a[b+13]=this.h[6]>>>8&255;a[b+14]=this.h[7]>>>0&255;a[b+15]=this.h[7]>>>8&255};A.prototype.update=function(a,b,c){var d,e;if(this.leftover){e=16-this.leftover;e>c&&(e=c);for(d=0;d<e;d++)this.buffer[this.leftover+d]=a[b+d];c-=e;b+=e;this.leftover+=e;if(this.leftover<16)return;this.blocks(this.buffer,0,16);this.leftover=0}c>=16&&(e=c-c%16,this.blocks(a,b,e),b+=e,c-=e);if(c){for(d=0;d<c;d++)this.buffer[this.leftover+d]=a[b+d];this.leftover+=c}};function B(a,b,c,d,e,f){f=new A(f);f.update(c,d,e);f.finish(a,b);return 0}function C(a,b,c,d,e,f){var g=new Uint8Array(16);B(g,0,c,d,e,f);return p(a,b,g,0)}function D(a,b,c,d,e){if(c<32)return-1;z(a,0,b,0,c,d,e);B(a,16,a,32,c-32,a);for(b=0;b<16;b++)a[b]=0;return 0}function E(a,b,c,d,e){var f=new Uint8Array(32);if(c<32)return-1;y(f,0,32,d,e);if(C(b,16,b,32,c-32,f)!==0)return-1;z(a,0,b,0,c,d,e);for(f=0;f<32;f++)a[f]=0;return 0}function F(a,b){var c;for(c=0;c<16;c++)a[c]=b[c]|0}function G(a){var b,c,d=1;for(b=0;b<16;b++)c=a[b]+d+65535,d=Math.floor(c/65536),a[b]=c-d*65536;a[0]+=d-1+37*(d-1)}function H(a,b,c){var d;c=~(c-1);for(var e=0;e<16;e++)d=c&(a[e]^b[e]),a[e]^=d,b[e]^=d}function I(a,c){var d,e,f=b(),g=b();for(d=0;d<16;d++)g[d]=c[d];G(g);G(g);G(g);for(c=0;c<2;c++){f[0]=g[0]-65517;for(d=1;d<15;d++)f[d]=g[d]-65535-(f[d-1]>>16&1),f[d-1]&=65535;f[15]=g[15]-32767-(f[14]>>16&1);e=f[15]>>16&1;f[14]&=65535;H(g,f,1-e)}for(d=0;d<16;d++)a[2*d]=g[d]&255,a[2*d+1]=g[d]>>8}function J(a,b){var c=new Uint8Array(32),d=new Uint8Array(32);I(c,a);I(d,b);return q(c,0,d,0)}function K(a){var b=new Uint8Array(32);I(b,a);return b[0]&1}function L(a,b){var c;for(c=0;c<16;c++)a[c]=b[2*c]+(b[2*c+1]<<8);a[15]&=32767}function M(a,b,c){for(var d=0;d<16;d++)a[d]=b[d]+c[d]}function N(a,b,c){for(var d=0;d<16;d++)a[d]=b[d]-c[d]}function O(a,b,c){var d,e=0,f=0,g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0,A=0,B=0,C=0,D=0,E=0,F=0,G=0,H=0,I=0,J=c[0],K=c[1],L=c[2],M=c[3],N=c[4],O=c[5],P=c[6],Q=c[7],R=c[8],S=c[9],T=c[10],U=c[11],V=c[12],W=c[13],X=c[14];c=c[15];d=b[0];e+=d*J;f+=d*K;g+=d*L;h+=d*M;i+=d*N;j+=d*O;k+=d*P;l+=d*Q;m+=d*R;n+=d*S;o+=d*T;p+=d*U;q+=d*V;r+=d*W;s+=d*X;t+=d*c;d=b[1];f+=d*J;g+=d*K;h+=d*L;i+=d*M;j+=d*N;k+=d*O;l+=d*P;m+=d*Q;n+=d*R;o+=d*S;p+=d*T;q+=d*U;r+=d*V;s+=d*W;t+=d*X;u+=d*c;d=b[2];g+=d*J;h+=d*K;i+=d*L;j+=d*M;k+=d*N;l+=d*O;m+=d*P;n+=d*Q;o+=d*R;p+=d*S;q+=d*T;r+=d*U;s+=d*V;t+=d*W;u+=d*X;v+=d*c;d=b[3];h+=d*J;i+=d*K;j+=d*L;k+=d*M;l+=d*N;m+=d*O;n+=d*P;o+=d*Q;p+=d*R;q+=d*S;r+=d*T;s+=d*U;t+=d*V;u+=d*W;v+=d*X;w+=d*c;d=b[4];i+=d*J;j+=d*K;k+=d*L;l+=d*M;m+=d*N;n+=d*O;o+=d*P;p+=d*Q;q+=d*R;r+=d*S;s+=d*T;t+=d*U;u+=d*V;v+=d*W;w+=d*X;x+=d*c;d=b[5];j+=d*J;k+=d*K;l+=d*L;m+=d*M;n+=d*N;o+=d*O;p+=d*P;q+=d*Q;r+=d*R;s+=d*S;t+=d*T;u+=d*U;v+=d*V;w+=d*W;x+=d*X;y+=d*c;d=b[6];k+=d*J;l+=d*K;m+=d*L;n+=d*M;o+=d*N;p+=d*O;q+=d*P;r+=d*Q;s+=d*R;t+=d*S;u+=d*T;v+=d*U;w+=d*V;x+=d*W;y+=d*X;z+=d*c;d=b[7];l+=d*J;m+=d*K;n+=d*L;o+=d*M;p+=d*N;q+=d*O;r+=d*P;s+=d*Q;t+=d*R;u+=d*S;v+=d*T;w+=d*U;x+=d*V;y+=d*W;z+=d*X;A+=d*c;d=b[8];m+=d*J;n+=d*K;o+=d*L;p+=d*M;q+=d*N;r+=d*O;s+=d*P;t+=d*Q;u+=d*R;v+=d*S;w+=d*T;x+=d*U;y+=d*V;z+=d*W;A+=d*X;B+=d*c;d=b[9];n+=d*J;o+=d*K;p+=d*L;q+=d*M;r+=d*N;s+=d*O;t+=d*P;u+=d*Q;v+=d*R;w+=d*S;x+=d*T;y+=d*U;z+=d*V;A+=d*W;B+=d*X;C+=d*c;d=b[10];o+=d*J;p+=d*K;q+=d*L;r+=d*M;s+=d*N;t+=d*O;u+=d*P;v+=d*Q;w+=d*R;x+=d*S;y+=d*T;z+=d*U;A+=d*V;B+=d*W;C+=d*X;D+=d*c;d=b[11];p+=d*J;q+=d*K;r+=d*L;s+=d*M;t+=d*N;u+=d*O;v+=d*P;w+=d*Q;x+=d*R;y+=d*S;z+=d*T;A+=d*U;B+=d*V;C+=d*W;D+=d*X;E+=d*c;d=b[12];q+=d*J;r+=d*K;s+=d*L;t+=d*M;u+=d*N;v+=d*O;w+=d*P;x+=d*Q;y+=d*R;z+=d*S;A+=d*T;B+=d*U;C+=d*V;D+=d*W;E+=d*X;F+=d*c;d=b[13];r+=d*J;s+=d*K;t+=d*L;u+=d*M;v+=d*N;w+=d*O;x+=d*P;y+=d*Q;z+=d*R;A+=d*S;B+=d*T;C+=d*U;D+=d*V;E+=d*W;F+=d*X;G+=d*c;d=b[14];s+=d*J;t+=d*K;u+=d*L;v+=d*M;w+=d*N;x+=d*O;y+=d*P;z+=d*Q;A+=d*R;B+=d*S;C+=d*T;D+=d*U;E+=d*V;F+=d*W;G+=d*X;H+=d*c;d=b[15];t+=d*J;u+=d*K;v+=d*L;w+=d*M;x+=d*N;y+=d*O;z+=d*P;A+=d*Q;B+=d*R;C+=d*S;D+=d*T;E+=d*U;F+=d*V;G+=d*W;H+=d*X;I+=d*c;e+=38*u;f+=38*v;g+=38*w;h+=38*x;i+=38*y;j+=38*z;k+=38*A;l+=38*B;m+=38*C;n+=38*D;o+=38*E;p+=38*F;q+=38*G;r+=38*H;s+=38*I;b=1;d=e+b+65535;b=Math.floor(d/65536);e=d-b*65536;d=f+b+65535;b=Math.floor(d/65536);f=d-b*65536;d=g+b+65535;b=Math.floor(d/65536);g=d-b*65536;d=h+b+65535;b=Math.floor(d/65536);h=d-b*65536;d=i+b+65535;b=Math.floor(d/65536);i=d-b*65536;d=j+b+65535;b=Math.floor(d/65536);j=d-b*65536;d=k+b+65535;b=Math.floor(d/65536);k=d-b*65536;d=l+b+65535;b=Math.floor(d/65536);l=d-b*65536;d=m+b+65535;b=Math.floor(d/65536);m=d-b*65536;d=n+b+65535;b=Math.floor(d/65536);n=d-b*65536;d=o+b+65535;b=Math.floor(d/65536);o=d-b*65536;d=p+b+65535;b=Math.floor(d/65536);p=d-b*65536;d=q+b+65535;b=Math.floor(d/65536);q=d-b*65536;d=r+b+65535;b=Math.floor(d/65536);r=d-b*65536;d=s+b+65535;b=Math.floor(d/65536);s=d-b*65536;d=t+b+65535;b=Math.floor(d/65536);t=d-b*65536;e+=b-1+37*(b-1);b=1;d=e+b+65535;b=Math.floor(d/65536);e=d-b*65536;d=f+b+65535;b=Math.floor(d/65536);f=d-b*65536;d=g+b+65535;b=Math.floor(d/65536);g=d-b*65536;d=h+b+65535;b=Math.floor(d/65536);h=d-b*65536;d=i+b+65535;b=Math.floor(d/65536);i=d-b*65536;d=j+b+65535;b=Math.floor(d/65536);j=d-b*65536;d=k+b+65535;b=Math.floor(d/65536);k=d-b*65536;d=l+b+65535;b=Math.floor(d/65536);l=d-b*65536;d=m+b+65535;b=Math.floor(d/65536);m=d-b*65536;d=n+b+65535;b=Math.floor(d/65536);n=d-b*65536;d=o+b+65535;b=Math.floor(d/65536);o=d-b*65536;d=p+b+65535;b=Math.floor(d/65536);p=d-b*65536;d=q+b+65535;b=Math.floor(d/65536);q=d-b*65536;d=r+b+65535;b=Math.floor(d/65536);r=d-b*65536;d=s+b+65535;b=Math.floor(d/65536);s=d-b*65536;d=t+b+65535;b=Math.floor(d/65536);t=d-b*65536;e+=b-1+37*(b-1);a[0]=e;a[1]=f;a[2]=g;a[3]=h;a[4]=i;a[5]=j;a[6]=k;a[7]=l;a[8]=m;a[9]=n;a[10]=o;a[11]=p;a[12]=q;a[13]=r;a[14]=s;a[15]=t}function P(a,b){O(a,b,b)}function Q(a,c){var d=b(),e;for(e=0;e<16;e++)d[e]=c[e];for(e=253;e>=0;e--)P(d,d),e!==2&&e!==4&&O(d,d,c);for(e=0;e<16;e++)a[e]=d[e]}function R(a,c){var d=b(),e;for(e=0;e<16;e++)d[e]=c[e];for(e=250;e>=0;e--)P(d,d),e!==1&&O(d,d,c);for(e=0;e<16;e++)a[e]=d[e]}function S(a,c,d){var e=new Uint8Array(32),f=new Float64Array(80),g,i=b(),j=b(),k=b(),l=b(),m=b(),n=b();for(g=0;g<31;g++)e[g]=c[g];e[31]=c[31]&127|64;e[0]&=248;L(f,d);for(g=0;g<16;g++)j[g]=f[g],l[g]=i[g]=k[g]=0;i[0]=l[0]=1;for(g=254;g>=0;--g)c=e[g>>>3]>>>(g&7)&1,H(i,j,c),H(k,l,c),M(m,i,k),N(i,i,k),M(k,j,l),N(j,j,l),P(l,m),P(n,i),O(i,k,i),O(k,j,m),M(m,i,k),N(i,i,k),P(j,i),N(k,l,n),O(i,k,h),M(i,i,l),O(k,k,i),O(i,l,n),O(l,j,f),P(j,m),H(i,j,c),H(k,l,c);for(g=0;g<16;g++)f[g+16]=i[g],f[g+32]=k[g],f[g+48]=j[g],f[g+64]=l[g];d=f.subarray(32);c=f.subarray(16);Q(d,d);O(c,c,d);I(a,c);return 0}function T(a,b){return S(a,b,e)}function U(a,b){c(b,32);return T(a,b)}function V(a,b,c){var e=new Uint8Array(32);S(e,c,b);return u(a,d,e,v)}var W=D,X=E;function aa(a,b,c,d,e,f){var g=new Uint8Array(32);V(g,e,f);return W(a,b,c,d,g)}function ba(a,b,c,d,e,f){var g=new Uint8Array(32);V(g,e,f);return X(a,b,c,d,g)}var ca=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function da(a,b,c,d){var e=new Int32Array(16),f=new Int32Array(16),g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G=a[0],H=a[1],I=a[2],J=a[3],K=a[4],L=a[5],M=a[6],N=a[7],O=b[0],P=b[1],Q=b[2],R=b[3],S=b[4],T=b[5],U=b[6],V=b[7],W=0;while(d>=128){for(y=0;y<16;y++)z=8*y+W,e[y]=c[z+0]<<24|c[z+1]<<16|c[z+2]<<8|c[z+3],f[y]=c[z+4]<<24|c[z+5]<<16|c[z+6]<<8|c[z+7];for(y=0;y<80;y++){g=G;h=H;i=I;j=J;k=K;l=L;m=M;N;o=O;p=P;q=Q;r=R;s=S;t=T;u=U;V;A=N;B=V;C=B&65535;D=B>>>16;E=A&65535;F=A>>>16;A=(K>>>14|S<<32-14)^(K>>>18|S<<32-18)^(S>>>41-32|K<<32-(41-32));B=(S>>>14|K<<32-14)^(S>>>18|K<<32-18)^(K>>>41-32|S<<32-(41-32));C+=B&65535;D+=B>>>16;E+=A&65535;F+=A>>>16;A=K&L^~K&M;B=S&T^~S&U;C+=B&65535;D+=B>>>16;E+=A&65535;F+=A>>>16;A=ca[y*2];B=ca[y*2+1];C+=B&65535;D+=B>>>16;E+=A&65535;F+=A>>>16;A=e[y%16];B=f[y%16];C+=B&65535;D+=B>>>16;E+=A&65535;F+=A>>>16;D+=C>>>16;E+=D>>>16;F+=E>>>16;w=E&65535|F<<16;x=C&65535|D<<16;A=w;B=x;C=B&65535;D=B>>>16;E=A&65535;F=A>>>16;A=(G>>>28|O<<32-28)^(O>>>34-32|G<<32-(34-32))^(O>>>39-32|G<<32-(39-32));B=(O>>>28|G<<32-28)^(G>>>34-32|O<<32-(34-32))^(G>>>39-32|O<<32-(39-32));C+=B&65535;D+=B>>>16;E+=A&65535;F+=A>>>16;A=G&H^G&I^H&I;B=O&P^O&Q^P&Q;C+=B&65535;D+=B>>>16;E+=A&65535;F+=A>>>16;D+=C>>>16;E+=D>>>16;F+=E>>>16;n=E&65535|F<<16;v=C&65535|D<<16;A=j;B=r;C=B&65535;D=B>>>16;E=A&65535;F=A>>>16;A=w;B=x;C+=B&65535;D+=B>>>16;E+=A&65535;F+=A>>>16;D+=C>>>16;E+=D>>>16;F+=E>>>16;j=E&65535|F<<16;r=C&65535|D<<16;H=g;I=h;J=i;K=j;L=k;M=l;N=m;G=n;P=o;Q=p;R=q;S=r;T=s;U=t;V=u;O=v;if(y%16===15)for(z=0;z<16;z++)A=e[z],B=f[z],C=B&65535,D=B>>>16,E=A&65535,F=A>>>16,A=e[(z+9)%16],B=f[(z+9)%16],C+=B&65535,D+=B>>>16,E+=A&65535,F+=A>>>16,w=e[(z+1)%16],x=f[(z+1)%16],A=(w>>>1|x<<32-1)^(w>>>8|x<<32-8)^w>>>7,B=(x>>>1|w<<32-1)^(x>>>8|w<<32-8)^(x>>>7|w<<32-7),C+=B&65535,D+=B>>>16,E+=A&65535,F+=A>>>16,w=e[(z+14)%16],x=f[(z+14)%16],A=(w>>>19|x<<32-19)^(x>>>61-32|w<<32-(61-32))^w>>>6,B=(x>>>19|w<<32-19)^(w>>>61-32|x<<32-(61-32))^(x>>>6|w<<32-6),C+=B&65535,D+=B>>>16,E+=A&65535,F+=A>>>16,D+=C>>>16,E+=D>>>16,F+=E>>>16,e[z]=E&65535|F<<16,f[z]=C&65535|D<<16}A=G;B=O;C=B&65535;D=B>>>16;E=A&65535;F=A>>>16;A=a[0];B=b[0];C+=B&65535;D+=B>>>16;E+=A&65535;F+=A>>>16;D+=C>>>16;E+=D>>>16;F+=E>>>16;a[0]=G=E&65535|F<<16;b[0]=O=C&65535|D<<16;A=H;B=P;C=B&65535;D=B>>>16;E=A&65535;F=A>>>16;A=a[1];B=b[1];C+=B&65535;D+=B>>>16;E+=A&65535;F+=A>>>16;D+=C>>>16;E+=D>>>16;F+=E>>>16;a[1]=H=E&65535|F<<16;b[1]=P=C&65535|D<<16;A=I;B=Q;C=B&65535;D=B>>>16;E=A&65535;F=A>>>16;A=a[2];B=b[2];C+=B&65535;D+=B>>>16;E+=A&65535;F+=A>>>16;D+=C>>>16;E+=D>>>16;F+=E>>>16;a[2]=I=E&65535|F<<16;b[2]=Q=C&65535|D<<16;A=J;B=R;C=B&65535;D=B>>>16;E=A&65535;F=A>>>16;A=a[3];B=b[3];C+=B&65535;D+=B>>>16;E+=A&65535;F+=A>>>16;D+=C>>>16;E+=D>>>16;F+=E>>>16;a[3]=J=E&65535|F<<16;b[3]=R=C&65535|D<<16;A=K;B=S;C=B&65535;D=B>>>16;E=A&65535;F=A>>>16;A=a[4];B=b[4];C+=B&65535;D+=B>>>16;E+=A&65535;F+=A>>>16;D+=C>>>16;E+=D>>>16;F+=E>>>16;a[4]=K=E&65535|F<<16;b[4]=S=C&65535|D<<16;A=L;B=T;C=B&65535;D=B>>>16;E=A&65535;F=A>>>16;A=a[5];B=b[5];C+=B&65535;D+=B>>>16;E+=A&65535;F+=A>>>16;D+=C>>>16;E+=D>>>16;F+=E>>>16;a[5]=L=E&65535|F<<16;b[5]=T=C&65535|D<<16;A=M;B=U;C=B&65535;D=B>>>16;E=A&65535;F=A>>>16;A=a[6];B=b[6];C+=B&65535;D+=B>>>16;E+=A&65535;F+=A>>>16;D+=C>>>16;E+=D>>>16;F+=E>>>16;a[6]=M=E&65535|F<<16;b[6]=U=C&65535|D<<16;A=N;B=V;C=B&65535;D=B>>>16;E=A&65535;F=A>>>16;A=a[7];B=b[7];C+=B&65535;D+=B>>>16;E+=A&65535;F+=A>>>16;D+=C>>>16;E+=D>>>16;F+=E>>>16;a[7]=N=E&65535|F<<16;b[7]=V=C&65535|D<<16;W+=128;d-=128}return d}function Y(a,b,c){var d=new Int32Array(8),e=new Int32Array(8),f=new Uint8Array(256),g,h=c;d[0]=1779033703;d[1]=3144134277;d[2]=1013904242;d[3]=2773480762;d[4]=1359893119;d[5]=2600822924;d[6]=528734635;d[7]=1541459225;e[0]=4089235720;e[1]=2227873595;e[2]=4271175723;e[3]=1595750129;e[4]=2917565137;e[5]=725511199;e[6]=4215389547;e[7]=327033209;da(d,e,b,c);c%=128;for(g=0;g<c;g++)f[g]=b[h-c+g];f[c]=128;c=256-128*(c<112?1:0);f[c-9]=0;n(f,c-8,h/536870912|0,h<<3);da(d,e,f,c);for(g=0;g<8;g++)n(a,8*g,d[g],e[g]);return 0}function ea(a,c){var d=b(),e=b(),f=b(),g=b(),h=b(),i=b(),k=b(),l=b(),m=b();N(d,a[1],a[0]);N(m,c[1],c[0]);O(d,d,m);M(e,a[0],a[1]);M(m,c[0],c[1]);O(e,e,m);O(f,a[3],c[3]);O(f,f,j);O(g,a[2],c[2]);M(g,g,g);N(h,e,d);N(i,g,f);M(k,g,f);M(l,e,d);O(a[0],h,i);O(a[1],l,k);O(a[2],k,i);O(a[3],h,l)}function fa(a,b,c){var d;for(d=0;d<4;d++)H(a[d],b[d],c)}function ga(a,c){var d=b(),e=b(),f=b();Q(f,c[2]);O(d,c[0],f);O(e,c[1],f);I(a,e);a[31]^=K(d)<<7}function ha(a,b,c){var d,e;F(a[0],f);F(a[1],g);F(a[2],g);F(a[3],f);for(e=255;e>=0;--e)d=c[e/8|0]>>(e&7)&1,fa(a,b,d),ea(b,a),ea(a,a),fa(a,b,d)}function ia(a,c){var d=[b(),b(),b(),b()];F(d[0],k);F(d[1],l);F(d[2],g);O(d[3],k,l);ha(a,d,c)}function ja(a,d,e){var f=new Uint8Array(64),g=[b(),b(),b(),b()];e||c(d,32);Y(f,d,32);f[0]&=248;f[31]&=127;f[31]|=64;ia(g,f);ga(a,g);for(e=0;e<32;e++)d[e+32]=a[e];return 0}var ka=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function la(a,b){var c,d,e,f;for(d=63;d>=32;--d){c=0;for(e=d-32,f=d-12;e<f;++e)b[e]+=c-16*b[d]*ka[e-(d-32)],c=Math.floor((b[e]+128)/256),b[e]-=c*256;b[e]+=c;b[d]=0}c=0;for(e=0;e<32;e++)b[e]+=c-(b[31]>>4)*ka[e],c=b[e]>>8,b[e]&=255;for(e=0;e<32;e++)b[e]-=c*ka[e];for(d=0;d<32;d++)b[d+1]+=b[d]>>8,a[d]=b[d]&255}function ma(a){var b=new Float64Array(64),c;for(c=0;c<64;c++)b[c]=a[c];for(c=0;c<64;c++)a[c]=0;la(a,b)}function na(a,c,d,e){var f=new Uint8Array(64),g=new Uint8Array(64),h=new Uint8Array(64),i,j=new Float64Array(64),k=[b(),b(),b(),b()];Y(f,e,32);f[0]&=248;f[31]&=127;f[31]|=64;var l=d+64;for(i=0;i<d;i++)a[64+i]=c[i];for(i=0;i<32;i++)a[32+i]=f[32+i];Y(h,a.subarray(32),d+32);ma(h);ia(k,h);ga(a,k);for(i=32;i<64;i++)a[i]=e[i];Y(g,a,d+64);ma(g);for(i=0;i<64;i++)j[i]=0;for(i=0;i<32;i++)j[i]=h[i];for(i=0;i<32;i++)for(c=0;c<32;c++)j[i+c]+=g[i]*f[c];la(a.subarray(32),j);return l}function oa(a,c){var d=b(),e=b(),h=b(),j=b(),k=b(),l=b(),n=b();F(a[2],g);L(a[1],c);P(h,a[1]);O(j,h,i);N(h,h,a[2]);M(j,a[2],j);P(k,j);P(l,k);O(n,l,k);O(d,n,h);O(d,d,j);R(d,d);O(d,d,h);O(d,d,j);O(d,d,j);O(a[0],d,j);P(e,a[0]);O(e,e,j);J(e,h)&&O(a[0],a[0],m);P(e,a[0]);O(e,e,j);if(J(e,h))return-1;K(a[0])===c[31]>>7&&N(a[0],f,a[0]);O(a[3],a[0],a[1]);return 0}function pa(a,c,d,e){var f,g=new Uint8Array(32),h=new Uint8Array(64),i=[b(),b(),b(),b()],j=[b(),b(),b(),b()];if(d<64)return-1;if(oa(j,e))return-1;for(f=0;f<d;f++)a[f]=c[f];for(f=0;f<32;f++)a[f+32]=e[f];Y(h,a,d);ma(h);ha(i,j,h);ia(j,c.subarray(32));ea(i,j);ga(g,i);d-=64;if(q(c,0,g,0)){for(f=0;f<d;f++)a[f]=0;return-1}for(f=0;f<d;f++)a[f]=c[f+64];return d}var qa=32,ra=24,sa=32,ta=16,ua=32,va=32,wa=32,xa=32,ya=32,za=ra,Aa=sa,Ba=ta,Z=64,Ca=32,Da=64,Ea=32,Fa=64;a.lowlevel={crypto_core_hsalsa20:u,crypto_stream_xor:z,crypto_stream:y,crypto_stream_salsa20_xor:w,crypto_stream_salsa20:x,crypto_onetimeauth:B,crypto_onetimeauth_verify:C,crypto_verify_16:p,crypto_verify_32:q,crypto_secretbox:D,crypto_secretbox_open:E,crypto_scalarmult:S,crypto_scalarmult_base:T,crypto_box_beforenm:V,crypto_box_afternm:W,crypto_box:aa,crypto_box_open:ba,crypto_box_keypair:U,crypto_hash:Y,crypto_sign:na,crypto_sign_keypair:ja,crypto_sign_open:pa,crypto_secretbox_KEYBYTES:qa,crypto_secretbox_NONCEBYTES:ra,crypto_secretbox_ZEROBYTES:sa,crypto_secretbox_BOXZEROBYTES:ta,crypto_scalarmult_BYTES:ua,crypto_scalarmult_SCALARBYTES:va,crypto_box_PUBLICKEYBYTES:wa,crypto_box_SECRETKEYBYTES:xa,crypto_box_BEFORENMBYTES:ya,crypto_box_NONCEBYTES:za,crypto_box_ZEROBYTES:Aa,crypto_box_BOXZEROBYTES:Ba,crypto_sign_BYTES:Z,crypto_sign_PUBLICKEYBYTES:Ca,crypto_sign_SECRETKEYBYTES:Da,crypto_sign_SEEDBYTES:Ea,crypto_hash_BYTES:Fa,gf:b,D:i,L:ka,pack25519:I,unpack25519:L,M:O,A:M,S:P,Z:N,pow2523:R,add:ea,set25519:F,modL:la,scalarmult:ha,scalarbase:ia};function Ga(a,b){if(a.length!==qa)throw new Error("bad key size");if(b.length!==ra)throw new Error("bad nonce size")}function Ha(a,b){if(a.length!==wa)throw new Error("bad public key size");if(b.length!==xa)throw new Error("bad secret key size")}function $(){for(var a=0;a<arguments.length;a++)if(!(arguments[a]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function Ia(a){for(var b=0;b<a.length;b++)a[b]=0}a.randomBytes=function(a){var b=new Uint8Array(a);c(b,a);return b};a.secretbox=function(a,b,c){$(a,b,c);Ga(c,b);var d=new Uint8Array(sa+a.length),e=new Uint8Array(d.length);for(var f=0;f<a.length;f++)d[f+sa]=a[f];D(e,d,d.length,b,c);return e.subarray(ta)};a.secretbox.open=function(a,b,c){$(a,b,c);Ga(c,b);var d=new Uint8Array(ta+a.length),e=new Uint8Array(d.length);for(var f=0;f<a.length;f++)d[f+ta]=a[f];if(d.length<32)return null;return E(e,d,d.length,b,c)!==0?null:e.subarray(sa)};a.secretbox.keyLength=qa;a.secretbox.nonceLength=ra;a.secretbox.overheadLength=ta;a.scalarMult=function(a,b){$(a,b);if(a.length!==va)throw new Error("bad n size");if(b.length!==ua)throw new Error("bad p size");var c=new Uint8Array(ua);S(c,a,b);return c};a.scalarMult.base=function(a){$(a);if(a.length!==va)throw new Error("bad n size");var b=new Uint8Array(ua);T(b,a);return b};a.scalarMult.scalarLength=va;a.scalarMult.groupElementLength=ua;a.box=function(b,c,d,e){d=a.box.before(d,e);return a.secretbox(b,c,d)};a.box.before=function(a,b){$(a,b);Ha(a,b);var c=new Uint8Array(ya);V(c,a,b);return c};a.box.after=a.secretbox;a.box.open=function(b,c,d,e){d=a.box.before(d,e);return a.secretbox.open(b,c,d)};a.box.open.after=a.secretbox.open;a.box.keyPair=function(){var a=new Uint8Array(wa),b=new Uint8Array(xa);U(a,b);return{publicKey:a,secretKey:b}};a.box.keyPair.fromSecretKey=function(a){$(a);if(a.length!==xa)throw new Error("bad secret key size");var b=new Uint8Array(wa);T(b,a);return{publicKey:b,secretKey:new Uint8Array(a)}};a.box.publicKeyLength=wa;a.box.secretKeyLength=xa;a.box.sharedKeyLength=ya;a.box.nonceLength=za;a.box.overheadLength=a.secretbox.overheadLength;a.sign=function(a,b){$(a,b);if(b.length!==Da)throw new Error("bad secret key size");var c=new Uint8Array(Z+a.length);na(c,a,a.length,b);return c};a.sign.open=function(a,b){$(a,b);if(b.length!==Ca)throw new Error("bad public key size");var c=new Uint8Array(a.length);a=pa(c,a,a.length,b);if(a<0)return null;b=new Uint8Array(a);for(var a=0;a<b.length;a++)b[a]=c[a];return b};a.sign.detached=function(b,c){b=a.sign(b,c);c=new Uint8Array(Z);for(var d=0;d<c.length;d++)c[d]=b[d];return c};a.sign.detached.verify=function(a,b,c){$(a,b,c);if(b.length!==Z)throw new Error("bad signature size");if(c.length!==Ca)throw new Error("bad public key size");var d=new Uint8Array(Z+a.length),e=new Uint8Array(Z+a.length),f;for(f=0;f<Z;f++)d[f]=b[f];for(f=0;f<a.length;f++)d[f+Z]=a[f];return pa(e,d,d.length,c)>=0};a.sign.keyPair=function(){var a=new Uint8Array(Ca),b=new Uint8Array(Da);ja(a,b);return{publicKey:a,secretKey:b}};a.sign.keyPair.fromSecretKey=function(a){$(a);if(a.length!==Da)throw new Error("bad secret key size");var b=new Uint8Array(Ca);for(var c=0;c<b.length;c++)b[c]=a[32+c];return{publicKey:b,secretKey:new Uint8Array(a)}};a.sign.keyPair.fromSeed=function(a){$(a);if(a.length!==Ea)throw new Error("bad seed size");var b=new Uint8Array(Ca),c=new Uint8Array(Da);for(var d=0;d<32;d++)c[d]=a[d];ja(b,c,!0);return{publicKey:b,secretKey:c}};a.sign.publicKeyLength=Ca;a.sign.secretKeyLength=Da;a.sign.seedLength=Ea;a.sign.signatureLength=Z;a.hash=function(a){$(a);var b=new Uint8Array(Fa);Y(b,a,a.length);return b};a.hash.hashLength=Fa;a.verify=function(a,b){$(a,b);if(a.length===0||b.length===0)return!1;return a.length!==b.length?!1:o(a,0,b,0,a.length)===0?!0:!1};a.setPRNG=function(a){c=a};(function(){var b=typeof self!=="undefined"?self.crypto||self.msCrypto:null;if(b&&b.getRandomValues){var c=65536;a.setPRNG(function(a,d){var e,f=new Uint8Array(d);for(e=0;e<d;e+=c)b.getRandomValues(f.subarray(e,e+Math.min(d-e,c)));for(e=0;e<d;e++)a[e]=f[e];Ia(f)})}else b&&b.randomBytes&&a.setPRNG(function(a,c){var d,e=b.randomBytes(c);for(d=0;d<c;d++)a[d]=e[d];Ia(e)})})()})(typeof g!=="undefined"&&g.exports?g.exports:self.nacl=self.nacl||{})}var i=!1;function j(){i||(i=!0,h());return g.exports}function a(a){switch(a){case void 0:return j()}}e.exports=a}),null);
__d("tweetnacl",["tweetnacl-1.0.3"],(function(a,b,c,d,e,f){e.exports=b("tweetnacl-1.0.3")()}),null);
__d("WAArrayBufferUtils",["Promise"],(function(a,b,c,d,e,f){function a(a){var b=new ArrayBuffer(a.length);b=new Uint8Array(b);var c,d;for(c=0,d=a.length;c<d;c++)b[c]=a.charCodeAt(c);return b.buffer}function c(a,c){c===void 0&&(c=5e5);return new(b("Promise"))(function(b,d){var e=a.length,f=new ArrayBuffer(e),g=new Uint8Array(f),h=0;requestAnimationFrame(i);function i(){var d=Math.min(h+c,e);while(h<d)g[h]=a.charCodeAt(h),h++;if(h===e){b(f);return}requestAnimationFrame(i)}})}function d(a){return String.fromCharCode.apply(null,new Uint8Array(a))}var g=8388607;function e(a,b){a=new Uint8Array(a);if(b>g)throw new Error("Divisor is too big");var c=0;for(var d=0;d<a.length;++d)c=((c<<8)+a[d])%b;return c}function h(a){a=a.map(function(a){return new Uint8Array(a)});var b=a.reduce(function(a,b){return a+b.byteLength},0),c=new Uint8Array(b);a.reduce(function(a,b){c.set(b,a);return a+b.byteLength},0);return c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength)}function i(a,b){a=new Uint8Array(a);b=new Uint8Array(b);return j(a,b)}function j(a,b){if(a.byteLength!==b.byteLength)return!1;for(var c=0;c!==a.byteLength;c++)if(a[c]!==b[c])return!1;return!0}f.stringToArrayBuffer=a;f.largeStringToArrayBuffer=c;f.arrayBufferToString=d;f.arrayBufferMod=e;f.concatBuffers=h;f.arrayBuffersEqualUNSAFE=i;f.uint8ArraysEqualUNSAFE=j}),66);
__d("MAWVault.bs",["MAWVault"],(function(a,b,c,d,e,f){"use strict";function a(a){return b("MAWVault").vault(a)}function c(a){return b("MAWVault").unvault(a)}f.vault=a;f.unvault=c}),null);
__d("MWV2DualSendMessageContent.bs",["MAWVault.bs"],(function(a,b,c,d,e,f){"use strict";var g="8031ded1058446aa93ccf8dace0eaf876dd5e32771904d5eb0058a0afdc724ce120dcba542d84548ac3f4a2741c45c0d";function a(a){if(a!==void 0)return b("MAWVault.bs").unvault(a).endsWith(g);else return!1}f.messageText=g;f.isDualSend=a}),null);
__d("MAWBridgeMsgUpdatedHandler.bs",["LSMessageUnsendabilityStatus.bs","MAWAckLevel.bs","MAWAdminMsg.bs","MAWAdminMsgCTA.bs","MAWMsg.bs","MAWMsgReply.bs","MAWThreadId.bs","MAWTimeUtils.bs","MWV2DualSendMessageContent.bs","Promise","ReQL.bs","bs_belt_Option","bs_caml_obj"],(function(a,b,c,d,e,f){"use strict";function a(a,c){return b("MAWThreadId.bs").toThreadKey(a,c.chatId).then(function(d){return b("MAWAdminMsgCTA.bs").getAdminMsgCtaStep(a,d,c)}).then(function(d){return b("MAWMsgReply.bs").getReplySnippet(a,d.threadKey,c).then(function(a){return[d,a]}).then(function(e){var d=e[0],f=d.threadKey;d=d.result;var g=e[1],h=c.type_===b("MAWMsg.bs").unsent;e=d!==void 0?[d.ctaId,d.title,d.ctaType]:[void 0,void 0,void 0];var i=e[2],j=e[1],k=e[0];return b("ReQL.bs").first(b("ReQL.bs").filter(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("messages")),{hd:f,tl:0}),function(a){return a.messageId===c.msgId})).then(function(d){if(d===void 0)return b("Promise").resolve(void 0);if(b("MWV2DualSendMessageContent.bs").isDualSend(c.content))return b("Promise").resolve(void 0);var e=b("MAWAckLevel.bs").levelToMessagingSendStatusV2(c.ack);d=b("bs_caml_obj").caml_obj_dup(d);d.replySourceTimestampMs=void 0;d.unsentTimestampMs=h?b("MAWTimeUtils.bs").toTimestamp(c.ts):void 0;d.displayedContentTypes=b("MAWMsg.bs").getDisplayedContentTypes(c.type_,c.isForwarded,c.isExpiredXmaMsg);d.cannotUnsendReason=h||!c.isAuthorMe?b("LSMessageUnsendabilityStatus.bs").denyForNonSender:void 0;d.adminMsgCtaType=i;d.adminMsgCtaTitle=j;d.adminMsgCtaId=k;d.replyAttachmentExtra=void 0;d.replyAttachmentId=b("MAWMsgReply.bs").getReplyAttachmentId(c);d.replyAttachmentType=b("MAWMsgReply.bs").getReplyAttachmentType(c);d.replyMediaUrlMimeType=b("MAWMsgReply.bs").getReplyMediaMimeType(c);d.replyMediaPreviewHeight=b("MAWMsgReply.bs").getReplyMediaHeight(c);d.replyMediaPreviewWidth=b("MAWMsgReply.bs").getReplyMediaWidth(c);d.replyMediaUrl=void 0;d.replyMediaExpirationTimestampMs=b("MAWMsgReply.bs").getReplyMediaExpirationTimestampMs(c);d.replyToUserId=b("MAWMsgReply.bs").getReplyUserId(c);d.replyMessageText=b("MAWMsgReply.bs").getReplyMessageText(c);d.replySnippet=g;d.replyStatus=b("MAWMsgReply.bs").getReplyStatus(c);d.replySourceTypeV2=b("MAWMsgReply.bs").getReplySourceTypeV2(c);d.replySourceType=b("MAWMsgReply.bs").getReplySourceType(c);d.replySourceId=b("MAWMsgReply.bs").getReplySourceId(c);d.isUnsent=h;d.sendStatusV2=e;d.sendStatus=b("MAWAckLevel.bs").levelToMessagingSendStatus(c.ack);if(c.isAdminMessage){e=c.adminContent;var f=c.adminType;e=e!==void 0&&f!==void 0?b("MAWAdminMsg.bs").buildLocalizedString(e,f):void 0}else e=c.content;d.text=e;return a.table("messages").put((d.timestampMs=b("MAWTimeUtils.bs").toTimestamp(h?b("bs_belt_Option").getWithDefault(c.originalTs,c.ts):c.ts),d))})})})}f.call=a}),null);
__d("MAWBridgeMsgsLoadedHandler.bs",["LS.bs","LSInsertNewMessageRange","MAWThreadId.bs","bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";function a(a,c){return b("MAWThreadId.bs").toThreadKey(a,c.threadId).then(function(d){var e=c.rangeExtensionType,f;if(typeof e==="number")f=b("bs_caml_int64").zero;else switch(e.TAG|0){case 0:case 1:f=b("bs_caml_int64").of_float(e._0.minMsgTs);break;case 2:f=b("bs_caml_int64").zero;break}e=c.rangeExtensionType;e=typeof e==="number"?[2328,1316134911]:e.TAG===2?b("bs_caml_int64").of_float(e._0.maxMsgTs):[2328,1316134911];var g=c.rangeExtensionType,h;if(typeof g==="number")h="";else switch(g.TAG|0){case 0:case 1:h=g._0.minMsgId;break;case 2:h="";break}g=c.rangeExtensionType;var i;if(typeof g==="number")i="";else switch(g.TAG|0){case 0:i=g._0.maxMsgId;break;case 1:i="";break;case 2:i=g._0.maxMsgId;break}g=c.rangeExtensionType;var j;if(typeof g==="number")j=b("bs_caml_int64").zero;else switch(g.TAG|0){case 0:case 1:j=b("bs_caml_int64").of_float(g._0.minMsgTs);break;case 2:j=b("bs_caml_int64").zero;break}g=c.rangeExtensionType;g=typeof g==="number"?[2328,1316134911]:g.TAG===2?b("bs_caml_int64").of_float(g._0.maxMsgTs):[2328,1316134911];var k=c.rangeExtensionType,l;if(typeof k==="number")l=!1;else switch(k.TAG|0){case 0:l=k._0.hasMoreBefore;break;case 1:l=k._0.hasMoreBefore;break;case 2:l=!1;break}k=c.rangeExtensionType;k=typeof k==="number"||k.TAG!==2?!1:k._0.hasMoreAfter;return b("LSInsertNewMessageRange")(d,f,e,h,i,j,g,l,k,void 0,b("LS.bs").make(a))})}f.call=a}),null);
__d("MAWBridgeMsgsStartCountdownHandler.bs",["MAWEphemeralMessageExpirationStorage.bs","MAWThreadId.bs","MAWTimeUtils.bs","Promise","ReQL.bs","bs_caml_int64","bs_caml_obj"],(function(a,b,c,d,e,f){"use strict";function a(a,c){return c.msgs.reduce(function(c,d){return c.then(function(c){b("MAWEphemeralMessageExpirationStorage.bs").setMessageForExpiration(a,d,d.countdownTs,d.millisecondsUntilCountdownTs);b("bs_caml_int64").of_int32(d.millisecondsUntilCountdownTs);return b("MAWThreadId.bs").toThreadKey(a,d.chatId).then(function(c){return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("messages")),{hd:c,tl:{hd:b("MAWTimeUtils.bs").toTimestamp(d.ts),tl:{hd:d.msgId,tl:0}}})).then(function(c){if(c===void 0)return b("Promise").resolve(void 0);c=b("bs_caml_obj").caml_obj_dup(c);return a.table("messages").put((c.ephemeralExpirationTs=b("bs_caml_int64").of_float(d.countdownTs),c))})})})},b("Promise").resolve(void 0))}f.call=a}),null);
__d("MAWBridgeNewMediaHandler.bs",["MAWDbMsg","MAWMedia.bs","MAWThreadId.bs","Promise","ReQLTable.bs","bs_belt_Option","bs_caml_int64","bs_caml_obj","bs_caml_option"],(function(a,b,c,d,e,f){"use strict";function g(a,c){return b("MAWThreadId.bs").toThreadKey(a,c.threadId).then(function(d){var e=String(c.mediaId);return c.msgIds.reduce(function(f,g){return f.then(function(f){var h=b("bs_caml_int64").of_int32(b("MAWDbMsg").getInChatMsgIdFromMsgId(g));return b("ReQLTable.bs").update(a.table("attachments"),{hd:d,tl:{hd:g,tl:{hd:e,tl:0}}},function(a){if(a===void 0){var f,i,j;return{threadKey:d,timestampMs:h,messageId:g,offlineAttachmentId:e,attachmentFbid:e,attachmentType:b("MAWMedia.bs").mediaTypeToMessageAttachmentType(c.mediaType),originalPageSenderId:void 0,filename:void 0,filesize:(f=b("bs_belt_Option")).map(c.filesize,(i=b("bs_caml_int64")).of_int32),hasMedia:c.hasMedia,isSharable:!1,hasXma:!1,xmaLayoutType:void 0,xmasTemplateType:void 0,defaultCtaId:void 0,defaultCtaTitle:void 0,defaultCtaType:void 0,attachmentCta1Id:void 0,cta1Title:void 0,cta1Type:void 0,attachmentCta2Id:void 0,cta2Title:void 0,cta2Type:void 0,attachmentCta3Id:void 0,cta3Title:void 0,cta3Type:void 0,playableUrl:void 0,playableUrlFallback:void 0,playableUrlExpirationTimestampMs:void 0,playableUrlMimeType:void 0,dashManifest:void 0,previewUrl:void 0,previewUrlFallback:void 0,previewUrlExpirationTimestampMs:void 0,previewUrlMimeType:void 0,miniPreview:void 0,previewWidth:f.map((j=b("bs_caml_option")).nullable_to_opt(c.previewWidth),i.of_int32),previewHeight:f.map(j.nullable_to_opt(c.previewHeight),i.of_int32),imageUrl:void 0,imageUrlFallback:void 0,imageUrlExpirationTimestampMs:void 0,imageUrlMimeType:void 0,actionUrl:void 0,titleText:void 0,subtitleText:void 0,maxTitleNumOfLines:void 0,maxSubtitleNumOfLines:void 0,descriptionText:void 0,sourceText:void 0,attributionAppId:void 0,attributionAppName:void 0,attributionAppIcon:void 0,attributionAppIconFallback:void 0,attributionAppIconUrlExpirationTimestampMs:void 0,localPlayableUrl:void 0,playableDurationMs:f.map(j.nullable_to_opt(c.duration),i.of_int32),attachmentIndex:i.zero,faviconUrl:void 0,faviconUrlFallback:void 0,faviconUrlExpirationTimestampMs:void 0,decryptionKey:void 0,accessibilitySummaryText:void 0,isPreviewImage:void 0,listItemsId:void 0,listItemsDescriptionText:void 0,listItemsSecondaryDescriptionText:void 0,listItemId1:void 0,listItemTitleText1:void 0,listItemContactUrlList1:void 0,listItemProgressBarFilledPercentage1:void 0,listItemContactUrlExpirationTimestampList1:void 0,listItemContactUrlFallbackList1:void 0,listItemAccessibilityText1:void 0,listItemId2:void 0,listItemTitleText2:void 0,listItemContactUrlList2:void 0,listItemProgressBarFilledPercentage2:void 0,listItemContactUrlExpirationTimestampList2:void 0,listItemContactUrlFallbackList2:void 0,listItemAccessibilityText2:void 0,listItemId3:void 0,listItemTitleText3:void 0,listItemContactUrlList3:void 0,listItemProgressBarFilledPercentage3:void 0,listItemContactUrlExpirationTimestampList3:void 0,listItemContactUrlFallbackList3:void 0,listItemAccessibilityText3:void 0,originalFileHash:void 0,isBorderless:void 0,headerImageUrl:void 0,headerImageUrlFallback:void 0,headerImageUrlExpirationTimestampMs:void 0,headerImageUrlMimeType:void 0,headerTitle:void 0,previewImageDecorationType:void 0,shouldHighlightHeaderTitleInTitle:void 0,targetId:void 0,shouldRespectServerPreviewSize:void 0,authorityLevel:i.zero,ephemeralMediaState:void 0,viewerSeenTimestampMs:void 0,shouldAutoplayVideo:void 0,previewUrlLarge:void 0,previewWidthLarge:f.map(j.nullable_to_opt(c.previewWidthLarge),i.of_int32),previewHeightLarge:f.map(j.nullable_to_opt(c.previewHeightLarge),i.of_int32),subtitleIconUrl:void 0,preheaderText:void 0,listItemsDescriptionSubtitleText:void 0,avatarViewUrlList:void 0,avatarViewUrlExpirationTimestampList:void 0,avatarViewUrlFallbackList:void 0,avatarViewTitleList:void 0,avatarViewAccessibilityLabel:void 0,listItemProfilePictureUrl1:void 0,listItemProfilePictureUrlExpirationTimestamp1:void 0,listItemProfilePictureUrlFallback1:void 0,listItemProfilePictureUrl2:void 0,listItemProfilePictureUrlExpirationTimestamp2:void 0,listItemProfilePictureUrlFallback2:void 0,listItemProfilePictureUrl3:void 0,listItemProfilePictureUrlExpirationTimestamp3:void 0,listItemProfilePictureUrlFallback3:void 0,attachmentLoggingType:void 0,waveformData:void 0,samplingFrequencyHz:void 0,gatingType:void 0,gatingTitle:void 0}}f=b("bs_caml_obj").caml_obj_dup(a);f.hasMedia=c.hasMedia;return f})})},b("Promise").resolve(void 0))})}function a(a,b){return g(a,b).then(function(a){})}f.call=a}),null);
__d("LSThreadMediaGalleryGroup.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;d=[0,2];f.photosAndVideos=a;f.filesOnly=c;f.links=d}),null);
__d("MAWBridgeNewMediaRangeHandler.bs",["LS.bs","LSThreadMediaGalleryGroup.bs","LSUpsertAttachmentRange","MAWThreadId.bs","bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";function g(a,c){return b("MAWThreadId.bs").toThreadKey(a,c.threadId).then(function(d){var e=b("bs_caml_int64").of_int32(c.minMsgRowId),f=c.hasMoreBefore;return b("LSUpsertAttachmentRange")(d,b("LSThreadMediaGalleryGroup.bs").photosAndVideos,e,f,b("LS.bs").make(a))})}function a(a,b){return g(a,b).then(function(a){})}f.call=a}),null);
__d("LSHotEmojiSize.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;d=[0,2];e=[0,3];f.none=a;f.small=c;f.medium=d;f.large=e}),null);
__d("LSMessageViewFlag.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;d=[0,2];e=[0,4];b=[0,8];var g=[0,16],h=[0,256],i=[0,1024],j=[0,2048],k=[0,4096],l=[0,8192],m=[0,16384],n=[0,524288],o=[0,1048576],p=[0,2097152],q=[0,8388608],r=[0,16777216],s=[0,33554432];f.uncalculated=a;f.showProfileImage=c;f.showTimestamp=d;f.showSender=e;f.connectTop=b;f.connectBottom=g;f.statusSending=h;f.statusDelivered=i;f.statusReadBy=j;f.statusReadByExcept=k;f.statusReadByAll=l;f.statusRead=m;f.isSendError=n;f.statusSent=o;f.isHotLike=p;f.isLocalMessage=q;f.isForwardedMedia=r;f.statusReadByAndMore=s}),null);
__d("LSQuickReplyType.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;d=[0,2];f.none=a;f.horizontal=c;f.vertical=d}),null);
__d("MAWBridgeNewMsgHandler.bs",["LSAuthorityLevel.bs","LSHotEmojiSize.bs","LSMessageUnsendabilityStatus.bs","LSMessageViewFlag.bs","LSQuickReplyType.bs","MAWAckLevel.bs","MAWAdminMsg.bs","MAWAdminMsgCTA.bs","MAWMsg.bs","MAWMsgReply.bs","MAWThreadId.bs","MAWTimeUtils.bs","ReQL.bs","bs_belt_Option","bs_caml_format","bs_caml_int64","bs_caml_obj"],(function(a,b,c,d,e,f){"use strict";function g(a){a=a.specialTextSize;if(b("bs_caml_obj").caml_equal(a,1))return b("LSHotEmojiSize.bs").small;else if(b("bs_caml_obj").caml_equal(a,2))return b("LSHotEmojiSize.bs").medium;else if(b("bs_caml_obj").caml_equal(a,3))return b("LSHotEmojiSize.bs").large;else return b("LSHotEmojiSize.bs").none}function h(a,c,d,e,f){e=e!==void 0?[e.ctaId,e.title,e.ctaType]:[void 0,void 0,void 0];if(d.isAdminMessage){var h=d.adminContent,i=d.adminType;h=h!==void 0&&i!==void 0?b("MAWAdminMsg.bs").buildLocalizedString(h,i):void 0}else h=d.content;i=d.ephemeralDurationInSec;return a.table("messages").add({threadKey:c,timestampMs:b("MAWTimeUtils.bs").toTimestamp(d.type_===b("MAWMsg.bs").unsent?b("bs_belt_Option").getWithDefault(d.originalTs,d.ts):d.ts),primarySortKey:b("bs_caml_int64").of_float(d.sortOrderMs),secondarySortKey:void 0,messageId:d.msgId,offlineThreadingId:d.msgId,text:h,senderId:b("bs_caml_format").caml_int64_of_string(d.sender),stickerId:void 0,isAdminMessage:d.isAdminMessage,sendStatus:b("MAWAckLevel.bs").levelToMessagingSendStatus(d.ack),sendStatusV2:b("MAWAckLevel.bs").levelToMessagingSendStatusV2(d.ack),isUnsent:d.type_===b("MAWMsg.bs").unsent,mentionOffsets:void 0,mentionLengths:void 0,mentionIds:void 0,mentionTypes:void 0,replySourceId:b("MAWMsgReply.bs").getReplySourceId(d),replySourceType:b("MAWMsgReply.bs").getReplySourceType(d),replySourceTypeV2:b("MAWMsgReply.bs").getReplySourceTypeV2(d),replyStatus:b("MAWMsgReply.bs").getReplyStatus(d),replySnippet:f,replyMessageText:b("MAWMsgReply.bs").getReplyMessageText(d),replyToUserId:b("MAWMsgReply.bs").getReplyUserId(d),replyMediaExpirationTimestampMs:b("MAWMsgReply.bs").getReplyMediaExpirationTimestampMs(d),replyMediaUrl:void 0,replyMediaPreviewWidth:b("MAWMsgReply.bs").getReplyMediaWidth(d),replyMediaPreviewHeight:b("MAWMsgReply.bs").getReplyMediaHeight(d),replyMediaUrlMimeType:b("MAWMsgReply.bs").getReplyMediaMimeType(d),replyMediaUrlFallback:void 0,replyCtaId:void 0,replyCtaTitle:void 0,replyAttachmentType:b("MAWMsgReply.bs").getReplyAttachmentType(d),replyAttachmentId:b("MAWMsgReply.bs").getReplyAttachmentId(d),replyAttachmentExtra:void 0,hasQuickReplies:!1,adminMsgCtaId:e[0],adminMsgCtaTitle:e[1],adminMsgCtaType:e[2],cannotUnsendReason:d.type_===b("MAWMsg.bs").unsent||!d.isAuthorMe?b("LSMessageUnsendabilityStatus.bs").denyForNonSender:void 0,textHasLinks:!1,viewFlags:b("LSMessageViewFlag.bs").uncalculated,displayedContentTypes:b("MAWMsg.bs").getDisplayedContentTypes(d.type_,d.isForwarded,d.isExpiredXmaMsg),viewedPluginKey:void 0,viewedPluginContext:void 0,quickReplyType:b("LSQuickReplyType.bs").none,hotEmojiSize:g(d),authorityLevel:b("LSAuthorityLevel.bs").authoritative,subscriptErrorMessage:void 0,unsentTimestampMs:b("MAWTimeUtils.bs").toTimestamp(d.ts),replySourceTimestampMs:void 0,forwardScore:void 0,ephemeralDurationInSec:i!==void 0?b("bs_caml_int64").of_int32(i):void 0,msUntilExpirationTs:void 0,localDataId:void 0,ephemeralExpirationTs:void 0,replyType:void 0,isForwarded:void 0,takedownState:void 0})}function a(a,c){return b("MAWThreadId.bs").toThreadKey(a,c.chatId).then(function(d){return b("MAWAdminMsgCTA.bs").getAdminMsgCtaStep(a,d,c)}).then(function(d){return b("MAWMsgReply.bs").getReplySnippet(a,d.threadKey,c).then(function(a){return[d,a]})}).then(function(d){var e=d[1];d=d[0];var f=c.offlineMsg;if(f!==void 0){var i=d.threadKey,j=d.result,k=j!==void 0?[j.ctaId,j.title,j.ctaType]:[void 0,void 0,void 0],l=k[2],m=k[1],n=k[0];return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("messages")),{hd:i,tl:{hd:b("bs_caml_int64").of_float(f.ts),tl:{hd:f.msgId,tl:0}}})).then(function(d){if(d===void 0)return h(a,i,c,j,e);d=b("bs_caml_obj").caml_obj_dup(d);var f=c.ephemeralDurationInSec;d.ephemeralDurationInSec=f!==void 0?b("bs_caml_int64").of_int32(f):void 0;return a.table("messages").put((d.replySourceTimestampMs=void 0,d.authorityLevel=b("LSAuthorityLevel.bs").authoritative,d.hotEmojiSize=g(c),d.displayedContentTypes=b("MAWMsg.bs").getDisplayedContentTypes(c.type_,c.isForwarded,c.isExpiredXmaMsg),d.adminMsgCtaType=l,d.adminMsgCtaTitle=m,d.adminMsgCtaId=n,d.replyAttachmentId=b("MAWMsgReply.bs").getReplyAttachmentId(c),d.replyAttachmentType=b("MAWMsgReply.bs").getReplyAttachmentType(c),d.replyMediaUrlMimeType=b("MAWMsgReply.bs").getReplyMediaMimeType(c),d.replyMediaPreviewHeight=b("MAWMsgReply.bs").getReplyMediaHeight(c),d.replyMediaPreviewWidth=b("MAWMsgReply.bs").getReplyMediaWidth(c),d.replyMediaUrl=void 0,d.replyMediaExpirationTimestampMs=b("MAWMsgReply.bs").getReplyMediaExpirationTimestampMs(c),d.replyToUserId=b("MAWMsgReply.bs").getReplyUserId(c),d.replyMessageText=b("MAWMsgReply.bs").getReplyMessageText(c),d.replySnippet=e,d.replyStatus=b("MAWMsgReply.bs").getReplyStatus(c),d.replySourceTypeV2=b("MAWMsgReply.bs").getReplySourceTypeV2(c),d.replySourceType=b("MAWMsgReply.bs").getReplySourceType(c),d.replySourceId=b("MAWMsgReply.bs").getReplySourceId(c),d.isUnsent=c.type_===b("MAWMsg.bs").unsent,d.sendStatusV2=b("MAWAckLevel.bs").levelToMessagingSendStatusV2(c.ack),d.sendStatus=b("MAWAckLevel.bs").levelToMessagingSendStatus(c.ack),d.messageId=c.msgId,d.primarySortKey=b("bs_caml_int64").of_float(c.sortOrderMs),d.timestampMs=b("MAWTimeUtils.bs").toTimestamp(c.ts),d))})}else return h(a,d.threadKey,c,d.result,e)}).then(function(a){})}f.call=a}),null);
__d("MAWBridgeOneToOneMessageRequestLoadedHandler.bs",["LSAuthorityLevel.bs","LSMessagingThreadTypeUtil.bs","LSThreadBitOffset.bs","MAWContact.bs","MAWMessageRequestUtil.bs","MAWThreadId.bs","Promise","ReQL.bs","bs_caml","bs_caml_format","bs_caml_int64","bs_caml_obj"],(function(a,b,c,d,e,f){"use strict";function a(a,c){return b("MAWThreadId.bs").toThreadKey(a,c.threadId).then(function(d){return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("threads")),{hd:d,tl:0})).then(function(d){if(d===void 0)return b("Promise").resolve([void 0,void 0,void 0,!1]);var e=b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("contacts")),{hd:b("bs_caml_format").caml_int64_of_string(c.fbid),tl:0}));return b("Promise").all([b("Promise").resolve(d),e,b("Promise").resolve(c.relationship),b("Promise").resolve(b("LSMessagingThreadTypeUtil.bs").isOneToOne(d.threadType))])}).then(function(c){var d=c[0];if(d===void 0)return b("Promise").resolve(void 0);var e=c[1];if(e===void 0)return b("Promise").resolve(void 0);var f=c[2];if(f===void 0)return b("Promise").resolve(void 0);if(!c[3])return b("Promise").resolve(void 0);c=b("bs_caml").i64_neq(e.authorityLevel,b("LSAuthorityLevel.bs").authoritative)?f:b("MAWContact.bs").lsContactToContactRelationshipType(e);if(d.folderName==="pending"||d.folderName==="other"||d.folderName==="inbox"&&c!==b("MAWContact.bs").twoWayContact&&c!==b("MAWContact.bs").oneWayContact&&b("bs_caml").i64_neq(d.lastActivityTimestampMs,b("bs_caml_int64").zero)){f=b("LSThreadBitOffset.bs").clear(b("MAWMessageRequestUtil.bs").disabledThreadCapabilitiesForIncomingRequest,d.capabilities,d.capabilities2,d.capabilities3);e=b("LSThreadBitOffset.bs").set(b("MAWMessageRequestUtil.bs").enabledThreadCapabilitiesForIncomingRequest,f[0],f[1],f[2])}else e=[d.capabilities,d.capabilities2,d.capabilities3];c=b("bs_caml_obj").caml_obj_dup(d);return a.table("threads").put((c.capabilities3=e[2],c.capabilities2=e[1],c.capabilities=e[0],c)).then(function(a){})})})}f.call=a}),null);
__d("MAWBridgeParticipantRemovedHandler.bs",["MAWThreadId.bs","bs_caml_format"],(function(a,b,c,d,e,f){"use strict";function a(a,c){return b("MAWThreadId.bs").toThreadKey(a,c.threadId).then(function(d){var e=b("bs_caml_format").caml_int64_of_string(c.fbid);return a.table("participants")["delete"]({hd:d,tl:{hd:e,tl:0}}).then(function(a){})})}f.call=a}),null);
__d("LSGroupParticipantJoinState.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;d=[0,2];f.member=a;f.pending=c;f.invited=d}),null);
__d("MAWBridgeParticipantUpdatedHandler.bs",["fbt","LS.bs","LSAuthorityLevel.bs","LSContactBlockedByViewerStatus.bs","LSContactGender.bs","LSContactIdType.bs","LSContactType.bs","LSContactViewerRelationship.bs","LSContactWorkForeignEntityType.bs","LSGroupParticipantJoinState.bs","LSVerifyContactRowExists","MAWCurrentUser","MAWGating.bs","MAWThreadId.bs","MAWTimeUtils.bs","MAWUpdateLSThreadCapabilities.bs","Promise","ReQLTable.bs","bs_caml","bs_caml_format","bs_caml_int64","bs_caml_obj"],(function(a,b,c,d,e,f,g){"use strict";var h=b("MAWCurrentUser").getID(),i=b("bs_caml_format").caml_int64_of_string(h);function a(a){return a.startsWith("shadow_")}function c(a,c){if(c.fbid.startsWith("shadow_"))return b("Promise").resolve(void 0);else return b("MAWThreadId.bs").toThreadKey(a,c.threadId).then(function(d){var e=b("bs_caml_format").caml_int64_of_string(c.fbid),f=b("MAWTimeUtils.bs").toTimestamp(c.readWatermarkTs),j=b("MAWTimeUtils.bs").toTimestamp(c.deliveredWatermarkTs),k=b("MAWTimeUtils.bs").toTimestamp(c.lastReadActionTs),l=c.isSuperAdmin?g._(/*FBT_CALL*/"Group creator"/*FBT_CALL*/).toString():void 0,m={contents:!1},n={contents:!1};return b("ReQLTable.bs").update(a.table("participants"),{hd:d,tl:{hd:e,tl:0}},function(a){if(a!==void 0){n.contents=!0;return{threadKey:d,contactId:e,readWatermarkTimestampMs:f,deliveredWatermarkTimestampMs:j,nickname:a.nickname,isAdmin:c.isAdmin,subscribeSource:l,normalizedSearchTerms:a.normalizedSearchTerms,participantCapabilities:a.participantCapabilities,authorityLevel:a.authorityLevel,readActionTimestampMs:k,isSuperAdmin:a.isSuperAdmin,isModerator:!1,groupParticipantJoinState:c.isInvited?b("LSGroupParticipantJoinState.bs").invited:b("LSGroupParticipantJoinState.bs").member}}else{n.contents=!0;m.contents=!0;return{threadKey:d,contactId:e,readWatermarkTimestampMs:f,deliveredWatermarkTimestampMs:j,nickname:void 0,isAdmin:c.isAdmin,subscribeSource:l,normalizedSearchTerms:void 0,participantCapabilities:void 0,authorityLevel:b("bs_caml_int64").zero,readActionTimestampMs:b("bs_caml_int64").zero,isSuperAdmin:c.isSuperAdmin,isModerator:!1,groupParticipantJoinState:c.isInvited?b("LSGroupParticipantJoinState.bs").invited:b("LSGroupParticipantJoinState.bs").member}}}).then(function(f){if(n.contents)return b("MAWUpdateLSThreadCapabilities.bs").disableBlockerCapabilitiesTxn(a,d).then(function(f){f=b("bs_caml").i64_eq(i,e);var g=c.isAdmin;if(f)if(g)return b("MAWUpdateLSThreadCapabilities.bs").enableAddMembersTxn(a,d);else return b("MAWUpdateLSThreadCapabilities.bs").disableAddMembersTxn(a,d);else return window.Promise.resolve(void 0)}).then(function(f){if(!b("MAWGating.bs").isMRInitSyncImprovementsEnabled(void 0)&&b("bs_caml").i64_neq(i,e))return b("MAWUpdateLSThreadCapabilities.bs").updateMessageRequestThreadCapabilitiesTxn(a,c.fbid,d);else return window.Promise.resolve(void 0)});else return b("Promise").resolve(void 0)}).then(function(d){if(m.contents)return b("LSVerifyContactRowExists")(e,b("LSContactIdType.bs").fbid,void 0,void 0,b("LSContactType.bs").user,void 0,void 0,void 0,void 0,!1,!1,b("LSContactBlockedByViewerStatus.bs").unblocked,void 0,b("bs_caml_obj").caml_equal(h,c.fbid),b("LSAuthorityLevel.bs").optimistic,void 0,void 0,b("LSContactWorkForeignEntityType.bs").unknown,b("LSContactGender.bs").unknown,b("LSContactViewerRelationship.bs").unknown,void 0,b("LS.bs").make(a));else return b("Promise").resolve(void 0)})})}f.currentUserId=h;f.currentUserIdAsInt64=i;f.checkIfDualSendUser=a;f.call=c}),null);
__d("MAWBridgeReactionUpsertHandler.bs",["LSAuthorityLevel.bs","MAWThreadId.bs","MAWTimeUtils.bs","bs_caml_format"],(function(a,b,c,d,e,f){"use strict";function g(a,c){return b("MAWThreadId.bs").toThreadKey(a,c.threadId).then(function(d){return a.table("reactions").upsert({hd:d,tl:{hd:c.messageId,tl:{hd:b("bs_caml_format").caml_int64_of_string(c.actorId),tl:0}}},{threadKey:d,timestampMs:b("MAWTimeUtils.bs").toTimestamp(c.ts),messageId:c.messageId,actorId:b("bs_caml_format").caml_int64_of_string(c.actorId),reaction:c.reaction,authorityLevel:b("LSAuthorityLevel.bs").authoritative})})}function a(a,b){return g(a,b).then(function(a){})}f.call=a}),null);
__d("WAChatState",[],(function(a,b,c,d,e,f){"use strict";a="typing";b="recording_audio";c="idle";d={TYPING:a,RECORDING_AUDIO:b};e={IDLE:c};f.TYPING=a;f.RECORDING_AUDIO=b;f.IDLE=c;f.ACTIVE_CHAT_STATE_TYPE=d;f.IDLE_CHAT_STATE_TYPE=e}),66);
__d("MAWBridgeReceivedChatStateHandler.bs",["MAWThreadId.bs","ServerTime","WAChatState","bs_caml_format","bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";function a(a,c){return b("MAWThreadId.bs").toThreadKey(a,c.threadId).then(function(d){var e=b("bs_caml_format").caml_int64_of_string(c.senderId),f=b("bs_caml_int64").of_float(3e3+b("ServerTime").getMillis());if(c.state===b("WAChatState").TYPING)return a.table("typing_indicator").upsert({hd:d,tl:{hd:e,tl:0}},{threadKey:d,senderId:e,expirationTimestampMs:f}).then(function(a){});else if(c.state===b("WAChatState").IDLE)return a.table("typing_indicator")["delete"]({hd:d,tl:{hd:e,tl:0}}).then(function(a){});else return window.Promise.resolve(void 0)})}f.call=a}),null);
__d("MAWBridgeReceivedReceiptHandler.bs",["MAWThreadId.bs","MAWTimeUtils.bs","Promise","ReQL.bs","bs_caml_format"],(function(a,b,c,d,e,f){"use strict";function a(a,c){return b("MAWThreadId.bs").toThreadKey(a,c.threadId).then(function(d){var e=b("bs_caml_format").caml_int64_of_string(c.fbid),f=b("MAWTimeUtils.bs").toTimestamp(c.lastReadWatermarkTs),g=b("MAWTimeUtils.bs").toTimestamp(c.deliveredWatermarkTs),h=b("MAWTimeUtils.bs").toTimestamp(c.lastReadActionTs);return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("participants")),{hd:d,tl:{hd:e,tl:0}})).then(function(c){if(c!==void 0)return a.table("participants").put({threadKey:c.threadKey,contactId:c.contactId,readWatermarkTimestampMs:f,deliveredWatermarkTimestampMs:g,nickname:c.nickname,isAdmin:c.isAdmin,subscribeSource:c.subscribeSource,normalizedSearchTerms:c.normalizedSearchTerms,participantCapabilities:c.participantCapabilities,authorityLevel:c.authorityLevel,readActionTimestampMs:h,isSuperAdmin:c.isSuperAdmin,isModerator:c.isModerator,groupParticipantJoinState:c.groupParticipantJoinState});else return b("Promise").resolve(void 0)}).then(function(a){})})}f.call=a}),null);
__d("ArmadilloDataTraceCheckPoint.bs",[],(function(a,b,c,d,e,f){"use strict";a=[0,63];b=[0,65];c=[0,98];d=[0,504];e=[0,1e3];var g=[0,1001],h=[0,1204],i=[0,1210],j=[0,1224],k=[0,1234],l=[0,1225];f.traceGroupMessage=a;f.armadilloActMessageSend=b;f.traceCreated=c;f.richMediaMediaSendAttachmentType=d;f.traceTextMessage=e;f.traceMediaMessage=g;f.advancedCryptoMEMSendTaskComplete=h;f.deliveryReceiptReceived=i;f.advancedCryptoMEMEncryptionDeviceCount=j;f.advancedCryptoGroupDualSend=k;f.advancedCryptoDualSend=l}),null);
__d("ArmadilloDataTraceType.bs",[],(function(a,b,c,d,e,f){"use strict";a=[0,13];f.armadilloMessageSend=a}),null);
__d("LSDataTraceTag.bs",[],(function(a,b,c,d,e,f){"use strict";a=0;b=1;c=2;d=3;e=4;var g=5,h=6,i=7;f.none=a;f.sticker=b;f.image=c;f.animatedImage=d;f.video=e;f.audio=g;f.file=h;f.xma=i}),null);
__d("MAWBridgeStartTraceHandler.bs",["ArmadilloDataTraceCheckPoint.bs","ArmadilloDataTraceType.bs","LS.bs","LSAppendDataTraceAddon","LSDataTraceTag.bs","LSRequestId","MAWBackendBridge.bs","MAWMsg.bs","MAWTimeUtils.bs","Promise","bs_caml","bs_caml_int64","bs_caml_option","bs_curry","killswitch","promiseDone","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";function a(a,c){if(!b("killswitch")("MESSENGER_WEB_DATA_TRACE_ID")&&c.ack===7){var d=b("LSRequestId").generate();return a.table("data_trace_meta").add({traceId:d,initTimestampMs:b("MAWTimeUtils.bs").toTimestamp(c.ts),foregroundTimestampMs:b("bs_caml_int64").zero,traceType:b("ArmadilloDataTraceType.bs").armadilloMessageSend,shouldFlush:!1,contextOne:void 0,contextTwo:void 0,contextThree:c.externalId,predefinedId:void 0}).then(function(c){return b("LSAppendDataTraceAddon")(d,b("ArmadilloDataTraceCheckPoint.bs").traceCreated,b("bs_caml_int64").neg_one,void 0,void 0,b("LS.bs").make(a))}).then(function(e){e=c.isDS;var f=c.openMessageOtid,g=c.threadType,h=c.openMessageParticipantCount,i=c.participantCount;if(e&&f!==void 0)if(g)if(h!==void 0&&i!==void 0)return b("LSAppendDataTraceAddon")(d,b("ArmadilloDataTraceCheckPoint.bs").advancedCryptoGroupDualSend,b("bs_caml_int64").neg_one,void 0,f+","+String(h)+","+String(i),b("LS.bs").make(a));else return b("Promise").resolve(void 0);else return b("LSAppendDataTraceAddon")(d,b("ArmadilloDataTraceCheckPoint.bs").advancedCryptoDualSend,b("bs_caml_int64").neg_one,void 0,f,b("LS.bs").make(a));else return b("Promise").resolve(void 0)}).then(function(e){if(c.isDS){e=c.threadJid;return b("bs_curry")._1(b("MAWBackendBridge.bs").getThreadIdByChatJid({chatJid:e}).sendAndReceive,void 0).then(function(c){if(c!==void 0)return b("bs_curry")._1(b("MAWBackendBridge.bs").getAllThreadDevicesCount({threadKey:b("bs_caml_option").valFromOption(c)}).sendAndReceive,void 0).then(function(c){return b("LSAppendDataTraceAddon")(d,b("ArmadilloDataTraceCheckPoint.bs").advancedCryptoMEMEncryptionDeviceCount,b("bs_caml_int64").neg_one,void 0,String(c),b("LS.bs").make(a))});else{b("recoverableViolation")("Unable to find thread from jid","messenger_e2ee_sweb");return b("Promise").resolve(void 0)}})}else return b("Promise").resolve(void 0)}).then(function(e){if(c.threadType===1)return b("LSAppendDataTraceAddon")(d,b("ArmadilloDataTraceCheckPoint.bs").traceGroupMessage,b("bs_caml_int64").neg_one,void 0,void 0,b("LS.bs").make(a));else return b("Promise").resolve(void 0)}).then(function(e){if(c.isFirstMsg)return b("LSAppendDataTraceAddon")(d,b("ArmadilloDataTraceCheckPoint.bs").armadilloActMessageSend,b("bs_caml_int64").neg_one,void 0,"first_msg=1",b("LS.bs").make(a));else return b("Promise").resolve(void 0)}).then(function(e){e=c.type_;e=e===b("MAWMsg.bs").text?b("ArmadilloDataTraceCheckPoint.bs").traceTextMessage:e===b("MAWMsg.bs").ptt||e===b("MAWMsg.bs").image||e===b("MAWMsg.bs").video||e===b("MAWMsg.bs").gif?b("ArmadilloDataTraceCheckPoint.bs").traceMediaMessage:void 0;if(e===void 0)return window.Promise.resolve(e);var f=b("LSAppendDataTraceAddon")(d,e,b("bs_caml_int64").neg_one,void 0,void 0,b("LS.bs").make(a));b("promiseDone")(f,void 0,void 0);return b("Promise").resolve(e)}).then(function(e){if(e===void 0)return window.Promise.resolve(void 0);if(!b("bs_caml").i64_eq(e,b("ArmadilloDataTraceCheckPoint.bs").traceMediaMessage))return window.Promise.resolve(void 0);e=c.type_;e=e===b("MAWMsg.bs").image?b("LSDataTraceTag.bs").image:e===b("MAWMsg.bs").ptt?b("LSDataTraceTag.bs").audio:e===b("MAWMsg.bs").video?b("LSDataTraceTag.bs").video:e===b("MAWMsg.bs").gif?b("LSDataTraceTag.bs").animatedImage:b("LSDataTraceTag.bs").none;return b("LSAppendDataTraceAddon")(d,b("ArmadilloDataTraceCheckPoint.bs").richMediaMediaSendAttachmentType,b("bs_caml_int64").neg_one,void 0,String(e),b("LS.bs").make(a))})}else return window.Promise.resolve(void 0)}f.call=a}),null);
__d("MAWBridgeSyncContacts.bs",["CurrentUser","LS.bs","LSAuthorityLevel.bs","LSContactBlockedByViewerStatus.bs","LSContactGender.bs","LSContactIdType.bs","LSContactType.bs","LSContactViewerRelationship.bs","LSContactWorkForeignEntityType.bs","LSVerifyContactRowExists","Promise","bs_caml_format","bs_caml_obj"],(function(a,b,c,d,e,f){"use strict";var g=b("CurrentUser").getID();function a(a,c){return c.reduce(function(c,d){var e=b("bs_caml_format").caml_int64_of_string(d);return c.then(function(c){return b("LSVerifyContactRowExists")(e,b("LSContactIdType.bs").fbid,void 0,void 0,b("LSContactType.bs").user,void 0,void 0,void 0,void 0,!1,!1,b("LSContactBlockedByViewerStatus.bs").unblocked,void 0,b("bs_caml_obj").caml_equal(g,d),b("LSAuthorityLevel.bs").optimistic,void 0,void 0,b("LSContactWorkForeignEntityType.bs").unknown,b("LSContactGender.bs").unknown,b("LSContactViewerRelationship.bs").unknown,void 0,b("LS.bs").make(a))}).then(function(a){})},b("Promise").resolve(void 0))}f.currentUserFbid=g;f.call=a}),null);
__d("MAWBumpThread.bs",["ODS","Promise","ReQL.bs","bs_caml_obj"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d,e,f,g){return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("threads")),{hd:c,tl:0})).then(function(c){if(c!==void 0){var h=g!==void 0?g:c.snippetSenderContactId;c=b("bs_caml_obj").caml_obj_dup(c);return a.table("threads").put((c.snippetSenderContactId=h,c.snippet=f,c.lastReadWatermarkTimestampMs=e,c.lastActivityTimestampMs=d,c))}b("ODS").bumpEntityKey(3185,"armadillo_thread_bump","missing_thread");return b("Promise").resolve(void 0)})}f.threadMutation=a}),null);
__d("MAWBridgeThreadBumpedHandler.bs",["LS.bs","LSBumpE2EEMetadataThread","MAWAdminMsg.bs","MAWBumpThread.bs","MAWGating.bs","MAWThreadId.bs","MAWTimeUtils.bs","MWV2DualSendMessageContent.bs","Promise","bs_belt_Option","bs_caml_format","bs_caml_option"],(function(a,b,c,d,e,f){"use strict";function a(a,c){return b("MAWThreadId.bs").toThreadKey(a,c.threadId).then(function(d){var e=b("MAWAdminMsg.bs").buildLocalizedString(c.snippetParams,c.snippetType),f=b("MWV2DualSendMessageContent.bs").isDualSend(e),g=b("MAWTimeUtils.bs").toTimestamp(c.lastActivityTs),h=b("MAWGating.bs").isOccamadillo(void 0)?b("LSBumpE2EEMetadataThread")(d,g,c.isCurrentDeviceSendingMsg,b("LS.bs").make(a)):b("Promise").resolve(void 0);d=b("MAWBumpThread.bs").threadMutation(a,d,g,b("MAWTimeUtils.bs").toTimestamp(c.lastReadTs),e,b("bs_belt_Option").mapWithDefault(b("bs_caml_option").nullable_to_opt(c.snippetSenderContactId),void 0,function(a){return b("bs_caml_format").caml_int64_of_string(a)}));if(f)return b("Promise").resolve(void 0);else return b("Promise").all([h,d]).then(function(a){})}).then(function(a){})}f.call=a}),null);
__d("LSThreadRemoveType.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;f.deleteThread=a;f.archiveThread=c}),null);
__d("MAWBridgeThreadHiddenHandler.bs",["LS.bs","LSOptimisticRemoveThread","LSThreadRemoveType.bs","MAWGating.bs","MAWThreadId.bs"],(function(a,b,c,d,e,f){"use strict";function a(a,c){return b("MAWThreadId.bs").toThreadKey(a,c).then(function(c){if(!b("MAWGating.bs").isOccamadillo(void 0))return a.table("threads")["delete"]({hd:c,tl:0}).then(function(a){});var d=b("LS.bs").make(a);return b("LSOptimisticRemoveThread")(c,b("LSThreadRemoveType.bs").deleteThread,d)})}f.call=a}),null);
__d("MAWBridgeThreadTimestampsHandler.bs",["CurrentUser","MAWThreadId.bs","MAWTimeUtils.bs","Promise","ReQL.bs","bs_caml_format","bs_caml_obj"],(function(a,b,c,d,e,f){"use strict";function g(a,c){return b("MAWThreadId.bs").toThreadKey(a,c.threadId).then(function(d){return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("threads")),{hd:d,tl:0})).then(function(d){if(d===void 0)return b("Promise").resolve(void 0);d=b("bs_caml_obj").caml_obj_dup(d);return a.table("threads").put((d.lastReadWatermarkTimestampMs=b("MAWTimeUtils.bs").toTimestamp(c.lastReadWatermarkTs),d))})})}function a(a,c){return g(a,c).then(function(d){return b("MAWThreadId.bs").toThreadKey(a,c.threadId).then(function(d){var e=b("bs_caml_format").caml_int64_of_string(b("CurrentUser").getID());return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("participants")),{hd:d,tl:{hd:e,tl:0}})).then(function(d){if(d!==void 0)return a.table("participants").put({threadKey:d.threadKey,contactId:d.contactId,readWatermarkTimestampMs:b("MAWTimeUtils.bs").toTimestamp(c.lastReadWatermarkTs),deliveredWatermarkTimestampMs:d.deliveredWatermarkTimestampMs,nickname:d.nickname,isAdmin:d.isAdmin,subscribeSource:d.subscribeSource,normalizedSearchTerms:d.normalizedSearchTerms,participantCapabilities:d.participantCapabilities,authorityLevel:d.authorityLevel,readActionTimestampMs:b("MAWTimeUtils.bs").toTimestamp(c.lastActivityTimestampMs),isSuperAdmin:d.isSuperAdmin,isModerator:d.isModerator,groupParticipantJoinState:d.groupParticipantJoinState});else return b("Promise").resolve(void 0)})})}).then(function(a){})}f.call=a}),null);
__d("MAWBridgeThreadUpdatedHandler.bs",["LSBitOffset.bs","LSThreadCapabilityBitOffset.bs","MAWAdminMsg.bs","MAWFolder.bs","MAWFolderTypes","MAWGating.bs","MAWThreadId.bs","MWV2DualSendMessageContent.bs","Promise","ReQL.bs","bs_caml_format","bs_caml_int64","bs_caml_obj"],(function(a,b,c,d,e,f){"use strict";function g(a,c){return b("MAWThreadId.bs").toThreadKey(a,c.threadId).then(function(d){return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("threads")),{hd:d,tl:0})).then(function(d){if(d===void 0)return b("Promise").resolve(void 0);var e=c.snippetParams,f=c.snippetType;e=!(e==null)&&!(f==null)?b("MAWAdminMsg.bs").buildLocalizedString(e,f):d.snippet;f=b("MWV2DualSendMessageContent.bs").isDualSend(e);var g=c.snippetSenderContactId;g=g==null?d.snippetSenderContactId:b("bs_caml_format").caml_int64_of_string(g);var h=c.muteExpireTimeMs,i=b("MAWGating.bs").isOccamadillo(void 0);i=!(h==null)&&!i?b("bs_caml_int64").of_float(h):d.muteExpireTimeMs;h=c.folder;h=h==null?d.folderName:b("MAWFolder.bs").messagingFolderTag(c.folder);var j=c.folder;j=j==null?d.parentThreadKey:b("MAWFolder.bs").systemFolder(c.folder);var k=c.cannotReplyReason;k=k==null?h==="inbox"?void 0:d.cannotReplyReason:k;var l=c.folder;l=l==null?d.capabilities2:l===b("MAWFolderTypes").ARCHIVED?b("LSBitOffset.bs").clear(b("bs_caml_int64").sub(b("LSThreadCapabilityBitOffset.bs").archiveThread,[0,64]),b("LSBitOffset.bs").set(b("bs_caml_int64").sub(b("LSThreadCapabilityBitOffset.bs").unarchiveThread,[0,64]),d.capabilities2)):l===b("MAWFolderTypes").INBOX?b("LSBitOffset.bs").set(b("bs_caml_int64").sub(b("LSThreadCapabilityBitOffset.bs").archiveThread,[0,64]),b("LSBitOffset.bs").clear(b("bs_caml_int64").sub(b("LSThreadCapabilityBitOffset.bs").unarchiveThread,[0,64]),d.capabilities2)):d.capabilities2;var m=b("bs_caml_obj").caml_obj_dup(d);return a.table("threads").put((m.capabilities2=l,m.parentThreadKey=j,m.cannotReplyReason=k,m.snippetSenderContactId=g,m.snippet=f?d.snippet:e,m.muteExpireTimeMs=i,m.folderName=h,m))})})}function a(a,b){return g(a,b).then(function(a){})}f.call=a}),null);
__d("MAWBridgeThreadsLoadedHandler.bs",["MAWFolder.bs","MAWThreadId.bs","MAWTimeUtils.bs","Promise","ReQL.bs","bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";function a(a,c){var d;switch(c.TAG|0){case 0:d=b("MAWFolder.bs").clientSystemFolder(c._0.folderId);break;case 1:d=b("MAWFolder.bs").clientSystemFolder(c._0.folderId);break;case 2:d=b("MAWFolder.bs").clientSystemFolder(c._0.folderId);break}return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("threads_ranges_v2__generated")),{hd:d,tl:0})).then(function(e){if(e!==void 0)return a.table("threads_ranges_v2__generated")["delete"]({hd:e.parentThreadKey,tl:{hd:e.minThreadKey,tl:{hd:e.minLastActivityTimestampMs,tl:0}}}).then(function(f){switch(c.TAG|0){case 0:case 1:break;case 2:var d=c._0;return b("MAWThreadId.bs").toThreadKey(a,d.minThreadId).then(function(c){return a.table("threads_ranges_v2__generated").put({parentThreadKey:e.parentThreadKey,minThreadKey:c,minLastActivityTimestampMs:b("MAWTimeUtils.bs").toTimestamp(d.minLastActivityTs),maxThreadKey:e.maxThreadKey,maxLastActivityTimestampMs:e.maxLastActivityTimestampMs,isLoadingBefore:!1,isLoadingAfter:e.isLoadingAfter,hasMoreBefore:d.hasMore,hasMoreAfter:e.hasMoreAfter})})}return a.table("threads_ranges_v2__generated").put({parentThreadKey:e.parentThreadKey,minThreadKey:e.minThreadKey,minLastActivityTimestampMs:e.minLastActivityTimestampMs,maxThreadKey:e.maxThreadKey,maxLastActivityTimestampMs:e.maxLastActivityTimestampMs,isLoadingBefore:!1,isLoadingAfter:e.isLoadingAfter,hasMoreBefore:e.hasMoreBefore,hasMoreAfter:e.hasMoreAfter})});switch(c.TAG|0){case 0:return a.table("threads_ranges_v2__generated").put({parentThreadKey:d,minThreadKey:b("bs_caml_int64").zero,minLastActivityTimestampMs:[2328,1316134911],maxThreadKey:b("bs_caml_int64").zero,maxLastActivityTimestampMs:[2328,1316134911],isLoadingBefore:!1,isLoadingAfter:!1,hasMoreBefore:!1,hasMoreAfter:!1});case 1:var f=c._0;return b("Promise").all([b("MAWThreadId.bs").toThreadKey(a,f.minThreadId),b("MAWThreadId.bs").toThreadKey(a,f.maxThreadId)]).then(function(c){return a.table("threads_ranges_v2__generated").add({parentThreadKey:d,minThreadKey:c[0],minLastActivityTimestampMs:b("MAWTimeUtils.bs").toTimestamp(f.minLastActivityTs),maxThreadKey:c[1],maxLastActivityTimestampMs:b("MAWTimeUtils.bs").toTimestamp(f.maxLastActivityTs),isLoadingBefore:!1,isLoadingAfter:!1,hasMoreBefore:f.hasMore,hasMoreAfter:!1})});case 2:return b("Promise").resolve(void 0)}})}f.call=a}),null);
__d("MAWBridgeUpdateE2EEMetadataParticipantsHandler.bs",["LS.bs","LSUpdateE2EEMetadataParticipants","MAWThreadId.bs"],(function(a,b,c,d,e,f){"use strict";function a(a,c){return b("MAWThreadId.bs").toThreadKey(a,c.threadId).then(function(c){return b("LSUpdateE2EEMetadataParticipants")(c,b("LS.bs").make(a))})}f.call=a}),null);
__d("MAWDualSendSimplePermissionsManager.bs",["MAWGating.bs"],(function(a,b,c,d,e,f){"use strict";function g(a){if(b("MAWGating.bs").isOneToOneDualSendTextEnabled(void 0))return!0;else return b("MAWGating.bs").isOneToOneDualSendMediaEnabled(void 0)}function h(a){if(b("MAWGating.bs").isGroupDualSendTextEnabled(void 0))return!0;else return b("MAWGating.bs").isGroupDualSendMediaEnabled(void 0)}function a(a){if(g(void 0))return!0;else return h(void 0)}function c(a){if(b("MAWGating.bs").isOneToOneDualSendMediaEnabled(void 0))return!0;else return b("MAWGating.bs").isGroupDualSendMediaEnabled(void 0)}e=(d=b("MAWGating.bs")).isOneToOneDualSendTextEnabled;var i=d.isOneToOneDualSendMediaEnabled,j=d.isGroupDualSendTextEnabled;d=d.isGroupDualSendMediaEnabled;f.isOneToOneDualSendTextUser=e;f.isOneToOneDualSendMediaUser=i;f.isOneToOneDualSendUser=g;f.isGroupDualSendTextUser=j;f.isGroupDualSendMediaUser=d;f.isGroupDualSendUser=h;f.isDualSendUser=a;f.isDualSendMediaUser=c}),null);
__d("MAWBridgeUpdateTraceHandler.bs",["ArmadilloDataTraceCheckPoint.bs","LS.bs","LSAppendDataTraceAddon","LSFlushDataTrace.bs","MAWDualSendSimplePermissionsManager.bs","Promise","ReQL.bs","bs_caml_int64","killswitch"],(function(a,b,c,d,e,f){"use strict";function g(a,c,d){return b("ReQL.bs").toArray(b("ReQL.bs").filter(b("ReQL.bs").fromTableAscending(a.table("data_trace_meta")),function(a){var b=a.contextThree;if(b!==void 0&&c.externalIds.includes(b))return a.shouldFlush===!1;else return!1})).then(function(c){var e=[];return c.reduce(function(c,f){return c.then(function(c){e.push(f.traceId);return b("LSAppendDataTraceAddon")(f.traceId,d,b("bs_caml_int64").neg_one,void 0,void 0,b("LS.bs").make(a))})},b("Promise").resolve(void 0)).then(function(a){return e})})}function h(a,c){return c.reduce(function(c,d){return c.then(function(c){return b("LSFlushDataTrace.bs").updateAndFlushTrace(a,d)})},b("Promise").resolve(void 0))}function a(a,c){if(b("killswitch")("MESSENGER_WEB_DATA_TRACE_ID"))return window.Promise.resolve(void 0);var d=c.event;if(d==="ReceivedReceipt")return g(a,c,b("ArmadilloDataTraceCheckPoint.bs").deliveryReceiptReceived).then(function(b){return h(a,b)});else return g(a,c,b("ArmadilloDataTraceCheckPoint.bs").advancedCryptoMEMSendTaskComplete).then(function(c){if(b("MAWDualSendSimplePermissionsManager.bs").isDualSendUser(void 0))return h(a,c);else return window.Promise.resolve(void 0)})}f.call=a}),null);
__d("LSBackupOperationType.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").one;c=[0,2];f.upsertBackupItem=a;f.removeBackupItem=c}),null);
__d("LSEncryptedBackupsBackupTenancy.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").one;c=[0,2];f.production=a;f.shadow=c}),null);
__d("MAWBridgeUploadMessageHandler.bs",["LS.bs","LSBackupOperationType.bs","LSEncryptedBackupsBackupTenancy.bs","LSUploadMessage","MAWEncryptedBackupUtils.bs","Promise","bs_caml","bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";function a(a,c){return b("MAWEncryptedBackupUtils.bs").getBackupTenancy(a).then(function(d){if(d===void 0)return b("Promise").resolve(void 0);if(!b("bs_caml").i64_eq(d,b("LSEncryptedBackupsBackupTenancy.bs").production))return b("Promise").resolve(void 0);d=c.echoDocument;if(d==null)return b("LSUploadMessage")(c.threadId,c.messageId,b("bs_caml_int64").of_float(c.sortOrderMs),void 0,b("LSBackupOperationType.bs").removeBackupItem,b("LS.bs").make(a));else return b("LSUploadMessage")(c.threadId,c.messageId,b("bs_caml_int64").of_float(c.sortOrderMs),d,b("LSBackupOperationType.bs").upsertBackupItem,b("LS.bs").make(a))})}f.call=a}),null);
__d("MAWBridgeUploadThreadHandler.bs",["LS.bs","LSBackupOperationType.bs","LSEncryptedBackupsBackupTenancy.bs","LSUploadThread","MAWEncryptedBackupUtils.bs","MAWTimeUtils.bs","Promise","bs_caml"],(function(a,b,c,d,e,f){"use strict";function a(a,c){return b("MAWEncryptedBackupUtils.bs").getBackupTenancy(a).then(function(d){if(d===void 0)return b("Promise").resolve(void 0);if(!b("bs_caml").i64_eq(d,b("LSEncryptedBackupsBackupTenancy.bs").production))return b("Promise").resolve(void 0);d=c.echoDocument;if(d==null)return b("LSUploadThread")(c.threadId,c.folderType,c.transportKey,b("MAWTimeUtils.bs").toTimestamp(c.ts),void 0,b("LSBackupOperationType.bs").removeBackupItem,b("LS.bs").make(a));else return b("LSUploadThread")(c.threadId,c.folderType,c.transportKey,b("MAWTimeUtils.bs").toTimestamp(c.ts),d,b("LSBackupOperationType.bs").upsertBackupItem,b("LS.bs").make(a))})}f.call=a}),null);
__d("MAWBridgeXMAShareExpiredHandler.bs",["MAWThreadId.bs","Promise","bs_belt_Option"],(function(a,b,c,d,e,f){"use strict";function a(a,c){var d=String(c.xmaId);return b("MAWThreadId.bs").toThreadKey(a,c.threadId).then(function(e){return a.table("attachments").get({hd:e,tl:{hd:c.msgId,tl:{hd:d,tl:0}}}).then(function(f){if(f===void 0)return b("Promise").resolve(void 0);f=[f.defaultCtaId,f.attachmentCta1Id,f.attachmentCta2Id,f.attachmentCta3Id].filter(b("bs_belt_Option").isSome).map(function(a){return a});f=f.map(function(b){return a.table("attachment_ctas")["delete"]({hd:b,tl:0})});return b("Promise").all(f).then(function(b){return a.table("attachments")["delete"]({hd:e,tl:{hd:c.msgId,tl:{hd:d,tl:0}}})})})})}f.call=a}),null);
__d("MAWBridgeXMAShareTombstonedHandler.bs",["MAWThreadId.bs","Promise","ReQL.bs","bs_belt_Option","bs_caml_obj","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";function a(a,c){var d=String(c.xmaId);return b("MAWThreadId.bs").toThreadKey(a,c.threadId).then(function(e){return a.table("attachments").get({hd:e,tl:{hd:c.msgId,tl:{hd:d,tl:0}}}).then(function(f){if(f===void 0)return b("Promise").resolve(void 0);f=[f.defaultCtaId,f.attachmentCta1Id,f.attachmentCta2Id,f.attachmentCta3Id].filter(b("bs_belt_Option").isSome).map(function(a){return a});f=f.map(function(b){return a.table("attachment_ctas")["delete"]({hd:b,tl:0})});return b("Promise").all(f).then(function(f){return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("attachments")),{hd:e,tl:{hd:c.msgId,tl:{hd:d,tl:0}}})).then(function(c){if(c!==void 0){c=b("bs_caml_obj").caml_obj_dup(c);return a.table("attachments").put((c.previewHeightLarge=void 0,c.previewWidthLarge=void 0,c.maxSubtitleNumOfLines=void 0,c.maxTitleNumOfLines=void 0,c.subtitleText=void 0,c.titleText=void 0,c.previewHeight=void 0,c.previewWidth=void 0,c.cta3Type=void 0,c.cta3Title=void 0,c.attachmentCta3Id=void 0,c.cta2Type=void 0,c.cta2Title=void 0,c.attachmentCta2Id=void 0,c.cta1Type=void 0,c.cta1Title=void 0,c.attachmentCta1Id=void 0,c.defaultCtaTitle=void 0,c.defaultCtaId=void 0,c))}b("recoverableViolation")("Trying to tombstone a secure xma attachment but no existing attachment","messenger_e2ee_web");return b("Promise").resolve(void 0)})})})})}f.call=a}),null);
__d("MAWBridgeUIEventHandler.bs",["JSResource","LSTransaction.bs","MAWBridgeAbPropsUpdatedHandler.bs","MAWBridgeClockSkewUpdatedHandler.bs","MAWBridgeDeleteMessagesHandler.bs","MAWBridgeDeleteReactionHandler.bs","MAWBridgeDropAllSecureThreadsHandler.bs","MAWBridgeGroupInfoUpdatedHandler.bs","MAWBridgeGroupInviteUpdateHandler.bs","MAWBridgeInitSyncCompleteHandler.bs","MAWBridgeMediaExpiredHandler.bs","MAWBridgeMsgClearCountdownHandler.bs","MAWBridgeMsgUpdatedHandler.bs","MAWBridgeMsgsLoadedHandler.bs","MAWBridgeMsgsStartCountdownHandler.bs","MAWBridgeNewMediaHandler.bs","MAWBridgeNewMediaRangeHandler.bs","MAWBridgeNewMsgHandler.bs","MAWBridgeNewXMAHandler.bs","MAWBridgeOneToOneMessageRequestLoadedHandler.bs","MAWBridgeParticipantRemovedHandler.bs","MAWBridgeParticipantUpdatedHandler.bs","MAWBridgeReactionUpsertHandler.bs","MAWBridgeReceivedChatStateHandler.bs","MAWBridgeReceivedReceiptHandler.bs","MAWBridgeStartTraceHandler.bs","MAWBridgeSyncContacts.bs","MAWBridgeThreadBumpedHandler.bs","MAWBridgeThreadHiddenHandler.bs","MAWBridgeThreadTimestampsHandler.bs","MAWBridgeThreadUpdatedHandler.bs","MAWBridgeThreadsLoadedHandler.bs","MAWBridgeUpdateE2EEMetadataParticipantsHandler.bs","MAWBridgeUpdateTraceHandler.bs","MAWBridgeUploadMessageHandler.bs","MAWBridgeUploadThreadHandler.bs","MAWBridgeXMAShareExpiredHandler.bs","MAWBridgeXMAShareTombstonedHandler.bs","MAWDualSendSimplePermissionsManager.bs","MAWGating.bs","MWV2DualSendMessageContent.bs","Promise","Promise.bs","bs_caml_option","bs_curry","bs_js_exn","cr:9875","promiseDone","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";function g(a){if(a.isDualSend)return!0;else return b("MWV2DualSendMessageContent.bs").isDualSend(a.content)}function a(a,c){a=a.then(function(a){return b("LSTransaction.bs").run(a,function(a){var d=b("MAWGating.bs").isArmadillo(void 0),e=b("MAWDualSendSimplePermissionsManager.bs").isDualSendUser(void 0),f=d||e?function(c){switch(c.TAG|0){case 0:var d=c._0;if(g(d))return b("Promise").resolve(void 0);else return b("MAWBridgeNewMsgHandler.bs").call(a,d);case 1:return b("MAWBridgeMsgsStartCountdownHandler.bs").call(a,c._0);case 2:return b("MAWBridgeMsgClearCountdownHandler.bs").call(c._0);case 3:return b("MAWBridgeDropAllSecureThreadsHandler.bs").call(a);case 4:d=c._0;if(d.isDualSend)return b("Promise").resolve(void 0);else return b("bs_curry")._2(b("cr:9875").call,a,d);case 5:d=c._0;if(g(d))return b("Promise").resolve(void 0);else return b("MAWBridgeMsgUpdatedHandler.bs").call(a,d);case 6:return b("MAWBridgeNewMediaHandler.bs").call(a,c._0);case 7:return b("MAWBridgeNewMediaRangeHandler.bs").call(a,c._0);case 8:return b("MAWBridgeMediaExpiredHandler.bs").call(a,c._0);case 9:return b("MAWBridgeXMAShareExpiredHandler.bs").call(a,c._0);case 10:return b("MAWBridgeNewXMAHandler.bs").call(a,c._0);case 11:return b("MAWBridgeXMAShareTombstonedHandler.bs").call(a,c._0);case 12:return b("MAWBridgeParticipantUpdatedHandler.bs").call(a,c._0);case 13:return b("MAWBridgeParticipantRemovedHandler.bs").call(a,c._0);case 14:return b("MAWBridgeUpdateE2EEMetadataParticipantsHandler.bs").call(a,c._0);case 15:return b("MAWBridgeReceivedReceiptHandler.bs").call(a,c._0);case 16:return b("MAWBridgeThreadUpdatedHandler.bs").call(a,c._0);case 17:d=c._0;if(d.isDualSend)return b("Promise").resolve(void 0);else return b("MAWBridgeGroupInfoUpdatedHandler.bs").call(a,d);case 18:d=c._0;if(d.isDualSend)return b("Promise").resolve(void 0);else return b("MAWBridgeThreadBumpedHandler.bs").call(a,d);case 19:return b("MAWBridgeThreadsLoadedHandler.bs").call(a,c._0);case 20:return b("MAWBridgeThreadTimestampsHandler.bs").call(a,c._0);case 21:return b("MAWBridgeMsgsLoadedHandler.bs").call(a,c._0);case 22:return b("MAWBridgeInitSyncCompleteHandler.bs").call(a);case 23:return b("MAWBridgeStartTraceHandler.bs").call(a,c._0);case 24:return b("MAWBridgeUpdateTraceHandler.bs").call(a,c._0);case 25:return b("MAWBridgeThreadHiddenHandler.bs").call(a,c._0);case 26:return b("MAWBridgeSyncContacts.bs").call(a,c._0);case 27:return b("MAWBridgeReceivedChatStateHandler.bs").call(a,c._0);case 28:return b("MAWBridgeClockSkewUpdatedHandler.bs").call(a,c._0);case 29:return b("MAWBridgeAbPropsUpdatedHandler.bs").call(c._0);case 30:return b("MAWBridgeReactionUpsertHandler.bs").call(a,c._0);case 31:return b("MAWBridgeDeleteReactionHandler.bs").call(a,c._0);case 32:return b("MAWBridgeUploadMessageHandler.bs").call(a,c._0);case 33:return b("MAWBridgeUploadThreadHandler.bs").call(a,c._0);case 34:var e=c._0;return b("JSResource")("MAWBridgeCallFinishAddDeviceHandler.bs").__setRef("MAWBridgeUIEventHandler.bs").load().then(function(c){return b("bs_curry")._2(c.call,a,e)});case 35:var f=c._0;return b("JSResource")("MAWBridgeUploadAttachmentHandler.bs").__setRef("MAWBridgeUIEventHandler.bs").load().then(function(c){return b("bs_curry")._2(c.call,a,f)});case 36:var h=c._0;return b("JSResource")("MAWBridgeResignAttachmentCDNUrlHandler.bs").__setRef("MAWBridgeUIEventHandler.bs").load().then(function(c){return b("bs_curry")._2(c.call,a,h)});case 37:return b("MAWBridgeDeleteMessagesHandler.bs").call(a,c._0);case 38:var i=c._0;return b("JSResource")("MAWBridgeRestoreMessageBatchHandler.bs").__setRef("MAWBridgeUIEventHandler.bs").load().then(function(c){return b("bs_curry")._2(c.call,a,i)});case 39:return b("MAWBridgeOneToOneMessageRequestLoadedHandler.bs").call(a,c._0);case 40:return b("MAWBridgeGroupInviteUpdateHandler.bs").call(a,c._0)}}:(b("recoverableViolation")("User is neither part of armadillo QE and dual send QE but somehow loaded this handler","messenger_web_product"),function(a){return b("Promise").resolve(void 0)});return c.reduce(function(a,c){return a.then(function(a){return b("bs_curry")._1(f,c)})},b("Promise").resolve(void 0))},"readWrite")});b("promiseDone")(a,void 0,function(a){a=a.RE_EXN_ID===b("Promise.bs").JsError||a.RE_EXN_ID===b("bs_js_exn").$$Error?b("bs_caml_option").some(a._1):a;b("recoverableViolation")("Error handling UI Event","messenger_web_product",{error:a})})}f.$MAWBridgeOccamadilloVerifyThreadExistsHandler$OR$MAWBridgeVerifyThreadExistsHandler$requireCond=b("cr:9875");f.handleEvents=a}),null);
__d("MAWBridgeUIEventHandler.re",["MAWBridgeUIEventHandler.bs"],(function(a,b,c,d,e,f){var g={0:0,1:1},h={SENDER_BACKFILL_SENT:0,INACTIVE_RECEIVED:1,CONTENT_UNUPLOADABLE:2,CONTENT_TOO_BIG:3,CONTENT_GONE:4,EXPIRED:5,FAILED:6,CLOCK:7,SENT:8,RECEIVED:9,READ:10,PLAYED:11};a=function(a,c){a=b("MAWBridgeUIEventHandler.bs").handleEvents(a,c.map(function(a){return a.tag===0?{TAG:0,_0:{ts:a.value.ts,isDualSend:a.value.isDualSend,chatId:a.value.chatId,rowId:a.value.rowId,msgId:a.value.msgId,sender:a.value.sender,isAdminMessage:a.value.isAdminMessage,content:a.value.content,ack:h[a.value.ack],type_:a.value.type_,adminType:a.value.adminType,adminContent:a.value.adminContent,offlineMsg:a.value.offlineMsg,isAuthorMe:a.value.isAuthorMe,isForwarded:a.value.isForwarded,originalTs:a.value.originalTs,replySnippet:a.value.replySnippet,replyMessageText:a.value.replyMessageText,replySourceId:a.value.replySourceId,replyToUserId:a.value.replyToUserId,replySourceTimestampMs:a.value.replySourceTimestampMs,replyStatusType:a.value.replyStatusType,replyMediaExpirationTimestampMs:a.value.replyMediaExpirationTimestampMs,replyMediaId:a.value.replyMediaId,replyMediaPreviewWidth:a.value.replyMediaPreviewWidth,replyMediaPreviewHeight:a.value.replyMediaPreviewHeight,replyMediaUrlMimeType:a.value.replyMediaUrlMimeType,replyMediaUrlFallback:a.value.replyMediaUrlFallback,replyCtaId:a.value.replyCtaId,replyCtaTitle:a.value.replyCtaTitle,replySenderIsMe:a.value.replySenderIsMe,ephemeralDurationInSec:a.value.ephemeralDurationInSec,sortOrderMs:a.value.sortOrderMs,specialTextSize:a.value.specialTextSize,isStoryReply:a.value.isStoryReply,replyXMAId:a.value.replyXMAId,isStoryShare:a.value.isStoryShare,isExpiredXmaMsg:a.value.isExpiredXmaMsg}}:a.tag===1?{TAG:1,_0:a.value}:a.tag===2?{TAG:2,_0:a.value}:a.tag===3?{TAG:3,_0:a.value}:a.tag===4?{TAG:4,_0:a.value}:a.tag===5?{TAG:5,_0:{ts:a.value.ts,isDualSend:a.value.isDualSend,chatId:a.value.chatId,rowId:a.value.rowId,msgId:a.value.msgId,sender:a.value.sender,isAdminMessage:a.value.isAdminMessage,content:a.value.content,ack:h[a.value.ack],type_:a.value.type_,adminType:a.value.adminType,adminContent:a.value.adminContent,offlineMsg:a.value.offlineMsg,isAuthorMe:a.value.isAuthorMe,isForwarded:a.value.isForwarded,originalTs:a.value.originalTs,replySnippet:a.value.replySnippet,replyMessageText:a.value.replyMessageText,replySourceId:a.value.replySourceId,replyToUserId:a.value.replyToUserId,replySourceTimestampMs:a.value.replySourceTimestampMs,replyStatusType:a.value.replyStatusType,replyMediaExpirationTimestampMs:a.value.replyMediaExpirationTimestampMs,replyMediaId:a.value.replyMediaId,replyMediaPreviewWidth:a.value.replyMediaPreviewWidth,replyMediaPreviewHeight:a.value.replyMediaPreviewHeight,replyMediaUrlMimeType:a.value.replyMediaUrlMimeType,replyMediaUrlFallback:a.value.replyMediaUrlFallback,replyCtaId:a.value.replyCtaId,replyCtaTitle:a.value.replyCtaTitle,replySenderIsMe:a.value.replySenderIsMe,ephemeralDurationInSec:a.value.ephemeralDurationInSec,sortOrderMs:a.value.sortOrderMs,specialTextSize:a.value.specialTextSize,isStoryReply:a.value.isStoryReply,replyXMAId:a.value.replyXMAId,isStoryShare:a.value.isStoryShare,isExpiredXmaMsg:a.value.isExpiredXmaMsg}}:a.tag===6?{TAG:6,_0:a.value}:a.tag===7?{TAG:7,_0:a.value}:a.tag===8?{TAG:8,_0:a.value}:a.tag===9?{TAG:9,_0:a.value}:a.tag===10?{TAG:10,_0:a.value}:a.tag===11?{TAG:11,_0:a.value}:a.tag===12?{TAG:12,_0:a.value}:a.tag===13?{TAG:13,_0:a.value}:a.tag===14?{TAG:14,_0:a.value}:a.tag===15?{TAG:15,_0:a.value}:a.tag===16?{TAG:16,_0:a.value}:a.tag===17?{TAG:17,_0:a.value}:a.tag===18?{TAG:18,_0:a.value}:a.tag===19?{TAG:19,_0:a.value}:a.tag===20?{TAG:20,_0:a.value}:a.tag===21?{TAG:21,_0:a.value}:a.tag===22?{TAG:22,_0:a.value}:a.tag===23?{TAG:23,_0:{ts:a.value.ts,externalId:a.value.externalId,threadType:g[a.value.threadType],type_:a.value.type_,ack:h[a.value.ack],isDS:a.value.isDS,threadJid:a.value.threadJid,isFirstMsg:a.value.isFirstMsg,openMessageOtid:a.value.openMessageOtid,openMessageParticipantCount:a.value.openMessageParticipantCount,participantCount:a.value.participantCount}}:a.tag===24?{TAG:24,_0:a.value}:a.tag===25?{TAG:25,_0:a.value}:a.tag===26?{TAG:26,_0:a.value}:a.tag===27?{TAG:27,_0:a.value}:a.tag===28?{TAG:28,_0:a.value}:a.tag===29?{TAG:29,_0:a.value}:a.tag===30?{TAG:30,_0:a.value}:a.tag===31?{TAG:31,_0:a.value}:a.tag===32?{TAG:32,_0:a.value}:a.tag===33?{TAG:33,_0:a.value}:a.tag===34?{TAG:34,_0:a.value}:a.tag===35?{TAG:35,_0:a.value}:a.tag===36?{TAG:36,_0:a.value}:a.tag===37?{TAG:37,_0:a.value}:a.tag===38?{TAG:38,_0:a.value}:a.tag===39?{TAG:39,_0:a.value}:{TAG:40,_0:a.value}}));return a};f.handleEvents=a}),null);
__d("MAWBridgeUIEventHandlerWrapper",["MAWBridgeUIEventHandler.re"],(function(a,b,c,d,e,f,g){"use strict";function h(a){switch(a){case 0:return"SENDER_BACKFILL_SENT";case 1:return"INACTIVE_RECEIVED";case 2:return"CONTENT_UNUPLOADABLE";case 3:return"CONTENT_TOO_BIG";case 4:return"CONTENT_GONE";case 5:return"EXPIRED";case 6:return"FAILED";case 7:return"CLOCK";case 8:return"SENT";case 9:return"RECEIVED";case 10:return"READ";case 11:return"PLAYED"}}function i(a){switch(a.tag){case 0:return{tag:0,value:babelHelpers["extends"]({},a.value,{ack:h(a.value.ack)})};case 5:return{tag:5,value:babelHelpers["extends"]({},a.value,{ack:h(a.value.ack)})};case 23:return{tag:23,value:babelHelpers["extends"]({},a.value,{ack:h(a.value.ack)})};default:return a}}function a(a,b){b=b.map(i);d("MAWBridgeUIEventHandler.re").handleEvents(a,b)}g.handleEvents=a}),98);
__d("MAWBridgeUIEventsWrapper",["MAWBridgeTypesWrapper"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(a.tag){case 0:return{tag:"NewMsg",value:d("MAWBridgeTypesWrapper").bridgeMsgToJS(a.value)};case 1:return{tag:"MsgsStartCountdown",value:a.value};case 2:return{tag:"MsgClearCountdown",value:a.value};case 3:return{tag:"DropAllSecureThreads",value:a.value};case 4:return{tag:"VerifyThreadExists",value:a.value};case 5:return{tag:"MsgUpdated",value:d("MAWBridgeTypesWrapper").bridgeMsgToJS(a.value)};case 6:return{tag:"NewMedia",value:a.value};case 7:return{tag:"NewMediaRange",value:a.value};case 8:return{tag:"MediaExpired",value:a.value};case 9:return{tag:"XMAShareExpired",value:a.value};case 10:return{tag:"NewXMA",value:a.value};case 11:return{tag:"XMAShareTombstoned",value:a.value};case 12:return{tag:"ParticipantUpdated",value:a.value};case 13:return{tag:"ParticipantRemoved",value:a.value};case 14:return{tag:"UpdateE2EEMetadataParticipants",value:a.value};case 15:return{tag:"ReceivedReceipt",value:a.value};case 16:return{tag:"ThreadUpdated",value:a.value};case 17:return{tag:"GroupInfoUpdated",value:a.value};case 18:return{tag:"ThreadBumped",value:a.value};case 19:return{tag:"ThreadsLoaded",value:a.value};case 20:return{tag:"ThreadTimestampsUpdated",value:a.value};case 21:return{tag:"MsgsLoaded",value:a.value};case 22:return{tag:"InitSyncComplete",value:a.value};case 23:return{tag:"StartTrace",value:d("MAWBridgeTypesWrapper").bridgeStartTraceDataToJS(a.value)};case 24:return{tag:"UpdateTrace",value:a.value};case 25:return{tag:"ThreadHidden",value:a.value};case 26:return{tag:"SyncContacts",value:a.value};case 27:return{tag:"ReceivedChatState",value:a.value};case 28:return{tag:"ClockSkewUpdated",value:a.value};case 29:return{tag:"ABPropsUpdated",value:a.value};case 30:return{tag:"UpsertReaction",value:a.value};case 31:return{tag:"DeleteReaction",value:a.value};case 32:return{tag:"UploadMessage",value:a.value};case 33:return{tag:"UploadThread",value:a.value};case 34:return{tag:"CallFinishAddDevice",value:a.value};case 35:return{tag:"UploadAttachment",value:a.value};case 36:return{tag:"ResignAttachmentCDNUrl",value:a.value};case 37:return{tag:"DeleteMessages",value:a.value};case 38:return{tag:"RestoreMessageBatch",value:a.value};case 39:return{tag:"OneToOneMessageRequestLoaded",value:a.value};case 40:return{tag:"GroupInviteUpdate",value:a.value}}}function b(a){switch(a.tag){case"NewMsg":return{tag:0,value:d("MAWBridgeTypesWrapper").bridgeMsgToRE(a.value)};case"MsgsStartCountdown":return{tag:1,value:a.value};case"MsgClearCountdown":return{tag:2,value:a.value};case"DropAllSecureThreads":return{tag:3,value:a.value};case"VerifyThreadExists":return{tag:4,value:a.value};case"MsgUpdated":return{tag:5,value:d("MAWBridgeTypesWrapper").bridgeMsgToRE(a.value)};case"NewMedia":return{tag:6,value:a.value};case"NewMediaRange":return{tag:7,value:a.value};case"MediaExpired":return{tag:8,value:a.value};case"XMAShareExpired":return{tag:9,value:a.value};case"NewXMA":return{tag:10,value:a.value};case"XMAShareTombstoned":return{tag:11,value:a.value};case"ParticipantUpdated":return{tag:12,value:a.value};case"ParticipantRemoved":return{tag:13,value:a.value};case"UpdateE2EEMetadataParticipants":return{tag:14,value:a.value};case"ReceivedReceipt":return{tag:15,value:a.value};case"ThreadUpdated":return{tag:16,value:a.value};case"GroupInfoUpdated":return{tag:17,value:a.value};case"ThreadBumped":return{tag:18,value:a.value};case"ThreadsLoaded":return{tag:19,value:a.value};case"ThreadTimestampsUpdated":return{tag:20,value:a.value};case"MsgsLoaded":return{tag:21,value:a.value};case"InitSyncComplete":return{tag:22,value:a.value};case"StartTrace":return{tag:23,value:d("MAWBridgeTypesWrapper").bridgeStartTraceDataToRE(a.value)};case"UpdateTrace":return{tag:24,value:a.value};case"ThreadHidden":return{tag:25,value:a.value};case"SyncContacts":return{tag:26,value:a.value};case"ReceivedChatState":return{tag:27,value:a.value};case"ClockSkewUpdated":return{tag:28,value:a.value};case"ABPropsUpdated":return{tag:29,value:a.value};case"UpsertReaction":return{tag:30,value:a.value};case"DeleteReaction":return{tag:31,value:a.value};case"UploadMessage":return{tag:32,value:a.value};case"UploadThread":return{tag:33,value:a.value};case"CallFinishAddDevice":return{tag:34,value:a.value};case"UploadAttachment":return{tag:35,value:a.value};case"ResignAttachmentCDNUrl":return{tag:36,value:a.value};case"DeleteMessages":return{tag:37,value:a.value};case"RestoreMessageBatch":return{tag:38,value:a.value};case"OneToOneMessageRequestLoaded":return{tag:39,value:a.value};case"GroupInviteUpdate":return{tag:40,value:a.value}}}g.UIEventToJS=a;g.UIEventToRE=b}),98);
__d("LSMailboxType.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;d=[0,1024];e=[0,4096];f.messenger=a;f.communities=c;f.tincan=d;f.tam=e}),null);
__d("LSNullstateDescriptionType.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;d=[0,2];e=[0,3];f.default_=a;f.subtext=c;f.titleSmallDefault=d;f.titleSmallSubtext=e}),null);
__d("LSRtcCallState.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;d=[0,2];f.noOngoingCall=a;f.audioGroupCall=c;f.videoGroupCall=d}),null);
__d("MAWThemeConstant.bs",[],(function(a,b,c,d,e,f){"use strict";a=[603383,3212336517];f.secureTheme=a}),null);
__d("MAWThreadDefaults.bs",["fbt","LSBitOffset.bs","LSThreadCapabilityBitOffset.bs","MAWGating.bs","bs_caml_int64"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a){if(b("MAWGating.bs").isRepliesEnabled(void 0))return b("LSBitOffset.bs").set(b("LSThreadCapabilityBitOffset.bs").messageReply,a);else return a}function c(a){if(b("MAWGating.bs").isGifSearchEnabled(void 0))return b("LSBitOffset.bs").set(b("LSThreadCapabilityBitOffset.bs").gif,a);else return a}var j=(e=b("LSBitOffset.bs")).set((h=b("LSThreadCapabilityBitOffset.bs")).rtcVoiceCall,e.set(h.rtcVideoCall,e.set(h.reactions,e.set(h.filePicker,e.set(h.feedbackAndReport,e.set(h.audioClips,e.set(h.threadDetails,e.empty))))))),k=a(c(e.set(h.block,e.set(h.muteThread,e.set(h.createGroup,j))))),l=e.set(h.feedbackAndReport,e.set(h.threadNameCustomization,e.set(h.blockGroupMember,e.set(h.memberList,e.set(h.leaveThread,e.clear(h.addMember,k))))));function d(a){return b("bs_caml_int64").sub(a,[0,64])}i=e.set((i=b("bs_caml_int64")).sub(h.messageForward,[0,64]),e.set(i.sub(h.restrictContact,[0,64]),e.set(i.sub(h.threadDetailsDeleteThread,[0,64]),e.set(i.sub(h.unarchiveThread,[0,64]),e.set(i.sub(h.archiveThread,[0,64]),e.empty)))));h=g._(/*FBT_CALL*/"Messages are secured with end-to-end encryption."/*FBT_CALL*/).toString();g=e.empty;f.setReplyCapability=a;f.setGifCapability=c;f.defaultOptimisticThreadCapabilities=j;f.defaultThreadCapabilities=k;f.defaultGroupThreadCapabilities=l;f.makeOffset=d;f.defaultThreadCapabilities_2=i;f.defaultThreadCapabilities_3=g;f.nullstateDescriptionText1=h}),null);
__d("MessengerJoinableModeType.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;f.private_=a;f.joinable=c}),null);
__d("MAWBridgeVerifyThreadExistsHandler.bs",["LSAuthorityLevel.bs","LSMailboxType.bs","LSNullstateDescriptionType.bs","LSRtcCallState.bs","MAWFolder.bs","MAWThemeConstant.bs","MAWThreadDefaults.bs","MAWThreadId.bs","MAWTimeUtils.bs","MessagingThreadType.bs","MessengerJoinableModeType.bs","Promise","ReQL.bs","ReQLTable.bs","bs_caml_format","bs_caml_int64","bs_caml_obj","bs_caml_option","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";function g(a,c,d){return b("MAWThreadId.bs").toThreadKey(a,c.chatId).then(function(e){return b("ReQLTable.bs").update(a.table("threads"),{hd:d,tl:0},function(a){if(a===void 0)return b("unrecoverableViolation")("Optimistic thread is missing","messenger_e2ee_web");a=b("bs_caml_obj").caml_obj_dup(a);a.capabilities2=b("MAWThreadDefaults.bs").defaultThreadCapabilities_2;a.authorityLevel=b("LSAuthorityLevel.bs").authoritative;a.capabilities=c.isGroup?b("MAWThreadDefaults.bs").defaultGroupThreadCapabilities:b("MAWThreadDefaults.bs").defaultThreadCapabilities;a.cannotReplyReason=b("bs_caml_option").nullable_to_opt(c.cannotReplyReason);a.lastReadWatermarkTimestampMs=b("MAWTimeUtils.bs").toTimestamp(c.lastReadTs);a.lastActivityTimestampMs=b("MAWTimeUtils.bs").toTimestamp(c.lastActivityTs);a.threadType=c.isGroup?b("MessagingThreadType.bs").secureMessageOverWaGroup:b("MessagingThreadType.bs").secureMessageOverWaOneToOne;a.threadKey=e;return a}).then(function(a){})})}function h(a,c){return b("MAWThreadId.bs").toThreadKey(a,c.chatId).then(function(d){return a.table("threads").add({threadKey:d,mailboxType:b("LSMailboxType.bs").tam,threadType:c.isGroup?b("MessagingThreadType.bs").secureMessageOverWaGroup:b("MessagingThreadType.bs").secureMessageOverWaOneToOne,threadName:void 0,folderName:b("MAWFolder.bs").messagingFolderTag(c.folder),threadPictureUrl:void 0,threadPictureUrlFallback:void 0,threadPictureUrlExpirationTimestampMs:void 0,lastActivityTimestampMs:b("MAWTimeUtils.bs").toTimestamp(c.lastActivityTs),lastReadWatermarkTimestampMs:b("MAWTimeUtils.bs").toTimestamp(c.lastReadTs),removeWatermarkTimestampMs:b("bs_caml_int64").zero,muteExpireTimeMs:b("bs_caml_int64").of_float(c.muteExpireTimeMs),snippet:void 0,isAdminSnippet:!1,snippetSenderContactId:void 0,snippetStringHash:void 0,snippetStringArgument1:void 0,snippetAttribution:void 0,snippetAttributionStringHash:void 0,needsAdminApprovalForNewParticipant:void 0,ongoingCallState:b("LSRtcCallState.bs").noOngoingCall,cannotReplyReason:b("bs_caml_option").nullable_to_opt(c.cannotReplyReason),customEmoji:void 0,customEmojiImageUrl:void 0,outgoingBubbleColor:void 0,themeFbid:b("MAWThemeConstant.bs").secureTheme,parentThreadKey:b("MAWFolder.bs").systemFolder(c.folder),nullstateDescriptionText1:b("MAWThreadDefaults.bs").nullstateDescriptionText1,nullstateDescriptionType1:b("LSNullstateDescriptionType.bs").default_,nullstateDescriptionText2:void 0,nullstateDescriptionType2:void 0,nullstateDescriptionText3:void 0,nullstateDescriptionType3:void 0,draftMessage:void 0,snippetHasEmoji:!1,hasPersistentMenu:!1,disableComposerInput:!1,cannotUnsendReason:void 0,viewedPluginKey:void 0,viewedPluginContext:void 0,clientThreadKey:void 0,capabilities:c.isGroup?b("MAWThreadDefaults.bs").defaultGroupThreadCapabilities:b("MAWThreadDefaults.bs").defaultThreadCapabilities,shouldRoundThreadPicture:void 0,isCustomThreadPicture:!1,otidOfFirstMessage:void 0,normalizedSearchTerms:void 0,additionalThreadContext:void 0,disappearingThreadKey:void 0,isDisappearingMode:!1,disappearingModeInitiator:void 0,unreadDisappearingMessageCount:b("bs_caml_int64").zero,authorityLevel:b("LSAuthorityLevel.bs").authoritative,threadDescription:void 0,capabilities2:b("MAWThreadDefaults.bs").defaultThreadCapabilities_2,muteCallsExpireTimeMs:b("bs_caml_int64").of_float(c.muteCallsExpireTimeMs),syncGroup:void 0,lastMessageCtaId:void 0,lastMessageCtaType:void 0,lastMessageCtaTimestampMs:void 0,unsendLimitMs:b("bs_caml_int64").zero,isAllUnreadMessageMissedCallXma:void 0,threadInvitesEnabled:b("MessengerJoinableModeType.bs").private_,lastNonMissedCallXmaMessageTimestampMs:void 0,threadInviteLink:void 0,threadInvitesEnabledV2:b("MessengerJoinableModeType.bs").private_,proactiveWarningDismissTime:void 0,eventStartTimestampMs:void 0,eventEndTimestampMs:void 0,hasPendingInvitation:void 0,capabilities3:b("MAWThreadDefaults.bs").defaultThreadCapabilities_3,igFolder:void 0}).then(function(a){})})}function i(a,c){return b("MAWThreadId.bs").toThreadKey(a,c.chatId).then(function(d){return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("threads")),{hd:d,tl:0})).then(function(d){if(d!==void 0)return b("Promise").resolve(void 0);else return h(a,c).then(function(a){})})})}function a(a,c){var d=c.clientThreadKey;if(d==null)return i(a,c);else{var e=b("bs_caml_format").caml_int64_of_string(d);return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("threads")),{hd:e,tl:0})).then(function(d){if(d!==void 0)return g(a,c,e).then(function(a){return b("Promise").resolve(void 0)});else return i(a,c)})}}f.call=a}),null);
__d("LSE2EEMetadataSyncSyncGroups.bs",["LSDatabaseType.bs","LSDict","LSJson","LSSyncChannel.bs","Promise","bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";c=b("LSJson").stringify(new(b("LSDict"))([]));var g={groupId:b("LSDatabaseType.bs").e2eeMessagingMetadataMailbox,currentCursor:void 0,syncStatus:(d=b("bs_caml_int64")).zero,syncParams:c,sendSyncParams:!0,minTimeToSyncTimestampMs:d.neg_one,canIgnoreTimestamp:!1,priority:d.zero,lastSyncRequestTimestampMs:d.zero,regionHint:void 0,lastSyncCompletedTimestampMs:void 0,dataTraceId:void 0,initTraceTimestampMs:void 0,syncChannel:b("LSSyncChannel.bs").mqtt},h={taskQueueName:"",syncDatabaseId:b("LSDatabaseType.bs").e2eeMessagingMetadataMailbox,epochId:void 0,networkTaskIdentifier:void 0,lastSentTimestampMs:d.zero,failureCount:d.zero,lastSyncRequestTimestampMs:d.zero,lastDelayedRequestTimestampMs:void 0};function a(a){return b("Promise").all([a.table("sync_groups").put(g),a.table("network_requests").put(h)]).then(function(a){})}f.defaultSyncGroup=g;f.defaultNetworkRequest=h;f.seed=a}),null);
__d("MAWOccamadilloOnMutexChange",["LSDatabaseType.bs","LSE2EEMetadataSyncSyncGroups.bs","MAWGating.re","Promise","bs_caml_int64","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";function h(a){if(c("MAWGating.re").isOccamadillo()&&c("MAWGating.re").isOccamadilloInitSyncEnabled())return a.table("sync_groups").put({canIgnoreTimestamp:c("LSE2EEMetadataSyncSyncGroups.bs").defaultSyncGroup.canIgnoreTimestamp,currentCursor:c("LSE2EEMetadataSyncSyncGroups.bs").defaultSyncGroup.currentCursor,dataTraceId:c("LSE2EEMetadataSyncSyncGroups.bs").defaultSyncGroup.dataTraceId,groupId:c("LSE2EEMetadataSyncSyncGroups.bs").defaultSyncGroup.groupId,initTraceTimestampMs:c("LSE2EEMetadataSyncSyncGroups.bs").defaultSyncGroup.initTraceTimestampMs,lastSyncCompletedTimestampMs:c("LSE2EEMetadataSyncSyncGroups.bs").defaultSyncGroup.lastSyncCompletedTimestampMs,lastSyncRequestTimestampMs:c("bs_caml_int64").zero,minTimeToSyncTimestampMs:c("LSE2EEMetadataSyncSyncGroups.bs").defaultSyncGroup.minTimeToSyncTimestampMs,priority:c("LSE2EEMetadataSyncSyncGroups.bs").defaultSyncGroup.priority,regionHint:c("LSE2EEMetadataSyncSyncGroups.bs").defaultSyncGroup.regionHint,sendSyncParams:c("LSE2EEMetadataSyncSyncGroups.bs").defaultSyncGroup.sendSyncParams,syncChannel:c("LSE2EEMetadataSyncSyncGroups.bs").defaultSyncGroup.syncChannel,syncParams:c("LSE2EEMetadataSyncSyncGroups.bs").defaultSyncGroup.syncParams,syncStatus:c("LSE2EEMetadataSyncSyncGroups.bs").defaultSyncGroup.syncStatus});else return b("Promise").resolve()}function i(a){if(c("MAWGating.re").isOccamadillo()&&c("MAWGating.re").isOccamadilloInitSyncEnabled())return a.table("network_requests").put({epochId:void 0,failureCount:c("bs_caml_int64").zero,lastDelayedRequestTimestampMs:void 0,lastSentTimestampMs:c("bs_caml_int64").zero,lastSyncRequestTimestampMs:c("bs_caml_int64").zero,networkTaskIdentifier:void 0,syncDatabaseId:d("LSDatabaseType.bs").e2eeMessagingMetadataMailbox,taskQueueName:""});else return b("Promise").resolve()}function a(a){c("promiseDone")(a.runInTransaction(function(a){return b("Promise").all([h(a),i(a)])},"readwrite"))}g.onOccamadilloMutexChange=a}),98);
__d("WAResultOrError",[],(function(a,b,c,d,e,f){function a(a){return{success:!1,error:a}}function b(a){return{success:!0,value:a}}f.makeError=a;f.makeSuccess=b}),66);
__d("WAProtoConst",[],(function(a,b,c,d,e,f){a={REPEATED:1<<6,PACKED:1<<7,REQUIRED:1<<8};b=31;c={INT32:1,INT64:2,UINT32:3,UINT64:4,SINT32:5,SINT64:6,BOOL:7,ENUM:8,FIXED64:9,SFIXED64:10,DOUBLE:11,STRING:12,BYTES:13,MESSAGE:14,FIXED32:15,SFIXED32:16,FLOAT:17};d={VARINT:0,BIT64:1,BINARY:2,BIT32:5};e={ONEOF:"__oneofs__",RESERVED:"__reserved__",RESERVED_TAGS:"tags",RESERVED_FIELDS:"fields"};f.FLAGS=a;f.TYPE_MASK=b;f.TYPES=c;f.ENC=d;f.KEYS=e}),66);
__d("WABinary",["WAHex"],(function(a,b,c,d,e,f,g){var h=65533,i=10,j=new Uint8Array(i),k=new Uint8Array(0);a=function(){function a(b,c){var d=this;b===void 0&&(b=k);c===void 0&&(c=!1);this.write=function(){for(var b=0;b<arguments.length;b++){var c=b<0||arguments.length<=b?void 0:arguments[b];typeof c==="string"?d.writeString(c):typeof c==="number"?d.writeUint8(c):c instanceof a?d.writeBinary(c):c instanceof ArrayBuffer?d.writeBuffer(c):c instanceof Uint8Array&&d.writeByteArray(c)}};b instanceof ArrayBuffer?(this.$1=new Uint8Array(b),this.$2=this.$4=b.byteLength):b instanceof Uint8Array&&(this.$1=b,this.$2=this.$4=b.length);this.$5=0;this.$6=this.$3=0;this.$7=null;this.$8=c;this.$9=0;this.$10=0}var b=a.prototype;b.size=function(){return this.$2-this.$3};b.peek=function(a,b){this.$9++;var c=this.$3,d=this.$5;try{return a(this,b)}finally{this.$9--,this.$3=c-(this.$5-d)}};b.advance=function(a){this.$11(a)};b.readWithViewParser=function(a,b,c,d){return b(this.$12(),this.$11(a),a,c,d)};b.readWithBytesParser=function(a,b,c,d){return b(this.$1,this.$11(a),a,c,d)};b.readUint8=function(){return p(this,1,r,!1)};b.readInt8=function(){return p(this,1,r,!0)};b.readUint16=function(a){a===void 0&&(a=this.$8);return p(this,2,s,a)};b.readInt32=function(a){a===void 0&&(a=this.$8);return p(this,4,t,a)};b.readUint32=function(a){a===void 0&&(a=this.$8);return p(this,4,u,a)};b.readInt64=function(a){a===void 0&&(a=this.$8);return p(this,8,v,U,a)};b.readUint64=function(a){a===void 0&&(a=this.$8);return p(this,8,v,V,a)};b.readLong=function(a,b){b===void 0&&(b=this.$8);return p(this,8,v,a,b)};b.readFloat32=function(a){a===void 0&&(a=this.$8);return p(this,4,w,a)};b.readFloat64=function(a){a===void 0&&(a=this.$8);return p(this,8,x,a)};b.readVarInt=function(a){var b=this.size();b=q(this,0,y,b);return q(this,b,z,a)};b.readBuffer=function(a){a===void 0&&(a=this.size());return a===0?new ArrayBuffer(0):q(this,a,A)};b.readByteArray=function(a){a===void 0&&(a=this.size());return a===0?new Uint8Array(0):q(this,a,B)};b.readBinary=function(b,c){b===void 0&&(b=this.size());c===void 0&&(c=this.$8);if(b===0)return new a(void 0,c);b=q(this,b,B);return new a(b,c)};b.indexOf=function(a){if(a.length===0)return 0;var b=this.$1,c=this.$2,d=this.$3,e=0,f=d;for(var g=d;g<c;g++)if(b[g]===a[e]){e===0&&(f=g);e++;if(e===a.byteLength)return g-d-a.byteLength+1}else e>0&&(e=0,g=f);return-1};b.readString=function(a){return q(this,a,C)};b.ensureCapacity=function(a){this.$13(this.$3+a)};b.ensureAdditionalCapacity=function(a){this.$13(this.$4+a)};b.writeToView=function(a,b,c,d){var e=this.$14(a);return b(this.$12(),e,a,c,d)};b.writeToBytes=function(a,b,c,d){var e=this.$14(a);return b(this.$1,e,a,c,d)};b.writeUint8=function(a){S(a,0,256,"uint8"),E(this,1,F,a,!1)};b.writeInt8=function(a){S(a,-128,128,"signed int8"),E(this,1,F,a,!0)};b.writeUint16=function(a,b){b===void 0&&(b=this.$8),S(a,0,65536,"uint16"),D(this,2,G,a,b)};b.writeInt16=function(a,b){b===void 0&&(b=this.$8),S(a,-32768,32768,"signed int16"),D(this,2,H,a,b)};b.writeUint32=function(a,b){b===void 0&&(b=this.$8),S(a,0,4294967296,"uint32"),D(this,4,I,a,b)};b.writeInt32=function(a,b){b===void 0&&(b=this.$8),S(a,-2147483648,2147483648,"signed int32"),D(this,4,J,a,b)};b.writeUint64=function(a,b){b===void 0&&(b=this.$8),S(a,0,18446744073709552e3,"uint64"),D(this,8,K,a,b)};b.writeInt64=function(a,b){b===void 0&&(b=this.$8),S(a,-9223372036854776e3,9223372036854776e3,"signed int64"),D(this,8,K,a,b)};b.writeFloat32=function(a,b){b===void 0&&(b=this.$8),D(this,4,L,a,b)};b.writeFloat64=function(a,b){b===void 0&&(b=this.$8),D(this,8,M,a,b)};b.writeVarInt=function(a){S(a,-9223372036854776e3,9223372036854776e3,"varint (signed int64)");var b=a<0;a=b?-a:a;var c=Math.floor(a/4294967296);a=a-c*4294967296;b&&(c=~c,a===0?c++:a=-a);b=R(c,a);E(this,b,N,c,a)};b.writeVarIntFromHexLong=function(a){var b=d("WAHex").hexLongIsNegative(a);a=b?d("WAHex").negateHexLong(a):a;a=d("WAHex").hexLongToHex(a);var c=0,e=0;for(var f=0;f<d("WAHex").NUM_HEX_IN_LONG;f++)c=c<<4|e>>>28,e=e<<4|d("WAHex").hexAt(a,f);b&&(c=~c,e===0?c++:e=-e);a=R(c,e);E(this,a,N,c,e)};b.writeBinary=function(a){a=a.peek(function(a){return a.readByteArray()});if(a.length){var b=this.$14(a.length);this.$1.set(a,b)}};b.writeBuffer=function(a){this.writeByteArray(new Uint8Array(a))};b.writeByteArray=function(a){var b=this.$14(a.length);this.$1.set(a,b)};b.writeBufferView=function(a){this.writeByteArray(new Uint8Array(a.buffer,a.byteOffset,a.byteLength))};b.writeString=function(a){E(this,n(a),O,a)};b.writeHexLong=function(a,b){b===void 0&&(b=this.$8),D(this,8,P,a,b)};b.writeBytes=function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];for(var d=0;d<b.length;d++)S(b[d],0,256,"byte");E(this,b.length,Q,b)};b.writeAtomically=function(a,b){this.$10++;var c=this.$4,d=this.$5;try{a=a(this,b);c=this.$4;d=this.$5;return a}finally{this.$10--,this.$4=c-(this.$5-d)}};b.writeWithVarIntLength=function(a,b){var c=this.$4;a=this.writeAtomically(a,b);b=this.$4;this.writeVarInt(b-c);var d=this.$4-b,e=this.$1;for(var f=0;f<d;f++)j[f]=e[b+f];for(var f=b-1;f>=c;f--)e[f+d]=e[f];for(var b=0;b<d;b++)e[c+b]=j[b];return a};a.build=function(){for(var b=arguments.length,c=new Array(b),d=0;d<b;d++)c[d]=arguments[d];var e=0;for(var f=0;f<c.length;f++){var g=c[f];typeof g==="string"?e+=n(g):typeof g==="number"?e++:g instanceof a?e+=g.size():g instanceof ArrayBuffer?e+=g.byteLength:g instanceof Uint8Array&&(e+=g.length)}var h=new a();h.ensureCapacity(e);h.write.apply(h,arguments);return h};b.$12=function(){return this.$7||(this.$7=new DataView(this.$1.buffer,this.$1.byteOffset))};b.$11=function(a){if(a<0)throw new Error("ReadError: given negative number of bytes to read");var b=this.$3;a=b+a;if(a>this.$2)throw new Error(b===this.$2?"ReadError: tried to read from depleted binary":"ReadError: tried to read beyond end of binary");this.$3=a;this.$9||(this.$6=a);return b};b.$13=function(a){var b=this.$1;if(a<=b.length)return a;else{var c=this.$6;a=a-c;var d=Math.max(a,2*(b.length-c),64);d=new Uint8Array(d);c?(d.set(b.subarray(c)),this.$5+=c,this.$3-=c,this.$2-=c,this.$4-=c,this.$6=0):d.set(b);this.$1=d;this.$7=null;return a}};b.$14=function(a){a=this.$13(this.$4+a);var b=this.$4;this.$4=a;this.$10||(this.$2=a);return b};return a}();var l="",m=0;function n(a){if(a===l)return m;var b=a.length,c=0;for(var d=0;d<b;d++){var e=a.charCodeAt(d);if(e<128)c++;else if(e<2048)c+=2;else if(e<55296||57344<=e&&e<=65535)c+=3;else if(55296<=e&&e<56320&&d+1!==b){e=a.charCodeAt(d+1);56320<=e&&e<57344?(d++,c+=4):c+=3}else c+=3}l=a;return m=c}function o(a,b,c){var d=b>>21;if(!a)return d===0;else{a=b&2097151;b=Boolean(a||c);return d===0||d===-1&&b}}function p(a,b,c,d,e){return a.readWithViewParser(b,c,d,e)}function q(a,b,c,d,e){return a.readWithBytesParser(b,c,d,e)}function r(a,b,c,d){return d?a.getInt8(b):a.getUint8(b)}function s(a,b,c,d){return a.getUint16(b,d)}function t(a,b,c,d){return a.getInt32(b,d)}function u(a,b,c,d){return a.getUint32(b,d)}function v(a,b,c,d,e){c=a.getInt32(e?b+4:b,e);a=a.getInt32(e?b:b+4,e);return d(c,a)}function w(a,b,c,d){return a.getFloat32(b,d)}function x(a,b,c,d){return a.getFloat64(b,d)}function y(a,b,c,d){c=Math.min(d,i);d=0;var e=128;while(d<c&&e&128)e=a[b+d++];if(d===i&&e>1)throw new Error("ParseError: varint exceeds 64 bits");else if(e&128)return d+1;return d}function z(b,c,d,a){var e=0,f=0,g=d;d===i&&(g--,f=b[c+g]&1);for(var d=g-1;d>=0;d--)e=e<<7|f>>>25,f=f<<7|b[c+d]&127;return a(e,f)}function A(a,b,c){b=b+a.byteOffset;a=a.buffer;return b===0&&c===a.byteLength?a:a.slice(b,b+c)}function B(a,b,c){return a.subarray(b,b+c)}function C(a,b,c){c=b+c;var d=[],e=null;for(var b=b;b<c;b++){d.length>5e3&&(e||(e=[]),e.push(String.fromCharCode.apply(String,d)),d=[]);var f=a[b]|0;if((f&128)===0)d.push(f);else if((f&224)===192){var g=W(a,b+1,c);if(g){b++;g=(f&31)<<6|g&63;g>=128?d.push(g):d.push(h)}else d.push(h)}else if((f&240)===224){g=W(a,b+1,c);var i=W(a,b+2,c);if(g&&i){b+=2;i=(f&15)<<12|(g&63)<<6|i&63;i>=2048&&!(55296<=i&&i<57344)?d.push(i):d.push(h)}else g?(b++,d.push(h)):d.push(h)}else if((f&248)===240){i=W(a,b+1,c);g=W(a,b+2,c);var j=W(a,b+3,c);if(i&&g&&j){b+=3;f=(f&7)<<18|(i&63)<<12|(g&63)<<6|j&63;if(f>=65536&&f<=1114111){j=f-65536;d.push(55296|j>>10,56320|j&1023)}else d.push(h)}else i&&g?(b+=2,d.push(h)):i?(b++,d.push(h)):d.push(h)}else d.push(h)}f=String.fromCharCode.apply(String,d);if(e){e.push(f);return e.join("")}else return f}function D(a,b,c,d,e){return a.writeToView(b,c,d,e)}function E(a,b,c,d,e){return a.writeToBytes(b,c,d,e)}function F(a,b,c,d){a[b]=d}function G(a,b,c,d,e){a.setUint16(b,d,e)}function H(a,b,c,d,e){a.setInt16(b,d,e)}function I(a,b,c,d,e){a.setUint32(b,d,e)}function J(a,b,c,d,e){a.setInt32(b,d,e)}function K(a,b,c,d,e){c=d<0;d=c?-d:d;var f=Math.floor(d/4294967296);d=d-f*4294967296;c&&(f=~f,d===0?f++:d=-d);a.setUint32(e?b+4:b,f,e);a.setUint32(e?b:b+4,d,e)}function L(a,b,c,d,e){a.setFloat32(b,d,e)}function M(a,b,c,d,e){a.setFloat64(b,d,e)}function N(a,b,c,d,e){d=d;e=e;c=b+c-1;for(var b=b;b<c;b++)a[b]=128|e&127,e=d<<25|e>>>7,d>>>=7;a[c]=e}function O(a,b,c,d){c=b;b=d.length;for(var e=0;e<b;e++){var f=d.charCodeAt(e);if(f<128)a[c++]=f;else if(f<2048)a[c++]=192|f>>6,a[c++]=128|f&63;else if(f<55296||57344<=f)a[c++]=224|f>>12,a[c++]=128|f>>6&63,a[c++]=128|f&63;else if(55296<=f&&f<56320&&e+1!==b){var g=d.charCodeAt(e+1);if(56320<=g&&g<57344){e++;f=65536+((f&1023)<<10|g&1023);a[c++]=240|f>>18;a[c++]=128|f>>12&63;a[c++]=128|f>>6&63;a[c++]=128|f&63}else a[c++]=239,a[c++]=191,a[c++]=189}else a[c++]=239,a[c++]=191,a[c++]=189}}function P(a,b,c,e,f){c=d("WAHex").hexLongIsNegative(e);e=d("WAHex").hexLongToHex(e);var g=0,h=0;for(var i=0;i<16;i++)g=g<<4|h>>>28,h=h<<4|d("WAHex").hexAt(e,i);c&&(g=~g,h===0?g++:h=-h);a.setUint32(f?b+4:b,g,f);a.setUint32(f?b:b+4,h,f)}function Q(a,b,c,d){for(var e=0;e<c;e++)a[b+e]=d[e]}function R(a,b){var c;a?(c=5,a=a>>>3):(c=1,a=b>>>7);while(a)c++,a>>>=7;return c}function S(a,b,c,d){if(typeof a!=="number"||a!==a||Math.floor(a)!==a||a<b||a>=c)throw new TypeError(typeof a==="string"?'WriteError: string "'+a+'" is not a valid '+d:"WriteError: "+String(a)+" is not a valid "+d)}function T(a,b,c){var d=o(a,b,c),e;b>=0?e=b:e=a?b:4294967296+b;a=c>=0?c:4294967296+c;b=e*4294967296+a;if(!d)throw new Error("ReadError: integer exceeded 53 bits ("+b+")");return b}function U(a,b){return T(!0,a,b)}function V(a,b){return T(!1,a,b)}function W(a,b,c){if(b>=c)return 0;c=a[b]|0;return(c&192)===128?c:0}g.Binary=a;g.numUtf8Bytes=n;g.longFitsInDouble=o;g.parseInt64OrThrow=U;g.parseUint64OrThrow=V}),98);
__d("WAHasProperty",[],(function(a,b,c,d,e,f){function a(a,b){return Object.prototype.hasOwnProperty.call(a,b)}f["default"]=a}),66);
__d("WAProtoCompile",["WAProtoConst"],(function(a,b,c,d,e,f,g){var h=function(a,b,c,d,e,f,g,h,i){this.names=a,this.fields=b,this.types=c,this.defaults=d,this.meta=e,this.oneofToFields=f,this.fieldToOneof=g,this.reservedTags=h?h.reduce(function(a,b){a[b]=!0;return a},{}):{},this.reservedFields=i?i.reduce(function(a,b){a[b]=!0;return a},{}):{}};function a(a){if(a.internalCompiledSpec)return a.internalCompiledSpec;var b=a.internalSpec;if(!b)throw new Error("Message Class "+String(a)+" does not have internalSpec");var c=a.internalDefaults||{},e=Object.keys(b).filter(function(a){return a!==d("WAProtoConst").KEYS.ONEOF}),f=new Array(e.length),g=[],j=[],k=new Array(e.length),l=b[d("WAProtoConst").KEYS.ONEOF]||{};e.sort(function(a,c){a=i(b,a);c=i(b,c);return a[0]-c[0]});for(var m=0;m<e.length;m++){var n=e[m],o=i(b,n);k[m]=c[n];n=o[1];var p=o[0];g.push(p);j.push(n);if((n&d("WAProtoConst").TYPE_MASK)===d("WAProtoConst").TYPES.MESSAGE)f[m]=o[2];else if((n&d("WAProtoConst").TYPE_MASK)===d("WAProtoConst").TYPES.ENUM){p=o[2];if(typeof p.cast==="function")f[m]=p;else{n=!0;o=0;for(var q in p)n&&q!==o++&&(n=!1);q=void 0;if(n){q=[];for(var n=0;n<o;n++)q.push(!0)}else{q={};for(var n in p)q[p[n]]=!0}f[m]=q}}else f[m]=null}var r={};o=function(a){l[a].forEach(function(b){r[b]||(r[b]=[]),r[b].push(a)})};for(var n in l)o(n);p=b[d("WAProtoConst").KEYS.RESERVED]&&b[d("WAProtoConst").KEYS.RESERVED][d("WAProtoConst").KEYS.RESERVED_TAGS];q=b[d("WAProtoConst").KEYS.RESERVED]&&b[d("WAProtoConst").KEYS.RESERVED][d("WAProtoConst").KEYS.RESERVED_FIELDS];m=new h(e,g,j,k,f,l,r,p,q);a.internalCompiledSpec=m;return m}function i(a,b){a=a[b];if(a==null)throw new Error("fieldData of "+b+" is missing");return a}g.Spec=h;g.compileSpec=a}),98);
__d("WAProtoUtils",["WAProtoConst"],(function(a,b,c,d,e,f,g){function a(a){if(a&d("WAProtoConst").FLAGS.PACKED)return d("WAProtoConst").ENC.BINARY;a=a&d("WAProtoConst").TYPE_MASK;if(a<=d("WAProtoConst").TYPES.ENUM)return d("WAProtoConst").ENC.VARINT;else if(a<=d("WAProtoConst").TYPES.DOUBLE)return d("WAProtoConst").ENC.BIT64;else if(a<=d("WAProtoConst").TYPES.MESSAGE)return d("WAProtoConst").ENC.BINARY;else return d("WAProtoConst").ENC.BIT32}g.typeToEncType=a}),98);
__d("WAProtoValidate",["WAHasProperty","WALogger","WAProtoCompile","WAProtoConst"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(['"','" is not an array']);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(['"','" is not ',""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(['"','" is out of range']);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(['"','" is not a valid int']);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(['"','" is not a valid long']);l=function(){return a};return a}var m=Number.MAX_SAFE_INTEGER;function n(a,b){a=o(a,b);if(a){a.reverse();throw new TypeError("Message missing required value "+a.join("."))}}function a(a,b){n(a,b);b=u(b,a);if(b){b.path.reverse();throw new TypeError("Invalid value at "+b.path.join(".")+": "+b.error)}}function o(a,b){a=d("WAProtoCompile").compileSpec(a);var e=a.names,f=a.types;a=a.meta;var g=void 0;for(var h=0;h<f.length&&!g;h++){var i=f[h],j=e[h],k=c("WAHasProperty")(b,j)?b[j]:void 0;if(i&d("WAProtoConst").FLAGS.REQUIRED&&k==null)g=[j];else if((i&d("WAProtoConst").TYPE_MASK)===d("WAProtoConst").TYPES.MESSAGE&&i&d("WAProtoConst").FLAGS.REPEATED&&k!=null){var l=a[h],m=void 0;for(m=0;m<k.length&&!g;m++)g=o(l,k[m]);g&&g.push(j+"["+m+"]")}else(i&d("WAProtoConst").TYPE_MASK)===d("WAProtoConst").TYPES.MESSAGE&&k!=null&&(g=o(a[h],k),g&&g.push(j))}return g}function p(a,b,c){if(typeof a==="string")if(/^-?0x[0-9a-f]{16}$/i.test(a))return!1;else{d("WALogger").LOG(l(),s(a)).color("red");return{path:[],error:"value must be a hex string of the form '0x123...' or '-0x123...' where the tail is always 16 characters long"}}else return q(a,b,c)}function q(a,b,c){if(typeof a!=="number"||a!==a||Math.floor(a)!==a){d("WALogger").LOG(k(),s(a)).color("red");return{path:[],error:"value must be an int"}}else if(a<b||a>=c){d("WALogger").LOG(j(),s(a)).color("red");return{path:[],error:"value is out of range"}}else return!1}function r(a,b,c){if(a)return void 0;else{d("WALogger").LOG(i(),s(c),b).color("red");return{path:[],error:"value is invalid"}}}function s(a){if(typeof a==="string")return'"'+a+'"';else if(Array.isArray(a))return"["+a.join(", ")+"]";else return""+a}var t=[void 0,function(a){return q(a,-2147483648,2147483648)},function(a){return p(a,-m,m+1)},function(a){return q(a,0,4294967296)},function(a){return p(a,0,m+1)},function(a){return q(a,-2147483648,2147483648)},function(a){return p(a,-m,m+1)},function(a){return r(typeof a==="boolean","boolean",a)},function(a,b){return r(typeof a==="number"&&(b[a]||b.cast(a)!==void 0),"in enum",a)},function(a){return p(a,0,m+1)},function(a){return p(a,-m,m+1)},function(a){return r(typeof a==="number","number",a)},function(a){return r(typeof a==="string","string",a)},function(a){return r(a instanceof ArrayBuffer||a instanceof Uint8Array,"ArrayBuffer or Uint8Array",a)},u,function(a){return q(a,0,4294967296)},function(a){return q(a,-2147483648,2147483648)},function(a){return r(typeof a==="number","number",a)}];function u(a,b){b=d("WAProtoCompile").compileSpec(b);var c=b.names,e=b.fields,f=b.types,g=b.meta,i=b.oneofToFields,j=b.fieldToOneof,k=b.reservedTags,l=b.reservedFields,m=void 0;b=function(b){var n=c[b],o=f[b],p=a[n],q=o&d("WAProtoConst").TYPE_MASK,r=t[q];if(r===void 0)throw new Error("Can not find the validator for type "+q);if(o&(d("WAProtoConst").FLAGS.PACKED|d("WAProtoConst").FLAGS.REPEATED)&&p!=null)if(!Array.isArray(p))d("WALogger").LOG(h(),s(p)).color("red"),m={path:[n],error:"repeated field must be array"};else{q=g[b];for(var o=0;o<p.length&&!m;o++)m=r(p[o],q),m&&m.path.push(n+"["+o+"]")}else if(p!=null){m=r(p,g[b]);m&&m.path.push(n);o=j[n];o&&o.forEach(function(b){var c=i[b].filter(function(a){return a!==n});c.forEach(function(c){typeof a[c]!=="undefined"&&(m={path:[b],error:"oneof has fields '"+n+"' and '"+c+"' set"})})});k[e[b]]&&(m={path:[n],error:"tag "+e[b]+" is reserved"});l[n]&&(m={path:[n],error:"field name is reserved"})}};for(var n=0;n<c.length&&!m;n++)b(n);return m}g.checkRequirements=n;g.checkValid=a}),98);
__d("decodeProtobuf",["WABinary","WAHasProperty","WAHex","WAProtoCompile","WAProtoConst","WAProtoUtils","WAProtoValidate"],(function(a,b,c,d,e,f,g){function a(a,b){b=new(d("WABinary").Binary)(b);b=n(a,b,void 0,!1);d("WAProtoValidate").checkRequirements(a,b);return b}function b(a,b){b=new(d("WABinary").Binary)(b);b=n(a,b,void 0,!0);d("WAProtoValidate").checkRequirements(a,b);return b}function e(a){return c("WAHasProperty")(a,"$$unsafeUnknownFields")?a.$$unsafeUnknownFields:null}function h(a,b,c){if(a!==d("WAProtoUtils").typeToEncType(b))throw new Error("FormatError: "+c+" encoded with wire type "+a)}function i(a,b,c){switch(b){case d("WAProtoConst").TYPES.INT32:return j(c,-2147483648,2147483648,a,d("WABinary").parseInt64OrThrow);case d("WAProtoConst").TYPES.INT64:return c.readVarInt(k);case d("WAProtoConst").TYPES.UINT32:return j(c,0,4294967296,a,d("WABinary").parseUint64OrThrow);case d("WAProtoConst").TYPES.UINT64:return c.readVarInt(l);case d("WAProtoConst").TYPES.SINT32:b=j(c,0,4294967296,a,d("WABinary").parseInt64OrThrow);return b&1?~(b>>>1):b>>>1;case d("WAProtoConst").TYPES.SINT64:return c.readVarInt(m);case d("WAProtoConst").TYPES.BOOL:return!!j(c,0,2,a,d("WABinary").parseUint64OrThrow);case d("WAProtoConst").TYPES.ENUM:return c.readVarInt(d("WABinary").parseInt64OrThrow);case d("WAProtoConst").TYPES.FIXED64:return c.readLong(l,!0);case d("WAProtoConst").TYPES.SFIXED64:return c.readLong(k,!0);case d("WAProtoConst").TYPES.DOUBLE:return c.readFloat64(!0);case d("WAProtoConst").TYPES.STRING:return c.readString(c.readVarInt(d("WABinary").parseUint64OrThrow));case d("WAProtoConst").TYPES.BYTES:return c.readBuffer(c.readVarInt(d("WABinary").parseUint64OrThrow));case d("WAProtoConst").TYPES.FIXED32:return c.readUint32(!0);case d("WAProtoConst").TYPES.SFIXED32:return c.readInt32(!0);case d("WAProtoConst").TYPES.FLOAT:return c.readFloat32(!0)}}function j(a,b,c,d,e){a=a.readVarInt(e);if(a<b||a>=c)throw new Error("FormatError: "+d+" encoded with out-of-range value "+a);return a}function k(a,b){var c=d("WABinary").longFitsInDouble(!0,a,b);if(c){c=o(b);return a*4294967296+c}else{c=a<0;var e;c?e=b===0?-a:~a:e=a;a=c?-b:b;return d("WAHex").createHexLongFrom32Bits(e,a,c)}}function l(a,b){var c=d("WABinary").longFitsInDouble(!1,a,b);if(c){c=o(a);var e=o(b);return c*4294967296+e}else return d("WAHex").createHexLongFrom32Bits(a,b)}function m(a,b){var c=a>>>1;a=a<<31|b>>>1;b&1&&(c=~c,a=~a);return k(c,a)}function n(a,b,c,e){var f=d("WAProtoCompile").compileSpec(a),g=f.names,k=f.fields,l=f.types,m=f.meta,o=f.oneofToFields,p=f.fieldToOneof,q=f.reservedTags,r=f.reservedFields;f=a.internalDefaults;var s=c||babelHelpers["extends"]({},f)||{};s.$$unknownFieldCount=(a=c==null?void 0:c.$$unknownFieldCount)!=null?a:0;for(var f=0;f<g.length;f++)l[f]&d("WAProtoConst").FLAGS.REPEATED&&(s[g[f]]=[]);var t=0;c=k.length>0;a=k[0];while(b.size()){f=j(b,0,4294967296,"field and enc type",d("WABinary").parseInt64OrThrow);var u=f&7,v=f>>>3;if(c&&v!==a){f=t;do++t===k.length&&(t=0),a=k[t];while(v!==a&&t!==f)}if(c&&v===a)(function(){var a=g[t],c=l[t];h(u,c,a);var f=c&d("WAProtoConst").TYPE_MASK,j=m[t];if(c&d("WAProtoConst").FLAGS.PACKED){var k=b.readVarInt(d("WABinary").parseUint64OrThrow);k=b.readBinary(k);while(k.size()){var w=i(a,f,k);(f!==d("WAProtoConst").TYPES.ENUM||j[w]||(j.cast==null?void 0:j.cast(w))!==void 0)&&s[a].push(w)}}else if(f===d("WAProtoConst").TYPES.MESSAGE){w=b.readVarInt(d("WABinary").parseUint64OrThrow);k=b.readBinary(w);if(c&d("WAProtoConst").FLAGS.REPEATED)s[a].push(n(j,k,void 0,e));else{w=s[a];s[a]=n(j,k,w,e)}}else{k=i(a,f,b);(f!==d("WAProtoConst").TYPES.ENUM||j[k]||(j.cast==null?void 0:j.cast(k))!==void 0)&&(c&d("WAProtoConst").FLAGS.REPEATED?s[a].push(k):s[a]=k)}w=p[a];w&&typeof s[a]!=="undefined"&&w.forEach(function(b){b=o[b].filter(function(b){return b!==a});b.forEach(function(a){delete s[a]})});(q[v]||r[a])&&delete s[a]})();else{s.$$unknownFieldCount++;if(e){s.$$unsafeUnknownFields||(s.$$unsafeUnknownFields={});f=void 0;switch(u){case d("WAProtoConst").ENC.VARINT:f=b.readVarInt(d("WABinary").parseInt64OrThrow);break;case d("WAProtoConst").ENC.BIT64:f=b.readBinary(8);break;case d("WAProtoConst").ENC.BINARY:f=b.readBinary(b.readVarInt(d("WABinary").parseUint64OrThrow));break;case d("WAProtoConst").ENC.BIT32:f=b.readBinary(4);break}s.$$unsafeUnknownFields[v]=f}else u===d("WAProtoConst").ENC.VARINT?b.readVarInt(d("WABinary").parseInt64OrThrow):u===d("WAProtoConst").ENC.BIT64?b.advance(8):u===d("WAProtoConst").ENC.BINARY?b.advance(b.readVarInt(d("WABinary").parseUint64OrThrow)):u===d("WAProtoConst").ENC.BIT32&&b.advance(4)}}return s}function o(a){return a>=0?a:4294967296+a}g.decodeProtobuf=a;g.decodeProtobufWithUnknowns=b;g.getUnknownFields=e}),98);
__d("encodeProtobuf",["WABinary","WAHex","WAProtoCompile","WAProtoConst","WAProtoUtils","WAProtoValidate"],(function(a,b,c,d,e,f,g){var h=void 0,i=128;function a(a,b,c){c===void 0&&(c=new(d("WABinary").Binary)());d("WAProtoValidate").checkValid(a,b);o(c,b,a);h=void 0;return c}function b(){return h!==void 0?"Last encoded value for "+h:"No information known"}function c(a,b){a.writeVarInt(b)}function e(a,b){if(typeof b==="number"&&b<4503599627370496&&b>=-4503599627370496)a.writeVarInt(b>=0?2*b:2*-b-1);else{var c=new(d("WABinary").Binary)(),e;typeof b==="number"?(e=b<0,c.writeVarInt(e?-b:b)):(e=d("WAHex").hexLongIsNegative(b),c.writeVarIntFromHexLong(e?d("WAHex").negateHexLong(b):b));b=c.peek(function(){return c.readByteArray()});var f=b.byteLength;if(e){var g=0,h;do h=b[g],b[g]=h&i|(h&127)-1&127,g++;while(b[g-1]===255)}h=e?1:0;for(var g=0;g<f;g++){e=b[g];var j=e&i|(e&63)<<1|h;h=(e&64)>>6;b[g]=j}h===1&&(b[f-1]|=i,c.writeInt8(1));a.writeBinary(c)}}function f(a,b){typeof b==="number"?a.writeVarInt(b):a.writeVarIntFromHexLong(b)}function j(a,b){a.writeVarInt(d("WABinary").numUtf8Bytes(b)),a.writeString(b)}function k(a,b){a.writeVarInt(b.byteLength),a.writeBuffer(b)}function l(a,b,c){a.writeWithVarIntLength(function(a,b){return o(a,b,c)},b)}var m=[void 0,c,f,c,f,e,e,function(a,b){a.writeVarInt(b?1:0)},c,function(a,b){typeof b==="number"?a.writeUint64(b,!0):a.writeHexLong(b,!0)},function(a,b){typeof b==="number"?a.writeInt64(b,!0):a.writeHexLong(b,!0)},function(a,b){a.writeFloat64(b,!0)},j,k,l,function(a,b){a.writeUint32(b,!0)},function(a,b){a.writeInt32(b,!0)},function(a,b){a.writeFloat32(b,!0)}];f=function(a){if(a==null)return void 0;var b=a;function c(a,c){for(var d=0;d<c.length;d++)b(a,c[d])}return function(a,b){a.writeWithVarIntLength(c,b)}};var n=m.map(f);function o(a,b,c){var e=d("WAProtoCompile").compileSpec(c),f=e.names,g=e.fields,i=e.types;e=e.meta;c=c.internalDefaults;for(var j=0;j<f.length;j++){var k=f[j],l=b[k];l==null&&c&&(l=c[k]);if(l!=null){h=k;k=g[j];var o=i[j],p=o&d("WAProtoConst").TYPE_MASK,q=e[j];k=k*8|d("WAProtoUtils").typeToEncType(o);if(o&d("WAProtoConst").FLAGS.PACKED){if(l.length>0){a.writeVarInt(k);var r=n[p];r(a,l,q)}}else if(o&d("WAProtoConst").FLAGS.REPEATED)for(var r=0;r<l.length;r++){a.writeVarInt(k);o=m[p];o(a,l[r],q)}else{a.writeVarInt(k);o=m[p];o(a,l,q)}}}}g.encodeProtobuf=a;g.encodeErrorInfo=b}),98);
/**
 * License: https://www.facebook.com/legal/license/7R_-0_GF-gR/
 */
__d("dexie-3.1.0-alpha.4",[],(function(a,b,c,d,e,f){"use strict";var g={},h={exports:g},i;function j(){(function(b,c){typeof g==="object"&&typeof h!=="undefined"?h.exports=c():typeof i==="function"&&i.amd?i(c):b.Dexie=c()})(this,function(){var b=function(){b=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};return b.apply(this,arguments)};function c(){for(var a=0,b=0,c=arguments.length;b<c;b++)a+=arguments[b].length;for(var d=Array(a),e=0,b=0;b<c;b++)for(var f=arguments[b],g=0,h=f.length;g<h;g++,e++)d[e]=f[g];return d}var d=Object.keys,e=Array.isArray,f=typeof self!=="undefined"?self:typeof window!=="undefined"?window:a;typeof Promise!=="undefined"&&!f.Promise&&(f.Promise=Promise);function g(a,b){if(typeof b!=="object")return a;d(b).forEach(function(c){a[c]=b[c]});return a}var h=Object.getPrototypeOf,i={}.hasOwnProperty;function j(a,b){return i.call(a,b)}function k(a,b){typeof b==="function"&&(b=b(h(a))),d(b).forEach(function(c){m(a,c,b[c])})}var l=Object.defineProperty;function m(a,b,c,d){l(a,b,g(c&&j(c,"get")&&typeof c.get==="function"?{get:c.get,set:c.set,configurable:!0}:{value:c,configurable:!0,writable:!0},d))}function n(a){return{from:function(b){a.prototype=Object.create(b.prototype);m(a.prototype,"constructor",a);return{extend:k.bind(null,a.prototype)}}}}var o=Object.getOwnPropertyDescriptor;function p(a,b){var c=o(a,b);return c||(c=h(a))&&p(c,b)}var q=[].slice;function r(a,b,c){return q.call(a,b,c)}function s(a,b){return b(a)}function t(a){if(!a)throw new Error("Assertion Failed")}function aa(a){f.setImmediate?setImmediate(a):setTimeout(a,0)}function u(a,b){return a.reduce(function(a,c,d){c=b(c,d);c&&(a[c[0]]=c[1]);return a},{})}function ba(a,b,c){try{a.apply(null,c)}catch(a){b&&b(a)}}function v(a,b){if(j(a,b))return a[b];if(!b)return a;if(typeof b!=="string"){var c=[];for(var d=0,e=b.length;d<e;++d){var f=v(a,b[d]);c.push(f)}return c}f=b.indexOf(".");if(f!==-1){d=a[b.substr(0,f)];return d===void 0?void 0:v(d,b.substr(f+1))}return void 0}function w(a,b,c){if(!a||b===void 0)return;if("isFrozen"in Object&&Object.isFrozen(a))return;if(typeof b!=="string"&&"length"in b){t(typeof c!=="string"&&"length"in c);for(var d=0,f=b.length;d<f;++d)w(a,b[d],c[d])}else{d=b.indexOf(".");if(d!==-1){f=b.substr(0,d);d=b.substr(d+1);if(d==="")c===void 0?e(a)&&!isNaN(parseInt(f))?a.splice(f,1):delete a[f]:a[f]=c;else{var g=a[f];g||(g=a[f]={});w(g,d,c)}}else c===void 0?e(a)&&!isNaN(parseInt(b))?a.splice(b,1):delete a[b]:a[b]=c}}function ca(a,b){typeof b==="string"?w(a,b,void 0):"length"in b&&[].map.call(b,function(b){w(a,b,void 0)})}function da(a){var b={};for(var c in a)j(a,c)&&(b[c]=a[c]);return b}var ea=[].concat;function fa(a){return ea.apply([],a)}var x="Boolean,String,Date,RegExp,Blob,File,FileList,ArrayBuffer,DataView,Uint8ClampedArray,ImageData,Map,Set".split(",").concat(fa([8,16,32,64].map(function(a){return["Int","Uint","Float"].map(function(b){return b+a+"Array"})}))).filter(function(a){return f[a]}),ga=x.map(function(a){return f[a]}),ha=u(x,function(a){return[a,!0]});function y(a){if(!a||typeof a!=="object")return a;var b;if(e(a)){b=[];for(var c=0,d=a.length;c<d;++c)b.push(y(a[c]))}else if(ga.indexOf(a.constructor)>=0)b=a;else{b=a.constructor?Object.create(a.constructor.prototype):{};for(var c in a)j(a,c)&&(b[c]=y(a[c]))}return b}var ia={}.toString;function ja(a){return ia.call(a).slice(8,-1)}var ka=function(a,b){return b==="Array"?""+a.map(function(a){return ka(a,ja(a))}):b==="ArrayBuffer"?""+new Uint8Array(a):b==="Date"?a.getTime():ArrayBuffer.isView(a)?""+new Uint8Array(a.buffer):a};function la(a,b,c,e){c=c||{};e=e||"";d(a).forEach(function(d){if(!j(b,d))c[e+d]=void 0;else{var f=a[d],g=b[d];if(typeof f==="object"&&typeof g==="object"&&f&&g){var h=ja(f),i=ja(g);h===i?ha[h]?ka(f,h)!==ka(g,i)&&(c[e+d]=b[d]):la(f,g,c,e+d+"."):c[e+d]=b[d]}else f!==g&&(c[e+d]=b[d])}});d(b).forEach(function(d){j(a,d)||(c[e+d]=b[d])});return c}var ma=typeof Symbol!=="undefined"&&Symbol.iterator,na=ma?function(a){var b;return a!=null&&(b=a[ma])&&b.apply(a)}:function(){return null},z={};function A(a){var b,c,d,f;if(arguments.length===1){if(e(a))return a.slice();if(this===z&&typeof a==="string")return[a];if(f=na(a)){c=[];while(d=f.next(),!d.done)c.push(d.value);return c}if(a==null)return[a];b=a.length;if(typeof b==="number"){c=new Array(b);while(b--)c[b]=a[b];return c}return[a]}b=arguments.length;c=new Array(b);while(b--)c[b]=arguments[b];return c}var oa=typeof Symbol!=="undefined"?function(a){return a[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},B=typeof location!=="undefined"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function pa(a,b){B=a,qa=b}var qa=function(){return!0},ra=!new Error("").stack;function C(){if(ra)try{throw new Error()}catch(a){return a}return new Error()}function sa(a,b){var c=a.stack;if(!c)return"";b=b||0;c.indexOf(a.name)===0&&(b+=(a.name+a.message).split("\n").length);return c.split("\n").slice(b).filter(qa).map(function(a){return"\n"+a}).join("")}x=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"];var D=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"];x=x.concat(D);var ta={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed"};function E(a,b){this._e=C(),this.name=a,this.message=b}n(E).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+sa(this._e,2))}},toString:function(){return this.name+": "+this.message}});function ua(a,b){return a+". Errors: "+Object.keys(b).map(function(a){return b[a].toString()}).filter(function(a,b,c){return c.indexOf(a)===b}).join("\n")}function va(a,b,c,d){this._e=C(),this.failures=b,this.failedKeys=d,this.successCount=c,this.message=ua(a,b)}n(va).from(E);function wa(a,b){this._e=C(),this.name="BulkError",this.failures=b,this.message=ua(a,b)}n(wa).from(E);var xa=x.reduce(function(a,b){return a[b]=b+"Error",a},{}),ya=E,F=x.reduce(function(b,c){var d=c+"Error";function a(a,b){this._e=C(),this.name=d,!a?(this.message=ta[c]||d,this.inner=null):typeof a==="string"?(this.message=""+a+(b?"\n "+b:""),this.inner=b||null):typeof a==="object"&&(this.message=a.name+" "+a.message,this.inner=a)}n(a).from(ya);b[c]=a;return b},{});F.Syntax=SyntaxError;F.Type=TypeError;F.Range=RangeError;var za=D.reduce(function(a,b){a[b+"Error"]=F[b];return a},{});function Aa(a,b){if(!a||a instanceof E||a instanceof TypeError||a instanceof SyntaxError||!a.name||!za[a.name])return a;b=new za[a.name](b||a.message,a);"stack"in a&&m(b,"stack",{get:function(){return this.inner.stack}});return b}D=x.reduce(function(a,b){["Syntax","Type","Range"].indexOf(b)===-1&&(a[b+"Error"]=F[b]);return a},{});D.ModifyError=va;D.DexieError=E;D.BulkError=wa;function G(){}function Ba(a){return a}function Ca(a,b){return a==null||a===Ba?b:function(c){return b(a(c))}}function H(a,b){return function(){a.apply(this,arguments),b.apply(this,arguments)}}function Da(a,b){return a===G?b:function(){var c=a.apply(this,arguments);c!==void 0&&(arguments[0]=c);var d=this.onsuccess,e=this.onerror;this.onsuccess=null;this.onerror=null;var f=b.apply(this,arguments);d&&(this.onsuccess=this.onsuccess?H(d,this.onsuccess):d);e&&(this.onerror=this.onerror?H(e,this.onerror):e);return f!==void 0?f:c}}function Ea(a,b){return a===G?b:function(){a.apply(this,arguments);var c=this.onsuccess,d=this.onerror;this.onsuccess=this.onerror=null;b.apply(this,arguments);c&&(this.onsuccess=this.onsuccess?H(c,this.onsuccess):c);d&&(this.onerror=this.onerror?H(d,this.onerror):d)}}function Fa(a,b){return a===G?b:function(c){var d=a.apply(this,arguments);g(c,d);var e=this.onsuccess,f=this.onerror;this.onsuccess=null;this.onerror=null;var h=b.apply(this,arguments);e&&(this.onsuccess=this.onsuccess?H(e,this.onsuccess):e);f&&(this.onerror=this.onerror?H(f,this.onerror):f);return d===void 0?h===void 0?void 0:h:g(d,h)}}function Ga(a,b){return a===G?b:function(){return b.apply(this,arguments)===!1?!1:a.apply(this,arguments)}}function Ha(a,b){return a===G?b:function(){var c=a.apply(this,arguments);if(c&&typeof c.then==="function"){var d=this,e=arguments.length,f=new Array(e);while(e--)f[e]=arguments[e];return c.then(function(){return b.apply(d,f)})}return b.apply(this,arguments)}}var Ia={},Ja=100,Ka=20,La=100;x=typeof Promise==="undefined"?[]:function(){var a=Promise.resolve();if(typeof crypto==="undefined"||!crypto.subtle)return[a,a.__proto__,a];var b=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[b,b.__proto__,a]}();var Ma=x[0],Na=x[1],Oa=x[2],Pa=Na&&Na.then,Qa=Ma&&Ma.constructor,Ra=!!Oa,Sa=!1,Ta=Oa?function(){Oa.then(kb)}:f.setImmediate?setImmediate.bind(null,kb):f.MutationObserver?function(){var a=document.createElement("div");new MutationObserver(function(){kb(),a=null}).observe(a,{attributes:!0});a.setAttribute("i","1")}:function(){setTimeout(kb,0)},Ua=function(a,b){$a.push([a,b]),Wa&&(Ta(),Wa=!1)},Va=!0,Wa=!0,I=[],Xa=[],Ya=null,Za=Ba,J={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Gb,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(function(a){try{Gb(a[0],a[1])}catch(a){}})}},K=J,$a=[],L=0,ab=[];function M(a){if(typeof this!=="object")throw new TypeError("Promises must be constructed via new");this._listeners=[];this.onuncatched=G;this._lib=!1;var b=this._PSD=K;B&&(this._stackHolder=C(),this._prev=null,this._numPrev=0);if(typeof a!=="function"){if(a!==Ia)throw new TypeError("Not a function");this._state=arguments[1];this._value=arguments[2];this._state===!1&&eb(this,this._value);return}this._state=null;this._value=null;++b.ref;db(this,a)}var bb={get:function(){var a=K,b=vb;function c(c,d){var e=this,f=!a.global&&(a!==K||b!==vb),g=f&&!R(),h=new M(function(b,h){gb(e,new cb(Db(c,a,f,g),Db(d,a,f,g),b,h,a))});B&&jb(h,this);return h}c.prototype=Ia;return c},set:function(a){m(this,"then",a&&a.prototype===Ia?bb:{get:function(){return a},set:bb.set})}};k(M.prototype,{then:bb,_then:function(a,b){gb(this,new cb(null,null,a,b,K))},"catch":function(a){if(arguments.length===1)return this.then(null,a);var b=arguments[0],c=arguments[1];return typeof b==="function"?this.then(null,function(a){return a instanceof b?c(a):rb(a)}):this.then(null,function(a){return a&&a.name===b?c(a):rb(a)})},"finally":function(a){return this.then(function(b){a();return b},function(b){a();return rb(b)})},stack:{get:function(){if(this._stack)return this._stack;try{Sa=!0;var a=ib(this,[],Ka);a=a.join("\nFrom previous: ");this._state!==null&&(this._stack=a);return a}finally{Sa=!1}}},timeout:function(a,b){var c=this;return a<Infinity?new M(function(d,e){var f=setTimeout(function(){return e(new F.Timeout(b))},a);c.then(d,e)["finally"](clearTimeout.bind(null,f))}):this}});typeof Symbol!=="undefined"&&Symbol.toStringTag&&m(M.prototype,Symbol.toStringTag,"Dexie.Promise");J.env=Ab();function cb(a,b,c,d,e){this.onFulfilled=typeof a==="function"?a:null,this.onRejected=typeof b==="function"?b:null,this.resolve=c,this.reject=d,this.psd=e}k(M,{all:function(){var a=A.apply(null,arguments).map(xb);return new M(function(b,c){a.length===0&&b([]);var d=a.length;a.forEach(function(e,f){return M.resolve(e).then(function(c){a[f]=c,--d||b(a)},c)})})},resolve:function(a){if(a instanceof M)return a;if(a&&typeof a.then==="function")return new M(function(b,c){a.then(b,c)});var b=new M(Ia,!0,a);jb(b,Ya);return b},reject:rb,race:function(){var a=A.apply(null,arguments).map(xb);return new M(function(b,c){a.map(function(a){return M.resolve(a).then(b,c)})})},PSD:{get:function(){return K},set:function(a){return K=a}},totalEchoes:{get:function(){return vb}},newPSD:P,usePSD:Bb,scheduler:{get:function(){return Ua},set:function(a){Ua=a}},rejectionMapper:{get:function(){return Za},set:function(a){Za=a}},follow:function(a,b){return new M(function(c,d){return P(function(b,c){var d=K;d.unhandleds=[];d.onunhandled=c;d.finalize=H(function(){var a=this;ob(function(){a.unhandleds.length===0?b():c(a.unhandleds[0])})},d.finalize);a()},b,c,d)})}});Qa&&(Qa.allSettled&&m(M,"allSettled",function(){var a=A.apply(null,arguments).map(xb);return new M(function(b){a.length===0&&b([]);var c=a.length,d=new Array(c);a.forEach(function(a,e){return M.resolve(a).then(function(a){return d[e]={status:"fulfilled",value:a}},function(a){return d[e]={status:"rejected",reason:a}}).then(function(){return--c||b(d)})})})}),Qa.any&&typeof AggregateError!=="undefined"&&m(M,"any",function(){var a=A.apply(null,arguments).map(xb);return new M(function(b,c){a.length===0&&c(new AggregateError([]));var d=a.length,e=new Array(d);a.forEach(function(a,f){return M.resolve(a).then(function(a){return b(a)},function(a){e[f]=a,--d||c(new AggregateError(e))})})})}));function db(a,b){try{b(function(b){if(a._state!==null)return;if(b===a)throw new TypeError("A promise cannot be resolved with itself.");var c=a._lib&&lb();b&&typeof b.then==="function"?db(a,function(a,c){b instanceof M?b._then(a,c):b.then(a,c)}):(a._state=!0,a._value=b,fb(a));c&&mb()},eb.bind(null,a))}catch(b){eb(a,b)}}function eb(a,b){Xa.push(b);if(a._state!==null)return;var c=a._lib&&lb();b=Za(b);a._state=!1;a._value=b;B&&b!==null&&typeof b==="object"&&!b._promise&&ba(function(){var c=p(b,"stack");b._promise=a;m(b,"stack",{get:function(){return Sa?c&&(c.get?c.get.apply(b):c.value):a.stack}})});pb(a);fb(a);c&&mb()}function fb(a){var b=a._listeners;a._listeners=[];for(var c=0,d=b.length;c<d;++c)gb(a,b[c]);c=a._PSD;--c.ref||c.finalize();L===0&&(++L,Ua(function(){--L===0&&nb()},[]))}function gb(a,b){if(a._state===null){a._listeners.push(b);return}var c=a._state?b.onFulfilled:b.onRejected;if(c===null)return(a._state?b.resolve:b.reject)(a._value);++b.psd.ref;++L;Ua(hb,[c,a,b])}function hb(a,b,c){try{Ya=b;var d,e=b._value;b._state?d=a(e):(Xa.length&&(Xa=[]),d=a(e),Xa.indexOf(e)===-1&&qb(b));c.resolve(d)}catch(a){c.reject(a)}finally{Ya=null,--L===0&&nb(),--c.psd.ref||c.psd.finalize()}}function ib(a,b,c){if(b.length===c)return b;var d="";if(a._state===!1){var e=a._value,f,g;e!=null?(f=e.name||"Error",g=e.message||e,d=sa(e,0)):(f=e,g="");b.push(f+(g?": "+g:"")+d)}B&&(d=sa(a._stackHolder,2),d&&b.indexOf(d)===-1&&b.push(d),a._prev&&ib(a._prev,b,c));return b}function jb(a,b){var c=b?b._numPrev+1:0;c<Ja&&(a._prev=b,a._numPrev=c)}function kb(){lb()&&mb()}function lb(){var a=Va;Va=!1;Wa=!1;return a}function mb(){var a,b,c;do while($a.length>0){a=$a;$a=[];c=a.length;for(b=0;b<c;++b){var d=a[b];d[0].apply(null,d[1])}}while($a.length>0);Va=!0;Wa=!0}function nb(){var a=I;I=[];a.forEach(function(a){a._PSD.onunhandled.call(null,a._value,a)});a=ab.slice(0);var b=a.length;while(b)a[--b]()}function ob(a){function b(){a(),ab.splice(ab.indexOf(b),1)}ab.push(b);++L;Ua(function(){--L===0&&nb()},[])}function pb(a){I.some(function(b){return b._value===a._value})||I.push(a)}function qb(a){var b=I.length;while(b)if(I[--b]._value===a._value){I.splice(b,1);return}}function rb(a){return new M(Ia,!1,a)}function N(a,b){var c=K;return function(){var d=lb(),e=K;try{S(c,!0);return a.apply(this,arguments)}catch(a){b&&b(a)}finally{S(e,!1),d&&mb()}}}var O={awaits:0,echoes:0,id:0},sb=0,tb=[],ub=0,vb=0,wb=0;function P(a,b,c,d){var e=K,f=Object.create(e);f.parent=e;f.ref=0;f.global=!1;f.id=++wb;var h=J.env;f.env=Ra?{Promise:M,PromiseProp:{value:M,configurable:!0,writable:!0},all:M.all,race:M.race,allSettled:M.allSettled,any:M.any,resolve:M.resolve,reject:M.reject,nthen:Eb(h.nthen,f),gthen:Eb(h.gthen,f)}:{};b&&g(f,b);++e.ref;f.finalize=function(){--this.parent.ref||this.parent.finalize()};h=Bb(f,a,c,d);f.ref===0&&f.finalize();return h}function Q(){O.id||(O.id=++sb);++O.awaits;O.echoes+=La;return O.id}function R(){if(!O.awaits)return!1;--O.awaits===0&&(O.id=0);O.echoes=O.awaits*La;return!0}(""+Pa).indexOf("[native code]")===-1&&(Q=R=G);function xb(a){if(O.echoes&&a&&a.constructor===Qa){Q();return a.then(function(a){R();return a},function(a){R();return T(a)})}return a}function yb(a){++vb,(!O.echoes||--O.echoes===0)&&(O.echoes=O.id=0),tb.push(K),S(a,!0)}function zb(){var a=tb[tb.length-1];tb.pop();S(a,!1)}function S(a,b){var c=K;(b?O.echoes&&(!ub++||a!==K):ub&&(!--ub||a!==K))&&Cb(b?yb.bind(null,a):zb);if(a===K)return;K=a;c===J&&(J.env=Ab());if(Ra){b=J.env.Promise;var d=a.env;Na.then=d.nthen;b.prototype.then=d.gthen;(c.global||a.global)&&(Object.defineProperty(f,"Promise",d.PromiseProp),b.all=d.all,b.race=d.race,b.resolve=d.resolve,b.reject=d.reject,d.allSettled&&(b.allSettled=d.allSettled),d.any&&(b.any=d.any))}}function Ab(){var a=f.Promise;return Ra?{Promise:a,PromiseProp:Object.getOwnPropertyDescriptor(f,"Promise"),all:a.all,race:a.race,allSettled:a.allSettled,any:a.any,resolve:a.resolve,reject:a.reject,nthen:Na.then,gthen:a.prototype.then}:{}}function Bb(a,b,c,d,e){var f=K;try{S(a,!0);return b(c,d,e)}finally{S(f,!1)}}function Cb(a){Pa.call(Ma,a)}function Db(a,b,c,d){return typeof a!=="function"?a:function(){var e=K;c&&Q();S(b,!0);try{return a.apply(this,arguments)}finally{S(e,!1),d&&Cb(R)}}}function Eb(a,b){return function(c,d){return a.call(this,Db(c,b),Db(d,b))}}var Fb="unhandledrejection";function Gb(a,b){var c;try{c=b.onuncatched(a)}catch(a){}if(c!==!1)try{var d;b={promise:b,reason:a};f.document&&document.createEvent?(d=document.createEvent("Event"),d.initEvent(Fb,!0,!0),g(d,b)):f.CustomEvent&&(d=new CustomEvent(Fb,{detail:b}),g(d,b));if(d&&f.dispatchEvent){dispatchEvent(d);if(!f.PromiseRejectionEvent&&f.onunhandledrejection)try{f.onunhandledrejection(d)}catch(a){}}B&&d&&!d.defaultPrevented}catch(a){}}var T=M.reject;function Hb(a,b,c,d){if(!a._state.openComplete&&!K.letThrough){if(!a._state.isBeingOpened){if(!a._options.autoOpen)return T(new F.DatabaseClosed());a.open()["catch"](G)}return a._state.dbReadyPromise.then(function(){return Hb(a,b,c,d)})}else{var e=a._createTransaction(b,c,a._dbSchema);try{e.create()}catch(a){return T(a)}return e._promise(b,function(a,b){return P(function(){K.trans=e;return d(a,b,e)})}).then(function(a){return e._completion.then(function(){return a})})}}x="3.1.0-alpha.4";var Ib=String.fromCharCode(65535),Jb=-Infinity,U="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Kb="String expected.",Lb=[],Mb=typeof navigator!=="undefined"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Nb=Mb,Ob=Mb,Pb=function(a){return!/(dexie\.js|dexie\.min\.js)/.test(a)},Qb="__dbnames",Rb="readonly",Sb="readwrite";function V(a,b){return a?b?function(){return a.apply(this,arguments)&&b.apply(this,arguments)}:a:b}var Tb={type:3,lower:-Infinity,lowerOpen:!1,upper:[[]],upperOpen:!1};function Ub(a){return function(b){v(b,a)===void 0&&(b=y(b),ca(b,a));return b}}var Vb=function(){function a(){}a.prototype._trans=function(a,b,c){var d=this._tx||K.trans,e=this.name;function f(c,d,a){if(!a.schema[e])throw new F.NotFound("Table "+e+" not part of transaction");return b(a.idbtrans,a)}var g=lb();try{return d&&d.db===this.db?d===K.trans?d._promise(a,f,c):P(function(){return d._promise(a,f,c)},{trans:d,transless:K.transless||K}):Hb(this.db,a,[this.name],f)}finally{g&&mb()}};a.prototype.get=function(a,b){var c=this;return a&&a.constructor===Object?this.where(a).first(b):this._trans("readonly",function(b){return c.core.get({trans:b,key:a}).then(function(a){return c.hook.reading.fire(a)})}).then(b)};a.prototype.where=function(a){if(typeof a==="string")return new this.db.WhereClause(this,a);if(e(a))return new this.db.WhereClause(this,"["+a.join("+")+"]");var b=d(a);if(b.length===1)return this.where(b[0]).equals(a[b[0]]);var c=this.schema.indexes.concat(this.schema.primKey).filter(function(a){return a.compound&&b.every(function(b){return a.keyPath.indexOf(b)>=0})&&a.keyPath.every(function(a){return b.indexOf(a)>=0})})[0];if(c&&this.db._maxKey!==Ib)return this.where(c.name).equals(c.keyPath.map(function(b){return a[b]}));!c&&B&&!1;var f=this.schema.idxByName,g=this.db._deps.indexedDB;function h(a,b){try{return g.cmp(a,b)===0}catch(a){return!1}}var i=b.reduce(function(b,c){var d=b[0];b=b[1];var g=f[c],i=a[c];return[d||g,d||!g?V(b,g&&g.multi?function(a){a=v(a,c);return e(a)&&a.some(function(a){return h(i,a)})}:function(a){return h(i,v(a,c))}):b]},[null,null]),j=i[0];i=i[1];return j?this.where(j.name).equals(a[j.keyPath]).filter(i):c?this.filter(i):this.where(b).equals("")};a.prototype.filter=function(a){return this.toCollection().and(a)};a.prototype.count=function(a){return this.toCollection().count(a)};a.prototype.offset=function(a){return this.toCollection().offset(a)};a.prototype.limit=function(a){return this.toCollection().limit(a)};a.prototype.each=function(a){return this.toCollection().each(a)};a.prototype.toArray=function(a){return this.toCollection().toArray(a)};a.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))};a.prototype.orderBy=function(a){return new this.db.Collection(new this.db.WhereClause(this,e(a)?"["+a.join("+")+"]":a))};a.prototype.reverse=function(){return this.toCollection().reverse()};a.prototype.mapToClass=function(a){this.schema.mappedClass=a;var b=function(b){if(!b)return b;var c=Object.create(a.prototype);for(var d in b)if(j(b,d))try{c[d]=b[d]}catch(a){}return c};this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook);this.schema.readHook=b;this.hook("reading",b);return a};a.prototype.defineClass=function(){function a(a){g(this,a)}return this.mapToClass(a)};a.prototype.add=function(a,b){var c=this,d=this.schema.primKey,e=d.auto,f=d.keyPath,g=a;f&&e&&(g=Ub(f)(a));return this._trans("readwrite",function(a){return c.core.mutate({trans:a,type:"add",keys:b!=null?[b]:null,values:[g]})}).then(function(a){return a.numFailures?M.reject(a.failures[0]):a.lastResult}).then(function(b){if(f)try{w(a,f,b)}catch(a){}return b})};a.prototype.update=function(a,b){if(typeof b!=="object"||e(b))throw new F.InvalidArgument("Modifications must be an object.");if(typeof a==="object"&&!e(a)){d(b).forEach(function(c){w(a,c,b[c])});var c=v(a,this.schema.primKey.keyPath);return c===void 0?T(new F.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(c).modify(b)}else return this.where(":id").equals(a).modify(b)};a.prototype.put=function(a,b){var c=this,d=this.schema.primKey,e=d.auto,f=d.keyPath,g=a;f&&e&&(g=Ub(f)(a));return this._trans("readwrite",function(a){return c.core.mutate({trans:a,type:"put",values:[g],keys:b!=null?[b]:null})}).then(function(a){return a.numFailures?M.reject(a.failures[0]):a.lastResult}).then(function(b){if(f)try{w(a,f,b)}catch(a){}return b})};a.prototype["delete"]=function(a){var b=this;return this._trans("readwrite",function(c){return b.core.mutate({trans:c,type:"delete",keys:[a]})}).then(function(a){return a.numFailures?M.reject(a.failures[0]):void 0})};a.prototype.clear=function(){var a=this;return this._trans("readwrite",function(b){return a.core.mutate({trans:b,type:"deleteRange",range:Tb})}).then(function(a){return a.numFailures?M.reject(a.failures[0]):void 0})};a.prototype.bulkGet=function(a){var b=this;return this._trans("readonly",function(c){return b.core.getMany({keys:a,trans:c}).then(function(a){return a.map(function(a){return b.hook.reading.fire(a)})})})};a.prototype.bulkAdd=function(a,b,c){var d=this,e=Array.isArray(b)?b:void 0;c=c||(e?void 0:b);var f=c?c.allKeys:void 0;return this._trans("readwrite",function(b){var c=d.schema.primKey,g=c.auto;c=c.keyPath;if(c&&e)throw new F.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(e&&e.length!==a.length)throw new F.InvalidArgument("Arguments objects and keys must have the same length");var h=a.length;g=c&&g?a.map(Ub(c)):a;return d.core.mutate({trans:b,type:"add",keys:e,values:g,wantResults:f}).then(function(a){var b=a.numFailures,c=a.results,e=a.lastResult,g=a.failures;a=f?c:e;if(b===0)return a;throw new wa(d.name+".bulkAdd(): "+b+" of "+h+" operations failed",Object.keys(g).map(function(a){return g[a]}))})})};a.prototype.bulkPut=function(a,b,c){var d=this,e=Array.isArray(b)?b:void 0;c=c||(e?void 0:b);var f=c?c.allKeys:void 0;return this._trans("readwrite",function(b){var c=d.schema.primKey,g=c.auto;c=c.keyPath;if(c&&e)throw new F.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(e&&e.length!==a.length)throw new F.InvalidArgument("Arguments objects and keys must have the same length");var h=a.length;g=c&&g?a.map(Ub(c)):a;return d.core.mutate({trans:b,type:"put",keys:e,values:g,wantResults:f}).then(function(a){var b=a.numFailures,c=a.results,e=a.lastResult,g=a.failures;a=f?c:e;if(b===0)return a;throw new wa(d.name+".bulkPut(): "+b+" of "+h+" operations failed",Object.keys(g).map(function(a){return g[a]}))})})};a.prototype.bulkDelete=function(a){var b=this,c=a.length;return this._trans("readwrite",function(c){return b.core.mutate({trans:c,type:"delete",keys:a})}).then(function(a){var d=a.numFailures,e=a.lastResult;a=a.failures;if(d===0)return e;throw new wa(b.name+".bulkDelete(): "+d+" of "+c+" operations failed",a)})};return a}();function Wb(a){var b={},c=function(d,e){if(e){var c=arguments.length,f=new Array(c-1);while(--c)f[c-1]=arguments[c];b[d].subscribe.apply(null,f);return a}else if(typeof d==="string")return b[d]};c.addEventType=h;for(var f=1,g=arguments.length;f<g;++f)h(arguments[f]);return c;function h(a,d,e){if(typeof a==="object")return i(a);d||(d=Ga);e||(e=G);var f={subscribers:[],fire:e,subscribe:function(a){f.subscribers.indexOf(a)===-1&&(f.subscribers.push(a),f.fire=d(f.fire,a))},unsubscribe:function(a){f.subscribers=f.subscribers.filter(function(b){return b!==a}),f.fire=f.subscribers.reduce(d,e)}};b[a]=c[a]=f;return f}function i(a){d(a).forEach(function(b){var c=a[b];if(e(c))h(b,a[b][0],a[b][1]);else if(c==="asap")var d=h(b,Ba,function(){var a=arguments.length,b=new Array(a);while(a--)b[a]=arguments[a];d.subscribers.forEach(function(a){aa(function(){a.apply(null,b)})})});else throw new F.InvalidArgument("Invalid event config")})}}function Xb(a,b){n(b).from({prototype:a});return b}function Yb(a){return Xb(Vb.prototype,function(b,c,d){this.db=a,this._tx=d,this.name=b,this.schema=c,this.hook=a._allTables[b]?a._allTables[b].hook:Wb(null,{creating:[Da,G],reading:[Ca,Ba],updating:[Fa,G],deleting:[Ea,G]})})}function Zb(a,b){return!(a.filter||a.algorithm||a.or)&&(b?a.justLimit:!a.replayFilter)}function $b(a,b){a.filter=V(a.filter,b)}function ac(a,b,c){var d=a.replayFilter;a.replayFilter=d?function(){return V(d(),b())}:b;a.justLimit=c&&!d}function bc(a,b){a.isMatch=V(a.isMatch,b)}function cc(a,b){if(a.isPrimKey)return b.primaryKey;var c=b.getIndexByKeyPath(a.index);if(!c)throw new F.Schema("KeyPath "+a.index+" on object store "+b.name+" is not indexed");return c}function dc(a,b,c){var d=cc(a,b.schema);return b.openCursor({trans:c,values:!a.keysOnly,reverse:a.dir==="prev",unique:!!a.unique,query:{index:d,range:a.range}})}function ec(a,b,c,d){var e=a.replayFilter?V(a.filter,a.replayFilter()):a.filter;if(!a.or)return fc(dc(a,d,c),V(a.algorithm,e),b,!a.keysOnly&&a.valueMapper);else{var f={},g=function(a,c,d){if(!e||e(c,d,function(a){return c.stop(a)},function(a){return c.fail(a)})){var g=c.primaryKey,h=""+g;h==="[object ArrayBuffer]"&&(h=""+new Uint8Array(g));j(f,h)||(f[h]=!0,b(a,c,d))}};return Promise.all([a.or._iterate(g,c),fc(dc(a,d,c),a.algorithm,g,!a.keysOnly&&a.valueMapper)])}}function fc(a,b,c,d){var e=d?function(a,b,e){return c(d(a),b,e)}:c,f=N(e);return a.then(function(a){if(a)return a.start(function(){var c=function(){return a["continue"]()};(!b||b(a,function(a){return c=a},function(b){a.stop(b),c=G},function(b){a.fail(b),c=G}))&&f(a.value,a,function(a){return c=a});c()})})}var gc=function(){function a(){}a.prototype._read=function(a,b){var c=this._ctx;return c.error?c.table._trans(null,T.bind(null,c.error)):c.table._trans("readonly",a).then(b)};a.prototype._write=function(a){var b=this._ctx;return b.error?b.table._trans(null,T.bind(null,b.error)):b.table._trans("readwrite",a,"locked")};a.prototype._addAlgorithm=function(a){var b=this._ctx;b.algorithm=V(b.algorithm,a)};a.prototype._iterate=function(a,b){return ec(this._ctx,a,b,this._ctx.table.core)};a.prototype.clone=function(a){var b=Object.create(this.constructor.prototype),c=Object.create(this._ctx);a&&g(c,a);b._ctx=c;return b};a.prototype.raw=function(){this._ctx.valueMapper=null;return this};a.prototype.each=function(a){var b=this._ctx;return this._read(function(c){return ec(b,a,c,b.table.core)})};a.prototype.count=function(a){var b=this;return this._read(function(a){var c=b._ctx,d=c.table.core;if(Zb(c,!0))return d.count({trans:a,query:{index:cc(c,d.schema),range:c.range}}).then(function(a){return Math.min(a,c.limit)});else{var e=0;return ec(c,function(){++e;return!1},a,d).then(function(){return e})}}).then(a)};a.prototype.sortBy=function(a,b){var c=a.split(".").reverse(),d=c[0],e=c.length-1;function f(a,b){return b?f(a[c[b]],b-1):a[d]}var g=this._ctx.dir==="next"?1:-1;function h(a,b){a=f(a,e);b=f(b,e);return a<b?-g:a>b?g:0}return this.toArray(function(a){return a.sort(h)}).then(b)};a.prototype.toArray=function(a){var b=this;return this._read(function(a){var c=b._ctx;if(c.dir==="next"&&Zb(c,!0)&&c.limit>0){var d=c.valueMapper,e=cc(c,c.table.core.schema);return c.table.core.query({trans:a,limit:c.limit,values:!0,query:{index:e,range:c.range}}).then(function(a){a=a.result;return d?a.map(d):a})}else{var f=[];return ec(c,function(a){return f.push(a)},a,c.table.core).then(function(){return f})}},a)};a.prototype.offset=function(a){var b=this._ctx;if(a<=0)return this;b.offset+=a;Zb(b)?ac(b,function(){var b=a;return function(a,c){if(b===0)return!0;if(b===1){--b;return!1}c(function(){a.advance(b),b=0});return!1}}):ac(b,function(){var b=a;return function(){return--b<0}});return this};a.prototype.limit=function(a){this._ctx.limit=Math.min(this._ctx.limit,a);ac(this._ctx,function(){var b=a;return function(a,c,d){--b<=0&&c(d);return b>=0}},!0);return this};a.prototype.until=function(a,b){$b(this._ctx,function(c,d,e){if(a(c.value)){d(e);return b}else return!0});return this};a.prototype.first=function(a){return this.limit(1).toArray(function(a){return a[0]}).then(a)};a.prototype.last=function(a){return this.reverse().first(a)};a.prototype.filter=function(a){$b(this._ctx,function(b){return a(b.value)});bc(this._ctx,a);return this};a.prototype.and=function(a){return this.filter(a)};a.prototype.or=function(a){return new this.db.WhereClause(this._ctx.table,a,this)};a.prototype.reverse=function(){this._ctx.dir=this._ctx.dir==="prev"?"next":"prev";this._ondirectionchange&&this._ondirectionchange(this._ctx.dir);return this};a.prototype.desc=function(){return this.reverse()};a.prototype.eachKey=function(a){var b=this._ctx;b.keysOnly=!b.isMatch;return this.each(function(b,c){a(c.key,c)})};a.prototype.eachUniqueKey=function(a){this._ctx.unique="unique";return this.eachKey(a)};a.prototype.eachPrimaryKey=function(a){var b=this._ctx;b.keysOnly=!b.isMatch;return this.each(function(b,c){a(c.primaryKey,c)})};a.prototype.keys=function(a){var b=this._ctx;b.keysOnly=!b.isMatch;var c=[];return this.each(function(a,b){c.push(b.key)}).then(function(){return c}).then(a)};a.prototype.primaryKeys=function(a){var b=this._ctx;if(b.dir==="next"&&Zb(b,!0)&&b.limit>0)return this._read(function(a){var c=cc(b,b.table.core.schema);return b.table.core.query({trans:a,values:!1,limit:b.limit,query:{index:c,range:b.range}})}).then(function(a){a=a.result;return a}).then(a);b.keysOnly=!b.isMatch;var c=[];return this.each(function(a,b){c.push(b.primaryKey)}).then(function(){return c}).then(a)};a.prototype.uniqueKeys=function(a){this._ctx.unique="unique";return this.keys(a)};a.prototype.firstKey=function(a){return this.limit(1).keys(function(a){return a[0]}).then(a)};a.prototype.lastKey=function(a){return this.reverse().firstKey(a)};a.prototype.distinct=function(){var a=this._ctx;a=a.index&&a.table.schema.idxByName[a.index];if(!a||!a.multi)return this;var b={};$b(this._ctx,function(a){a=a.primaryKey.toString();var c=j(b,a);b[a]=!0;return!c});return this};a.prototype.modify=function(a){var b=this,c=this._ctx;return this._write(function(e){var f;if(typeof a==="function")f=a;else{var g=d(a),h=g.length;f=function(b){var c=!1;for(var d=0;d<h;++d){var e=g[d],f=a[e];v(b,e)!==f&&(w(b,e,f),c=!0)}return c}}var i=c.table.core,j=i.schema.primaryKey,k=j.outbound,l=j.extractKey,m=b.db._options.modifyChunkSize||2e3,n=b.db.core.cmp,o=[],p=0,q=[],r=function(a,b){var c=b.failures;b=b.numFailures;p+=a-b;for(var a=0,b=d(c);a<b.length;a++){var e=b[a];o.push(c[e])}};return b.clone().primaryKeys().then(function(a){var b=function(c){var d=Math.min(m,a.length-c);return i.getMany({trans:e,keys:a.slice(c,c+d)}).then(function(g){var h=[],j=[],o=k?[]:null,p=[];for(var q=0;q<d;++q){var s=g[q],t={value:y(s),primKey:a[c+q]};f.call(t,t.value,t)!==!1&&(t.value==null?p.push(a[c+q]):!k&&n(l(s),l(t.value))!==0?(p.push(a[c+q]),h.push(t.value)):(j.push(t.value),k&&o.push(a[c+q])))}return Promise.resolve(h.length>0&&i.mutate({trans:e,type:"add",values:h}).then(function(a){for(var b in a.failures)p.splice(parseInt(b),1);r(h.length,a)})).then(function(a){return j.length>0&&i.mutate({trans:e,type:"put",keys:o,values:j}).then(function(a){return r(j.length,a)})}).then(function(){return p.length>0&&i.mutate({trans:e,type:"delete",keys:p}).then(function(a){return r(p.length,a)})}).then(function(){return a.length>c+d&&b(c+m)})})};return b(0).then(function(){if(o.length>0)throw new va("Error modifying one or more objects",o,p,q);return a.length})})})};a.prototype["delete"]=function(){var a=this._ctx,b=a.range;return Zb(a)&&(a.isPrimKey&&!Ob||b.type===3)?this._write(function(c){var d=a.table.core.schema.primaryKey,e=b;return a.table.core.count({trans:c,query:{index:d,range:e}}).then(function(b){return a.table.core.mutate({trans:c,type:"deleteRange",range:e}).then(function(a){var c=a.failures;a.lastResult;a.results;a=a.numFailures;if(a)throw new va("Could not delete some values",Object.keys(c).map(function(a){return c[a]}),b-a);return b-a})})}):this.modify(function(b,a){return a.value=null})};return a}();function hc(a){return Xb(gc.prototype,function(b,c){this.db=a;var d=Tb,e=null;if(c)try{d=c()}catch(a){e=a}c=b._ctx;b=c.table;var f=b.hook.reading.fire;this._ctx={table:b,index:c.index,isPrimKey:!c.index||b.schema.primKey.keyPath&&c.index===b.schema.primKey.name,range:d,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:Infinity,error:e,or:c.or,valueMapper:f!==Ba?f:null}})}function ic(a,b){return a<b?-1:a===b?0:1}function jc(a,b){return a>b?-1:a===b?0:1}function W(a,b,c){a=a instanceof qc?new a.Collection(a):a;a._ctx.error=c?new c(b):new TypeError(b);return a}function kc(a){return new a.Collection(a,function(){return pc("")}).limit(0)}function lc(a){return a==="next"?function(a){return a.toUpperCase()}:function(a){return a.toLowerCase()}}function mc(a){return a==="next"?function(a){return a.toLowerCase()}:function(a){return a.toUpperCase()}}function nc(a,b,c,d,e,f){var g=Math.min(a.length,d.length),h=-1;for(var i=0;i<g;++i){var j=b[i];if(j!==d[i]){if(e(a[i],c[i])<0)return a.substr(0,i)+c[i]+c.substr(i+1);if(e(a[i],d[i])<0)return a.substr(0,i)+d[i]+c.substr(i+1);return h>=0?a.substr(0,h)+b[h]+c.substr(h+1):null}e(a[i],j)<0&&(h=i)}if(g<d.length&&f==="next")return a+c.substr(a.length);return g<a.length&&f==="prev"?a.substr(0,c.length):h<0?null:a.substr(0,h)+d[h]+c.substr(h+1)}function oc(a,b,c,d){var e,f,g,h,i,j,k,l=c.length;if(!c.every(function(a){return typeof a==="string"}))return W(a,Kb);function m(a){e=lc(a);f=mc(a);g=a==="next"?ic:jc;var b=c.map(function(a){return{lower:f(a),upper:e(a)}}).sort(function(a,b){return g(a.lower,b.lower)});h=b.map(function(a){return a.upper});i=b.map(function(a){return a.lower});j=a;k=a==="next"?"":d}m("next");a=new a.Collection(a,function(){return X(h[0],i[l-1]+d)});a._ondirectionchange=function(a){m(a)};var n=0;a._addAlgorithm(function(a,c,d){var e=a.key;if(typeof e!=="string")return!1;var m=f(e);if(b(m,i,n))return!0;else{var o=null;for(var p=n;p<l;++p){var q=nc(e,m,h[p],i[p],g,j);q===null&&o===null?n=p+1:(o===null||g(o,q)>0)&&(o=q)}o!==null?c(function(){a["continue"](o+k)}):c(d);return!1}});return a}function X(a,b,c,d){return{type:2,lower:a,upper:b,lowerOpen:c,upperOpen:d}}function pc(a){return{type:1,lower:a,upper:a}}var qc=function(){function a(){}Object.defineProperty(a.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!0,configurable:!0});a.prototype.between=function(a,b,c,d){c=c!==!1;d=d===!0;try{return this._cmp(a,b)>0||this._cmp(a,b)===0&&(c||d)&&!(c&&d)?kc(this):new this.Collection(this,function(){return X(a,b,!c,!d)})}catch(a){return W(this,U)}};a.prototype.equals=function(a){return a==null?W(this,U):new this.Collection(this,function(){return pc(a)})};a.prototype.above=function(a){return a==null?W(this,U):new this.Collection(this,function(){return X(a,void 0,!0)})};a.prototype.aboveOrEqual=function(a){return a==null?W(this,U):new this.Collection(this,function(){return X(a,void 0,!1)})};a.prototype.below=function(a){return a==null?W(this,U):new this.Collection(this,function(){return X(void 0,a,!1,!0)})};a.prototype.belowOrEqual=function(a){return a==null?W(this,U):new this.Collection(this,function(){return X(void 0,a)})};a.prototype.startsWith=function(a){return typeof a!=="string"?W(this,Kb):this.between(a,a+Ib,!0,!0)};a.prototype.startsWithIgnoreCase=function(a){return a===""?this.startsWith(a):oc(this,function(a,b){return a.indexOf(b[0])===0},[a],Ib)};a.prototype.equalsIgnoreCase=function(a){return oc(this,function(a,b){return a===b[0]},[a],"")};a.prototype.anyOfIgnoreCase=function(){var a=A.apply(z,arguments);return a.length===0?kc(this):oc(this,function(a,b){return b.indexOf(a)!==-1},a,"")};a.prototype.startsWithAnyOfIgnoreCase=function(){var a=A.apply(z,arguments);return a.length===0?kc(this):oc(this,function(a,b){return b.some(function(b){return a.indexOf(b)===0})},a,Ib)};a.prototype.anyOf=function(){var a=this,b=A.apply(z,arguments),c=this._cmp;try{b.sort(c)}catch(a){return W(this,U)}if(b.length===0)return kc(this);var d=new this.Collection(this,function(){return X(b[0],b[b.length-1])});d._ondirectionchange=function(d){c=d==="next"?a._ascending:a._descending,b.sort(c)};var e=0;d._addAlgorithm(function(a,d,f){var g=a.key;while(c(g,b[e])>0){++e;if(e===b.length){d(f);return!1}}if(c(g,b[e])===0)return!0;else{d(function(){a["continue"](b[e])});return!1}});return d};a.prototype.notEqual=function(a){return this.inAnyRange([[Jb,a],[a,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})};a.prototype.noneOf=function(){var a=A.apply(z,arguments);if(a.length===0)return new this.Collection(this);try{a.sort(this._ascending)}catch(a){return W(this,U)}var b=a.reduce(function(a,b){return a?a.concat([[a[a.length-1][1],b]]):[[Jb,b]]},null);b.push([a[a.length-1],this.db._maxKey]);return this.inAnyRange(b,{includeLowers:!1,includeUppers:!1})};a.prototype.inAnyRange=function(a,b){var c=this,d=this._cmp,e=this._ascending,f=this._descending,g=this._min,h=this._max;if(a.length===0)return kc(this);if(!a.every(function(a){return a[0]!==void 0&&a[1]!==void 0&&e(a[0],a[1])<=0}))return W(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",F.InvalidArgument);var i=!b||b.includeLowers!==!1,j=b&&b.includeUppers===!0;function k(a,b){var c=0,e=a.length;for(;c<e;++c){var f=a[c];if(d(b[0],f[1])<0&&d(b[1],f[0])>0){f[0]=g(f[0],b[0]);f[1]=h(f[1],b[1]);break}}c===e&&a.push(b);return a}var l=e;function m(a,b){return l(a[0],b[0])}var n;try{n=a.reduce(k,[]),n.sort(m)}catch(a){return W(this,U)}var o=0,p=j?function(a){return e(a,n[o][1])>0}:function(a){return e(a,n[o][1])>=0},q=i?function(a){return f(a,n[o][0])>0}:function(a){return f(a,n[o][0])>=0};function r(a){return!p(a)&&!q(a)}var s=p;b=new this.Collection(this,function(){return X(n[0][0],n[n.length-1][1],!i,!j)});b._ondirectionchange=function(a){a==="next"?(s=p,l=e):(s=q,l=f),n.sort(m)};b._addAlgorithm(function(a,b,d){var f=a.key;while(s(f)){++o;if(o===n.length){b(d);return!1}}if(r(f))return!0;else if(c._cmp(f,n[o][1])===0||c._cmp(f,n[o][0])===0)return!1;else{b(function(){l===e?a["continue"](n[o][0]):a["continue"](n[o][1])});return!1}});return b};a.prototype.startsWithAnyOf=function(){var a=A.apply(z,arguments);if(!a.every(function(a){return typeof a==="string"}))return W(this,"startsWithAnyOf() only works with strings");return a.length===0?kc(this):this.inAnyRange(a.map(function(a){return[a,a+Ib]}))};return a}();function rc(a){return Xb(qc.prototype,function(b,c,d){this.db=a;this._ctx={table:b,index:c===":id"?null:c,or:d};var e=a._deps.indexedDB;if(!e)throw new F.MissingAPI("indexedDB API missing");this._cmp=this._ascending=e.cmp.bind(e);this._descending=function(a,b){return e.cmp(b,a)};this._max=function(a,b){return e.cmp(a,b)>0?a:b};this._min=function(a,b){return e.cmp(a,b)<0?a:b};this._IDBKeyRange=a._deps.IDBKeyRange})}function sc(a){return a.length===1?a[0]:a}function tc(a){try{a.only([[]]);return[[]]}catch(a){return Ib}}function Y(a){return N(function(b){uc(b);a(b.target.error);return!1})}function uc(a){a.stopPropagation&&a.stopPropagation(),a.preventDefault&&a.preventDefault()}var Z=Wb(null,"txcommitted"),vc=function(){function a(){}a.prototype._lock=function(){t(!K.global);++this._reculock;this._reculock===1&&!K.global&&(K.lockOwnerFor=this);return this};a.prototype._unlock=function(){t(!K.global);if(--this._reculock===0){K.global||(K.lockOwnerFor=null);while(this._blockedFuncs.length>0&&!this._locked()){var a=this._blockedFuncs.shift();try{Bb(a[1],a[0])}catch(a){}}}return this};a.prototype._locked=function(){return this._reculock&&K.lockOwnerFor!==this};a.prototype.create=function(a){var b=this;if(!this.mode)return this;var c=this.db.idbdb,d=this.db._state.dbOpenError;t(!this.idbtrans);if(!a&&!c)switch(d&&d.name){case"DatabaseClosedError":throw new F.DatabaseClosed(d);case"MissingAPIError":throw new F.MissingAPI(d.message,d);default:throw new F.OpenFailed(d)}if(!this.active)throw new F.TransactionInactive();t(this._completion._state===null);a=this.idbtrans=a||c.transaction(sc(this.storeNames),this.mode);a.onerror=N(function(c){uc(c),b._reject(a.error)});a.onabort=N(function(c){uc(c),b.active&&b._reject(new F.Abort(a.error)),b.active=!1,b.on("abort").fire(c)});a.oncomplete=N(function(){b.active=!1,b._resolve(),"mutatedParts"in a&&Z.txcommitted.fire(a.mutatedParts)});return this};a.prototype._promise=function(a,b,c){var d=this;if(a==="readwrite"&&this.mode!=="readwrite")return T(new F.ReadOnly("Transaction is readonly"));if(!this.active)return T(new F.TransactionInactive());if(this._locked())return new M(function(e,f){d._blockedFuncs.push([function(){d._promise(a,b,c).then(e,f)},K])});else if(c)return P(function(){var a=new M(function(a,c){d._lock();var e=b(a,c,d);e&&e.then&&e.then(a,c)});a["finally"](function(){return d._unlock()});a._lib=!0;return a});else{var e=new M(function(a,c){var e=b(a,c,d);e&&e.then&&e.then(a,c)});e._lib=!0;return e}};a.prototype._root=function(){return this.parent?this.parent._root():this};a.prototype.waitFor=function(a){var b=this._root(),c=M.resolve(a);if(b._waitingFor)b._waitingFor=b._waitingFor.then(function(){return c});else{b._waitingFor=c;b._waitingQueue=[];var d=b.idbtrans.objectStore(b.storeNames[0]);(function a(){++b._spinCount;while(b._waitingQueue.length)b._waitingQueue.shift()();b._waitingFor&&(d.get(-Infinity).onsuccess=a)})()}var e=b._waitingFor;return new M(function(a,d){c.then(function(c){return b._waitingQueue.push(N(a.bind(null,c)))},function(a){return b._waitingQueue.push(N(d.bind(null,a)))})["finally"](function(){b._waitingFor===e&&(b._waitingFor=null)})})};a.prototype.abort=function(){this.active&&this._reject(new F.Abort()),this.active=!1};a.prototype.table=function(a){var b=this._memoizedTables||(this._memoizedTables={});if(j(b,a))return b[a];var c=this.schema[a];if(!c)throw new F.NotFound("Table "+a+" not part of transaction");c=new this.db.Table(a,c,this);c.core=this.db.core.table(a);b[a]=c;return c};return a}();function wc(a){return Xb(vc.prototype,function(b,c,d,e){var f=this;this.db=a;this.mode=b;this.storeNames=c;this.schema=d;this.idbtrans=null;this.on=Wb(this,"complete","error","abort");this.parent=e||null;this.active=!0;this._reculock=0;this._blockedFuncs=[];this._resolve=null;this._reject=null;this._waitingFor=null;this._waitingQueue=null;this._spinCount=0;this._completion=new M(function(a,b){f._resolve=a,f._reject=b});this._completion.then(function(){f.active=!1,f.on.complete.fire()},function(a){var b=f.active;f.active=!1;f.on.error.fire(a);f.parent?f.parent._reject(a):b&&f.idbtrans&&f.idbtrans.abort();return T(a)})})}function xc(a,b,c,d,e,f,g){return{name:a,keyPath:b,unique:c,multi:d,auto:e,compound:f,src:(c&&!g?"&":"")+(d?"*":"")+(e?"++":"")+yc(b)}}function yc(a){return typeof a==="string"?a:a?"["+[].join.call(a,"+")+"]":""}function zc(a,b,c){return{name:a,primKey:b,indexes:c,mappedClass:null,idxByName:u(c,function(a){return[a.name,a]})}}function Ac(a){if(a==null)return function(){return void 0};else if(typeof a==="string")return Bc(a);else return function(b){return v(b,a)}}function Bc(a){var b=a.split(".");if(b.length===1)return function(b){return b[a]};else return function(b){return v(b,a)}}function Cc(a,b){return b.type==="delete"?b.keys:b.keys||b.values.map(a.extractKey)}function Dc(a,b,c){return b.type==="add"?Promise.resolve(new Array(b.values.length)):a.getMany({trans:b.trans,keys:c})}function Ec(a){return[].slice.call(a)}var Fc=0;function Gc(a){return a==null?":id":typeof a==="string"?a:"["+a.join("+")+"]"}function Hc(a,b,d,f){b=b.cmp.bind(b);function g(a,b){var c=Ec(a.objectStoreNames);return{schema:{name:a.name,tables:c.map(function(a){return b.objectStore(a)}).map(function(a){var b=a.keyPath,c=a.autoIncrement,d=e(b),f=b==null,g={};f={name:a.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:f,compound:d,keyPath:b,autoIncrement:c,unique:!0,extractKey:Ac(b)},indexes:Ec(a.indexNames).map(function(b){return a.index(b)}).map(function(b){var c=b.name,d=b.unique,f=b.multiEntry;b=b.keyPath;var a=e(b);c={name:c,compound:a,keyPath:b,unique:d,multiEntry:f,extractKey:Ac(b)};g[Gc(b)]=c;return c}),getIndexByKeyPath:function(a){return g[Gc(a)]}};g[":id"]=f.primaryKey;b!=null&&(g[Gc(b)]=f.primaryKey);return f})},hasGetAll:c.length>0&&"getAll"in b.objectStore(c[0])&&!(typeof navigator!=="undefined"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function h(a){if(a.type===3)return null;if(a.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var b=a.lower,c=a.upper,e=a.lowerOpen;a=a.upperOpen;b=b===void 0?c===void 0?null:d.upperBound(c,!!a):c===void 0?d.lowerBound(b,!!e):d.bound(b,c,!!e,!!a);return b}function i(b){var d=b.name;function e(a){var e=a.trans,f=a.type,g=a.keys,i=a.values,j=a.range,k=a.wantResults;return new Promise(function(a,l){a=N(a);l=e.objectStore(d);var m=l.keyPath==null,n=f==="put"||f==="add";if(!n&&f!=="delete"&&f!=="deleteRange")throw new Error("Invalid operation type: "+f);var o=(g||i||{length:1}).length;if(g&&i&&g.length!==i.length)throw new Error("Given keys array must have same length as given values array.");if(o===0)return a({numFailures:0,failures:{},results:[],lastResult:void 0});var p=k&&c(g?g:Cc(b.primaryKey,{type:f,keys:g,values:i})),q,r=[],s=0,t=function(a){++s,uc(a),p&&(p[a.target._reqno]=void 0),r[a.target._reqno]=a.target.error},aa=function(a){a=a.target;p[a._reqno]=a.result};if(f==="deleteRange"){if(j.type===4)return a({numFailures:s,failures:r,results:p,lastResult:void 0});j.type===3?q=l.clear():q=l["delete"](h(j))}else{m=n?m?[i,g]:[i,null]:[g,null];var u=m[0];m=m[1];if(n)for(var n=0;n<o;++n)q=m&&m[n]!==void 0?l[f](u[n],m[n]):l[f](u[n]),q._reqno=n,p&&p[n]===void 0&&(q.onsuccess=aa),q.onerror=t;else for(var n=0;n<o;++n)q=l[f](u[n]),q._reqno=n,q.onerror=t}var ba=function(b){b=b.target.result;p&&(p[o-1]=b);a({numFailures:s,failures:r,results:p,lastResult:b})};q.onerror=function(a){t(a),ba(a)};q.onsuccess=ba})}function a(b){var c=b.trans,e=b.values,a=b.query,f=b.reverse,g=b.unique;return new Promise(function(b,i){b=N(b);var j=a.index,k=a.range,l=c.objectStore(d);l=j.isPrimaryKey?l:l.index(j.name);j=f?g?"prevunique":"prev":g?"nextunique":"next";var m=e||!("openKeyCursor"in l)?l.openCursor(h(k),j):l.openKeyCursor(h(k),j);m.onerror=Y(i);m.onsuccess=N(function(a){var d=m.result;if(!d){b(null);return}d.___id=++Fc;d.done=!1;var e=d["continue"].bind(d),f=d.continuePrimaryKey;f&&(f=f.bind(d));var g=d.advance.bind(d);a=function(){throw new Error("Cursor not started")};var h=function(){throw new Error("Cursor not stopped")};d.trans=c;d.stop=d["continue"]=d.continuePrimaryKey=d.advance=a;d.fail=N(i);d.next=function(){var a=this,b=1;return this.start(function(){return b--?a["continue"]():a.stop()}).then(function(){return a})};d.start=function(a){var b=new Promise(function(a,b){a=N(a),m.onerror=Y(b),d.fail=b,d.stop=function(b){d.stop=d["continue"]=d.continuePrimaryKey=d.advance=h,a(b)}}),c=function(){if(m.result)try{a()}catch(a){d.fail(a)}else d.done=!0,d.start=function(){throw new Error("Cursor behind last entry")},d.stop()};m.onsuccess=N(function(a){m.onsuccess=c,c()});d["continue"]=e;d.continuePrimaryKey=f;d.advance=g;c();return b};b(d)},i)})}function f(a){return function(b){return new Promise(function(e,f){e=N(e);var g=b.trans,i=b.values,j=b.limit,c=b.query,k=j===Infinity?void 0:j,l=c.index;c=c.range;g=g.objectStore(d);g=l.isPrimaryKey?g:g.index(l.name);l=h(c);if(j===0)return e({result:[]});if(a){c=i?g.getAll(l,k):g.getAllKeys(l,k);c.onsuccess=function(a){return e({result:a.target.result})};c.onerror=Y(f)}else{var m=0,n=i||!("openKeyCursor"in g)?g.openCursor(l):g.openKeyCursor(l),o=[];n.onsuccess=function(a){a=n.result;if(!a)return e({result:o});o.push(i?a.value:a.primaryKey);if(++m===j)return e({result:o});a["continue"]()};n.onerror=Y(f)}})}}return{name:d,schema:b,mutate:e,getMany:function(a){var b=a.trans,c=a.keys;return new Promise(function(a,e){a=N(a);var f=b.objectStore(d),g=c.length,h=new Array(g),i=0,j=0,k=0,l=function(b){b=b.target;(h[b._pos]=b.result)!=null&&++k;++j===i&&a(h)};e=Y(e);for(var m=0;m<g;++m){var n=c[m];n!=null&&(n=f.get(c[m]),n._pos=m,n.onsuccess=l,n.onerror=e,++i)}i===0&&a(h)})},get:function(a){var b=a.trans,c=a.key;return new Promise(function(a,e){a=N(a);var f=b.objectStore(d);f=f.get(c);f.onsuccess=function(b){return a(b.target.result)};f.onerror=Y(e)})},query:f(j),openCursor:a,count:function(b){var a=b.query,c=b.trans,e=a.index,f=a.range;return new Promise(function(a,b){var g=c.objectStore(d);g=e.isPrimaryKey?g:g.index(e.name);var i=h(f);i=i?g.count(i):g.count();i.onsuccess=N(function(b){return a(b.target.result)});i.onerror=Y(b)})}}}g=g(a,f);f=g.schema;var j=g.hasGetAll;g=f.tables.map(function(a){return i(a)});var k={};g.forEach(function(a){return k[a.name]=a});return{stack:"dbcore",transaction:a.transaction.bind(a),table:function(a){var b=k[a];if(!b)throw new Error("Table '"+a+"' not found");return k[a]},cmp:b,MIN_KEY:-Infinity,MAX_KEY:tc(d),schema:f}}function Ic(a,c){return c.reduce(function(a,c){c=c.create;return b(b({},a),c(a))},a)}function Jc(a,b,c,d){var e=c.IDBKeyRange;c=c.indexedDB;b=Ic(Hc(b,c,e,d),a.dbcore);return{dbcore:b}}function Kc(a,b){var c=b.db;c=Jc(a._middlewares,c,a._deps,b);a.core=c.dbcore;a.tables.forEach(function(b){var c=b.name;a.core.schema.tables.some(function(a){return a.name===c})&&(b.core=a.core.table(c),a[c]instanceof a.Table&&(a[c].core=b.core))})}function Lc(a,b,c,d){c.forEach(function(c){var e=d[c];b.forEach(function(b){var d=p(b,c);(!d||"value"in d&&d.value===void 0)&&(b===a.Transaction.prototype||b instanceof a.Transaction?m(b,c,{get:function(){return this.table(c)},set:function(a){l(this,c,{value:a,writable:!0,configurable:!0,enumerable:!0})}}):b[c]=new a.Table(c,e))})})}function Mc(a,b){b.forEach(function(b){for(var c in b)b[c]instanceof a.Table&&delete b[c]})}function Nc(a,b){return a._cfg.version-b._cfg.version}function Oc(a,b,c,e){var f=a._dbSchema,g=a._createTransaction("readwrite",a._storeNames,f);g.create(c);g._completion["catch"](e);var h=g._reject.bind(g),i=K.transless||K;P(function(){K.trans=g,K.transless=i,b===0?(d(f).forEach(function(a){Rc(c,a,f[a].primKey,f[a].indexes)}),Kc(a,c),M.follow(function(){return a.on.populate.fire(g)})["catch"](h)):Pc(a,b,g,c)["catch"](h)})}function Pc(a,b,c,e){var f=[],g=a._versions,h=a._dbSchema=Vc(a,a.idbdb,e),i=!1;g=g.filter(function(a){return a._cfg.version>=b});g.forEach(function(g){f.push(function(){var f=h,j=g._cfg.dbschema;Yc(a,f,e);Yc(a,j,e);h=a._dbSchema=j;var k=Qc(f,j);k.add.forEach(function(a){Rc(e,a[0],a[1].primKey,a[1].indexes)});k.change.forEach(function(a){if(a.recreate)throw new F.Upgrade("Not yet support for changing primary key");else{var b=e.objectStore(a.name);a.add.forEach(function(a){return Uc(b,a)});a.change.forEach(function(a){b.deleteIndex(a.name),Uc(b,a)});a.del.forEach(function(a){return b.deleteIndex(a)})}});var l=g._cfg.contentUpgrade;if(l&&g._cfg.version>b){Kc(a,e);c._memoizedTables={};i=!0;var m=da(j);k.del.forEach(function(a){m[a]=f[a]});Mc(a,[a.Transaction.prototype]);Lc(a,[a.Transaction.prototype],d(m),m);c.schema=m;var n=oa(l);n&&Q();var o;j=M.follow(function(){o=l(c);if(o&&n){var a=R.bind(null,null);o.then(a,a)}});return o&&typeof o.then==="function"?M.resolve(o):j.then(function(){return o})}}),f.push(function(b){if(!i||!Nb){var d=g._cfg.dbschema;Tc(d,b)}Mc(a,[a.Transaction.prototype]);Lc(a,[a.Transaction.prototype],a._storeNames,a._dbSchema);c.schema=a._dbSchema})});function j(){return f.length?M.resolve(f.shift()(c.idbtrans)).then(j):M.resolve()}return j().then(function(){Sc(h,e)})}function Qc(a,b){var c={del:[],add:[],change:[]},d;for(d in a)b[d]||c.del.push(d);for(d in b){var e=a[d],f=b[d];if(!e)c.add.push([d,f]);else{var g={name:d,def:f,recreate:!1,del:[],add:[],change:[]};if(""+(e.primKey.keyPath||"")!==""+(f.primKey.keyPath||"")||e.primKey.auto!==f.primKey.auto&&!Mb)g.recreate=!0,c.change.push(g);else{e=e.idxByName;f=f.idxByName;var h;for(h in e)f[h]||g.del.push(h);for(h in f){var i=e[h],j=f[h];!i?g.add.push(j):i.src!==j.src&&g.change.push(j)}(g.del.length>0||g.add.length>0||g.change.length>0)&&c.change.push(g)}}}return c}function Rc(a,b,c,d){var e=a.db.createObjectStore(b,c.keyPath?{keyPath:c.keyPath,autoIncrement:c.auto}:{autoIncrement:c.auto});d.forEach(function(a){return Uc(e,a)});return e}function Sc(a,b){d(a).forEach(function(c){b.db.objectStoreNames.contains(c)||Rc(b,c,a[c].primKey,a[c].indexes)})}function Tc(a,b){for(var c=0;c<b.db.objectStoreNames.length;++c){var d=b.db.objectStoreNames[c];a[d]==null&&b.db.deleteObjectStore(d)}}function Uc(a,b){a.createIndex(b.name,b.keyPath,{unique:b.unique,multiEntry:b.multi})}function Vc(a,b,c){var d={};a=r(b.objectStoreNames,0);a.forEach(function(a){var b=c.objectStore(a),e=b.keyPath,f=xc(yc(e),e||"",!1,!1,!!b.autoIncrement,e&&typeof e!=="string",!0),g=[];for(var h=0;h<b.indexNames.length;++h){var i=b.index(b.indexNames[h]);e=i.keyPath;i=xc(i.name,e,!!i.unique,!!i.multiEntry,!1,e&&typeof e!=="string",!1);g.push(i)}d[a]=zc(a,f,g)});return d}function Wc(a,b,c){a.verno=b.version/10;c=a._dbSchema=Vc(a,b,c);a._storeNames=r(b.objectStoreNames,0);Lc(a,[a._allTables],d(c),c)}function Xc(a,b){b=Vc(a,a.idbdb,b);b=Qc(b,a._dbSchema);return!(b.add.length||b.change.some(function(a){return a.add.length||a.change.length}))}function Yc(a,b,c){var d=c.db.objectStoreNames;for(var e=0;e<d.length;++e){var g=d[e],h=c.objectStore(g);a._hasGetAll="getAll"in h;for(var i=0;i<h.indexNames.length;++i){var j=h.indexNames[i],k=h.index(j).keyPath;k=typeof k==="string"?k:"["+r(k).join("+")+"]";if(b[g]){var l=b[g].idxByName[k];l&&(l.name=j,delete b[g].idxByName[k],b[g].idxByName[j]=l)}}}typeof navigator!=="undefined"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&f.WorkerGlobalScope&&f instanceof f.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(a._hasGetAll=!1)}function Zc(a){return a.split(",").map(function(a,b){a=a.trim();var c=a.replace(/([&*]|\+\+)/g,""),d=/^\[/.test(c)?c.match(/^\[(.*)\]$/)[1].split("+"):c;return xc(c,d||null,/\&/.test(a),/\*/.test(a),/\+\+/.test(a),e(d),b===0)})}var $c=function(){function a(){}a.prototype._parseStoresSpec=function(a,b){d(a).forEach(function(c){if(a[c]!==null){var d=Zc(a[c]),e=d.shift();if(e.multi)throw new F.Schema("Primary key cannot be multi-valued");d.forEach(function(a){if(a.auto)throw new F.Schema("Only primary key can be marked as autoIncrement (++)");if(!a.keyPath)throw new F.Schema("Index must have a name and cannot be an empty string")});b[c]=zc(c,e,d)}})};a.prototype.stores=function(a){var b=this.db;this._cfg.storesSource=this._cfg.storesSource?g(this._cfg.storesSource,a):a;a=b._versions;var c={},e={};a.forEach(function(a){g(c,a._cfg.storesSource),e=a._cfg.dbschema={},a._parseStoresSpec(c,e)});b._dbSchema=e;Mc(b,[b._allTables,b,b.Transaction.prototype]);Lc(b,[b._allTables,b,b.Transaction.prototype,this._cfg.tables],d(e),e);b._storeNames=d(e);return this};a.prototype.upgrade=function(a){this._cfg.contentUpgrade=a;return this};return a}();function ad(a){return Xb($c.prototype,function(b){this.db=a,this._cfg={version:b,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}var bd;function cd(a){var b=a&&typeof a.databases==="function",c;if(!b){var d=new pd(Qb,{addons:[]});d.version(1).stores({dbnames:"name"});c=d.table("dbnames")}return{getDatabaseNames:function(){return b?M.resolve(a.databases()).then(function(a){return a.map(function(a){return a.name}).filter(function(a){return a!==Qb})}):c.toCollection().primaryKeys()},add:function(a){return!b&&a!==Qb&&c.put({name:a})["catch"](G)},remove:function(a){return!b&&a!==Qb&&c["delete"](a)["catch"](G)}}}function dd(a){try{bd=cd(a)}catch(a){}}function ed(a){return P(function(){K.letThrough=!0;return a()})}function fd(a){var b=a._state,c=a._deps.indexedDB;if(b.isBeingOpened||a.idbdb)return b.dbReadyPromise.then(function(){return b.dbOpenError?T(b.dbOpenError):a});B&&(b.openCanceller._stackHolder=C());b.isBeingOpened=!0;b.dbOpenError=null;b.openComplete=!1;var d=b.dbReadyResolve,e=null;return M.race([b.openCanceller,new M(function(d,f){if(!c)throw new F.MissingAPI("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using old Safari versions, make sure to include indexedDB polyfill.");var g=a.name,h=b.autoSchema?c.open(g):c.open(g,Math.round(a.verno*10));if(!h)throw new F.MissingAPI("IndexedDB API not available");h.onerror=Y(f);h.onblocked=N(a._fireOnBlocked);h.onupgradeneeded=N(function(d){e=h.transaction;if(b.autoSchema&&!a._options.allowEmptyDB){h.onerror=uc;e.abort();h.result.close();var i=c.deleteDatabase(g);i.onsuccess=i.onerror=N(function(){f(new F.NoSuchDatabase("Database "+g+" doesnt exist"))})}else{e.onerror=Y(f);i=d.oldVersion>Math.pow(2,62)?0:d.oldVersion;a.idbdb=h.result;Oc(a,i/10,e,f)}},f);h.onsuccess=N(function(){e=null;var c=a.idbdb=h.result,f=r(c.objectStoreNames);if(f.length>0)try{f=c.transaction(sc(f),"readonly");b.autoSchema?Wc(a,c,f):(Yc(a,a._dbSchema,f),!Xc(a,f));Kc(a,f)}catch(a){}Lb.push(a);c.onversionchange=N(function(c){b.vcFired=!0,a.on("versionchange").fire(c)});bd.add(g);d()},f)})]).then(function(){b.onReadyBeingFired=[];return M.resolve(ed(a.on.ready.fire)).then(function a(){if(b.onReadyBeingFired.length>0){var c=b.onReadyBeingFired.reduce(Ha,G);b.onReadyBeingFired=[];return M.resolve(ed(c)).then(a)}})})["finally"](function(){b.onReadyBeingFired=null}).then(function(){b.isBeingOpened=!1;return a})["catch"](function(c){try{e&&e.abort()}catch(a){}b.isBeingOpened=!1;a.close();b.dbOpenError=c;return T(b.dbOpenError)})["finally"](function(){b.openComplete=!0,d()})}function gd(a){var b=function(b){return a.next(b)},c=function(b){return a["throw"](b)},d=g(b),f=g(c);function g(a){return function(b){b=a(b);var c=b.value;return b.done?c:!c||typeof c.then!=="function"?e(c)?Promise.all(c).then(d,f):d(c):c.then(d,f)}}return g(b)()}function hd(a,b,c){var d=arguments.length;if(d<2)throw new F.InvalidArgument("Too few arguments");var e=new Array(d-1);while(--d)e[d-1]=arguments[d];c=e.pop();var f=fa(e);return[a,f,c]}function id(a,b,c,d,e){return M.resolve().then(function(){var f=K.transless||K,g=a._createTransaction(b,c,a._dbSchema,d);f={trans:g,transless:f};d?g.idbtrans=d.idbtrans:g.create();var h=oa(e);h&&Q();var i;f=M.follow(function(){i=e.call(g,g);if(i)if(h){var a=R.bind(null,null);i.then(a,a)}else typeof i.next==="function"&&typeof i["throw"]==="function"&&(i=gd(i))},f);return(i&&typeof i.then==="function"?M.resolve(i).then(function(a){return g.active?a:T(new F.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):f.then(function(){return i})).then(function(a){d&&g._resolve();return g._completion.then(function(){return a})})["catch"](function(a){g._reject(a);return T(a)})})}function jd(a,b,c){a=e(a)?a.slice():[a];for(var d=0;d<c;++d)a.push(b);return a}function kd(a){return b(b({},a),{table:function(c){var d=a.table(c);c=d.schema;var e={},f=[];function g(a,c,d){var h=Gc(a);h=e[h]=e[h]||[];var i=a==null?0:typeof a==="string"?1:a.length,j=c>0;j=b(b({},d),{isVirtual:j,isPrimaryKey:!j&&d.isPrimaryKey,keyTail:c,keyLength:i,extractKey:Ac(a),unique:!j&&d.unique});h.push(j);j.isPrimaryKey||f.push(j);if(i>1){a=i===2?a[0]:a.slice(0,i-1);g(a,c+1,d)}h.sort(function(a,b){return a.keyTail-b.keyTail});return j}var h=g(c.primaryKey.keyPath,0,c.primaryKey);e[":id"]=[h];for(var i=0,j=c.indexes;i<j.length;i++){var k=j[i];g(k.keyPath,0,k)}function l(a){a=e[Gc(a)];return a&&a[0]}function m(b,c){return{type:b.type===1?2:b.type,lower:jd(b.lower,b.lowerOpen?a.MAX_KEY:a.MIN_KEY,c),lowerOpen:!0,upper:jd(b.upper,b.upperOpen?a.MIN_KEY:a.MAX_KEY,c),upperOpen:!0}}function n(c){var a=c.query.index;return a.isVirtual?b(b({},c),{query:{index:a,range:m(c.query.range,a.keyTail)}}):c}k=b(b({},d),{schema:b(b({},c),{primaryKey:h,indexes:f,getIndexByKeyPath:l}),count:function(a){return d.count(n(a))},query:function(a){return d.query(n(a))},openCursor:function(c){var b=c.query.index,e=b.keyTail,f=b.isVirtual,g=b.keyLength;if(!f)return d.openCursor(c);function h(b){function d(d){d!=null?b["continue"](jd(d,c.reverse?a.MAX_KEY:a.MIN_KEY,e)):c.unique?b["continue"](jd(b.key,c.reverse?a.MIN_KEY:a.MAX_KEY,e)):b["continue"]()}d=Object.create(b,{"continue":{value:d},continuePrimaryKey:{value:function(d,c){b.continuePrimaryKey(jd(d,a.MAX_KEY,e),c)}},key:{get:function(){var a=b.key;return g===1?a[0]:a.slice(0,g)}},value:{get:function(){return b.value}}});return d}return d.openCursor(n(c)).then(function(a){return a&&h(a)})}});return k}})}var ld={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:kd},md={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(a){return b(b({},a),{table:function(d){var e=a.table(d),f=e.schema.primaryKey,g=b(b({},e),{mutate:function(a){var g=K.trans,h=g.table(d).hook,i=h.deleting,k=h.creating,l=h.updating;switch(a.type){case"add":if(k.fire===G)break;return g._promise("readwrite",function(){return m(a)},!0);case"put":if(k.fire===G&&l.fire===G)break;return g._promise("readwrite",function(){return m(a)},!0);case"delete":if(i.fire===G)break;return g._promise("readwrite",function(){return m(a)},!0);case"deleteRange":if(i.fire===G)break;return g._promise("readwrite",function(){return n(a)},!0)}return e.mutate(a);function m(a){var d=K.trans,g=a.keys||Cc(f,a);if(!g)throw new Error("Keys missing");a=a.type==="add"||a.type==="put"?b(b({},a),{keys:g,wantResults:!0}):b({},a);a.type!=="delete"&&(a.values=c(a.values));a.keys&&(a.keys=c(a.keys));return Dc(e,a,g).then(function(b){var c=g.map(function(c,e){var g=b[e],h={onerror:null,onsuccess:null};if(a.type==="delete")i.fire.call(h,c,g,d);else if(a.type==="add"||g===void 0){var m=k.fire.call(h,c,a.values[e],d);c==null&&m!=null&&(c=m,a.keys[e]=c,f.outbound||w(a.values[e],f.keyPath,c))}else{m=la(g,a.values[e]);var n=l.fire.call(h,m,c,g,d);if(n){var o=a.values[e];Object.keys(n).forEach(function(a){j(o,a)?o[a]=n[a]:w(o,a,n[a])})}}return h});return e.mutate(a).then(function(d){var e=d.failures,f=d.results,h=d.numFailures;d=d.lastResult;for(var i=0;i<g.length;++i){var j=f?f[i]:g[i],k=c[i];j==null?k.onerror&&k.onerror(e[i]):k.onsuccess&&k.onsuccess(a.type==="put"&&b[i]?a.values[i]:j)}return{failures:e,results:f,numFailures:h,lastResult:d}})["catch"](function(a){c.forEach(function(b){return b.onerror&&b.onerror(a)});return Promise.reject(a)})})}function n(a){return o(a.trans,a.range,1e4)}function o(a,c,d){return e.query({trans:a,values:!1,query:{index:f,range:c},limit:d}).then(function(e){var f=e.result;return m({type:"delete",keys:f,trans:a}).then(function(e){if(e.numFailures>0)return Promise.reject(e.failures[0]);if(f.length<d)return{failures:[],numFailures:0,lastResult:void 0};else return o(a,b(b({},c),{lower:f[f.length-1],lowerOpen:!0}),d)})})}}});return g}})}};function nd(a,b){d(b).forEach(function(c){var e=a[c],f=b[c];e?d(f).forEach(function(a){var b=e[a],c=f[a];b&&b!==!0&&b.keys?c===!0?e[a]=!0:c.keys&&(e[a]={keys:b.keys.concat(c.keys)}):e[a]=y(c)}):a[c]=y(f)});return a}var od={stack:"dbcore",level:0,create:function(a){var c=a.schema.name,d=function(a){return[a.key]},e=function(a){return a.keys},f=function(a){a=a.query;var b=a.index;a=a.range;return b.isPrimaryKey&&a.type===1&&[a.lower]},g=[["get",d],["getMany",e],["count",f],["query",f],["openCursor",f]];return b(b({},a),{table:function(d){var e=a.table(d),f=b(b({},e),{mutate:function(b){var a=b.type!=="deleteRange"&&(b.type==="delete"?b.keys:b.keys=Cc(e.schema.primaryKey,b)),f=b.trans;return e.mutate(b).then(function(b){var e,g;g=(e={},e[c]=(g={},g[d]=a&&a.every(function(a){return a!=null})?{keys:a}:!0,g),e);f.mutatedParts||(f.mutatedParts={});nd(f.mutatedParts,g);return b})}});g.forEach(function(g){var h=g[0],b=g[1];f[h]=function(i){var g,j;if(K.subscr){var f=b&&b(i),k=(g={},g[c]=(j={},j[d]=f?{keys:f,cmp:a.cmp}:!0,j),g);nd(K.subscr,k)}return e[h].apply(this,arguments)}});return f}})}},pd=function(){function a(c,d){var e=this;this._middlewares={};this.verno=0;var f=a.dependencies;this._options=d=b({addons:a.addons,autoOpen:!0,indexedDB:f.indexedDB,IDBKeyRange:f.IDBKeyRange},d);this._deps={indexedDB:d.indexedDB,IDBKeyRange:d.IDBKeyRange};f=d.addons;this._dbSchema={};this._versions=[];this._storeNames=[];this._allTables={};this.idbdb=null;var g={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:G,dbReadyPromise:null,cancelOpen:G,openCanceller:null,autoSchema:!0};g.dbReadyPromise=new M(function(a){g.dbReadyResolve=a});g.openCanceller=new M(function(a,b){g.cancelOpen=b});this._state=g;this.name=c;this.on=Wb(this,"populate","blocked","versionchange",{ready:[Ha,G]});this.on.ready.subscribe=s(this.on.ready.subscribe,function(b){return function(c,d){a.vip(function(){var a=e._state;if(a.openComplete)a.dbOpenError||M.resolve().then(c),d&&b(c);else if(a.onReadyBeingFired)a.onReadyBeingFired.push(c),d&&b(c);else{b(c);var f=e;d||b(function a(){f.on.ready.unsubscribe(c),f.on.ready.unsubscribe(a)})}})}});this.Collection=hc(this);this.Table=Yb(this);this.Transaction=wc(this);this.Version=ad(this);this.WhereClause=rc(this);this.on("versionchange",function(a){a.newVersion>0?!1:!1,e.close()});this.on("blocked",function(a){!a.newVersion||a.newVersion<a.oldVersion?!1:!1});this._maxKey=tc(d.IDBKeyRange);this._createTransaction=function(a,b,c,d){return new e.Transaction(a,b,c,d)};this._fireOnBlocked=function(a){e.on("blocked").fire(a),Lb.filter(function(a){return a.name===e.name&&a!==e&&!a._state.vcFired}).map(function(b){return b.on("versionchange").fire(a)})};this.use(ld);this.use(md);this.use(od);f.forEach(function(a){return a(e)})}a.prototype.version=function(a){if(isNaN(a)||a<.1)throw new F.Type("Given version is not a positive number");a=Math.round(a*10)/10;if(this.idbdb||this._state.isBeingOpened)throw new F.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,a);var b=this._versions,c=b.filter(function(b){return b._cfg.version===a})[0];if(c)return c;c=new this.Version(a);b.push(c);b.sort(Nc);c.stores({});this._state.autoSchema=!1;return c};a.prototype._whenReady=function(a){var b=this;return this._state.openComplete||K.letThrough?a():new M(function(a,c){if(!b._state.isBeingOpened){if(!b._options.autoOpen){c(new F.DatabaseClosed());return}b.open()["catch"](G)}b._state.dbReadyPromise.then(a,c)}).then(a)};a.prototype.use=function(a){var b=a.stack,c=a.create,d=a.level;a=a.name;a&&this.unuse({stack:b,name:a});var e=this._middlewares[b]||(this._middlewares[b]=[]);e.push({stack:b,create:c,level:d==null?10:d,name:a});e.sort(function(a,b){return a.level-b.level});return this};a.prototype.unuse=function(a){var b=a.stack,c=a.name,d=a.create;b&&this._middlewares[b]&&(this._middlewares[b]=this._middlewares[b].filter(function(a){return d?a.create!==d:c?a.name!==c:!1}));return this};a.prototype.open=function(){return fd(this)};a.prototype.close=function(){var a=Lb.indexOf(this),b=this._state;a>=0&&Lb.splice(a,1);if(this.idbdb){try{this.idbdb.close()}catch(a){}this.idbdb=null}this._options.autoOpen=!1;b.dbOpenError=new F.DatabaseClosed();b.isBeingOpened&&b.cancelOpen(b.dbOpenError);b.dbReadyPromise=new M(function(a){b.dbReadyResolve=a});b.openCanceller=new M(function(a,c){b.cancelOpen=c})};a.prototype["delete"]=function(){var a=this,b=arguments.length>0,c=this._state;return new M(function(d,e){var f=function(){a.close();var b=a._deps.indexedDB.deleteDatabase(a.name);b.onsuccess=N(function(){bd.remove(a.name),d()});b.onerror=Y(e);b.onblocked=a._fireOnBlocked};if(b)throw new F.InvalidArgument("Arguments not allowed in db.delete()");c.isBeingOpened?c.dbReadyPromise.then(f):f()})};a.prototype.backendDB=function(){return this.idbdb};a.prototype.isOpen=function(){return this.idbdb!==null};a.prototype.hasBeenClosed=function(){var a=this._state.dbOpenError;return a&&a.name==="DatabaseClosed"};a.prototype.hasFailed=function(){return this._state.dbOpenError!==null};a.prototype.dynamicallyOpened=function(){return this._state.autoSchema};Object.defineProperty(a.prototype,"tables",{get:function(){var a=this;return d(this._allTables).map(function(b){return a._allTables[b]})},enumerable:!0,configurable:!0});a.prototype.transaction=function(){var a=hd.apply(this,arguments);return this._transaction.apply(this,a)};a.prototype._transaction=function(a,b,c){var d=this,e=K.trans;(!e||e.db!==this||a.indexOf("!")!==-1)&&(e=null);var f=a.indexOf("?")!==-1;a=a.replace("!","").replace("?","");var g,h;try{h=b.map(function(a){a=a instanceof d.Table?a.name:a;if(typeof a!=="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return a});if(a=="r"||a===Rb)g=Rb;else if(a=="rw"||a==Sb)g=Sb;else throw new F.InvalidArgument("Invalid transaction mode: "+a);if(e){if(e.mode===Rb&&g===Sb)if(f)e=null;else throw new F.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");e&&h.forEach(function(a){if(e&&e.storeNames.indexOf(a)===-1)if(f)e=null;else throw new F.SubTransaction("Table "+a+" not included in parent transaction.")});f&&e&&!e.active&&(e=null)}}catch(a){return e?e._promise(null,function(b,c){c(a)}):T(a)}var i=id.bind(null,this,g,h,e,c);return e?e._promise(g,i,"lock"):K.trans?Bb(K.transless,function(){return d._whenReady(i)}):this._whenReady(i)};a.prototype.table=function(a){if(!j(this._allTables,a))throw new F.InvalidTable("Table "+a+" does not exist");return this._allTables[a]};return a}(),qd=function(){function a(a){this._subscribe=a}a.prototype.subscribe=function(a,b,c){return typeof a==="function"?this._subscribe({next:a,error:b,complete:c}):this._subscribe(a)};return a}();function rd(a){return new qd(function(b){var c=b.start,e=b.next,f=b.error,g=oa(a);function h(b){g&&Q();var c=function(){return P(a,{subscr:b,trans:null})};c=K.trans?Bb(K.transless,c):c();g&&c.then(R,R);return c}var i=!1,j={},k={},l={get closed(){return i},unsubscribe:function(){i=!0,Z.txcommitted.unsubscribe(p)}};c&&c(l);var m=!1,n=!1;function o(){for(var b=0,a=d(k);b<a.length;b++){var c=a[b],e=j[c];if(e){var f=k[c];c=function(a){var b=e[a],c=f[a];if(b===!0)if(c)return{value:!0};else return"continue";if(c===!0)if(b)return{value:!0};else return"continue";if(b&&b.keys&&c.keys.some(function(a){return b.keys.some(function(b){try{return c.cmp(a,b)===0}catch(a){return!1}})}))return{value:!0}};for(var g=0,h=d(f);g<h.length;g++){var i=h[g];i=c(i);if(typeof i==="object")return i.value}}}return!1}var p=function(a){nd(j,a),o()&&q()},q=function(){if(m||i)return;j={};var a={},b=h(a);n||(Z("txcommitted",p),n=!0);m=!0;Promise.resolve(b).then(function(b){m=!1;if(i)return;o()?q():(j={},k=a,e&&e(b))},function(a){m=!1,f&&f(a),l.unsubscribe()})};q();return l})}var $=pd;k($,b(b({},D),{"delete":function(a){a=new $(a);return a["delete"]()},exists:function(a){return new $(a,{addons:[]}).open().then(function(a){a.close();return!0})["catch"]("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(a){return bd?bd.getDatabaseNames().then(a):M.resolve([])},defineClass:function(){function a(a){g(this,a)}return a},ignoreTransaction:function(a){return K.trans?Bb(K.transless,a):a()},vip:ed,async:function(a){return function(){try{var b=gd(a.apply(this,arguments));return!b||typeof b.then!=="function"?M.resolve(b):b}catch(a){return T(a)}}},spawn:function(a,b,c){try{a=gd(a.apply(c,b||[]));return!a||typeof a.then!=="function"?M.resolve(a):a}catch(a){return T(a)}},currentTransaction:{get:function(){return K.trans||null}},waitFor:function(a,b){a=M.resolve(typeof a==="function"?$.ignoreTransaction(a):a).timeout(b||6e4);return K.trans?K.trans.waitFor(a):a},Promise:M,debug:{get:function(){return B},set:function(a){pa(a,a==="dexie"?function(){return!0}:Pb)}},derive:n,extend:g,props:k,override:s,Events:Wb,on:Z,liveQuery:rd,extendObservabilitySet:nd,getByKeyPath:v,setByKeyPath:w,delByKeyPath:ca,shallowClone:da,deepClone:y,getObjectDiff:la,asap:aa,minKey:Jb,addons:[],connections:Lb,errnames:xa,dependencies:function(){try{return{indexedDB:f.indexedDB||f.mozIndexedDB||f.webkitIndexedDB||f.msIndexedDB,IDBKeyRange:f.IDBKeyRange||f.webkitIDBKeyRange}}catch(a){return{indexedDB:null,IDBKeyRange:null}}}(),semVer:x,version:x.split(".").map(function(a){return parseInt(a)}).reduce(function(a,b,c){return a+b/Math.pow(10,c*2)}),"default":$,Dexie:$}));$.maxKey=tc($.dependencies.IDBKeyRange);function sd(a){var b=ud;try{ud=!0,Z.txcommitted.fire(a)}finally{ud=b}}var td=sd,ud=!1,vd={};if(typeof document!=="undefined"&&document.addEventListener){var wd=function(){document.visibilityState==="visible"&&(Object.keys(vd).length>0&&sd(vd),vd={})};document.addEventListener("visibilitychange",wd);td=function(a){nd(vd,a),wd()}}if(typeof BroadcastChannel!=="undefined"){var xd=new BroadcastChannel("dexie-txcommitted");Z("txcommitted",function(a){ud||xd.postMessage(a)});xd.onmessage=function(a){a.data&&td(a.data)}}else typeof localStorage!=="undefined"&&(Z("txcommitted",function(a){try{ud||localStorage.setItem("dexie-txcommitted",JSON.stringify({trig:Math.random(),changedParts:a}))}catch(a){}}),addEventListener("storage",function(a){if(a.key==="dexie-txcommitted"){a=JSON.parse(a.newValue);a&&td(a.changedParts)}}));dd(pd.dependencies.indexedDB);M.rejectionMapper=Aa;pa(B,Pb);return pd})}var k=!1;function l(){k||(k=!0,j());return h.exports}function b(a){switch(a){case void 0:return l()}}e.exports=b}),null);
__d("dexie_alpha",["dexie-3.1.0-alpha.4"],(function(a,b,c,d,e,f){e.exports=b("dexie-3.1.0-alpha.4")()}),null);
__d("WAOdsEnums",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({MSG_ENCRYPTION:"armadillo_message_encryption",MSG_DECRYPTION:"armadillo_message_decryption",WA_CONNECTIVITY:"armadillo_wa_connectivity",GET_DEVICES:"armadillo_get_devices",PHASH_MISMATCH:"phash_mismatch",WEB_PLACEHOLDER:"armadillo_web_placeholder",PREKEY_UPLOAD:"armadillo_prekey_upload",PREKEY_DIGEST:"armadillo_prekey_digest",C2C_META_SYNC:"armadillo_c2c_meta_sync",ADMIN_MESSAGE:"armadillo_admin_message",PREVIEW_SNIPPET:"armadillo_snippet",GROUP_CREATE:"armadillo_group_create",GROUP_DELETE:"armadillo_group_delete",GROUP_ADD_PARTICIPANT:"armadillo_group_add_participant",GROUP_PROMOTE_PARTICIPANT:"armadillo_group_promote_participant",GROUP_DEMOTE_PARTICIPANT:"armadillo_group_demote_participant",GROUP_REMOVE_PARTICIPANT:"armadillo_group_remove_participant",GROUP_LEAVE_PARTICIPANT:"armadillo_group_leave_participant",SEND_READ_RECEIPTS:"armadillo_send_read_receipts",MESSAGE_MISSING_THREAD_JID:"MESSAGE_MISSING_THREAD_JID",MESSAGE_MISSING:"MESSAGE_MISSING"});f.Entity=a}),66);
__d("isObject",[],(function(a,b,c,d,e,f){function a(a){var b=typeof a;return b==="function"||b==="object"&&!!a}f["default"]=a}),66);
__d("WAPromiseBackoffs",["Promise"],(function(a,b,c,d,e,f){function a(a,b){if(a===0)return 0;var c=m(b.algo);for(var d=1;d<a;d++)c();return h(b,c())}function g(a){var b=a.relativeDelay,c=b===void 0?!1:b,d=null,e=m(a.algo);return function(){var b=d;if(b==null){d=c?Date.now():0;return 0}var f=h(a,e());if(c){var g=Date.now();b=g-b;b>0&&(f=Math.max(0,f-b));d=g}return f}}function c(a){var c=g(a);return function(a){return new(b("Promise"))(function(b){var d=c();d>0?setTimeout(b,d,a):b(a)})}}function h(a,b){var c=a.max,d=a.min;a=a.jitter;a=a===void 0?.1:a;b=b;c!=null&&b>c&&(b=c);d!=null&&b<d&&(b=d);a!==0&&(b=Math.ceil(b*(1+a*Math.random())));return b}function i(a){var b=a.second-a.first,c=a.first-b;return function(){var a=b+c;c=b;b=a;return a}}function j(a){var b=a.base,c=b===void 0?2:b,d=a.first;return function(){var a=d;d*=c;return a}}function k(a){var b=a.delay;return function(){return b}}function l(a){var b=a.toMs;a=a.backoff;var c=m(a);return function(){return b(c())}}function m(a){switch(a.type){case"fibonacci":return i(a);case"exponential":return j(a);case"constant":return k(a);case"adjust":return l(a);default:a;throw new Error("makeTimeFunc unrecognized backoff "+a.type)}}f.getDelay=a;f.createTimer=g;f.createPromiseTimer=c}),66);
__d("WAResolvable",["Promise"],(function(a,b,c,d,e,f){a=function(){function a(){var a=this;this.$2=!1;this.promise=new(b("Promise"))(function(b){a.$1=b})}var c=a.prototype;c.resolve=function(a){this.$2=!0,this.$1(a)};c.reject=function(a){this.resolve(b("Promise").reject(a))};c.resolveWasCalled=function(){return this.$2};return a}();f.Resolvable=a}),66);
__d("WAPromiseRetryLoop",["Promise","WALogger","WAPromiseBackoffs","WAPromiseDelays","WAResolvable"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop: retrying "," in ","ms"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop: resetting ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop was called several times. You may have race conditions"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop: starting ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop: resetting ",""]);l=function(){return a};return a}a=function(){function a(a){var b=this;this.$2=new(d("WAResolvable").Resolvable)();this.$3=null;this.$4=null;this.$5=0;this.endWithValue=function(a){b.$5++,b.$2.resolve(a)};this.$1=a}var c=a.prototype;c.resetTimeoutAfter=function(a){this.$4=Date.now()+a};c.cancelReset=function(){this.$4=null};c.reset=function(){if(this.$2.resolveWasCalled())return;d("WALogger").LOG(l(),this.$1.name);this.$5++;this.$6()};c.start=function(){if(this.$2.resolveWasCalled())return;d("WALogger").LOG(k(),this.$1.name);this.$5!==0&&d("WALogger").ERROR(j());this.$5++;this.$6()};c.$6=function(){var a=this,c=this.$1,e=this.$5,f=d("WAPromiseBackoffs").createTimer(this.$1.timer);f();var g=function b(){if(a.$2.resolveWasCalled())return;if(e!==a.$5)return;var g=Date.now();a.$3=c.code(a.endWithValue).then(function(){if(a.$2.resolveWasCalled())return;var e=c.resetDelay;(e!==void 0&&Date.now()>=g+e||a.$4!=null&&a.$4<=Date.now())&&(d("WALogger").LOG(i(),c.name),f=d("WAPromiseBackoffs").createTimer(a.$1.timer));a.$4=null;e=f();d("WALogger").LOG(h(),c.name,e);return d("WAPromiseDelays").delayMs(e).then(b)});return a.$3};this.$3=b("Promise").resolve().then(g)};c.promise=function(){var a=this;if(this.$2.resolveWasCalled())return this.$2.promise;return!this.$3?b("Promise").reject(new Error("PromiseRetryLoop "+this.$1.name+" had promise() called before start()")):b("Promise").race([this.$2.promise,this.$3.then(function(){return a.$2.promise})])};return a}();g.PromiseRetryLoop=a}),98);
__d("WARetryUtils",[],(function(a,b,c,d,e,f){a={algo:{type:"adjust",backoff:{type:"fibonacci",first:1,second:1},toMs:function(a){return 1e3*(a+9)}},max:62e4};f.FIBONACCI_BACKOFF=a}),66);
__d("MAWSetupMutex",["FBLogger","LSPersistedDbGating","LocalStorageMutex","MAWAppMutex","MAWBridge","MAWDetectDbSupport","MAWGating.re","MAWIndexedDb","MAWKeychainInit","MAWLocalStorage","MAWOccamadilloOnMutexChange","MWChatBadgeCountUpdates.re","QPLUserCountEvent","QPLUserFlow","Run","WALogger","cr:1230","cr:863","cr:917","qpl","react","regeneratorRuntime","useReStore"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["AppMutex - Shouldn't reinitialize, worker already exists"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["AppMutex - Reinitializing"]);i=function(){return a};return a}a=d("react");var j=a.useCallback,k=a.useEffect,l=a.useMemo,m=c("FBLogger")("messenger_e2ee_web");e=function(a,e,f){var g=f.doesWorkerExist,n=f.getOrSetupWorker,o=f.setupBridge,p=f.terminateWorker,q=l(function(){return d("MAWAppMutex").use()},[]),r=c("useReStore")(),s=j(function(a){var b=q.takeoverFilter(a);if(b&&a.newValue!==d("LocalStorageMutex").THIS_TAB&&a.newValue!==""){b=d("MAWGating.re").isPersistedDbEnabled()&&d("LSPersistedDbGating").allTablesPersisted;b||d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:[{tag:"DropAllSecureThreads",value:void 0}]});p();q.onMutexDeath()}},[q,p]),t=j(function(){p(),q.onMutexDeath()},[q,p]),u=j(function(){var f,j,k,l,p,s,t,u,v;return b("regeneratorRuntime").async(function(w){while(1)switch(w.prev=w.next){case 0:if(!(document.visibilityState==="visible")){w.next=56;break}f=g();w.next=4;return b("regeneratorRuntime").awrap(c("MAWDetectDbSupport")());case 4:j=w.sent;k=d("MAWLocalStorage").isLocalStorageAvailable();if(!(!f&&j&&k)){w.next=55;break}c("QPLUserFlow").start(c("qpl")._(25310984,"169"));w.next=10;return b("regeneratorRuntime").awrap(q.init());case 10:l=w.sent;if(!l){w.next=52;break}d("WALogger").LOG(i());w.next=15;return b("regeneratorRuntime").awrap(b("cr:917").makeEncryptionDB(e));case 15:w.next=17;return b("regeneratorRuntime").awrap(d("MAWKeychainInit").initSetupKeychain());case 17:p=w.sent;d("MAWIndexedDb").makeDB(e,b("cr:1230").getDbEncryptionKey);if(!p.success){w.next=49;break}w.prev=20;s=null;if(!(b("cr:863")!=null&&d("LSPersistedDbGating").allTablesPersisted)){w.next=26;break}w.next=25;return b("regeneratorRuntime").awrap(b("cr:863").setupVaultForPersistedLSDB());case 25:s=w.sent;case 26:w.next=28;return b("regeneratorRuntime").awrap(n(e,p.value,s));case 28:t=w.sent;w.next=31;return b("regeneratorRuntime").awrap(o({environment:a,worker:t}));case 31:u=w.sent;v=d("MAWGating.re").isPersistedDbEnabled()&&d("LSPersistedDbGating").allTablesPersisted;if(!(!v&&d("MAWGating.re").isOccamadillo())){w.next=37;break}d("MAWOccamadilloOnMutexChange").onOccamadilloMutexChange(r);w.next=40;break;case 37:if(v){w.next=40;break}w.next=40;return b("regeneratorRuntime").awrap(u.sendAndReceive("backend","initSync",{numMsgsPerThread:10,numThreads:d("MWChatBadgeCountUpdates.re").minSyncedThreads}));case 40:w.next=47;break;case 42:w.prev=42,w.t0=w["catch"](20),m.mustfix("AppMutex - failed to reinitialize worker"),m.catching(w.t0),c("QPLUserFlow").endFailure(c("qpl")._(25310984,"169"),"failed_to_reinitialize_worker");case 47:w.next=50;break;case 49:c("QPLUserFlow").endFailure(c("qpl")._(25310984,"169"),"mutex_keychain_setup_failure_on_reinit");case 50:w.next=53;break;case 52:c("QPLUserFlow").endFailure(c("qpl")._(25310984,"169"),"mutex_no_premission_on_reinit");case 53:w.next=56;break;case 55:f?d("WALogger").DEV(h()):!j?d("QPLUserCountEvent").fireQplUserCount(c("qpl")._(25299354,"201")):k||d("QPLUserCountEvent").fireQplUserCount(c("qpl")._(25309925,"203"));case 56:case"end":return w.stop()}},null,this,[[20,42]])},[a,e,q,g,n,o,r]);k(function(){window.addEventListener("storage",s);var a=c("Run").onBeforeUnload(t,!1),b=c("Run").onUnload(t);window.addEventListener("visibilitychange",u);return function(){window.removeEventListener("storage",s),a.remove(),b.remove(),window.removeEventListener("visibilitychange",u)}},[s,t,u])};g.useMutex=e}),98);
__d("MAWSetupMutex.react",["MAWSetupMutex","react"],(function(a,b,c,d,e,f,g){"use strict";d("react");function a(a){var b=a.environment,c=a.fbId;a=a.platformSetupUtils;d("MAWSetupMutex").useMutex(b,c,a);return null}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("WorkerUtils",[],(function(a,b,c,d,e,f){"use strict";function b(){try{return"WorkerGlobalScope"in a&&a instanceof a.WorkerGlobalScope}catch(a){return!1}}function c(){try{return"SharedWorkerGlobalScope"in a&&a instanceof a.SharedWorkerGlobalScope}catch(a){return!1}}function d(){return"SharedWorker"in a&&typeof a.SharedWorker==="function"}f.isWorkerContext=b;f.isSharedWorkerContext=c;f.isSharedWorkerSupported=d}),66);
__d("shouldUseMAWSharedWorker",["MAWGating.re","WorkerUtils","gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(){return d("WorkerUtils").isSharedWorkerSupported()&&d("MAWGating.re").isSharedWorkerEnabled()&&c("gkx")("264")}g["default"]=a}),98);
__d("LSInt64.bs",["bs_int64"],(function(a,b,c,d,e,f){"use strict";function a(a){return a}c=b("bs_int64").compare;d=b("bs_int64").equal;e=b("bs_int64").to_string;f.compare=c;f.equal=d;f.string=e;f.ofString=a}),null);
__d("MWPBumpEntityKey.re",["MWPBumpEntityKey.bs","bs_curry"],(function(a,b,c,d,e,f){a=function(a,c){a=b("bs_curry")._2(b("MWPBumpEntityKey.bs").bumpEntityKey,a,c);return a};f.bumpEntityKey=a;c=function(a,c){a=b("bs_curry")._2(b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId,a,c);return a};f.bumpEntityKeyWithAppId=c}),null);
__d("LSDatascriptEvaluator",["LS.re","MWPBumpEntityKey.re","createTrustedFunction","createTrustedScriptWithoutValidation_DO_NOT_USE","recoverableViolation","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return function(e){return function(f){var g,h,i,j,k,l,m;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:g=f.experiments,h=f.syncScript;i=g!=null?JSON.parse(g):null;j=function(a,b){var c;return i==null?void 0:(c=i.qe)==null?void 0:(c=c[a])==null?void 0:c[b]};k={getBool:j,getNumber:j,getString:j};l=function(a){var b;return i==null?void 0:(b=i.gk)==null?void 0:b[a]};n.prev=5;n.next=8;return b("regeneratorRuntime").awrap(e.runInTransaction(function(b){a&&a();var d=c("createTrustedFunction")(c("createTrustedScriptWithoutValidation_DO_NOT_USE")("gkx"),c("createTrustedScriptWithoutValidation_DO_NOT_USE")("qex"),c("createTrustedScriptWithoutValidation_DO_NOT_USE")("return "+h));return d(l,k)(c("LS.re").make(b))},"readwrite"));case 8:m=n.sent;return n.abrupt("return",m);case 12:n.prev=12;n.t0=n["catch"](5);d("MWPBumpEntityKey.re").bumpEntityKeyWithAppId("lsplatform","eval_datascript_failure");c("recoverableViolation")("Error executing sync script: "+n.t0.message,"messenger_web_product",n.t0);throw n.t0;case 18:case"end":return n.stop()}},null,this,[[5,12]])}}}g["default"]=a}),98);
__d("LSDataTraceType.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").one;c=[0,2];d=[0,3];e=[0,4];b=[0,5];var g=[0,6],h=[0,69],i=[0,70],j=[0,71],k=[0,72],l=[0,73],m=[0,75],n=[0,76],o=[0,77],p=[0,78],q=[0,79],r=[0,80],s=[0,83],t=[0,86],u=[0,88],v=[0,197],w=[0,198],x=[0,199],y=[0,200],z=[0,201],A=[0,203],B=[0,204],C=[0,205],D=[0,206],E=[0,207],F=[0,216];f.task=a;f.sync=c;f.receiveMsg=d;f.richMediaSend=e;f.richMediaDownload=b;f.taskClientMode=g;f.encryptedBackupsFetchBackupStatus=h;f.encryptedBackupsInit=i;f.encryptedBackupsAddDevice=j;f.encryptedBackupsUpload=k;f.encryptedBackupsRestore=l;f.encryptedBackupsDeleteBackup=m;f.encryptedBackupsCreateExtraVirtualDevice=n;f.encryptedBackupsQrAddDevice=o;f.encryptedBackupsSyncEpochs=p;f.encryptedBackupsOpenEpoch=q;f.encryptedBackupsOptOutOfBackup=r;f.encryptedBackupsThirdPartyIdGeneration=s;f.encryptedBackupsFetchBackupsMetadata=t;f.encryptedBackupsQrAddDeviceReceiver=u;f.encryptedBackupsShadowFetchBackupStatus=v;f.encryptedBackupsShadowInit=w;f.encryptedBackupsShadowAddDevice=x;f.encryptedBackupsShadowUpload=y;f.encryptedBackupsShadowRestore=z;f.encryptedBackupsShadowDeleteBackup=A;f.encryptedBackupsShadowCreateExtraVirtualDevice=B;f.encryptedBackupsShadowQrAddDevice=C;f.encryptedBackupsShadowSyncEpochs=D;f.encryptedBackupsShadowOpenEpoch=E;f.encryptedBackupsShadowQrAddDeviceReceiver=F}),null);
__d("LsDataTraceFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1743851");c=b("FalcoLoggerInternal").create("ls_data_trace",a);e.exports=c}),null);
__d("LSDataTraceFlush.bs",["ArmadilloDataTraceType.bs","LSDataTraceType.bs","LSInt64.bs","LSTransaction.bs","LsDataTraceFalcoEvent","ODS","Promise","ReQL.bs","bs_belt_Option","bs_caml","bs_caml_int64","bs_caml_option","bs_int64","clearTimeout","promiseDone","setTimeout"],(function(a,b,c,d,e,f){"use strict";function g(a,c,d){var e=a.length;if(e===0)return[b("bs_caml_int64").neg_one,b("bs_caml_int64").neg_one,void 0,void 0,void 0];e=a.find(function(a){return a.errorMessage!==void 0});e=b("bs_belt_Option").mapWithDefault(e===void 0?void 0:b("bs_caml_option").some(e),void 0,function(a){return a.errorMessage});a=a[a.length-1|0];var f=b("bs_caml_int64").of_float(Date.now()),g=[0,12e4],h=a.timestampMs;g=b("bs_int64").compare(b("bs_caml_int64").sub(f,d),g)>=0;return!c&&g?[b("bs_caml_int64").sub(f,d),a.checkPointId,h,e,"trace expired"]:[b("bs_caml_int64").sub(h,d),a.checkPointId,h,e,e]}function h(a){return a.reduce(function(a,c,d){var e=b("bs_int64").to_string(c.checkPointId),f=c.timestampMs,g=b("bs_int64").to_string(b("bs_belt_Option").getWithDefault(c.syncChannel,b("bs_caml_int64").neg_one));c=c.tags;c=c!==void 0?","+c:"";if(d===0)a.pointsList="".concat("(",e,",",g,c,")");else{d=String(b("bs_caml_int64").to_int32(b("bs_caml_int64").sub(f,a.lastCheckPointTimestamp)));a.pointsList=a.pointsList.concat("-",d,"-(",e,",",g,c,")")}a.lastCheckPointTimestamp=f;return a},{pointsList:"",lastCheckPointTimestamp:b("bs_caml_int64").zero}).pointsList}var i=[0,2];function j(a,c){var d=c.traceId,e=c.shouldFlush,f=c.traceType,j=b("bs_caml").i64_eq(f,b("LSDataTraceType.bs").task)?"send":b("bs_caml").i64_eq(f,b("ArmadilloDataTraceType.bs").armadilloMessageSend)?"armadillo send":b("bs_caml").i64_eq(f,b("LSDataTraceType.bs").encryptedBackupsInit)?"encrypted_backups_init":b("bs_caml").i64_eq(f,b("LSDataTraceType.bs").encryptedBackupsAddDevice)?"encrypted_backups_add_device":b("bs_caml").i64_eq(f,b("LSDataTraceType.bs").encryptedBackupsUpload)?"encrypted_backups_upload":b("bs_caml").i64_eq(f,b("LSDataTraceType.bs").encryptedBackupsRestore)?"encrypted_backups_restore":b("bs_caml").i64_eq(f,b("LSDataTraceType.bs").encryptedBackupsDeleteBackup)?"encrypted_backups_delete_backup":b("bs_caml").i64_eq(f,b("LSDataTraceType.bs").encryptedBackupsShadowInit)?"shadow_encrypted_backups_init":b("bs_caml").i64_eq(f,b("LSDataTraceType.bs").encryptedBackupsShadowAddDevice)?"shadow_encrypted_backups_add_device":b("bs_caml").i64_eq(f,b("LSDataTraceType.bs").encryptedBackupsShadowUpload)?"shadow_encrypted_backups_upload":b("bs_caml").i64_eq(f,b("LSDataTraceType.bs").encryptedBackupsShadowRestore)?"shadow_encrypted_backups_restore":b("bs_caml").i64_eq(f,b("LSDataTraceType.bs").encryptedBackupsShadowDeleteBackup)?"shadow_encrypted_backups_delete_backup":c.contextTwo;f=c.traceType;var k=b("bs_caml").i64_eq(f,b("ArmadilloDataTraceType.bs").armadilloMessageSend)?"tam_message_send":c.contextOne,l=b("bs_caml").i64_eq(c.traceType,i)?void 0:c.predefinedId,m=c.initTimestampMs;return b("ReQL.bs").toArray(b("ReQL.bs").filter(b("ReQL.bs").fromTableAscending(a.table("data_trace_addon")),function(a){return a.traceId===d})).then(function(a){var c=g(a,e,m),f=c[4],i=c[3],n=c[1],o=c[0],p=a.length,q=h(a);b("LsDataTraceFalcoEvent").log(function(){var a,c;return{data_trace_id:d,trace_flow:b("bs_belt_Option").getWithDefault(j,""),database_id:k,error_message:f,first_error_message:i,has_backgrounded:!1,predefined_id:l,latency:(a=b("bs_caml_option")).some((c=b("LSInt64.bs")).string(o)),last_check_point:a.some(c.string(n)),check_point_count:a.some(c.string(b("bs_caml_int64").of_int32(p))),check_point_list:q,client_event_ts:a.some(c.string(b("bs_caml_int64").of_float(Date.now()))),start_time:a.some(c.string(m)),cold_start_time:void 0,sent_text_messages:void 0,sent_rich_media_messages:void 0,delivered_messages:void 0,media_type:void 0,num_of_attachments:void 0,persisted_metadata:void 0}});return b("Promise").resolve(void 0)}).then(function(b){return a.table("data_trace_meta")["delete"]({hd:d,tl:0})})}function a(a,c){return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("data_trace_meta")),{hd:c,tl:0})).then(function(c){if(c!==void 0)return j(a,c);else return b("Promise").resolve(void 0)})}var k={contents:void 0};function l(a){var c=[0,12e4];return b("LSTransaction.bs").run(a,function(a){return b("ReQL.bs").toArray(b("ReQL.bs").fromTableAscending(a.table("data_trace_meta"))).then(function(d){return b("Promise").all(d.map(function(d){var e=d.shouldFlush,f=d.initTimestampMs,g=b("bs_caml_int64").of_float(Date.now());if(e===!1&&b("bs_int64").compare(b("bs_caml_int64").sub(g,f),c)>=0)return j(a,d);else return b("Promise").resolve(void 0)}))})},"readWrite")}function m(a){b("promiseDone")(l(a),function(c){c=k.contents;c!==void 0&&b("clearTimeout")(b("bs_caml_option").valFromOption(c));c=b("setTimeout")(function(b){return m(a)},6e4);k.contents=b("bs_caml_option").some(c)},function(a){a=k.contents;a!==void 0&&b("clearTimeout")(b("bs_caml_option").valFromOption(a));b("ODS").bumpEntityKey(3185,"mw_trace","error")})}c=[0,4];d=[0,5];f.dataTraceSync=i;f.dataTraceRichMediaSend=c;f.dataTraceRichMediaDownload=d;f.flushForTraceMeta=j;f.flush=a;f.flushExpiredDataTraces=m}),null);
__d("FBMqttChannel.bs",["FBMqttChannel"],(function(a,b,c,d,e,f){"use strict";var g=b("FBMqttChannel");function a(a){}function c(a){return g}f.instance=g;f.shutdownAndClear=a;f.getInstance=c}),null);
__d("DoubleKeyMap",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=new Map()}var b=a.prototype;b.set=function(a,b,c){var d=this.$1.get(a);d||this.$1.set(a,d=new Map());d.set(b,c)};b.get=function(a,b){return(a=this.$1.get(a))==null?void 0:a.get(b)};b["delete"]=function(a,b){var c=this.$1.get(a);c&&(c["delete"](b),c.size===0&&this.$1["delete"](a))};b.deleteAll=function(a){this.$1["delete"](a)};return a}();f.DoubleKeyMap=a}),66);
__d("NestedTimeRange",["SimpleHook","performance","performanceAbsoluteNow"],(function(a,b,c,d,e,f,g){"use strict";var h=new(d("SimpleHook").SimpleHook)(),i=new(d("SimpleHook").SimpleHook)(),j="/";function k(a,b){return""+a+j+b}b=function(){function a(a,b){b===void 0&&(b=null),this.$3=0,this.$1=a,this.$2=b}var b=a.prototype;b.isRunning=function(){return this.$3>0};b.fullname=function(){return this.$2!==null?k(this.$2.fullname(),this.$1):this.$1};b.start=function(a){a===void 0&&(a=c("performanceAbsoluteNow")());if(this.$3===0){var b;(b=this.$2)==null?void 0:b.start(a);this.__onStart(a)}++this.$3;return a};b.__onStart=function(a){h.call(this,a)};b.stop=function(a){a===void 0&&(a=c("performanceAbsoluteNow")());--this.$3;if(this.$3===0){var b;this.__onStop(a);(b=this.$2)==null?void 0:b.stop(a)}return a};b.__onStop=function(a){i.call(this,a)};return a}();function a(){c("performance").mark&&c("performance").measure&&(h.add(function(a,b){c("performance").mark(a.fullname()+"_start")}),i.add(function(a,b){c("performance").measure(a.fullname(),a.fullname()+"_start")}))}g.OnRangeStart=h;g.OnRangeStop=i;g.TIME_RANGE_LEVEL_SEPARATOR=j;g.rangeFullName=k;g.NestedTimeRange=b;g.enableDevConsoleTimeline=a}),98);
__d("QLogEvent",["DoubleKeyMap","FBLogger","NestedTimeRange","QPLEvent","SimpleHook","performanceNavigationStart"],(function(a,b,c,d,e,f,g){"use strict";var h=new(d("DoubleKeyMap").DoubleKeyMap)(),i=function(b){babelHelpers.inheritsLoose(a,b);function a(a,c,d){a=b.call(this,a,d)||this;a.$QPLRange1=c;h.set(c,a.fullname(),babelHelpers.assertThisInitialized(a));return a}var e=a.prototype;e.__onStart=function(a){b.prototype.__onStart.call(this,a),this.$QPLRange1.point(this.fullname()+"_START",{timestamp:a})};e.__onStop=function(a){b.prototype.__onStop.call(this,a),this.$QPLRange1.point(this.fullname()+"_END",{timestamp:a}),h["delete"](this.$QPLRange1,this.fullname())};e.range=function(b){this.fullname().startsWith(d("NestedTimeRange").TIME_RANGE_LEVEL_SEPARATOR)||c("FBLogger")("qpl").warn("Range %s cannot have subrange since root name does not start with /",this.fullname());var e=d("NestedTimeRange").rangeFullName(this.fullname(),b);return(e=h.get(this.$QPLRange1,e))!=null?e:new a(b,this.$QPLRange1,this)};return a}(d("NestedTimeRange").NestedTimeRange),j=new(d("DoubleKeyMap").DoubleKeyMap)(),k=new(d("SimpleHook").SimpleHook)(),l=new(d("SimpleHook").SimpleHook)(),m=new(d("SimpleHook").SimpleHook)(),n=new(d("SimpleHook").SimpleHook)(),o=function(b){babelHelpers.inheritsLoose(a,b);function a(a,c,e,f){var g;c===void 0&&(c=0);e===void 0&&(e=2);f===void 0&&(f=!1);var h=d("QPLEvent").getMarkerId(a);g=b.call(this,"event_"+h)||this;g.event=a;g.instanceKey=c;g.$QPLEvent1=e;g.isUserFlow=f;j.set(h,c,babelHelpers.assertThisInitialized(g));return g}var e=a.prototype;e.action=function(a){this.$QPLEvent1=a;return this};e.getAction=function(){return this.$QPLEvent1};e.setIsUserFlow=function(a){this.isUserFlow=a;return this};e.startFromNavStart=function(){this.start(c("performanceNavigationStart")());return this};e.startFromTime=function(a){this.start(a);return this};e.__onStart=function(a){k.call(this,a)};e.__onStop=function(a){l.call(this,a),h.deleteAll(this),j["delete"](d("QPLEvent").getMarkerId(this.event),this.instanceKey)};e.range=function(a){var b;return(b=h.get(this,a))!=null?b:new i(a,this)};e.point=function(a,b){b===void 0&&(b={});m.call(this,a,b);return this};e.annotate=function(a){n.call(this,a);return this};return a}(d("NestedTimeRange").NestedTimeRange);function a(a,b){var c;b===void 0&&(b=0);return(c=j.get(d("QPLEvent").getMarkerId(a),b))!=null?c:new o(a,b)}g.OnEventStart=k;g.OnEventStop=l;g.OnEventPoint=m;g.OnEventAnnotate=n;g.QPLEvent=o;g.event=a}),98);
__d("createTrustedScriptURLForWebWorker",["TrustedTypesWithNoDefaultPolicies"],(function(a,b,c,d,e,f,g){"use strict";b=function(a){return a};var h="web-worker-url",i,j={createScriptURL:function(a){return a},createScript:b,createHTML:b};function k(){if(i)return;i=c("TrustedTypesWithNoDefaultPolicies").createPolicy(h,j)}function l(){i||k();return i}function a(a){return l().createScriptURL(a)}g["default"]=a}),98);
/**
 * License: https://www.facebook.com/legal/license/OKBVmODmb-W/
 */
__d("tweetnacl-auth-1.0.1",["tweetnacl-1.0.3"],(function(a,b,c,d,e,f){"use strict";function a(a){return a&&typeof a==="object"&&"default"in a?a["default"]:a}var g=a(b("tweetnacl-1.0.3"));d={};var h={exports:d};function i(){(function(a,b){typeof h!=="undefined"&&h.exports?h.exports=b(g()):a.nacl.auth=b(a.nacl)})(this,function(a){if(!a)throw new Error("tweetnacl not loaded");var b=128,c=64;function d(d,e){var f=new Uint8Array(b+Math.max(c,d.length)),g;e.length>b&&(e=a.hash(e));for(g=0;g<b;g++)f[g]=54;for(g=0;g<e.length;g++)f[g]^=e[g];f.set(d,b);d=a.hash(f.subarray(0,b+d.length));for(g=0;g<b;g++)f[g]=92;for(g=0;g<e.length;g++)f[g]^=e[g];f.set(d,b);return a.hash(f.subarray(0,b+d.length))}function e(a,b){var c=new Uint8Array(32);c.set(d(a,b).subarray(0,32));return c}e.full=function(a,b){return d(a,b)};e.authLength=32;e.authFullLength=64;e.keyLength=32;return e})}var j=!1;function k(){j||(j=!0,i());return h.exports}function c(a){switch(a){case void 0:return k()}}e.exports=c}),null);
__d("tweetnacl-auth",["tweetnacl-auth-1.0.1"],(function(a,b,c,d,e,f){e.exports=b("tweetnacl-auth-1.0.1")()}),null);
__d("TimedOnceFunc",["ExecutionEnvironment"],(function(a,b,c,d,e,f,g){a=function(){function a(a,b){this.$2=!1,this.$4=a,this.$3=b,c("ExecutionEnvironment").isInBrowser&&this.$5()}var b=a.prototype;b.$6=function(){this.$1!=null&&clearTimeout(this.$1),this.$1=null};b.$5=function(){var a=this;this.isDone()||(this.$6(),this.$1=setTimeout(function(){a.$2=!0,a.run()},this.$3))};b.isDone=function(){return this.$4===null};b.isCancelled=function(){return this.$1===null&&this.$4!==null};b.run=function(){this.$6();if(this.$4!=null){var a=this.$4;this.$4=null;a(this.$2)}};b.getDelay=function(){return this.$3};b.delay=function(a){this.$3=(a=a)!=null?a:this.$3;this.$5()};b.cancel=function(){this.$6()};return a}();g.TimedOnceFunc=a}),98);
__d("MainPageUrl",["ExecutionEnvironment","FBLogger","SimpleHook"],(function(a,b,c,d,e,f,g){"use strict";var h=new URL("http://undefined"),i=new(d("SimpleHook").SimpleHook)();function j(){return c("ExecutionEnvironment").isInBrowser&&h.searchParams.get("workerlog")==="debug"}function a(a){try{j()&&c("FBLogger")("worker").debug("received url "+a);var b=new URL(a,h.href||"http://undefined");h.href!==b.href?(h.href=b.href,i.call(h)):j()&&c("FBLogger")("worker").debug("ignoring url: path didn't change in "+a)}catch(a){c("FBLogger")("worker").catching(a).warn("invalid url")}}typeof window==="object"&&typeof window.location==="object"&&typeof window.location.href==="string"&&a(window.location.href);g.mainPageUrl=h;g.onMainPageUrlChange=i;g.isWorkerLogEnabled=j;g.updateMainPageUrl=a}),98);
__d("WorkerBundleResource",["createTrustedScriptURLForWebWorker"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var d,e;for(var f=arguments.length,g=new Array(f>2?f-2:0),h=2;h<f;h++)g[h-2]=arguments[h];var i=(d=b)!=null?d:a.name,j=new window.URL(a.url,window.location.href).href;if(j==null){var k=new Error("Can't start up worker without a resource url.");k.stack;throw k}var l=new Blob(["__DEV__=false;","if (self.trustedTypes && self.trustedTypes.createPolicy) {","const escapeScriptURLPolicy = self.trustedTypes.createPolicy('workerPolicy', {\n  createScriptURL: url => url });","importScripts(escapeScriptURLPolicy.createScriptURL('"+j+"'));","} else {","importScripts('"+j+"');","}","StartBundle.apply(null, "+JSON.stringify([a].concat((e=g)!=null?e:[]))+")"],{type:"text/javascript"}),m=window.URL.createObjectURL(l),n=new Worker(c("createTrustedScriptURLForWebWorker")(m),{name:i}),o=n.terminate;n.terminate=function(){window.URL.revokeObjectURL(this._objectURL),o.apply(this,arguments)};return n}function b(a,b){b=(b=b)!=null?b:a.name;b=new SharedWorker(c("createTrustedScriptURLForWebWorker")(a.url),{name:b});b.port.start();b.port.postMessage({type:"execute-worker",args:[a]});return b}g.createDedicatedWebWorker=a;g.createSharedWebWorker=b}),98);
__d("FuncChannel",["FBLogger","Promise"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){var d=this;this.$2=[];this.callMessageHandler=function(a){return new(b("Promise"))(function(b,c){a.result={resolveFunc:b,rejectFunc:c},d.$2.push(a)})};this.messageToCall=function(a){var b,e,f=d.proxyMethods[a.method];if(typeof f!=="function"){c("FBLogger")("worker").mustfix("proxyMethods["+a.method+"] is not a functions");return}b=(b=a.result)==null?void 0:b.resolveFunc;e=(e=a.result)==null?void 0:e.rejectFunc;if(typeof b==="function"&&typeof e==="function")try{var g=f.apply(a.thisArg,a.argList);b(g)}catch(a){e(a)}else return f.apply(a.thisArg,a.argList)};var e=this,f={},g=a(f);a=Object.keys(g);var h={};a.forEach(function(a){h[a]=function(){var b={type:"call",method:a,thisArg:null,argList:Array.from(arguments)};return e.callMessageHandler(b)},f[a]=function(){var b=e.$1[a];if(typeof b!=="function"){c("FBLogger")("worker").mustfix("_backend["+a+"] is not a functions");return}return b.apply(e.$1,arguments)},g[a]===null&&(g[a]=f[a])});this.$1=h;this.proxyMethods=g}var d=a.prototype;d.flushBuffer=function(){var a=this.$2;this.$2=[];a.forEach(this.messageToCall)};d.setBackend=function(a){this.$1!==a&&(this.$1=a,this.flushBuffer());return this};d.setCallMessageHandler=function(a){this.callMessageHandler=a,this.flushBuffer()};return a}();g["default"]=a}),98);
__d("VirtualMessageChannel",["invariant","Promise","SimpleHook","nullthrows","promiseDone"],(function(a,b,c,d,e,f,g,h){"use strict";var i=function(){function a(a){a===void 0&&(a=!1),this.$2=new(d("SimpleHook").SimpleHook)(),this.onmessage=null,this.onmessageerror=null,this.$3=a}var e=a.prototype;e.setRemotePort=function(a){this.$1=a};e.addEventListener=function(a,b,c){(a==="message"||a==="error")&&c==null||h(0,55320,a);if(a==="message")if(typeof b==="function")this.$2.add(b);else{c=b.handleEvent.bind(b);this.$2.add(c);b.__handler=c}};e.removeEventListener=function(a,b,c){if(typeof b==="function")this.$2.remove(b);else{a=b.__handler;this.$2.remove(a)}};e.postMessage=function(a,d){var e=this,f=function(){var b=c("nullthrows")(e.$1,"By now remote port must have value!");b.$2.call({data:a,ports:d})};this.$3?f():c("promiseDone")(b("Promise").resolve(),f)};e.start=function(){};return a}();a=function(a,b){this.port1=new i(a),this.port2=new i(b),this.port1.setRemotePort(this.port2),this.port2.setRemotePort(this.port1)};g.VirtualMessagePort=i;g.VirtualMessageChannel=a}),98);
__d("WorkerMessagePort",["FBLogger","MainPageUrl","Promise","QLogEvent","SimpleHook","VirtualMessageChannel","performanceAbsoluteNow","promiseDone","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h=20,i=100,j=50;function k(a){return a}var l=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}return a}(d("SimpleHook").SimpleHook);function m(a,b){a=k(a);a.__timing=b}function n(a){return a.__timing}var o=0;function p(){return d("QLogEvent").event(c("qpl")._(41497718,"106"),o++)}var q=Math.random()<.1;function r(a,b,c){var d;if(b==null||!q)return;var e=b.sendDelayHighPrecision,f=b.sendTimestamp,g=b.sendDateTime,j=b.receiveTimestamp;b=b.receiveDateTime;d=(d=c)!=null?d:p();c==null&&d.startFromTime();var k=d.range("SEND_DELAY");k.start(f);k.stop(j);k=d.range("SEND_DELAY_LOW_PRECISION");k.start(g);k.stop(b);k=Math.abs(f-g);f=Math.abs(j-b);d.annotate({string:{port_name:a},"int":{send_delay:e,send_drift:k,receive_drift:f},bool:{send_delay_above_max:e!=null&&e>h,send_drift_above_max:k>i,receive_drift_above_max:f>i}});c==null&&d.stop()}a=function(){var a=e.prototype;a.onMessageHandler=function(a){try{this.onMessage.call(a);var b=this.$1[a.type];!b?this.onUnhandledMessage.call(a):b.call(a)}catch(a){this.onError.call(a)}};function e(a,b){var d=this;this.$1={};this.onUnhandledMessage=new l();this.onMessage=new l();this.onPostMessage=new l();this.onError=new l();this.$2=a;this.name=b;this.$2.addEventListener("message",function(a){return d.onMessageHandler(k(a.data))});this.$2.addEventListener("error",function(a){return d.onError.call(a)});this.onPostMessage.add(function(a){m(a,{sendTimestamp:c("performanceAbsoluteNow")(),receiveTimestamp:-1,sendDelayHighPrecision:0,sendDateTime:Date.now(),receiveDateTime:-1,sendDelayLowPrecision:0})});this.onMessage.add(function(a){a=n(a);if(a!=null){var b=a.sendTimestamp,e=a.sendDateTime,f=c("performanceAbsoluteNow")(),g=Date.now();a.receiveTimestamp=f;a.receiveDateTime=g;a.sendDelayHighPrecision=f-b;a.sendDelayLowPrecision=g-e;r(d.name,a)}})}a.postMessage=function(a,b){this.onPostMessage.call(a),b?this.$2.postMessage(a,b):this.$2.postMessage(a)};a.addMessageListener=function(a,b){var c=this.$1[a];c||(c=new l(),this.$1[a]=c);return c.add(b)};a.removeMessageListener=function(a,b){a=this.$1[a];return!!a&&a.remove(b)};a.onMessageOnce=function(a,c){var d=this;return new(b("Promise"))(function(b){var e=d.addMessageListener(a,function(f){c(f)&&(d.removeMessageListener(a,e),b(f))})})};a.close=function(){if(this.$2 instanceof MessagePort)this.$2.close();else if(this.$2 instanceof Worker)this.$2.terminate();else if(this.$2 instanceof DedicatedWorkerGlobalScope)this.$2.close();else{var a;(a=(a=this.$2.close)!=null?a:this.$2.terminate)==null?void 0:a.call(this.$2)}};a.isWrappingVirtualMessagePort=function(){return this.$2 instanceof d("VirtualMessageChannel").VirtualMessagePort};return e}();function s(a){return k(a)}e=function(a){babelHelpers.inheritsLoose(d,a);function d(d,e){var f;f=a.call(this,d,e)||this;var g=s(babelHelpers.assertThisInitialized(f));d=g.onMessageOnce("endpoint_started",function(){return!0});e=g.onMessageOnce("endpoint_started_received",function(){return!0});g.postMessage({type:"endpoint_started",endpoint:f.name});c("promiseDone")(d,function(a){var b=n(a);g.postMessage({type:"endpoint_started_received",endpoint:a.endpoint,targetEndpoint:f.name,startSendTimestamp:b==null?void 0:b.sendTimestamp});r(f.name,b)});c("promiseDone")(e,function(a){var b=n(a);if(b!=null){var c=p();c.startFromTime();r(f.name,b,c);var d=c.range("ROUND_TRIP");d.start(a.startSendTimestamp);d.stop(b.receiveTimestamp);d=b.receiveTimestamp-a.startSendTimestamp;c.annotate({"int":{round_trip:d},bool:{round_trip_above_max:d>j}}).stop()}});f.fullyConnected=b("Promise").race([d,e]).then(function(){return babelHelpers.assertThisInitialized(f)});return f}return d}(a);g.getMessageTiming=n;g.WorkerMessagePort=a;g.CastWorkerMessagePort=s;g.WorkerSyncedMessagePort=e}),98);
__d("WorkerFuncChannel",["invariant","DateConsts","ExecutionEnvironment","FBLogger","FuncChannel","MainPageUrl","Promise","TimedOnceFunc","VirtualMessageChannel","WorkerMessagePort","err","promiseDone"],(function(a,b,c,d,e,f,g,h){"use strict";var i=1e4,j=0,k=5,l=k+1,m=function(){function a(a){self.WeakRef&&(this.$1=new self.WeakRef(a))}var b=a.prototype;b.isDead=function(){return this.$1!=null&&this.$1.deref()==null};return a}(),n=function(e){babelHelpers.inheritsLoose(a,e);function a(a,b,f,g){var h;f===void 0&&(f=null);g===void 0&&(g={});h=e.call(this,a)||this;h.$WorkerFuncChannel1=new Map();h.$WorkerFuncChannel2=new Map();h.$WorkerFuncChannel5={"function":{serialize:function(a,b){b=l++;h.$WorkerFuncChannel1.set(b,a);a={type:"function",value:b};return a},deserialize:function(a){var b=babelHelpers.assertThisInitialized(h),c=a.value;a=function(){var a={type:"call",id:c,method:"__anonymous",thisArg:null,argList:Array.from(arguments)};return b.callMessageHandler(a)};h.$WorkerFuncChannel2.set(c,new m(a));return a}},error:{serialize:function(a,b){b={name:a.name,message:a.message,stack:a.stack};return{type:"error",value:b}},deserialize:function(a){var b=c("err")(a.value.message);b.name=a.value.name;b.stack=a.value.stack;return b}},object:{serialize:function(a,b){var c=a.constructor.name;if(c!=="Object"){var d=h.$WorkerFuncChannel4[c];if(d){d=d.serialize(a,b);return{type:"object",custom:c,value:d}}throw new Error("Cannot clone class object")}return{type:"object",value:a}},deserialize:function(a){var b=a.custom;if(b!=null){b=h.$WorkerFuncChannel4[b];if(b)return b.deserialize(a.value)}return a.value}},raw:{serialize:function(a,b){return{type:"raw",value:a}},deserialize:function(a){return a.value}}};h.name=b;h.$WorkerFuncChannel3=f;h.$WorkerFuncChannel4=g;a=function(a){d("MainPageUrl").isWorkerLogEnabled()&&c("FBLogger")("adsworker").debug("[Channel] removing callback ids: %s",a.join()),a.forEach(function(a){return h.$WorkerFuncChannel1["delete"](a)})};var k=h.__remoteInternalFunc(j,a);typeof jest===typeof void 0&&c("ExecutionEnvironment").isInBrowser&&setInterval(function(){var a=[];h.$WorkerFuncChannel2.forEach(function(b,c){b.isDead()&&(a.push(c),h.$WorkerFuncChannel2["delete"](c))});a.length>0?k(a):h.$WorkerFuncChannel2.size>5e3&&c("FBLogger")("adsworker").warn("[%s] has too many remaining refs %s",h.name,h.$WorkerFuncChannel2.size)},i);return h}var f=a.prototype;f.__remoteInternalFunc=function(a,b){(a>k||this.$WorkerFuncChannel1.get(a)!=null)&&c("FBLogger")("adsworker").mustfix("invalid internal func id %s",a);this.$WorkerFuncChannel1.set(a,b);b=this.$WorkerFuncChannel5["function"].deserialize({type:"function",value:a});return b};f.$WorkerFuncChannel6=function(a){return a instanceof Int8Array||a instanceof Int16Array||a instanceof Int32Array||a instanceof Uint8Array||a instanceof Uint8ClampedArray||a instanceof Uint16Array||a instanceof Uint32Array||a instanceof Float32Array||a instanceof Float64Array};f.$WorkerFuncChannel7=function(a){if(typeof a==="function")return"function";if(a===null)return"raw";if(typeof a!=="object")return"raw";if(Array.isArray(a))return"raw";if(this.$WorkerFuncChannel6(a))return"raw";return a instanceof Error?"error":"object"};f.$WorkerFuncChannel8=function(a,b){var c=this.$WorkerFuncChannel7(a);return this.$WorkerFuncChannel5[c].serialize(a,b)};f.$WorkerFuncChannel9=function(a){var b=a;if(a!==null&&typeof a==="object"&&typeof a.type==="string"){var c=this.$WorkerFuncChannel5[a.type];if(c)return c.deserialize(a)}return b};f.__onPostOutMessage=function(a){return a};f.__callCallback=function(a,b){a.apply(null,b.argList)};f.setOutMessagePort=function(a,d){var e=this,f=[];this.setCallMessageHandler(function(d){d.thisArg=e.name;var g=[];d.argList=d.argList.map(function(a){return e.$WorkerFuncChannel8(a,g)});var h=new(b("Promise"))(function(a,b){d.result={resolveFunc:e.$WorkerFuncChannel8(a,g),rejectFunc:e.$WorkerFuncChannel8(b,g)}}),i=e.__onPostOutMessage(d);i!=null&&(f!=null?f.push({message:d,transferList:g}):a.postMessage(d,g));h["catch"](function(a){c("FBLogger")("worker").catching(a).mustfix("Error: channel %s, remote call of %s returned error %s",e.name,d.method,a.message)});return h});c("promiseDone")(d||u.waitForRemote(this.name),function(){var b=f;f=null;b==null?void 0:b.forEach(function(b){a.postMessage(b.message,b.transferList)});e.$WorkerFuncChannel3==null?void 0:e.$WorkerFuncChannel3()})};f.__messageToCall=function(a){var b=this;a.argList=a.argList.map(function(a){return b.$WorkerFuncChannel9(a)});if(a.result){var d=a.result,e=d.resolveFunc;d=d.rejectFunc;e=this.$WorkerFuncChannel9(e);d=this.$WorkerFuncChannel9(d);a.result={resolveFunc:e,rejectFunc:d}}e=a.id;if(e===void 0)this.messageToCall(a);else{d=this.$WorkerFuncChannel1.get(e);d?this.__callCallback(d,a):c("FBLogger")("adsworker").mustfix("Error: callback is called but no longer available")}};f.setInMessagePort=function(a){var b=this;a.addMessageListener("call",function(a){typeof a.thisArg==="string"&&a.thisArg===b.name&&b.__messageToCall(a)});u.notifyReady(this.name)};f.setMessagePort=function(a){this.setInMessagePort(a);this.setOutMessagePort(a);return this};return a}(c("FuncChannel")),o=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}return a}(d("WorkerMessagePort").WorkerMessagePort);function p(a,b,d,e){u.exportChannel(a,function(e){var f=e.syncPort;e=e.remoteNativePort;var g=b();a===g.name||h(0,54247,a,g.name);var i;e?(i=new o(e,f.name+"("+g.name+")"),e.start(),i.onError.add(function(a){c("FBLogger")("worker").catching(a).mustfix("error caught in remotePort");throw a})):i=f;g.setMessagePort(i).setBackend(d);c("promiseDone")(f.fullyConnected,function(){f.postMessage({type:"channelReady",channelName:g.name}),u.logState("EXPORTED",a)})})}function a(a,b,c,d){d===void 0&&(d={});return p(c,function(){return new n(function(b){return a},c,null,d)},a,b)}var q=function(b){babelHelpers.inheritsLoose(a,b);function a(a,e){e===void 0&&(e="");var f=d("DateConsts").MS_PER_MIN*1;return b.call(this,function(){c("FBLogger")("worker").warn("Channel %s did not establish eventually. %s",a,e)},f)||this}return a}(d("TimedOnceFunc").TimedOnceFunc);function r(a,b){var e,f=null,g,h;b.isWrappingVirtualMessagePort()?(h=new(d("VirtualMessageChannel").VirtualMessageChannel)(!0,!0),e="on virtual dedicated channel"):(h=new MessageChannel(),e="on native dedicated channel",g=[h.port2]);var i=h.port1;f=h.port2;i.start();var j=new o(i,b.name+"("+a.name+")");c("promiseDone")(b.fullyConnected,function(){u.logState("IMPORTING "+e+" ",a.name);a.setInMessagePort(j);var d=new q(a.name,e);c("promiseDone")(b.onMessageOnce("channelReady",function(b){return b.channelName===a.name}),function(b){a.setOutMessagePort(j),d.cancel(),u.logState("ESTABLISHED",a.name)});b.postMessage({type:"channelImport",channelName:a.name,port:f},g)});return a.proxyMethods}function s(a,b,c,d){c===void 0&&(c=null);d===void 0&&(d={});b=new n(function(b){return a},b,c,d);return b}function e(a,b,c,d,e){d===void 0&&(d=null);e===void 0&&(e={});return r(s(a,c,d,e),b)}var t=function(){function a(){this.name=self.name+"_P"+Math.round(10*Math.random()),this.$1=new Map(),this.$2=new Set()}var e=a.prototype;e.logState=function(a,b){d("MainPageUrl").isWorkerLogEnabled()&&c("FBLogger")("worker").debug("%s-%s %s",this.name,a,b)};e.$3=function(a){var b=this.$1.get(a);b==null&&(b={pendingPorts:null,onImportRequest:null},this.$1.set(a,b));return b};e.exportChannel=function(a,b){var d=this,e=this.$3(a);e.onImportRequest!=null&&c("FBLogger")("worker").debug("Re-exporting channel %s",a);e.onImportRequest=b;this.logState("REGISTERED",a);a=e.pendingPorts;if(a!=null){var f=a.filter(function(a){return d.$2.has(a.syncPort)});f.forEach(b);f.length<a.length?e.pendingPorts=a.filter(function(a){return!d.$2.has(a.syncPort)}):e.pendingPorts=null}return e};e.activate=function(a,b,d){var e=this;if(this.$2.has(a)){c("FBLogger")("worker").debug("Port %sis already duplicated ",a.name);return}this.$2.add(a);a.addMessageListener("channelImport",function(b){var c=b.channelName,d=e.$3(c);b={syncPort:a,remoteNativePort:b.port};d.onImportRequest!=null?d.onImportRequest(b):d.pendingPorts!=null?d.pendingPorts.push(b):d.pendingPorts=[b];e.logState("IMPORT REQUEST",c)})};e.notifyReady=function(a){};e.waitForRemote=function(a){return b("Promise").resolve()};return a}(),u=new t();function f(a,b,c){u.activate(a,b,c)}g.WorkerFuncChannel=n;g.exportChannelOnPort=p;g.exportChannel=a;g.importChannelOnPort=r;g.makeChannel=s;g.importChannel=e;g.activateChannels=f}),98);
__d("WorkerBanzaiLazyQueueChannelClient",["BanzaiLazyQueue","WorkerFuncChannel"],(function(a,b,c,d,e,f,g){"use strict";function a(a){d("WorkerFuncChannel").exportChannel(c("BanzaiLazyQueue"),a,"banzai_lazyqueue_channel")}g.init=a}),98);
__d("WorkerQPLChannel",["WorkerFuncChannel","performanceAbsoluteNow"],(function(a,b,c,d,e,f,g){"use strict";var h=new(d("WorkerFuncChannel").WorkerFuncChannel)(function(a){return{markerStartFromNavStart:null,markerStart:function(b,d,e){e===void 0&&(e=c("performanceAbsoluteNow")());return a.markerStart(b,d,e)},markerAnnotate:function(b,c,d){return a.markerAnnotate(b,c,d)},markerPoint:function(b,d,e){e=(e==null?void 0:e.timestamp)===void 0?babelHelpers["extends"]({},e,{timestamp:c("performanceAbsoluteNow")()}):e;return a.markerPoint(b,d,e)},markerEnd:function(b,d,e,f){f===void 0&&(f=c("performanceAbsoluteNow")());return a.markerEnd(b,d,e,f)}}},"qpl");function a(a){h.setMessagePort(a)}function b(a){h.setBackend(a)}g.setMessagePort=a;g.initQPL=b}),98);
__d("WorkerClient",["WorkerBanzaiLazyQueueChannelClient","WorkerFuncChannel","WorkerQPLChannel"],(function(a,b,c,d,e,f,g){"use strict";function a(a){d("WorkerFuncChannel").activateChannels(a,"client","worker"),d("WorkerBanzaiLazyQueueChannelClient").init(a),d("WorkerQPLChannel").setMessagePort(a),e(["QuickPerformanceLogger"],function(a){return d("WorkerQPLChannel").initQPL(a)})}g.init=a}),98);
__d("WATweetnacl",["tweetnacl"],(function(a,b,c,d,e,f){"use strict";Object.keys(importNamespace("tweetnacl")).forEach(function(a){if(a==="default"||a==="__esModule")return;f[a]=importNamespace("tweetnacl")[a]})}),null);
__d("WAJobDefinitions",["WAGlobals"],(function(a,b,c,d,e,f,g){"use strict";var h="msgr";a=function(a){var b=a.generateExternalId;return{deleteThread:function(a){return{type:"deleteThread",args:{chatId:a}}},generateAndUploadPreKeys:function(){return{type:"generateAndUploadPreKeys",args:{},uniqKey:"generateAndUploadPreKeys"}},getDevices:function(a,b,c){c===void 0&&(c=!1);return{type:"getDevices",args:{users:a,ignoreDhash:c,reason:b}}},getCurrentUserDeviceList:function(){return{type:"getCurrentUserDeviceList",args:void 0}},removeDevice:function(a,b){return{type:"removeDevice",args:{deviceId:a,identity:b}}},removeCurrentDevice:function(){return{type:"removeCurrentDevice",args:{}}},notifyDeviceChange:function(a){return{type:"notifyDeviceChange",args:{users:a},uniqKey:"notifyDeviceChange"}},markThreadAsRead:function(a,b){return{type:"markThreadAsRead",args:{chatJid:a,upTo:b},uniqKey:b==null?void 0:b.externalId}},requestPreKeyDigest:function(){return{type:"requestPreKeyDigest",args:{}}},rotateSignedPreKey:function(){return{type:"rotateSignedPreKey",args:{},uniqKey:"rotateSignedPreKey"}},sendPushNotificationSetup:function(a,b,c){return{type:"sendPushNotificationSetup",args:{appId:a,deviceId:b,platform:c},uniqKey:"sendPushNotificationSetup"}},sendXMAShareMsg:function(a,c,d,e,f,g,h,i,j){return{type:"sendXMAShareMsg",args:{chatJid:a,previewFile:c,headerFile:d,faviconFile:e,associatedMsgContent:f,args:g,xmaMsgExternalId:(a=h)!=null?a:b(),associatedMsgContentExternalId:(c=i)!=null?c:b(),xmaArgs:j}}},sendMediaMsg:function(a,c,d,e,f,g,h,i,j,k,l,m,n,o,p){return{type:"sendMediaMsg",args:{chatJid:a,file:c,args:{openMessageOtid:m,height:f,width:e,jpegThumbnail:d,jpegThumbnailHeight:h,jpegThumbnailWidth:g,duration:i,isPtt:j,ephemeralSetting:k,quote:l,isForwarded:n,isFirstMsg:o},externalId:(a=p)!=null?a:b()}}},sendMsg:function(a,c,d){return{type:"sendMsg",args:{chatJid:a,args:c,externalId:(a=d)!=null?a:b()}}},sendReactionMsg:function(a,c,d,e,f){return{type:"sendReactionMsg",args:{chatJid:a,args:{reactToProtocolMsgId:c,reactToAuthor:d,reaction:e,groupingKey:""},externalId:(a=f)!=null?a:b()}}},forwardMsg:function(a,c,d,e){return{type:"forwardMsg",args:{chatJid:a,protocolMsgId:c,ephemeralSetting:d,externalId:(a=e)!=null?a:b()}}},sendWrittenMsg:function(a,b){b===void 0&&(b="message");return{type:"sendWrittenMsg",args:{protocolMsgId:a,type:b}}},handleFutureproofMsg:function(){return{type:"handleFutureproofMsg",args:{}}},createGroup:function(a,b,c,d){return{type:"createGroup",args:{key:c,subject:a,users:b,extras:c!=null?{platform:h,clientThreadKey:c,isDualSend:d}:{platform:h,isDualSend:d}},uniqKey:(a=c)!=null?a:void 0}},queryGroups:function(a){var b;a==null?b={type:"all"}:b={type:"single",group:a};return{type:"queryGroups",args:b}},leaveGroups:function(a){return{type:"leaveGroups",args:{groups:a}}},addGroupParticipants:function(a,b){return{type:"addGroupParticipants",args:{group:a,users:b}}},removeGroupParticipants:function(a,b){return{type:"removeGroupParticipants",args:{group:a,users:b}}},deleteGroups:function(a){return{type:"deleteGroups",args:{groups:a}}},downloadAndHandleMedia:function(a,b){return{type:"downloadAndHandleMedia",args:{protocolMsgId:a,hash:b}}},requestReuploadMedia:function(a,b){return{type:"requestReuploadMedia",args:{protocolMsgId:a,hash:b}}},reuploadMedia:function(a,b,c,d,e){return{type:"reuploadMedia",args:{externalId:a,encProto:d,encIv:e,receiver:b,chatJid:c}}},syncAbProps:function(a){return{type:"syncAbProps",args:{sendHash:a}}},promoteGroupParticipants:function(a,b){return{type:"promoteGroupParticipants",args:{group:a,users:b}}},demoteGroupParticipants:function(a,b){return{type:"demoteGroupParticipants",args:{group:a,users:b}}},setGroupSubject:function(a,b){return{type:"setGroupSubject",args:{group:a,subject:b}}},revokeMsgs:function(a){return{type:"revokeMsgs",args:{msgIds:a}}},deleteMsgsForMe:function(a){return{type:"deleteMsgsForMe",args:{msgIds:a}}},sendAppData:function(a,c){return{type:"sendAppData",args:{args:a,externalId:(a=c)!=null?a:b()}}},sendWrittenAppData:function(a){return{type:"sendWrittenAppData",args:{appDataExternalId:a}}},resendWrittenAppData:function(a){return{type:"resendWrittenAppData",args:{appDataExternalId:a}}},getSpams:function(){return{type:"getSpams",args:void 0}},computeAndUploadICDCInfo:function(){return{type:"computeAndUploadICDCInfo",args:void 0}},handleSpamMsg:function(){return{type:"handleSpamMsg",args:void 0}},uploadRetroactiveThreadsAndMessages:function(){return{type:"uploadRetroactiveThreadsAndMessages",args:void 0}},restoreMessagesFromEncryptedBackups:function(a,b,c,d,e){return{type:"restoreMessagesFromEncryptedBackups",args:{transportKey:a,threadId:b,messages:c,hasMoreBefore:d,hasMoreAfter:e}}},restoreThreadsFromEncryptedBackups:function(a,b){return{type:"restoreThreadsFromEncryptedBackups",args:{transportKey:a,threads:b}}},sendEphemeralSettingMsg:function(a,c,d){return{type:"sendEphemeralSettingMsg",args:{chatJid:a,args:c,externalId:(a=d)!=null?a:b()}}},updateBackupEntFbidForMedia:function(a,b){return{type:"updateBackupEntFbidForMedia",args:{deliveryObjectId:a,backupEntFbid:b}}},backupMessageWithMedia:function(a,b){return{type:"backupMessageWithMedia",args:{deliveryObjectId:a,backupEntFbid:b}}},downloadAndRestoreMedia:function(a,b){return{type:"downloadAndRestoreMedia",args:{deliveryObjectId:a,restorationCdnUrl:b}}},sendGroupInviteMsg:function(a,c){return{type:"sendGroupInviteMsg",args:{args:a,externalId:(a=c)!=null?a:b()}}}}};b=a({generateExternalId:function(){return d("WAGlobals").getDependencies().generateExternalId()}});g.createJobSerializers=a;g.jobSerializers=b}),98);
__d("WADevToolMessageChannel",[],(function(a,b,c,d,e,f){a=new MessageChannel();b=a.port1;c=a.port2;f.devToolMessageChannelPort1=b;f.devToolMessageChannelPort2=c}),66);
__d("WATypedArraysCast",["WABase64"],(function(a,b,c,d,e,f,g){function a(a,b){if(b instanceof a)return b;return typeof b==="string"?new a(d("WABase64").decodeB64(b)):new a(b)}g.castTypedArrays=a}),98);
__d("WATypedArraysConcat",[],(function(a,b,c,d,e,f){function a(a,b){var c=b.reduce(function(a,b){return a+b.length},0),d=new a(c),e=0;b.forEach(function(a){d.set(a,e),e+=a.length});return d}f.concatTypedArrays=a}),66);
__d("WACryptoAesCbc",["Promise","WABinary","WATypedArraysCast","WATypedArraysConcat","regeneratorRuntime"],(function(a,b,c,d,e,f,g){var h=16,i=1024,j=16;f=1024*1024;var k=h*f;f=function(){function a(a,b,c,d){this.$4=null;this.$6=!1;this.$1=a;this.$2=b;this.$3=c;var e={name:"AES-CBC",iv:d};this.$5=self.crypto.subtle.importKey("raw",c,"AES-CBC",!1,[b]).then(function(a){return{algo:e,key:a}})}var b=a.prototype;b.append=function(a){var b=this;this.$7("append");var c=this.$4;if(c){c.writeByteArray(a);if(c.size()>i){var e=c.size()%h;e=c.readByteArray(c.size()-e);c.size()||(this.$4=null)}else e=null}else if(a.length>i){c=a.length%h;!c?e=a:(this.$4=new(d("WABinary").Binary)(a),e=this.$4.readByteArray(a.length-c))}else this.$4=new(d("WABinary").Binary)(a),e=null;var f=e;f&&(this.$5=this.$5.then(function(a){var c=a.key;a=a.algo;if(b.$2==="encrypt")return self.crypto.subtle.encrypt(a,c,f).then(function(a){b.$1.writeByteArray(new Uint8Array(a,0,a.byteLength-h));return new Uint8Array(a,a.byteLength-2*h,h)});else{var d=f.slice(-h);return self.crypto.subtle.decrypt(a,c,f).then(function(a){b.$1.writeBuffer(a);return d})}}).then(function(a){var c={name:"AES-CBC",iv:a};return self.crypto.subtle.importKey("raw",b.$3,"AES-CBC",!1,[b.$2]).then(function(a){return{algo:c,key:a}})}));return this.$5.then(function(){})};b.finalize=function(a){var b=this;this.$7("finalize");var c;this.$4?(a&&this.$4.writeByteArray(a),c=this.$4.readByteArray(),this.$4=null):a&&(c=a);if(c){var d=c;return this.$5.then(function(a){var c=a.algo;a=a.key;if(b.$2==="encrypt")return self.crypto.subtle.encrypt(c,a,d);else return self.crypto.subtle.decrypt(c,a,d)}).then(function(a){b.$1.writeBuffer(a)})}else return this.$5.then(function(){})};b.$7=function(a){if(this.$6)throw new Error("AesCbcStream."+a+" called after finalize")};return a}();function l(a){return{name:"AES-CBC",iv:d("WATypedArraysCast").castTypedArrays(Uint8Array,a)}}function m(a){return self.crypto.subtle.importKey("raw",d("WATypedArraysCast").castTypedArrays(Uint8Array,a),"AES-CBC",!1,["encrypt"])}function n(a){if(a)return d("WATypedArraysCast").castTypedArrays(Uint8Array,a);a=new Uint8Array(j);self.crypto.getRandomValues(a);return a}function o(a){a=a.byteLength;var b=h-a%h;return Number.isNaN(b)?a:a+b}function p(a,c,e){var f=l(c);return b("Promise").resolve(self.crypto.subtle.importKey("raw",d("WATypedArraysCast").castTypedArrays(Uint8Array,a),"AES-CBC",!1,["decrypt"])).then(function(a){return self.crypto.subtle.decrypt(f,a,e)})}function a(a,c){return b("Promise").resolve().then(function(){var b=c.slice(0,j),d=c.slice(j);return p(a,b,d)})}function c(a,c,e){return b("Promise").resolve().then(function(){var f=n(e),g=l(f);return b("Promise").resolve(m(a)).then(function(a){return self.crypto.subtle.encrypt(g,a,c)}).then(function(a){return d("WATypedArraysConcat").concatTypedArrays(Uint8Array,[f,new Uint8Array(a)]).buffer})})}function e(a,c,d,e){var f,g,i,j,p,q,r,s,t,u;return b("regeneratorRuntime").async(function(v){while(1)switch(v.prev=v.next){case 0:e===void 0&&(e=k);if(!(e%h!==0)){v.next=3;break}throw new Error("chunkSize must be a multiple of "+h+", "+e+" received");case 3:v.next=5;return b("regeneratorRuntime").awrap(m(a));case 5:f=v.sent,g=new Uint8Array(c),i=Math.ceil(g.byteLength/e),j=n(d),p=new Uint8Array(o(g)+j.byteLength),p.set(j),q=function(a,c,d,k){var m,n;return b("regeneratorRuntime").async(function(o){while(1)switch(o.prev=o.next){case 0:m=a===i-1;n=a*e;d=g.subarray(n,n+e);o.next=5;return b("regeneratorRuntime").awrap(self.crypto.subtle.encrypt(l(c),f,d).then(function(a){return m?new Uint8Array(a):new Uint8Array(a).subarray(0,-h)}));case 5:k=o.sent,p.set(k,j.byteLength+a*e),c=k.slice(-h),s=c,t=d,u=k;case 11:case"end":return o.stop()}},null,this)},(r=0,s=j);case 13:if(!(r<i)){v.next=19;break}v.next=16;return b("regeneratorRuntime").awrap(q(r,s,t,u));case 16:r++;v.next=13;break;case 19:return v.abrupt("return",p.buffer);case 20:case"end":return v.stop()}},null,this)}g.AesCbcStream=f;g.aesCbcDecrypt=p;g.aesCbcDecryptSplit=a;g.aesCbcEncrypt=c;g.aesCbcEncryptWithChunking=e}),98);
__d("WACryptoHmac",["WATypedArraysCast"],(function(a,b,c,d,e,f,g){var h=32,i=new Uint8Array(h),j={name:"HMAC",hash:"SHA-256"},k={name:"HMAC",hash:"SHA-512"},l={name:"HMAC",hash:"SHA-1"};function m(a,b){b=d("WATypedArraysCast").castTypedArrays(Uint8Array,b);return self.crypto.subtle.importKey("raw",b,a,!1,["sign"]).then(function(b){return{key:b,algo:a}})}function a(a){return m(j,a)}function n(a,b,c){var d=a.key;a=a.algo;return self.crypto.subtle.sign(a,d,b).then(function(a){return c!=null&&c!==0?a.slice(0,c):a})}function b(a,b){return m(j,a!=null?a:i).then(function(a){return n(a,b)})}function c(a,b,c){return m(j,a).then(function(a){return n(a,b,c)})}function e(a,b,c){return m(k,a).then(function(a){return n(a,b,c)})}function f(a,b,c){return m(l,a).then(function(a){return n(a,b,c)})}g.SHA256_BYTE_LENGTH=h;g.DEFAULT_SALT=i;g.encodeKeySha256=a;g.sign=n;g.extractSha256=b;g.hmacSha256=c;g.hmacSha512=e;g.hmacSha1=f}),98);
__d("WACryptoHkdf",["Promise","WABinary","WACryptoHmac"],(function(a,b,c,d,e,f,g){var h=255*d("WACryptoHmac").SHA256_BYTE_LENGTH;function i(a,c,e){if(e<0||e>h)return b("Promise").reject(new Error("HKDF::expand given bad length "+e));var f,g=Math.ceil(e/d("WACryptoHmac").SHA256_BYTE_LENGTH),i=d("WABinary").Binary.build(c).readByteArray(),j=new(d("WABinary").Binary)(),k=d("WACryptoHmac").encodeKeySha256(a).then(function(a){f=a;return new Uint8Array(0)});c=function(a){k=k.then(function(b){return d("WACryptoHmac").sign(f,d("WABinary").Binary.build(b,i,a).readByteArray())}).then(function(a){a=new Uint8Array(a);j.writeByteArray(a);return a})};for(var a=1;a<=g;a++)c(a);return k.then(function(){return j.readBuffer(e)})}function a(a,b,c){return d("WACryptoHmac").extractSha256(null,a).then(function(a){return i(new Uint8Array(a),b,c)})}function c(a,b,c,e){return d("WACryptoHmac").extractSha256(b,a).then(function(a){return i(new Uint8Array(a),c,e)})}g.expand=i;g.extractAndExpand=a;g.extractWithSaltAndExpand=c}),98);
__d("WAConcurrentIterate",["Promise","regeneratorRuntime"],(function(a,b,c,d,e,f){function a(a,c,d){var e=[],f=[],g=0,h=function(){var d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:if(!(g<a)){e.next=8;break}d=g;g++;e.next=5;return b("regeneratorRuntime").awrap(c(d));case 5:f[d]=e.sent;e.next=0;break;case 8:case"end":return e.stop()}},null,this)};d=Math.min(a,d);for(var i=0;i<d;i++)e.push(h());return b("Promise").all(e).then(function(){return f})}f.concurrentIterate=a}),66);
__d("WAMediaCryptoSidecar",["WAConcurrentIterate","WACryptoHmac"],(function(a,b,c,d,e,f,g){function a(a){return a==="video"}function b(a){return a}var h=16,i=10,j=64*1024;function c(a,b,c){c===void 0&&(c=1);var e=b.buffer.byteLength;e=Math.ceil((e-h)/j);var f=new Uint8Array(i*e);return d("WAConcurrentIterate").concurrentIterate(e,function(c){var e=c*j,g=e+h+j;e=b.subarray(e,g);return d("WACryptoHmac").sign(a,e).then(function(a){a=new Uint8Array(a,0,i);f.set(a,c*i)})},c).then(function(){return f.buffer})}g.shouldHaveStreamingSidecar=a;g.castToStreamingSidecar=b;g.calculateStreamingSidecar=c}),98);
__d("WAMediaCrypto",["Promise","WABase64","WABinary","WACryptoAesCbc","WACryptoHkdf","WACryptoHmac","WACustomError","WAErr","WAMediaCryptoSidecar","WAMediaUtils","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=new Uint8Array(32);self.crypto.getRandomValues(a);return a.buffer}function a(a){return a}function e(){return h()}function f(a){return a}var i={image:"WhatsApp Image Keys",sticker:"WhatsApp Image Keys",video:"WhatsApp Video Keys",gif:"WhatsApp Video Keys",audio:"WhatsApp Audio Keys",ptt:"WhatsApp Audio Keys"},j=d("WACustomError").customError("HmacValidationError",!1);function k(a){switch(a){case"image":case"xma-image":return"image";case"sticker":return"sticker";case"video":return"video";case"gif":return"gif";case"audio":return"audio";case"ptt":return"ptt";default:throw c("WAErr")("Unexpected media type with no KEY_SALT")}}function l(a,b){b=i[k(b)];return d("WACryptoHkdf").extractAndExpand(new Uint8Array(a),b,112).then(function(a){return{iv:new Uint8Array(a,0,16),cipherKey:new Uint8Array(a,16,32),hmacKey:new Uint8Array(a,48,32),refKey:new Uint8Array(a,80,32)}})}var m=16,n=16,o=10,p=64*1024;function q(a,c,e,f,g){var h,i,j,k,l,q,r,s,t,u,v,w,x,y,z;return b("regeneratorRuntime").async(function(A){while(1)switch(A.prev=A.next){case 0:h=new(d("WABinary").Binary)(),h.ensureCapacity(n+f.size+m+o),h.writeByteArray(c),i=new(d("WACryptoAesCbc").AesCbcStream)(h,"encrypt",a,c),j=0,k=j+p;case 6:if(!(k<f.size)){A.next=17;break}l=f.slice(j,k);A.next=10;return b("regeneratorRuntime").awrap(d("WAMediaUtils").blobToArrayBuffer(l));case 10:q=A.sent;A.next=13;return b("regeneratorRuntime").awrap(i.append(new Uint8Array(q)));case 13:j=k;k+=p;A.next=6;break;case 17:A.next=19;return b("regeneratorRuntime").awrap(d("WAMediaUtils").blobToArrayBuffer(f.slice(j)));case 19:r=A.sent;A.next=22;return b("regeneratorRuntime").awrap(i.finalize(new Uint8Array(r)));case 22:s=h.peek(function(a){return a.readByteArray()});A.next=25;return b("regeneratorRuntime").awrap(d("WACryptoHmac").encodeKeySha256(e));case 25:t=A.sent;A.next=28;return b("regeneratorRuntime").awrap(d("WACryptoHmac").sign(t,s));case 28:u=A.sent;h.writeByteArray(new Uint8Array(u,0,o));v=h.readByteArray();w=v.subarray(n);A.next=34;return b("regeneratorRuntime").awrap(b("Promise").all([self.crypto.subtle.digest("SHA-256",w),d("WAMediaCryptoSidecar").shouldHaveStreamingSidecar(g)?d("WAMediaCryptoSidecar").calculateStreamingSidecar(t,v):void 0]));case 34:x=A.sent;y=x[0];z=x[1];return A.abrupt("return",{ciphertext:w,ciphertextHash:y,sidecar:z});case 38:case"end":return A.stop()}},null,this)}function r(a,c,e,f,g){var h,i,k,l,m;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:if(10<=g.length&&g.length<=32){n.next=2;break}throw new j("Bad hmac size "+g.length);case 2:h=d("WABinary").Binary.build(c,e).readByteArray();n.next=5;return b("regeneratorRuntime").awrap(d("WACryptoHmac").hmacSha256(f,h).then(function(a){return new Uint8Array(a)}));case 5:i=n.sent;k=i.slice(0,g.length);if(s(k,g)){n.next=9;break}throw new j("hmacAndDecrypt hmac mismatch");case 9:n.next=11;return b("regeneratorRuntime").awrap(d("WACryptoAesCbc").aesCbcDecrypt(a,c,e));case 11:l=n.sent;n.next=14;return b("regeneratorRuntime").awrap(self.crypto.subtle.digest("SHA-256",l));case 14:m=n.sent;return n.abrupt("return",{plaintextHash:d("WABase64").encodeB64UrlSafe(new Uint8Array(m)),plaintext:l});case 16:case"end":return n.stop()}},null,this)}function s(a,b){if(a.length!==b.length)return!1;var c=1,d=a.length;for(var e=0;e<d;e++)c&=a[e]===b[e]?1:0;return c!==0}g.createMediaKey=h;g.castToMediaKey=a;g.createUploadToken=e;g.castToUploadToken=f;g.HmacValidationError=j;g.computeMediaKeys=l;g.HMAC_LENGTH=o;g.encryptAndHmac=q;g.hmacAndDecrypt=r}),98);
__d("WALongInt",["WAHex","WALogger"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(['"','" is over 64 bits']);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(['"','" is not a valid decimal string']);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([""," is not a safe integer"]);j=function(){return a};return a}function k(a){if(typeof a!=="number"){d("WALogger").LOG(j(),a).color("red");throw new Error("numberOrThrowIfTooLarge is given a non-safe integer")}return a}e=function(a){return a==null?a:k(a)};function a(a,b){if(typeof a==="number"&&typeof b==="number")return a>b;a=typeof a==="number"?d("WAHex").hexLongFromNumber(a):a;b=typeof b==="number"?d("WAHex").hexLongFromNumber(b):b;return d("WAHex").isBiggerHexLong(a,b)}function b(a){if(typeof a==="number")return a.toString(10);var b=d("WAHex").hexLongToHex(a),c=[0],e=0;for(var f=0;f<b.length;f++){e=d("WAHex").hexAt(b,f);for(var g=0;g<c.length;g++)c[g]=c[g]*16+e,e=c[g]/10|0,c[g]%=10;while(e>0)c.push(e%10),e=e/10|0}g=c.reverse().join("");return d("WAHex").hexLongIsNegative(a)?"-"+g:g}function c(a){if(!/^-?\d+$/.test(a)){d("WALogger").LOG(i(),a).color("red");throw new Error("decimalStringToLongInt is given an invalid decimal string")}var b=a[0]==="-",c=a.replace(/^-?0*/,""),e=c.length;if(e<16||e===16&&c<="9007199254740991")return b?-Number(c):Number(c);if(e>20||e===20&&c>"18446744073709551615"||b&&(e>19||e===19&&c>"9223372036854775807")){d("WALogger").LOG(h(),a).color("red");throw new Error("decimalStringToHexLong is given value over 64 bits")}a=0;var f=0;for(var g=0;g<e;g++)a=a*10+Number(c[g]),f=f*10+Math.floor(a/4294967296),a=a%4294967296;return d("WAHex").createHexLongFrom32Bits(f,a,b)}g.numberOrThrowIfTooLarge=k;g.maybeNumberOrThrowIfTooLarge=e;g.isBiggerLongInt=a;g.longIntToDecimalString=b;g.decimalStringToLongInt=c}),98);
__d("WAMediaEntryData.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.internalSpec={fileSha256:[1,d("WAProtoConst").TYPES.BYTES],mediaKey:[2,d("WAProtoConst").TYPES.BYTES],fileEncSha256:[3,d("WAProtoConst").TYPES.BYTES],directPath:[4,d("WAProtoConst").TYPES.STRING],mediaKeyTimestamp:[5,d("WAProtoConst").TYPES.INT64],serverMediaType:[6,d("WAProtoConst").TYPES.STRING],uploadToken:[7,d("WAProtoConst").TYPES.BYTES],validatedTimestamp:[8,d("WAProtoConst").TYPES.BYTES],sidecar:[9,d("WAProtoConst").TYPES.BYTES],objectId:[10,d("WAProtoConst").TYPES.STRING],fbid:[11,d("WAProtoConst").TYPES.STRING]};g.MediaEntrySpec=a}),98);
__d("WAServerMediaType",[],(function(a,b,c,d,e,f){b=["image","sticker","ptt","audio","document","video","gif","ppic","md-app-state","md-msg-hist","kyc-id","template","thumbnail-image","thumbnail-video","thumbnail-gif","thumbnail-document","thumbnail-link","payment-bg-image","novi-video","novi-image","product","product-catalog-image","xma-image","biz-cover-photo"];function a(a){switch(a){case"image":case"sticker":case"ptt":case"audio":case"document":case"video":case"gif":case"ppic":case"md-app-state":case"md-msg-hist":case"kyc-id":case"thumbnail-image":case"thumbnail-video":case"thumbnail-gif":case"thumbnail-document":case"thumbnail-link":case"payment-bg-image":case"novi-video":case"novi-image":case"template":case"product":case"product-catalog-image":case"xma-image":case"biz-cover-photo":return a;default:return null}}f.SERVER_MEDIA=b;f.castToServerMediaType=a}),66);
__d("WAMediaUtils",["Promise","WABase64","WAErr","WALongInt","WAMediaCrypto","WAMediaCryptoSidecar","WAMediaEntryData.pb","WAServerMediaType","WATimeUtils","decodeProtobuf","encodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return d("WABase64").encodeB64UrlSafe(a)}function e(a){return a}function f(a){return a}function h(a){return a}function i(a){return a}function j(a,b){a=d("decodeProtobuf").decodeProtobuf(d("WAMediaEntryData.pb").MediaEntrySpec,b);b=a.fileSha256;var c=a.mediaKey,e=a.fileEncSha256,f=a.directPath,g=a.mediaKeyTimestamp,h=a.sidecar,i=a.objectId;a=a.fbid;return{fileSha256:b,mediaKey:c,fileEncSha256:e,directPath:f,mediaKeyTimestamp:g==null?null:d("WATimeUtils").castToUnixTime(d("WALongInt").numberOrThrowIfTooLarge(g)),sidecar:h&&d("WAMediaCryptoSidecar").castToStreamingSidecar(h),objectId:i,fbid:a}}function k(a,b,c,e,f,g,h,i){a=d("encodeProtobuf").encodeProtobuf(d("WAMediaEntryData.pb").MediaEntrySpec,{fileSha256:a,fileEncSha256:b,mediaKey:c,directPath:e,mediaKeyTimestamp:f,serverMediaType:g,objectId:h,fbid:i});return a.readByteArray()}function l(a){return d("encodeProtobuf").encodeProtobuf(d("WAMediaEntryData.pb").MediaEntrySpec,a).readByteArray()}function m(a){return d("encodeProtobuf").encodeProtobuf(d("WAMediaEntryData.pb").MediaEntrySpec,a).readByteArray()}function n(a,b){return d("encodeProtobuf").encodeProtobuf(d("WAMediaEntryData.pb").MediaEntrySpec,babelHelpers["extends"]({directPath:b},a)).readByteArray()}function o(a){a=d("decodeProtobuf").decodeProtobuf(d("WAMediaEntryData.pb").MediaEntrySpec,a);var b=a.serverMediaType,c=a.mediaKey,e=a.mediaKeyTimestamp,f=a.uploadToken;a=babelHelpers.objectWithoutPropertiesLoose(a,["serverMediaType","mediaKey","mediaKeyTimestamp","uploadToken"]);return babelHelpers["extends"]({},a,{serverMediaType:b==null?null:d("WAServerMediaType").castToServerMediaType(b),mediaKey:c&&d("WAMediaCrypto").castToMediaKey(c),mediaKeyTimestamp:e==null?null:d("WATimeUtils").castToUnixTime(d("WALongInt").numberOrThrowIfTooLarge(e)),uploadToken:f&&d("WAMediaCrypto").castToUploadToken(f)})}function p(a){return"arrayBuffer"in a&&typeof a.arrayBuffer==="function"?a.arrayBuffer():new(b("Promise"))(function(b,d){var e=new FileReader();e.onload=function(){var a=e.result;a instanceof ArrayBuffer?b(a):d(c("WAErr")("blobToArrayBuffer got error becaues result is not ArrayBuffer"))};e.onerror=function(){d(e.error)};e.readAsArrayBuffer(a)})}function q(a){var b="image/jpeg";switch(a){case"image":b="image/jpeg";break;case"ptt":b="audio/wav";break;case"video":b="video/mp4";break;case"gif":b="image/gif";break;case"sticker":b="image/webp";break;default:throw c("WAErr")("Unsupported server media type: "+a)}return b}g.toPlaintextHash=a;g.stringToPlaintextHash=e;g.toHashedPlaintextHash=f;g.stringToDeliveryObjectId=h;g.stringToBackupEntFbid=i;g.mediaEntryDataToRawData=j;g.rawDataToMediaEntry=k;g.encodeMediaEntryForUpload=l;g.encodeMediaEntryForDownload=m;g.encodeMediaEntryWithUpdatedPath=n;g.decodeMediaEntryData=o;g.blobToArrayBuffer=p;g.getMimeTypeFromServerMediaType=q}),98);
__d("WAPREList",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({DECRYPT_MESSAGE_FINAL:"decrypt_message_final",FRANKING_VALIDATION:"franking_validation",GET_DEVICES:"get_devices",MEDIA_UPLOAD:"media_upload",MESSAGE_DECRYPTION:"message_decryption",MESSAGE_ENCRYPTION:"message_encryption",OFFLINE_QUEUE:"offline_queue",OFFLINE_RETRY:"offline_retry",QUERY_GROUP:"query_group",QUERY_GROUPS:"query_groups",RETRY_RECEIPTS_SENT:"retry_receipts_sent",SAVE_SESSION_RETRIES:"save_session_retries",SAVE_SIGNAL_SESSION_RETRIES:"save_signal_session_retries",SYNCD_FATAL_ERROR:"syncd_fatal_error",SYNCD_CRITICAL_EVENT:"syncd_critical_event",APP_STATE_SYNC_DAILY:"app_state_sync_daily"});f.PRE_METRIC=a}),66);
__d("WAPREMetrics",["WALogger"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[PRE] "," ends with an error ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[PRE] "," ends successfully"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[PRE] add point "," to ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[PRE] start ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[PRE] There are no subscribers to PRE events"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Removing all listeners from PRE_METRICS"]);m=function(){return a};return a}var n=0;function a(){var b=[];function c(a){b.push(a)}function e(){d("WALogger").WARN(m()),b.length=0}function a(a){b.length===0&&d("WALogger").ERROR(l()),b.forEach(function(b){b(a)})}return{subscribe:c,notify:a,clear:e}}c=a();var o=c.notify;e=c.clear;f=c.subscribe;function b(a,b){n++;var c=n;o({name:a,stage:"START",instanceKey:c,annotations:b});d("WALogger").DEV(k(),a);return{addPoint:function(e,b){o({name:a,stage:"POINT",reason:e,instanceKey:c,annotations:b}),d("WALogger").DEV(j(),e,a)},endSuccess:function(b){o({name:a,stage:"SUCCESS",instanceKey:c,annotations:b}),d("WALogger").DEV(i(),a)},endFail:function(e,b){o({name:a,stage:"FAIL",reason:e,instanceKey:c,annotations:b}),d("WALogger").DEV(h(),a,e)}}}g.clear=e;g.subscribe=f;g.startMetric=b}),98);
__d("WAOfflineQueueStats",["WALogger","WAPREList","WAPREMetrics","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["OfflineStats::"," called before startOfflineStats or after completion"]);h=function(){return a};return a}[50,100,200,400,600,800,1e3];var i=null;function a(a){if(i)return;i=new n(a)}function b(){var a;return(a=(a=j("completeOfflineStats"))==null?void 0:a.getStartTime())!=null?a:0}function c(a){var b=j("completeOfflineStats");if(b==null)return;b.complete(a);a=b.stats();i=null;return a}function j(a){if(i)return i;else{d("WALogger").LOG(h(),a);return null}}function e(a){var b;(b=i)==null?void 0:b.measureDbStart(a)}function f(a){var b;(b=i)==null?void 0:b.measureDbEnd(a)}function k(){var a;(a=i)==null?void 0:a.measureCryptoStart()}function l(){var a;(a=i)==null?void 0:a.measureCryptoEnd()}function m(a){var b;(b=i)==null?void 0:b.measureMaxOffline(a)}var n=function(){function a(a){this.$1=[],this.$3=0,this.$5=0,this.$6=0,this.$7=0,this.$8=0,this.$9=0,this.$10=0,this.$4=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.OFFLINE_QUEUE),this.$9=d("WATimeUtils").performanceAbsoluteNow(),this.$2=a}var b=a.prototype;b.complete=function(a){a={"int":babelHelpers["extends"]({},this.$2,{processedStanzasCount:a,dbTiming:this.$8,cryptoTiming:this.$6,maxOffline:this.$10})};this.$4.endSuccess(a)};b.stats=function(){return{count:this.$2.count,stanzas:this.$2}};b.measureCryptoStart=function(){this.$5=d("WATimeUtils").performanceAbsoluteNow()};b.measureCryptoEnd=function(){this.$6=this.$6+d("WATimeUtils").performanceAbsoluteNow()-this.$5};b.measureDbStart=function(a){this.$7=a};b.measureDbEnd=function(a){this.$8=a-this.$7};b.measureMaxOffline=function(a){this.$10=Math.max(this.$10,a)};b.getStartTime=function(){return this.$9};return a}();g.startOfflineStats=a;g.getStartTime=b;g.completeOfflineStats=c;g.maybeMeasureDBStart=e;g.maybeMeasureDbEnd=f;g.maybeMeasureCryptoStart=k;g.maybeMeasureCryptoEnd=l;g.maybeUpdateMaxOffline=m}),98);
__d("WAArmadilloICDC.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};a.internalSpec={seq:[1,d("WAProtoConst").TYPES.INT32],timestamp:[2,d("WAProtoConst").TYPES.INT64],devices:[3,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.BYTES],signingDeviceIndex:[4,d("WAProtoConst").TYPES.INT32]};b.internalSpec={details:[1,d("WAProtoConst").TYPES.BYTES],signature:[2,d("WAProtoConst").TYPES.BYTES]};g.ICDCIdentityListSpec=a;g.SignedICDCIdentityListSpec=b}),98);
__d("WAShiftTimer",[],(function(a,b,c,d,e,f){a=function(){function a(a){var b=this;this.$2=0;this.$3=0;this.ts=0;this.$4=0;this.$5=0;this.$6=0;this.$7=void 0;this.$8=function(){var a=b.$7,c=b.$1;b.$3=0;b.$2=0;b.ts=0;b.$4=0;b.$5=0;b.$6=0;b.$7=void 0;c(a)};this.onOrBefore=function(a,c){g(a);var d=Date.now();d=d+a;var e=b.$5;if(e!==0&&e<d)return;e=b.$6;if(e!==0&&d<e)return;b.$5=d;!b.$3&&(!b.$2||d<b.ts)&&b.$9(d,a,c)};this.forceRunNow=function(a){b.$2&&clearTimeout(b.$2),b.$3&&cancelAnimationFrame(b.$3),b.$7=a,b.$8()};this.cancel=function(){b.$2&&clearTimeout(b.$2),b.$3&&cancelAnimationFrame(b.$3),b.$2=0,b.$3=0,b.ts=0,b.$4=0,b.$5=0,b.$6=0,b.$7=void 0};this.$1=a}var b=a.prototype;b.onOrBeforeRepaint=function(a){if(this.$3)return;var b=Date.now(),c=this.$6;if(c!==0&&b<c)return;c=this.$5;(c===0||b<c)&&(this.$5=b);this.$2&&(clearTimeout(this.$2),this.$2=0);(!this.ts||this.ts>b)&&(this.ts=b);this.$7=a;this.$3=requestAnimationFrame(this.$8)};b.onOrAfter=function(a,b){g(a);var c=Date.now();c=c+a;var d=this.$6;if(d!==0&&c<d)return;d=this.$5;if(d!==0&&d<c)return;this.$6=c;(!this.$2||this.ts<c)&&this.$9(c,a,b)};b.debounce=function(a,b){g(a),this.$10(Date.now(),a,b)};b.debounceAndCap=function(a,b,c){g(a);g(b);var d=Date.now();b=d+b;var e=this.$6,f=this.$5;(e===0||e<=b)&&(f===0||b<f)&&(this.$5=b);this.$10(d,a,c)};b.forceRunNowIfScheduled=function(){this.$2?(clearTimeout(this.$2),this.$8()):this.$3&&(cancelAnimationFrame(this.$3),this.$8())};b.isScheduled=function(){return this.$2!==0||this.$3!==0};b.$10=function(a,b,c){var d=a+b,e=this.$6;if(e!==0&&d<e)return;e=this.ts;var f=this.$5;f!==0&&f<d?e<f&&this.$9(f,f-a,c):e<d&&this.$9(d,b,c)};b.$9=function(a,b,c){this.$3&&(cancelAnimationFrame(this.$3),this.$3=0);this.$7=c;this.ts=a;if(this.$2){c=a-this.$4;if(-16<c&&c<16)return;clearTimeout(this.$2)}this.$2=setTimeout(this.$8,b);this.$4=a};return a}();function g(a){if(!(a>=0))throw new Error("ShiftTimer must be given delay >= 0")}f.ShiftTimer=a}),66);
__d("WABridgeBatcher",["WAShiftTimer"],(function(a,b,c,d,e,f,g){var h=20,i=1e3;a=function(){function a(a,b){var c=this;this.$1=null;this.$4=h;this.$5=Date.now();this.$6=new(d("WAShiftTimer").ShiftTimer)(function(){var a=c.$1;if(a==null)return;c.$1=null;c.$2(a)});this.$2=b;this.$3=a}var b=a.prototype;b.addEvent=function(a){var b=this.$1;this.$1=b?this.$3(b,a):[a];if(this.$6.isScheduled())return;b=this.$4;if(b<1){a=Date.now();var c=Math.max(a-this.$5,0)/i;b=Math.min(b+c,h);this.$4=b;this.$5=a}b>=1?(c=0,this.$4=b-1):(c=Math.ceil(i*(1-b)),this.$4=0);this.$6.onOrBefore(c)};b.cancel=function(){this.$1=null,this.$6.cancel()};return a}();g.BridgeBatcher=a}),98);
__d("WAPromiseCallSync",["Promise"],(function(a,b,c,d,e,f){function a(a,c){try{for(var d=arguments.length,e=new Array(d>2?d-2:0),f=2;f<d;f++)e[f-2]=arguments[f];return b("Promise").resolve(a.apply(c,e))}catch(a){return b("Promise").reject(a)}}f.promiseCallSync=a}),66);
__d("WAPromiseManagement",["Promise","WAPromiseCallSync"],(function(a,b,c,d,e,f,g){function a(a){var b=null,c=function(){b||(b=d("WAPromiseCallSync").promiseCallSync(a)["finally"](function(){b=null}));return b};c.isPending=function(){return!!b};return c}function c(a,c){var d=new Map();return function(e){var f=a(e),g=d.get(f);if(g)return g;try{g=b("Promise").resolve(c(e))}catch(a){g=b("Promise").reject(a)}e=g["finally"](function(){return void d["delete"](f)});d.set(f,e);return e}}var h=new Set();function e(a){h.add(a),a["finally"](function(){h["delete"](a)})}g.nullaryCacheWhilePending=a;g.cacheWhilePending=c;g.preventGarbageCollection=e}),98);
__d("WACrossWorkerPortal",["Promise","WABridgeBatcher","WALogger","WAPromiseManagement"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["absorbPortal: transferring request #",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bridge unexpected non-result to call"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bridge unexpected result to cast"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bridge unrecognized result ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bridge "," response of ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bridge "," request for ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bridge queuing "," msgs"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bridge sending "," across (delayed)"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bridge received msg on old port"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bridge updating port"]);q=function(){return a};return a}var r=function(){function a(a,b,c){var e=this;this.port=null;this.$2=1;this.openRequests=new Map();this.$1=a;this.sendStream=new(d("WABridgeBatcher").BridgeBatcher)(b,function(a){e.$3(a)});c.forEach(function(b){a.setNamespaceHandler(b,e.$4(b))})}var c=a.prototype;c.setPort=function(a){var b=this;d("WALogger").LOG(q());this.port=a;this.sendStream.cancel();a.onmessage=function(c){if(b.port!==a){d("WALogger").WARN(p()).devConsole(c.data);return}c=c.data;if(!c)return;c.forEach(function(c){return b.$5(a,c)})};this.openRequests.forEach(function(a){a=a.request;d("WALogger").LOG(o(),a.name);b.sendStream.addEvent({type:"request",content:a})})};c.getBridge=function(){return this.$1};c.$4=function(a){var b=this;return function(c,d,e,f){b.$6(a,c,d,e,f)}};c.$6=function(a,b,c,d,e){var f=this.$2++;a={requestId:f,expectsResponse:!!d,namespace:a,name:b,arg:c,silentLog:e};this.openRequests.set(f,{request:a,resolver:d});this.sendStream.addEvent({type:"request",content:a})};c.$7=function(a,b){if(a!==this.port)return;this.sendStream.addEvent({type:"result",content:b})};c.$3=function(a){var b=this.port;if(!b){d("WALogger").LOG(n(),a.length);return}b.postMessage(a)};c.$5=function(a,c){var e=this;if(c.type==="request"){var f=c.content,g=f.namespace,h=f.name,n=f.requestId,o=f.arg,p=f.expectsResponse,q=f.silentLog;q||d("WALogger").LOG(m(),n,h);f=this.$1;if(p){p=f.sendAndReceive(g,h,o,q).then(function(b){e.$7(a,{requestId:n,type:"success",result:b,silentLog:q})},function(b){e.$7(a,{requestId:n,type:"error",result:String(b),silentLog:q})});d("WAPromiseManagement").preventGarbageCollection(p)}else f.fireAndForget(g,h,o,q),a.postMessage([{type:"result",content:{requestId:n,type:"handled",silentLog:q}}])}else{c.type;p=c.content;f=p.requestId;g=p.type;h=p.result;o=p.silentLog;o||d("WALogger").LOG(l(),f,g);c=this.openRequests.get(f);if(!c){d("WALogger").WARN(k(),f);return}switch(g){case"success":case"error":this.openRequests["delete"](f);p=c.resolver;p?p(g==="success"?h:b("Promise").reject(new Error(h))):d("WALogger").ERROR(j());break;case"handled":c.resolver?d("WALogger").ERROR(i()):this.openRequests["delete"](f);break}}};return a}();function a(a,b,c){a=new r(a,c,b);return a}function c(a){var b;(b=a.port)==null?void 0:b.close();a.port=null;a.sendStream.cancel();b=a.openRequests;a.openRequests=new Map();var c=a.getBridge();b.forEach(function(a){var b=a.request;a=a.resolver;var e=b.namespace,f=b.name,g=b.arg,i=b.silentLog;d("WALogger").LOG(h(),b.requestId);a?a(c.sendAndReceive(e,f,g,i)):c.fireAndForget(e,f,g,i)})}g.CrossWorkerPortal=r;g.attachPortal=a;g.killPortalAndSendPendingToBridge=c}),98);
__d("WACryptoEd25519",["WATweetnacl"],(function(a,b,c,d,e,f,g){var h=null;function i(a){var b=h;h=[];try{return a()}finally{((a=h)!=null?a:[]).forEach(function(a){return void a.fill(0)});h=b}}function j(a,b){if(h==null)throw new Error("allocate called outside of active scope");return new a(b)}function a(a,b,c){d("WATweetnacl").lowlevel.crypto_hash(a,b,c)}function b(a,b){for(var c=0;c<64;++c)b[c]=a[c],a[c]=0;l(a,b);b.fill(0)}function c(a,b){var c=[k(),k(),k(),k()];d("WATweetnacl").lowlevel.scalarbase(c,b);Q(a,c)}function k(a){var b=j(Float64Array,16);if(a){if(a.length>16)throw new Error("Incorrect initialiser array provided to the fieldElement");for(var c=0;c<a.length;c++)b[c]=a[c]}return b}function l(a,b){d("WATweetnacl").lowlevel.modL(a,b)}var m=function(){return k([0])},n=function(){return k([1])},o=function(){return k([2])},p=function(){return k([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139])};function q(){return[k(),k(),k(),k()]}function r(){return[k(),k(),k(),k()]}function s(){return[k(),k(),k()]}function t(a,b){var c=0;b=b;while(b>0){var d=b%65536;a[c]=d;b=(b-d)/65536;c++}}function u(a,b){return S(a,b)?0:1}function v(a){var b=d("WATweetnacl").lowlevel.pack25519,c=j(Uint8Array,32);b(c,a);return c[0]&1}function w(a,b){var c=d("WATweetnacl").lowlevel.S,e=d("WATweetnacl").lowlevel.M,f=o(),g=k();c(g,b);e(a,f,g)}function x(a,b){var c=d("WATweetnacl").lowlevel.S,e=d("WATweetnacl").lowlevel.M,f=d("WATweetnacl").lowlevel.A,g=m(),h=n(),i=k(),j=k(),l=k(),o=k();t(g,486662);c(i,b);e(j,g,b);f(l,i,j);f(o,l,h);e(a,b,o)}function y(a,b,c){c===1&&a.set(b)}var z=new Uint8Array([176,160,14,74,39,27,238,196,120,228,47,173,6,24,67,47,167,215,251,61,153,0,77,43,11,223,193,79,128,36,131,43]);function A(a,b){var c=d("WATweetnacl").lowlevel.unpack25519,e=d("WATweetnacl").lowlevel.pow2523,f=d("WATweetnacl").lowlevel.M,g=d("WATweetnacl").lowlevel.S,h=k();c(h,z);c=k();e(c,b);e=k();f(e,b,c);c=k();g(c,e);g=k();f(g,e,h);y(e,g,1^u(c,b));a.set(e)}function B(a,b){var c=d("WATweetnacl").lowlevel.Z,e=d("WATweetnacl").lowlevel.A,f=d("WATweetnacl").lowlevel.M,g=n(),h=k(),i=k(),j=k();c(h,b,g);e(i,b,g);R(j,i);f(a,h,j)}function C(a,b){var c=d("WATweetnacl").lowlevel.Z,e=m();c(a,e,b)}function D(a,b){var c=d("WATweetnacl").lowlevel.M;c(a[0],b[0],b[3]);c(a[1],b[1],b[2]);c(a[2],b[2],b[3])}function E(a,b){var c=d("WATweetnacl").lowlevel.M;c(a[0],b[0],b[3]);c(a[1],b[1],b[2]);c(a[2],b[2],b[3]);c(a[3],b[0],b[1])}function F(a,b){var c=d("WATweetnacl").lowlevel.S,e=d("WATweetnacl").lowlevel.A,f=d("WATweetnacl").lowlevel.Z;c(a[0],b[0]);c(a[2],b[1]);w(a[3],b[2]);e(a[1],b[0],b[1]);b=k();c(b,a[1]);e(a[1],a[2],a[0]);f(a[2],a[2],a[0]);f(a[0],b,a[1]);f(a[3],a[3],a[2])}var G=new Uint8Array([6,126,69,255,170,4,110,204,130,26,125,75,209,211,161,197,126,79,252,3,220,8,123,210,187,6,160,96,244,237,38,15]);function H(a,b,c){var e=d("WATweetnacl").lowlevel.unpack25519,f=d("WATweetnacl").lowlevel.M,g=k();e(g,G);e=k();B(e,b);var h=k();x(h,b);var i=k();A(i,h);h=k();f(h,b,g);b=k();R(b,i);g=k();f(g,h,b);i=k();C(i,g);y(g,i,v(g)^c);a[0].set(g);a[1].set(e);a[2].set(n());f(a[3],a[0],a[1])}function I(a,b){a[0].set(b[0]),a[1].set(b[1]),a[2].set(b[2])}function J(a,b){var c=s();I(c,b);F(a,c)}function K(a,b){var c=r(),d=s();J(c,b);D(d,c);F(c,d);D(d,c);F(c,d);E(a,c)}function L(a){var b=d("WATweetnacl").lowlevel.S,c=d("WATweetnacl").lowlevel.M,e=d("WATweetnacl").lowlevel.pow2523,f=d("WATweetnacl").lowlevel.pack25519,g=k(),h=k(),i=k(),j=k(),l=k();e(g,a);b(h,g);b(i,h);c(j,i,a);c(l,j,a);e=new Uint8Array(32);f(e,l);return 1&e[31]}function M(a,b){C(a[0],b[0]),a[1].set(b[1]),a[2].set(b[2]),C(a[3],b[3])}function e(a,b){var c=q();b=T(c,b);if(b!==0)return-1;M(a,c);return 0}function N(a,b){var c=d("WATweetnacl").lowlevel.M,e=d("WATweetnacl").lowlevel.A;b=b;var f=n(),g=m();t(g,486662);var h=k();w(h,b);b=k();e(b,h,f);h=k();R(h,b);f=k();c(f,h,g);b=k();C(b,f);c=k();x(c,b);h=L(c);f=k([0]);y(f,g,h);c=k();e(c,b,f);g=k();C(g,c);y(c,g,h);a.set(c)}function O(a){var b=d("WATweetnacl").lowlevel.unpack25519;a=d("WATweetnacl").hash(a);var c=(a[31]&128)>>7;a[31]&=127;var e=k();b(e,a);b=k();P(b,e);a=q();H(a,b,c);e=q();K(e,a);return e}function P(a,b){return i(function(){return N(a,b)})}function f(a){return i(function(){return O(a)})}function Q(a,b){var c=k(),e=k(),f=k(),g=d("WATweetnacl").lowlevel.M,h=d("WATweetnacl").lowlevel.pack25519;R(f,b[2]);g(c,b[0],f);g(e,b[1],f);h(a,e);g=new Uint8Array(32);h(g,c);a[31]^=(g[0]&1)<<7}function R(a,b){var c=k();c.set(b);var e=d("WATweetnacl").lowlevel.M,f=d("WATweetnacl").lowlevel.S;for(var g=253;g>=0;--g)f(c,c),g!==2&&g!==4&&e(c,c,b);a.set(c)}function S(a,b){var c=d("WATweetnacl").lowlevel.pack25519,e=d("WATweetnacl").lowlevel.crypto_verify_32,f=new Uint8Array(32),g=new Uint8Array(32);c(f,a);c(g,b);return e(f,0,g,0)}function T(a,b){var c=d("WATweetnacl").lowlevel.set25519,e=d("WATweetnacl").lowlevel.S,f=d("WATweetnacl").lowlevel.M,g=d("WATweetnacl").lowlevel.Z,h=d("WATweetnacl").lowlevel.A,i=d("WATweetnacl").lowlevel.D,j=d("WATweetnacl").lowlevel.unpack25519,l=d("WATweetnacl").lowlevel.pow2523,o=k(),q=k(),r=k(),s=k(),t=k(),u=k(),v=k();c(a[2],n());j(a[1],b);e(r,a[1]);f(s,r,i);g(r,r,a[2]);h(s,a[2],s);e(t,s);e(u,t);f(v,u,t);f(o,v,r);f(o,o,s);l(o,o);f(o,o,r);f(o,o,s);f(o,o,s);f(a[0],o,s);e(q,a[0]);f(q,q,s);S(q,r)&&f(a[0],a[0],p());e(q,a[0]);f(q,q,s);if(S(q,r))return-1;U(a[0])===b[31]>>7&&g(a[0],m(),a[0]);f(a[3],a[0],a[1]);return 0}function U(a){var b=d("WATweetnacl").lowlevel.pack25519,c=new Uint8Array(32);b(c,a);return c[0]&1}g.runInAllocationScope=i;g.allocate=j;g.hashSha512=a;g.reduce=b;g.scalarmultBase=c;g.fieldElement=k;g.modL=l;g.p3Element=q;g.unpack=e;g.elligator=P;g.hashToPoint=f;g.pack=Q;g.inv25519=R;g.unpackneg=T}),98);
__d("WACryptoUtils",["WATweetnacl"],(function(a,b,c,d,e,f,g){function a(a,b){return h(new Uint8Array(a),new Uint8Array(b))}function h(a,b){return a.length===0&&b.length===0||d("WATweetnacl").verify(a,b)}function b(a){if(a!==(a|0))throw new Error("bound must be int32");if(a<=0)throw new Error("bound must not be positive");var b=new Int32Array(1),c=-1>>>1;c=a*Math.floor(c/a);var d=-1;while(d===-1){self.crypto.getRandomValues(b);var e=b[0]>>>1;e<c&&(d=e%a)}return d}g.arrayBuffersEqual=a;g.uint8ArraysEqual=h;g.randomNumberLessThan=b}),98);
__d("WASignalLocalStorageProtocol.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};c={};e={};f={};var h={},i={},j={},k={},l={},m={},n={},o={},p={},q={};a.internalSpec={sessionVersion:[1,d("WAProtoConst").TYPES.UINT32],localIdentityPublic:[2,d("WAProtoConst").TYPES.BYTES],remoteIdentityPublic:[3,d("WAProtoConst").TYPES.BYTES],rootKey:[4,d("WAProtoConst").TYPES.BYTES],previousCounter:[5,d("WAProtoConst").TYPES.UINT32],senderChain:[6,d("WAProtoConst").TYPES.MESSAGE,e],receiverChains:[7,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.MESSAGE,e],pendingKeyExchange:[8,d("WAProtoConst").TYPES.MESSAGE,c],pendingPreKey:[9,d("WAProtoConst").TYPES.MESSAGE,b],remoteRegistrationId:[10,d("WAProtoConst").TYPES.UINT32],localRegistrationId:[11,d("WAProtoConst").TYPES.UINT32],needsRefresh:[12,d("WAProtoConst").TYPES.BOOL],aliceBaseKey:[13,d("WAProtoConst").TYPES.BYTES]};b.internalSpec={preKeyId:[1,d("WAProtoConst").TYPES.UINT32],signedPreKeyId:[3,d("WAProtoConst").TYPES.INT32],baseKey:[2,d("WAProtoConst").TYPES.BYTES]};c.internalSpec={sequence:[1,d("WAProtoConst").TYPES.UINT32],localBaseKey:[2,d("WAProtoConst").TYPES.BYTES],localBaseKeyPrivate:[3,d("WAProtoConst").TYPES.BYTES],localRatchetKey:[4,d("WAProtoConst").TYPES.BYTES],localRatchetKeyPrivate:[5,d("WAProtoConst").TYPES.BYTES],localIdentityKey:[7,d("WAProtoConst").TYPES.BYTES],localIdentityKeyPrivate:[8,d("WAProtoConst").TYPES.BYTES]};e.internalSpec={senderRatchetKey:[1,d("WAProtoConst").TYPES.BYTES],senderRatchetKeyPrivate:[2,d("WAProtoConst").TYPES.BYTES],chainKey:[3,d("WAProtoConst").TYPES.MESSAGE,h],messageKeys:[4,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.MESSAGE,f]};f.internalSpec={index:[1,d("WAProtoConst").TYPES.UINT32],cipherKey:[2,d("WAProtoConst").TYPES.BYTES],macKey:[3,d("WAProtoConst").TYPES.BYTES],iv:[4,d("WAProtoConst").TYPES.BYTES]};h.internalSpec={index:[1,d("WAProtoConst").TYPES.UINT32],key:[2,d("WAProtoConst").TYPES.BYTES]};i.internalSpec={currentSession:[1,d("WAProtoConst").TYPES.MESSAGE,a],previousSessions:[2,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.MESSAGE,a]};j.internalSpec={id:[1,d("WAProtoConst").TYPES.UINT32],publicKey:[2,d("WAProtoConst").TYPES.BYTES],privateKey:[3,d("WAProtoConst").TYPES.BYTES]};k.internalSpec={id:[1,d("WAProtoConst").TYPES.UINT32],publicKey:[2,d("WAProtoConst").TYPES.BYTES],privateKey:[3,d("WAProtoConst").TYPES.BYTES],signature:[4,d("WAProtoConst").TYPES.BYTES],timestamp:[5,d("WAProtoConst").TYPES.FIXED64]};l.internalSpec={publicKey:[1,d("WAProtoConst").TYPES.BYTES],privateKey:[2,d("WAProtoConst").TYPES.BYTES]};m.internalSpec={senderKeyId:[1,d("WAProtoConst").TYPES.UINT32],senderChainKey:[2,d("WAProtoConst").TYPES.MESSAGE,p],senderSigningKey:[3,d("WAProtoConst").TYPES.MESSAGE,n],senderMessageKeys:[4,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.MESSAGE,o]};n.internalSpec={"public":[1,d("WAProtoConst").TYPES.BYTES],"private":[2,d("WAProtoConst").TYPES.BYTES]};o.internalSpec={iteration:[1,d("WAProtoConst").TYPES.UINT32],seed:[2,d("WAProtoConst").TYPES.BYTES]};p.internalSpec={iteration:[1,d("WAProtoConst").TYPES.UINT32],seed:[2,d("WAProtoConst").TYPES.BYTES]};q.internalSpec={senderKeyStates:[1,d("WAProtoConst").FLAGS.REPEATED|d("WAProtoConst").TYPES.MESSAGE,m]};g.SessionStructureSpec=a;g.PendingPreKeySpec=b;g.PendingKeyExchangeSpec=c;g.ChainSpec=e;g.MessageKeySpec=f;g.ChainKeySpec=h;g.RecordStructureSpec=i;g.PreKeyRecordStructureSpec=j;g.SignedPreKeyRecordStructureSpec=k;g.IdentityKeyPairStructureSpec=l;g.SenderKeyStateStructureSpec=m;g.SenderSigningKeySpec=n;g.SenderMessageKeySpec=o;g.SenderChainKeySpec=p;g.SenderKeyRecordStructureSpec=q}),98);
__d("WASignalOther",["WACryptoHkdf","WACryptoUtils","decodeProtobuf","encodeProtobuf"],(function(a,b,c,d,e,f,g){var h={name:"AES-CBC"},i={name:"HMAC",hash:"SHA-256"};function j(a,b){if(a.length!==b)throw new Error("Signal expected "+b+" bytes, given "+a.length);return a}function a(a,b){return j(new Uint8Array(a),b)}function b(a){var b=a.buffer,c=a.byteOffset;a=a.length;return c===0&&a===b.byteLength?b:b.slice(c,c+a)}function c(a,b){return a.readByteArray(b)}function e(a){return new Uint8Array(a)}function f(a,b,c){if(a.length-b<c)throw new Error("Can not split off "+c+" bytes from index "+b+" of "+a.length+" bytes");return a.slice(b,b+c)}function k(a){a=a==="extendedRange"?(-1>>>1)-1:16380;return d("WACryptoUtils").randomNumberLessThan(a)+1}function l(a){return o(a)}function m(){var a=-1>>>1;return d("WACryptoUtils").randomNumberLessThan(a)+1}function n(a){return o(a)}function o(a,b,c){b===void 0&&(b=0);c===void 0&&(c=4294967296);if(typeof a==="number"&&b<=a&&a<c&&Math.floor(a)===a)return a;else throw new Error("Expected integer in range ["+b+", "+c+"), given "+String(a))}function p(a,b){return d("encodeProtobuf").encodeProtobuf(a,b).readByteArray()}function q(a,b,c){return c(d("decodeProtobuf").decodeProtobuf(a,b))}function r(a,b,c,e){return d("WACryptoHkdf").extractWithSaltAndExpand(a,b,c,e).then(function(a){return new Uint8Array(a)})}function s(a,b){var c,d;b==="hmac-sha256"?(c=i,d=["sign"]):(b,c=h,d=["encrypt","decrypt"]);return self.crypto.subtle.importKey("raw",a,c,!1,d)}function t(a){return a}function u(a){return a}function v(a,b){return d("WACryptoUtils").arrayBuffersEqual(a,b)}g.AES_CBC=h;g.HMAC_SHA256=i;g.ensureSize=j;g.toBytes=a;g.toBuffer=b;g.readBytes=c;g.makeBytes=e;g.sliceBytes=f;g.makeRegistrationId=k;g.castRegistrationId=l;g.makeSenderKeyId=m;g.castSenderKeyId=n;g.ensureIntInRange=o;g.encodeSignalProto=p;g.decodeSignalProto=q;g.hkdf=r;g.makeCryptoKey=s;g.castToByteEncoded=t;g.castToSessionHash=u;g.areSessionHashesEqual=v}),98);
__d("WASignalKeys",["WASignalLocalStorageProtocol.pb","WASignalOther","WATweetnacl","decodeProtobuf"],(function(a,b,c,d,e,f,g){var h=5,i=16777215;function j(a,b){return{publicKey:a,privateKey:b}}function a(a){a=d("WATweetnacl").box.keyPair.fromSecretKey(a);var b=a.publicKey;a=a.secretKey;return j(d("WASignalOther").ensureSize(b,32),d("WASignalOther").ensureSize(a,32))}function b(a,b){return{publicKey:d("WASignalOther").toBytes(a,32),privateKey:d("WASignalOther").toBytes(b,32)}}function k(){var a=d("WATweetnacl").box.keyPair(),b=a.publicKey;a=a.secretKey;a[0]&=248;a[31]=64|a[31]&63;return j(d("WASignalOther").ensureSize(b,32),d("WASignalOther").ensureSize(a,32))}function l(a,b){return j(d("WASignalOther").sliceBytes(b,1,32),a)}function m(a,b){return{serializedPubKey:b,privateKey:a}}function c(){var a=k();return m(a.privateKey,n(a))}function n(a){var b=d("WASignalOther").makeBytes(33);b[0]=h;b.set(a.publicKey,1);return b}function e(a){var b=d("WASignalOther").makeBytes(33);b[0]=h;b.set(d("WASignalOther").ensureSize(a,32),1);return b}function f(a){return m(a.privateKey,n(a))}function o(a,b){a=(a-1)%i;a<=0&&(a+=i);var c=[];for(var e=0;e<b;e++){var f=a===i?1:a+1,g=k(),h=d("WASignalOther").encodeSignalProto(d("WASignalLocalStorageProtocol.pb").PreKeyRecordStructureSpec,{id:f,publicKey:n(g),privateKey:g.privateKey});c.push({plainObject:{id:f,keyPair:g},record:h});a=f}return c}function p(a){try{a=d("decodeProtobuf").decodeProtobuf(d("WASignalLocalStorageProtocol.pb").PreKeyRecordStructureSpec,a);var b=a.id,c=a.publicKey;a=a.privateKey;return b==null||c==null||a==null?null:{id:q(b),keyPair:l(d("WASignalOther").toBytes(a,32),r(new Uint8Array(c)))}}catch(a){return null}}function q(a){return d("WASignalOther").ensureIntInRange(a,1,i)}function r(a){if(a.length===0||a[0]!==h)throw new Error("Unrecognized public key type");return d("WASignalOther").ensureSize(a,33)}function s(){var a=d("WASignalOther").makeBytes(32);self.crypto.getRandomValues(a);return a}function t(a,b){return d("WATweetnacl").scalarMult(a,b.subarray(1)).buffer}g.KEY_TYPE=h;g.makeKeyPairFrom=a;g.makeKeyPairFromArrayBuffers=b;g.makeKeyPair=k;g.makeKeyPairFromSerialized=l;g.makeSerializedKeyPairFrom=m;g.makeSerializedKeyPair=c;g.serializePubKey=n;g.serializeIdentity=e;g.toSerializedKeyPair=f;g.makePreKeys=o;g.deserializePreKey=p;g.castToPreKeyId=q;g.castToSerializedPubKey=r;g.makeRawSenderKey=s;g.ecdh=t}),98);
__d("WASignalSignatures",["Promise","WACryptoEd25519","WAHex","WASignalKeys","WASignalLocalStorageProtocol.pb","WASignalOther","WATweetnacl","decodeProtobuf"],(function(a,b,c,d,e,f,g){function h(a,b,c){return d("WACryptoEd25519").runInAllocationScope(function(){var e=b.length,f=a.privateKey,g=new Uint8Array(32);d("WACryptoEd25519").scalarmultBase(g,f);var h=g[31]&128,i=new Uint8Array(e+128);i[0]=254;i.fill(255,1,32);i.set(f,32);i.set(b,64);i.set(c,e+64);var j=d("WACryptoEd25519").allocate(Uint8Array,64);d("WACryptoEd25519").hashSha512(j,i,e+128);i.set(g,32);g=d("WACryptoEd25519").allocate(Float64Array,64);d("WACryptoEd25519").reduce(j,g);d("WACryptoEd25519").scalarmultBase(i,j);var k=d("WACryptoEd25519").allocate(Uint8Array,64);d("WACryptoEd25519").hashSha512(k,i,e+64);d("WACryptoEd25519").reduce(k,g);for(e=0;e<32;++e)g[e]=j[e];for(e=0;e<32;++e)for(j=0;j<32;++j)g[e+j]+=k[e]*f[j];d("WACryptoEd25519").modL(i.subarray(32,64),g);return{pubKeyNegative:h!==0,signedMsg:i}})}function a(a,c){return b("Promise").resolve().then(function(){var b=d("WASignalOther").makeBytes(64);self.crypto.getRandomValues(b);return i(a,c,b)})}function c(a,b,c){var e=c[63];return e&96?!1:d("WACryptoEd25519").runInAllocationScope(function(){var f=d("WATweetnacl").lowlevel.A,g=d("WATweetnacl").lowlevel.M,h=d("WATweetnacl").lowlevel.Z,i=d("WATweetnacl").lowlevel.pack25519,j=d("WATweetnacl").lowlevel.unpack25519,k=d("WACryptoEd25519").allocate(Uint8Array,64);k.set(c);k[63]=e&127;var l=d("WACryptoEd25519").fieldElement(),m=d("WACryptoEd25519").fieldElement(),n=d("WACryptoEd25519").fieldElement(),o=d("WACryptoEd25519").fieldElement(),p=d("WACryptoEd25519").fieldElement(),q=d("WACryptoEd25519").allocate(Uint8Array,32),r=d("WACryptoEd25519").fieldElement();r[0]=1;j(l,a.subarray(1));h(m,l,r);f(n,l,r);d("WACryptoEd25519").inv25519(o,n);g(p,m,o);i(q,p);q[31]=q[31]&127|e&128;return d("WATweetnacl").sign.detached.verify(b,k,q)})}function i(a,b,c){a=h(a,b,c);b=d("WASignalOther").sliceBytes(a.signedMsg,0,64);b[63]=b[63]&127|(a.pubKeyNegative?128:0);return b}function j(a,b,c){var e=d("WASignalKeys").makeKeyPair(),f=d("WASignalOther").makeBytes(64);self.crypto.getRandomValues(f);c=i(c,d("WASignalKeys").serializePubKey(e),f);if(!Number.isSafeInteger(b))throw new Error("Expected timestamp to be a safe integer, given "+String(b));return{id:d("WASignalKeys").castToPreKeyId(a),ts:b,keyPair:e,signature:c}}function e(a,b){var c=d("WASignalOther").makeBytes(64);self.crypto.getRandomValues(c);a=i(a,b,c);return a}function k(a){var b=a.id,c=a.keyPair;return d("WASignalOther").encodeSignalProto(d("WASignalLocalStorageProtocol.pb").SignedPreKeyRecordStructureSpec,{id:b,publicKey:d("WASignalKeys").serializePubKey(c),privateKey:c.privateKey,signature:a.signature,timestamp:a.ts})}function f(a){try{a=d("decodeProtobuf").decodeProtobuf(d("WASignalLocalStorageProtocol.pb").SignedPreKeyRecordStructureSpec,a);var b=a.id,c=a.publicKey,e=a.privateKey,f=a.signature;a=a.timestamp;return b==null||c==null||e==null||f==null||a==null?null:{id:d("WASignalKeys").castToPreKeyId(b),ts:a,keyPair:d("WASignalKeys").makeKeyPairFromSerialized(d("WASignalOther").toBytes(e,32),d("WASignalKeys").castToSerializedPubKey(new Uint8Array(c))),signature:d("WASignalOther").toBytes(f,64)}}catch(a){return null}}function l(a){return new Uint8Array(d("WAHex").parseHex(a))}function m(a){if(a.length===33)return d("WASignalKeys").castToSerializedPubKey(a);else if(a.length===32)return d("WASignalKeys").serializeIdentity(a);else throw new Error("verifyCertificate publicKey incorrect length")}function n(a,c,d){return b("Promise").resolve().then(function(){var b=j(a,c,d),e=k(b);return{plainObject:b,record:e}})}g.signMsg=a;g.verifyMsgSignalVariant=c;g.makeSignature=i;g.makeSignedPreKey=j;g.signSenderKeyMessage=e;g.serializeSignedPreKeyForPrivateStorage=k;g.deserializeSignedPreKey=f;g.convertPublicKeyHexToUint8Array=l;g.convertPublicKeyToSerializedPubKey=m;g.generateSignedPreKey=n}),98);
__d("WAFixedSizeMap",[],(function(a,b,c,d,e,f){a=function(){function a(a){a=a.max;this.$1=new Map();this.$2=new Map();this.$3=0;this.$4=100;this.$4=a}var b=a.prototype;b.has=function(a){return this.$1.has(a)};b.get=function(a){return this.$1.get(a)};b.set=function(a,b){this.$1.set(a,b);this.$2.set(this.$3,a);this.$3+=1;b=this.$2.get(this.$3-this.$4-1);b!=null&&(this.$1["delete"](b),this.$2["delete"](this.$3-this.$4-1))};b.clear=function(){this.$1.clear(),this.$2.clear(),this.$3=0};b.size=function(){return this.$1.size};return a}();f.FixedSizeMap=a}),66);
__d("WAIdentityUtils",["WABinary","WASignalOther"],(function(a,b,c,d,e,f,g){"use strict";function h(a){var b=a.length===33&&a[0]===5;return b?a.slice(1):a}function i(a,b){for(var c=0;c<a.length&&c<b.length;++c)if(a[c]!==b[c])return a[c]-b[c];return a.length-b.length}function a(a){a=a.map(function(a){return h(a)});var b=new(d("WABinary").Binary)();a.sort(i).forEach(function(a){return b.writeByteArray(a)});a=self.crypto.subtle.digest("SHA-256",b.readByteArray());return a.then(function(a){a=new Uint8Array(a);return d("WASignalOther").sliceBytes(a,0,10)})}g.removeKeyTypeIfNeeded=h;g.computeIdentitiesHash=a}),98);
__d("WAICDCUtils",["WAArmadilloICDC.pb","WABase64","WABinary","WACryptoEd25519","WACryptoUtils","WAErr","WAIdentityUtils","WAJids","WALogger","WASignalKeys","WASignalOther","WASignalSignatures","WATimeUtils","decodeProtobuf","encodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["signingDeviceIndex not found. This should never happen."]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Received ICDC has mismatched missed signingDeviceIndex"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Received ICDC has mismatched timestamp between XML node and byte structure"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Received ICDC has mismatched sequence between XML node and byte structure"]);k=function(){return a};return a}function a(a,b,c,e){if(a!==e.details.seq){d("WALogger").ERROR(k());return null}if(c!==e.details.timestamp){d("WALogger").ERROR(j());return null}if(e.details.signingDeviceIndex==null){d("WALogger").ERROR(i());return null}var f=e.details.signingDeviceIndex;return{dirty:b,sequence:a,timestamp:c,signingDeviceIndex:f,devices:e.details.devices.map(function(a){return new Uint8Array(a)})}}function l(a,b){var c=new Set(),e=new Set();b.devices.forEach(function(a){c.add(a.id),e.add(a.identity.toString())});var f=new Set(),g=new Set();a.devicesInfo.forEach(function(a){var b=d("WAJids").extractDeviceId(a.jid);a=d("WAIdentityUtils").removeKeyTypeIfNeeded(a.identity);(!c.has(b)||!e.has(a.toString()))&&(f.add(b),g.add(a.buffer))});return{seq:b.sequence,signingDevice:d("WAIdentityUtils").removeKeyTypeIfNeeded(b.devices[b.signingDeviceIndex].identity).buffer,unknownDevices:Array.from(g),unknownDeviceIds:Array.from(f)}}function b(a,b,c){var d=new Map();c.forEach(function(a){d.set(a.user,a)});c=d.get(a.user);var e=void 0;c!=null&&(e=l(a,c));var f=[],g=[];b.forEach(function(a){var b=d.get(a.user);if(b!=null){b=l(a,b);f.push(b)}g.push(a.user)});return f.length===0||e==null?null:{senderIdentity:e,recipientIdentities:f,recipientUserJids:g}}function e(a,b,c){if(a==null||a.seq==null||a.signingDevice==null)return{action:"none"};else if(b==null)return{action:"error",failureTs:d("WATimeUtils").unixTime(),sync:!0};var e=a.seq,f=a.signingDevice;if(e===b.sequence){var g=new Set();c.forEach(function(a){return g.add(d("WAIdentityUtils").removeKeyTypeIfNeeded(a).toString())});e=!g.has(new Uint8Array(f).toString());b=a.unknownDevices.find(function(a){return!g.has(new Uint8Array(a).toString())})!=null;if(e||b)return{action:"error",failureTs:d("WATimeUtils").unixTime(),sync:!1}}else return{action:"error",failureTs:d("WATimeUtils").unixTime(),sync:!0};return{action:"none"}}function f(a){a=d("decodeProtobuf").decodeProtobuf(d("WAArmadilloICDC.pb").SignedICDCIdentityListSpec,a);var b=a.signature;a=d("decodeProtobuf").decodeProtobuf(d("WAArmadilloICDC.pb").ICDCIdentityListSpec,a.details);return{signature:b,details:a}}function m(a){return a.map(function(a){return d("WASignalKeys").serializeIdentity(new Uint8Array(d("WABase64").decodeB64UrlSafe(a)))})}function n(a,b,e){var f=d("WAIdentityUtils").removeKeyTypeIfNeeded(a.publicKey);e=e.map(function(a){return d("WAIdentityUtils").removeKeyTypeIfNeeded(a)});var g=e.findIndex(function(a){return d("WACryptoUtils").uint8ArraysEqual(a,f)});if(g===-1){d("WALogger").ERROR(h());throw c("WAErr")("signingDeviceIndex not found")}b=b==null?1:b.sequence+1;var i=d("WATimeUtils").unixTime();b={seq:b,timestamp:i,devices:e,signingDeviceIndex:g};i=d("encodeProtobuf").encodeProtobuf(d("WAArmadilloICDC.pb").ICDCIdentityListSpec,b).readBuffer();e=o(a,d("WABinary").Binary.build(i).readByteArray());g={details:i,signature:e};a=d("encodeProtobuf").encodeProtobuf(d("WAArmadilloICDC.pb").SignedICDCIdentityListSpec,g).readBuffer();return{icdcInfo:b,encodedSignedICDC:a}}function o(a,b){var c=d("WASignalOther").makeBytes(64);self.crypto.getRandomValues(c);var e=new Uint8Array(64);d("WACryptoEd25519").hashSha512(e,b,b.length);e=d("WASignalSignatures").makeSignature(a,b,c);return d("WABinary").Binary.build(e).readBuffer()}g.validateAndPrepareICDCFromNotification=a;g.computeUnknownRecipients=l;g.computeICDCParticipantDevices=b;g.validateICDCInfo=e;g.decodeICDCInfo=f;g.base64DeviceIdentitiesToSerializedPubKeys=m;g.computeICDCInfoForUpload=n}),98);